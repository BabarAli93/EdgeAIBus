{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -228686.4375, "policy_loss": -232659.796875, "entropy": 12.424266815185547, "entropy_coeff": 0.01, "var_gnorm": 16.000333786010742, "vf_loss": 404168.875, "vf_explained_var": 9.924173355102539e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 4.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272727293}}, "num_env_steps_sampled": 2550, "num_env_steps_trained": 2200, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 2200, "learner_queue": {"size_count": 4, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 104.022, "learner_load_time_ms": 2.521, "learner_load_wait_time_ms": 2203.202, "learner_dequeue_time_ms": 4790.992}}, "env_runners": {"episode_reward_max": -176.7622233624081, "episode_reward_min": -306.16582520950936, "episode_reward_mean": -250.38171241662394, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 2400, "policy_reward_min": {"default_policy": -306.16582520950936}, "policy_reward_max": {"default_policy": -176.7622233624081}, "policy_reward_mean": {"default_policy": -250.38171241662394}, "custom_metrics": {"num_consolidated_mean": 2.4175, "num_consolidated_min": 2.21, "num_consolidated_max": 2.54, "num_overloaded_mean": 0.7287500000000001, "num_overloaded_min": 0.63, "num_overloaded_max": 0.85, "num_moves_mean": 4.1658333333333335, "num_moves_min": 3.99, "num_moves_max": 4.3, "mean_accuracy_mean": 41.03413333333334, "mean_accuracy_min": 40.7352, "mean_accuracy_max": 41.3736, "num_model_switches_mean": 2.4758333333333336, "num_model_switches_min": 2.25, "num_model_switches_max": 2.69, "num_slav_mean": 0.19143, "num_slav_min": 0.16344, "num_slav_max": 0.22616, "cpu_conserved_cost_mean": 4.835, "cpu_conserved_cost_min": 4.42, "cpu_conserved_cost_max": 5.08, "mean_cluster_cpu_util_mean": 0.7327461427748992, "mean_cluster_cpu_util_min": 0.7177247841105354, "mean_cluster_cpu_util_max": 0.755000518134715, "mean_cluster_mem_util_mean": 0.5189384070294785, "mean_cluster_mem_util_min": 0.5122638888888889, "mean_cluster_mem_util_max": 0.5272284580498866, "oversub_cores_mean": 0.9594991364421416, "oversub_cores_min": 0.9295336787564767, "oversub_cores_max": 0.9910189982728842, "reward_consolidation_mean_mean": -0.07860045749957255, "reward_consolidation_mean_min": -0.1656815460920131, "reward_consolidation_mean_max": -0.02649649392851046, "reward_illegal_mean_mean": -1.2145833333333333, "reward_illegal_mean_min": -1.4166666666666663, "reward_illegal_mean_max": -1.05, "reward_accuracy_mean_mean": 1.457499999999998, "reward_accuracy_mean_min": 0.8799999999999966, "reward_accuracy_mean_max": 1.9799999999999986, "reward_sla_mean_mean": -2.6681333333333335, "reward_sla_mean_min": -3.6464, "reward_sla_mean_max": -1.4176, "reward_consolidation_sum_mean": -7.860045749957254, "reward_consolidation_sum_min": -16.56815460920131, "reward_consolidation_sum_max": -2.649649392851046, "reward_illegal_sum_mean": -121.45833333333331, "reward_illegal_sum_min": -141.66666666666663, "reward_illegal_sum_max": -105.0, "reward_accuracy_sum_mean": 145.7499999999998, "reward_accuracy_sum_min": 87.99999999999966, "reward_accuracy_sum_max": 197.99999999999986, "reward_sla_sum_mean": -266.81333333333333, "reward_sla_sum_min": -364.64, "reward_sla_sum_max": -141.76, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 450.0, "global_timestep_min": 100, "global_timestep_max": 800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.368685615889194, "mean_inference_ms": 1.5845521963487827, "mean_action_processing_ms": 0.15775838927385902, "mean_env_wait_ms": 1.7845903337585474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014244516690572103, "StateBufferConnector_ms": 0.0065515438715616865, "ViewRequirementAgentConnector_ms": 0.13497571150461832}, "num_episodes": 24, "episode_return_max": -176.7622233624081, "episode_return_min": -306.16582520950936, "episode_return_mean": -250.38171241662394, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2200, "num_env_steps_sampled": 2550, "num_env_steps_trained": 2200, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 243.0839097919894, "num_env_steps_trained_throughput_per_sec": 209.71945158524576, "timesteps_total": 2550, "num_env_steps_sampled_lifetime": 2550, "num_agent_steps_sampled_lifetime": 2550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 2550, "timers": {"training_iteration_time_ms": 10490.229, "restore_workers_time_ms": 0.023, "training_step_time_ms": 628.547, "sample_time_ms": 605.191, "synch_weights_time_ms": 20.911}, "counters": {"num_env_steps_sampled": 2550, "num_env_steps_trained": 2200, "num_agent_steps_sampled": 2550, "num_agent_steps_trained": 2200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 17, "num_samples_added_to_queue": 2200}, "done": false, "training_iteration": 1, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-47-23", "timestamp": 1731091643, "time_this_iter_s": 10.499224662780762, "time_total_s": 10.499224662780762, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6ef73010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.499224662780762, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.733333333333334, "ram_util_percent": 65.72}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -193208.015625, "policy_loss": -196082.109375, "entropy": 12.423978805541992, "entropy_coeff": 0.01, "var_gnorm": 16.000463485717773, "vf_loss": 294242.1875, "vf_explained_var": 0.0004407167434692383}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 8.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 4950, "num_env_steps_trained": 4400, "num_agent_steps_sampled": 4950, "num_agent_steps_trained": 4400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 33, "num_samples_added_to_queue": 4950, "learner_queue": {"size_count": 8, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 105.484, "learner_load_time_ms": 2.521, "learner_load_wait_time_ms": 2219.994, "learner_dequeue_time_ms": 4790.992}}, "env_runners": {"episode_reward_max": -176.7622233624081, "episode_reward_min": -306.16582520950936, "episode_reward_mean": -245.9579836525854, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 4800, "policy_reward_min": {"default_policy": -306.16582520950936}, "policy_reward_max": {"default_policy": -176.7622233624081}, "policy_reward_mean": {"default_policy": -245.9579836525854}, "custom_metrics": {"num_consolidated_mean": 2.4122916666666665, "num_consolidated_min": 2.21, "num_consolidated_max": 2.54, "num_overloaded_mean": 0.7385416666666668, "num_overloaded_min": 0.63, "num_overloaded_max": 0.86, "num_moves_mean": 4.154166666666667, "num_moves_min": 3.99, "num_moves_max": 4.3, "mean_accuracy_mean": 41.08955, "mean_accuracy_min": 40.7352, "mean_accuracy_max": 41.495200000000004, "num_model_switches_mean": 2.486458333333333, "num_model_switches_min": 2.25, "num_model_switches_max": 2.76, "num_slav_mean": 0.192835, "num_slav_min": 0.16344, "num_slav_max": 0.22616, "cpu_conserved_cost_mean": 4.824583333333333, "cpu_conserved_cost_min": 4.42, "cpu_conserved_cost_max": 5.08, "mean_cluster_cpu_util_mean": 0.7329586427748994, "mean_cluster_cpu_util_min": 0.7177247841105354, "mean_cluster_cpu_util_max": 0.755000518134715, "mean_cluster_mem_util_mean": 0.5188942554799698, "mean_cluster_mem_util_min": 0.5122638888888889, "mean_cluster_mem_util_max": 0.5272284580498866, "oversub_cores_mean": 0.9586211859527921, "oversub_cores_min": 0.9295336787564767, "oversub_cores_max": 0.9910189982728842, "reward_consolidation_mean_mean": -0.08682705874807606, "reward_consolidation_mean_min": -0.1656815460920131, "reward_consolidation_mean_max": -0.02649649392851046, "reward_illegal_mean_mean": -1.2309027777777777, "reward_illegal_mean_min": -1.433333333333333, "reward_illegal_mean_max": -1.05, "reward_accuracy_mean_mean": 1.4504166666666654, "reward_accuracy_mean_min": 0.8799999999999966, "reward_accuracy_mean_max": 1.9799999999999986, "reward_sla_mean_mean": -2.5922666666666667, "reward_sla_mean_min": -3.6464, "reward_sla_mean_max": -1.4176, "reward_consolidation_sum_mean": -8.682705874807604, "reward_consolidation_sum_min": -16.56815460920131, "reward_consolidation_sum_max": -2.649649392851046, "reward_illegal_sum_mean": -123.09027777777776, "reward_illegal_sum_min": -143.3333333333333, "reward_illegal_sum_max": -105.0, "reward_accuracy_sum_mean": 145.04166666666652, "reward_accuracy_sum_min": 87.99999999999966, "reward_accuracy_sum_max": 197.99999999999986, "reward_sla_sum_mean": -259.22666666666663, "reward_sla_sum_min": -364.64, "reward_sla_sum_max": -141.76, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 850.0, "global_timestep_min": 100, "global_timestep_max": 1600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3720877876797668, "mean_inference_ms": 1.595805941335913, "mean_action_processing_ms": 0.15907318269067475, "mean_env_wait_ms": 1.8014354872503198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013603270053863525, "StateBufferConnector_ms": 0.006582339604695638, "ViewRequirementAgentConnector_ms": 0.137255589167277}, "num_episodes": 24, "episode_return_max": -176.7622233624081, "episode_return_min": -306.16582520950936, "episode_return_mean": -245.9579836525854, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4950, "num_agent_steps_trained": 4400, "num_env_steps_sampled": 4950, "num_env_steps_trained": 4400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 233.71276865756678, "num_env_steps_trained_throughput_per_sec": 214.23670460276955, "timesteps_total": 4950, "num_env_steps_sampled_lifetime": 4950, "num_agent_steps_sampled_lifetime": 4950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 4950, "timers": {"training_iteration_time_ms": 10379.628, "restore_workers_time_ms": 0.023, "training_step_time_ms": 631.628, "sample_time_ms": 610.635, "synch_weights_time_ms": 18.732}, "counters": {"num_env_steps_sampled": 4950, "num_env_steps_trained": 4400, "num_agent_steps_sampled": 4950, "num_agent_steps_trained": 4400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 33, "num_samples_added_to_queue": 4950}, "done": false, "training_iteration": 2, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-47-34", "timestamp": 1731091654, "time_this_iter_s": 10.317593336105347, "time_total_s": 20.81681799888611, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6ef165c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.81681799888611, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.846666666666668, "ram_util_percent": 65.62000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -215803.984375, "policy_loss": -219358.203125, "entropy": 12.42363452911377, "entropy_coeff": 0.01, "var_gnorm": 16.000547409057617, "vf_loss": 362254.15625, "vf_explained_var": 0.0007982850074768066}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 13.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7150, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 50, "num_samples_added_to_queue": 7150, "learner_queue": {"size_count": 13, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 112.794, "learner_load_time_ms": 1.667, "learner_load_wait_time_ms": 2250.278, "learner_dequeue_time_ms": 11687.629}}, "env_runners": {"episode_reward_max": -176.7622233624081, "episode_reward_min": -329.27926458012706, "episode_reward_mean": -250.5933056040135, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 7500, "policy_reward_min": {"default_policy": -329.27926458012706}, "policy_reward_max": {"default_policy": -176.7622233624081}, "policy_reward_mean": {"default_policy": -250.5933056040135}, "custom_metrics": {"num_consolidated_mean": 2.415466666666666, "num_consolidated_min": 2.21, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7354666666666668, "num_overloaded_min": 0.58, "num_overloaded_max": 0.87, "num_moves_mean": 4.162800000000001, "num_moves_min": 3.99, "num_moves_max": 4.3, "mean_accuracy_mean": 41.07547733333333, "mean_accuracy_min": 40.7352, "mean_accuracy_max": 41.495200000000004, "num_model_switches_mean": 2.494533333333334, "num_model_switches_min": 2.25, "num_model_switches_max": 2.76, "num_slav_mean": 0.1914533333333333, "num_slav_min": 0.16227999999999998, "num_slav_max": 0.22616, "cpu_conserved_cost_mean": 4.830933333333332, "cpu_conserved_cost_min": 4.42, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.7331838917674152, "mean_cluster_cpu_util_min": 0.7134000863557859, "mean_cluster_cpu_util_max": 0.7656183074265975, "mean_cluster_mem_util_mean": 0.5190065170068028, "mean_cluster_mem_util_min": 0.5116354875283446, "mean_cluster_mem_util_max": 0.531653798185941, "oversub_cores_mean": 0.9591663788140471, "oversub_cores_min": 0.9295336787564767, "oversub_cores_max": 1.0055267702936097, "reward_consolidation_mean_mean": -0.08565927826235688, "reward_consolidation_mean_min": -0.1656815460920131, "reward_consolidation_mean_max": -0.018618094749444255, "reward_illegal_mean_mean": -1.2257777777777774, "reward_illegal_mean_min": -1.4499999999999997, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.4677333333333316, "reward_accuracy_mean_min": 0.8799999999999966, "reward_accuracy_mean_max": 2.099999999999997, "reward_sla_mean_mean": -2.6622293333333333, "reward_sla_mean_min": -4.3088, "reward_sla_mean_max": -1.4176, "reward_consolidation_sum_mean": -8.565927826235685, "reward_consolidation_sum_min": -16.56815460920131, "reward_consolidation_sum_max": -1.8618094749444256, "reward_illegal_sum_mean": -122.57777777777777, "reward_illegal_sum_min": -144.99999999999997, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 146.7733333333332, "reward_accuracy_sum_min": 87.99999999999966, "reward_accuracy_sum_max": 209.99999999999972, "reward_sla_sum_mean": -266.2229333333333, "reward_sla_sum_min": -430.88, "reward_sla_sum_max": -141.76, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1300.0, "global_timestep_min": 100, "global_timestep_max": 2500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3736992531989407, "mean_inference_ms": 1.5957489587273874, "mean_action_processing_ms": 0.1593672325635799, "mean_env_wait_ms": 1.8057414259857478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013134956359863281, "StateBufferConnector_ms": 0.0066089630126953125, "ViewRequirementAgentConnector_ms": 0.1385666529337565}, "num_episodes": 27, "episode_return_max": -176.7622233624081, "episode_return_min": -329.27926458012706, "episode_return_mean": -250.5933056040135, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7150, "num_env_steps_sampled": 7500, "num_env_steps_trained": 7150, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 239.57333246841384, "num_env_steps_trained_throughput_per_sec": 258.36339776005417, "timesteps_total": 7500, "num_env_steps_sampled_lifetime": 7500, "num_agent_steps_sampled_lifetime": 7500, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 7500, "timers": {"training_iteration_time_ms": 10467.734, "restore_workers_time_ms": 0.024, "training_step_time_ms": 635.231, "sample_time_ms": 607.006, "synch_weights_time_ms": 25.687}, "counters": {"num_env_steps_sampled": 7500, "num_env_steps_trained": 7150, "num_agent_steps_sampled": 7500, "num_agent_steps_trained": 7150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 50, "num_samples_added_to_queue": 7150}, "done": false, "training_iteration": 3, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-47-45", "timestamp": 1731091665, "time_this_iter_s": 10.660171508789062, "time_total_s": 31.47698950767517, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6ef14d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.47698950767517, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 19.381249999999998, "ram_util_percent": 65.83125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -206224.703125, "policy_loss": -209485.046875, "entropy": 12.423266410827637, "entropy_coeff": 0.01, "var_gnorm": 16.00096893310547, "vf_loss": 332866.6875, "vf_explained_var": 0.001145482063293457}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 17.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 9900, "num_env_steps_trained": 9350, "num_agent_steps_sampled": 9900, "num_agent_steps_trained": 9350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 66, "num_samples_added_to_queue": 9900, "learner_queue": {"size_count": 17, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 107.67, "learner_load_time_ms": 1.164, "learner_load_wait_time_ms": 2213.473, "learner_dequeue_time_ms": 14015.972}}, "env_runners": {"episode_reward_max": -176.7622233624081, "episode_reward_min": -329.27926458012706, "episode_reward_mean": -250.45060783998704, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9900, "policy_reward_min": {"default_policy": -329.27926458012706}, "policy_reward_max": {"default_policy": -176.7622233624081}, "policy_reward_mean": {"default_policy": -250.45060783998704}, "custom_metrics": {"num_consolidated_mean": 2.418484848484849, "num_consolidated_min": 2.21, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7360606060606063, "num_overloaded_min": 0.58, "num_overloaded_max": 0.87, "num_moves_mean": 4.167676767676768, "num_moves_min": 3.99, "num_moves_max": 4.33, "mean_accuracy_mean": 41.0800404040404, "mean_accuracy_min": 40.7352, "mean_accuracy_max": 41.495200000000004, "num_model_switches_mean": 2.502727272727273, "num_model_switches_min": 2.25, "num_model_switches_max": 2.76, "num_slav_mean": 0.19144565656565662, "num_slav_min": 0.16227999999999998, "num_slav_max": 0.22616, "cpu_conserved_cost_mean": 4.836969696969698, "cpu_conserved_cost_min": 4.42, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.7340564348144658, "mean_cluster_cpu_util_min": 0.7134000863557859, "mean_cluster_cpu_util_max": 0.7656183074265975, "mean_cluster_mem_util_mean": 0.5193218780778305, "mean_cluster_mem_util_min": 0.5116354875283446, "mean_cluster_mem_util_max": 0.531653798185941, "oversub_cores_mean": 0.9603635665811832, "oversub_cores_min": 0.9295336787564767, "oversub_cores_max": 1.0055267702936097, "reward_consolidation_mean_mean": -0.08707173496552678, "reward_consolidation_mean_min": -0.1656815460920131, "reward_consolidation_mean_max": -0.018618094749444255, "reward_illegal_mean_mean": -1.2267676767676767, "reward_illegal_mean_min": -1.4499999999999997, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.4668686868686853, "reward_accuracy_mean_min": 0.8799999999999966, "reward_accuracy_mean_max": 2.099999999999997, "reward_sla_mean_mean": -2.6575353535353536, "reward_sla_mean_min": -4.3088, "reward_sla_mean_max": -1.4176, "reward_consolidation_sum_mean": -8.707173496552677, "reward_consolidation_sum_min": -16.56815460920131, "reward_consolidation_sum_max": -1.8618094749444256, "reward_illegal_sum_mean": -122.67676767676764, "reward_illegal_sum_min": -144.99999999999997, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 146.68686868686854, "reward_accuracy_sum_min": 87.99999999999966, "reward_accuracy_sum_max": 209.99999999999972, "reward_sla_sum_mean": -265.7535353535353, "reward_sla_sum_min": -430.88, "reward_sla_sum_max": -141.76, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1700.0, "global_timestep_min": 100, "global_timestep_max": 3300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-228.385736275013, -266.95820762784336, -176.7622233624081, -239.38828116983066, -224.81660338635203, -226.80028390627695, -306.16582520950936, -284.38158371814603, -261.99973319651104, -252.9990114588677, -239.60040020523334, -271.64964939285136, -249.71631948007504, -238.95495809817018, -222.8074157687705, -260.0961210877373, -241.72740208653983, -258.9189396271593, -241.03659312467948, -243.24815460920118, -270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37449413720645364, "mean_inference_ms": 1.5976346368804675, "mean_action_processing_ms": 0.15981178359261738, "mean_env_wait_ms": 1.8105109415331695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012844018261842054, "StateBufferConnector_ms": 0.006587336761782868, "ViewRequirementAgentConnector_ms": 0.13853106835875847}, "num_episodes": 24, "episode_return_max": -176.7622233624081, "episode_return_min": -329.27926458012706, "episode_return_mean": -250.45060783998704, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9900, "num_agent_steps_trained": 9350, "num_env_steps_sampled": 9900, "num_env_steps_trained": 9350, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 231.94323332612365, "num_env_steps_trained_throughput_per_sec": 212.61463054894668, "timesteps_total": 9900, "num_env_steps_sampled_lifetime": 9900, "num_agent_steps_sampled_lifetime": 9900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 9900, "timers": {"training_iteration_time_ms": 10437.644, "restore_workers_time_ms": 0.022, "training_step_time_ms": 650.898, "sample_time_ms": 622.883, "synch_weights_time_ms": 25.667}, "counters": {"num_env_steps_sampled": 9900, "num_env_steps_trained": 9350, "num_agent_steps_sampled": 9900, "num_agent_steps_trained": 9350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 66, "num_samples_added_to_queue": 9900}, "done": false, "training_iteration": 4, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-47-55", "timestamp": 1731091675, "time_this_iter_s": 10.363366603851318, "time_total_s": 41.84035611152649, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6ed51000>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.84035611152649, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.928571428571427, "ram_util_percent": 65.64285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -214401.65625, "policy_loss": -217975.03125, "entropy": 12.422759056091309, "entropy_coeff": 0.01, "var_gnorm": 16.00187873840332, "vf_loss": 364169.8125, "vf_explained_var": 0.0013648271560668945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 21.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 12150, "num_env_steps_trained": 11550, "num_agent_steps_sampled": 12150, "num_agent_steps_trained": 11550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 81, "num_samples_added_to_queue": 12100, "learner_queue": {"size_count": 21, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 102.588, "learner_load_time_ms": 1.164, "learner_load_wait_time_ms": 2354.995, "learner_dequeue_time_ms": 14015.972}}, "env_runners": {"episode_reward_max": -195.56748075936386, "episode_reward_min": -329.27926458012706, "episode_reward_mean": -252.5272662561998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -329.27926458012706}, "policy_reward_max": {"default_policy": -195.56748075936386}, "policy_reward_mean": {"default_policy": -252.5272662561998}, "custom_metrics": {"num_consolidated_mean": 2.4183, "num_consolidated_min": 2.25, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7387000000000001, "num_overloaded_min": 0.58, "num_overloaded_max": 0.87, "num_moves_mean": 4.173500000000001, "num_moves_min": 4.02, "num_moves_max": 4.33, "mean_accuracy_mean": 41.09057600000001, "mean_accuracy_min": 40.7352, "mean_accuracy_max": 41.495200000000004, "num_model_switches_mean": 2.5068, "num_model_switches_min": 2.27, "num_model_switches_max": 2.76, "num_slav_mean": 0.1917096, "num_slav_min": 0.16227999999999998, "num_slav_max": 0.23392000000000002, "cpu_conserved_cost_mean": 4.8366, "cpu_conserved_cost_min": 4.5, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.7339443851468048, "mean_cluster_cpu_util_min": 0.7134000863557859, "mean_cluster_cpu_util_max": 0.7656183074265975, "mean_cluster_mem_util_mean": 0.519232578798186, "mean_cluster_mem_util_min": 0.5114789115646259, "mean_cluster_mem_util_max": 0.531653798185941, "oversub_cores_mean": 0.9598963730569946, "oversub_cores_min": 0.9316062176165802, "oversub_cores_max": 1.0055267702936097, "reward_consolidation_mean_mean": -0.08724199589533103, "reward_consolidation_mean_min": -0.16885240294167964, "reward_consolidation_mean_max": -0.005151359671626574, "reward_illegal_mean_mean": -1.2311666666666667, "reward_illegal_mean_min": -1.4499999999999997, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.4635999999999985, "reward_accuracy_mean_min": 1.0199999999999967, "reward_accuracy_mean_max": 2.099999999999997, "reward_sla_mean_mean": -2.670464, "reward_sla_mean_min": -4.3088, "reward_sla_mean_max": -1.7168, "reward_consolidation_sum_mean": -8.724199589533105, "reward_consolidation_sum_min": -16.885240294167964, "reward_consolidation_sum_max": -0.5151359671626574, "reward_illegal_sum_mean": -123.11666666666665, "reward_illegal_sum_min": -144.99999999999997, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 146.35999999999984, "reward_accuracy_sum_min": 101.99999999999967, "reward_accuracy_sum_max": 209.99999999999972, "reward_sla_sum_mean": -267.04639999999995, "reward_sla_sum_min": -430.88, "reward_sla_sum_max": -171.68, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2378.0, "global_timestep_min": 500, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-270.07455789293664, -259.2019223533436, -287.6879459551908, -255.78322900632787, -266.8426646143321, -203.786930049598, -249.8167299469811, -205.52610569522835, -252.91106208311942, -230.132163502651, -276.3891841970239, -246.96331109970933, -227.11399350094052, -271.2682230203522, -235.20571233110982, -246.82192919445845, -275.02590730289023, -239.87527278946447, -224.71288181973662, -220.29766375919274, -287.63476312638954, -235.3780537027537, -261.2953377800583, -210.4960458354716, -213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764631979118193, "mean_inference_ms": 1.604311384880284, "mean_action_processing_ms": 0.16074408849939936, "mean_env_wait_ms": 1.820525113800934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012454748153686523, "StateBufferConnector_ms": 0.00666046142578125, "ViewRequirementAgentConnector_ms": 0.14114904403686523}, "num_episodes": 21, "episode_return_max": -195.56748075936386, "episode_return_min": -329.27926458012706, "episode_return_mean": -252.5272662561998, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12150, "num_agent_steps_trained": 11550, "num_env_steps_sampled": 12150, "num_env_steps_trained": 11550, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 220.48306882150067, "num_env_steps_trained_throughput_per_sec": 215.58344506991176, "timesteps_total": 12150, "num_env_steps_sampled_lifetime": 12150, "num_agent_steps_sampled_lifetime": 12150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 12150, "timers": {"training_iteration_time_ms": 10391.091, "restore_workers_time_ms": 0.031, "training_step_time_ms": 678.41, "sample_time_ms": 653.516, "synch_weights_time_ms": 22.519}, "counters": {"num_env_steps_sampled": 12150, "num_env_steps_trained": 11550, "num_agent_steps_sampled": 12150, "num_agent_steps_trained": 11550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 81, "num_samples_added_to_queue": 12100}, "done": false, "training_iteration": 5, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-48-05", "timestamp": 1731091685, "time_this_iter_s": 10.22165560722351, "time_total_s": 52.06201171875, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5f1b70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.06201171875, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.06, "ram_util_percent": 65.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -195387.375, "policy_loss": -198427.625, "entropy": 12.42182731628418, "entropy_coeff": 0.01, "var_gnorm": 16.003765106201172, "vf_loss": 310855.46875, "vf_explained_var": 0.0018510222434997559}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 97, "num_samples_added_to_queue": 14300, "learner_queue": {"size_count": 26, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 117.561, "learner_load_time_ms": 0.918, "learner_load_wait_time_ms": 2356.025, "learner_dequeue_time_ms": 15539.021}}, "env_runners": {"episode_reward_max": -195.56748075936386, "episode_reward_min": -329.27926458012706, "episode_reward_mean": -254.42733134941003, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -329.27926458012706}, "policy_reward_max": {"default_policy": -195.56748075936386}, "policy_reward_mean": {"default_policy": -254.42733134941003}, "custom_metrics": {"num_consolidated_mean": 2.4252000000000002, "num_consolidated_min": 2.25, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7421, "num_overloaded_min": 0.58, "num_overloaded_max": 0.87, "num_moves_mean": 4.176900000000001, "num_moves_min": 3.99, "num_moves_max": 4.33, "mean_accuracy_mean": 41.08784, "mean_accuracy_min": 40.7808, "mean_accuracy_max": 41.571200000000005, "num_model_switches_mean": 2.5038, "num_model_switches_min": 2.25, "num_model_switches_max": 2.8, "num_slav_mean": 0.19183, "num_slav_min": 0.16227999999999998, "num_slav_max": 0.23392000000000002, "cpu_conserved_cost_mean": 4.8504000000000005, "cpu_conserved_cost_min": 4.5, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.7346469663212436, "mean_cluster_cpu_util_min": 0.713139378238342, "mean_cluster_cpu_util_max": 0.7656183074265975, "mean_cluster_mem_util_mean": 0.5195096660997732, "mean_cluster_mem_util_min": 0.5107615079365079, "mean_cluster_mem_util_max": 0.531653798185941, "oversub_cores_mean": 0.9609533678756478, "oversub_cores_min": 0.9288428324697755, "oversub_cores_max": 1.0055267702936097, "reward_consolidation_mean_mean": -0.08412798016076632, "reward_consolidation_mean_min": -0.16885240294167964, "reward_consolidation_mean_max": -0.005151359671626574, "reward_illegal_mean_mean": -1.2368333333333332, "reward_illegal_mean_min": -1.4499999999999997, "reward_illegal_mean_max": -0.9666666666666666, "reward_accuracy_mean_mean": 1.445599999999998, "reward_accuracy_mean_min": 0.9199999999999975, "reward_accuracy_mean_max": 2.099999999999997, "reward_sla_mean_mean": -2.6689119999999997, "reward_sla_mean_min": -4.3088, "reward_sla_mean_max": -1.568, "reward_consolidation_sum_mean": -8.412798016076634, "reward_consolidation_sum_min": -16.885240294167964, "reward_consolidation_sum_max": -0.5151359671626574, "reward_illegal_sum_mean": -123.68333333333334, "reward_illegal_sum_min": -144.99999999999997, "reward_illegal_sum_max": -96.66666666666666, "reward_accuracy_sum_mean": 144.55999999999983, "reward_accuracy_sum_min": 91.99999999999974, "reward_accuracy_sum_max": 209.99999999999972, "reward_sla_sum_mean": -266.8912, "reward_sla_sum_min": -430.88, "reward_sla_sum_max": -156.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3178.0, "global_timestep_min": 1300, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.23286813750647, -281.18072515820097, -200.0569659654525, -234.85762271250195, -251.40870873952454, -269.91772532922886, -287.5343150333503, -256.78000000000003, -329.27926458012706, -238.56345476312637, -269.44676244227816, -251.8387343937063, -249.4460851718832, -241.07988712160085, -270.9497691123651, -234.79511202325972, -272.48369762271267, -244.56315033350432, -239.4874739182488, -280.92847614161104, -283.7610022233624, -219.01775953480427, -199.74173422267853, -263.03551564905086, -278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3786394077588911, "mean_inference_ms": 1.6131468127547242, "mean_action_processing_ms": 0.1616690897910478, "mean_env_wait_ms": 1.8288238351931432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227426528930664, "StateBufferConnector_ms": 0.0067920684814453125, "ViewRequirementAgentConnector_ms": 0.1437528133392334}, "num_episodes": 24, "episode_return_max": -195.56748075936386, "episode_return_min": -329.27926458012706, "episode_return_mean": -254.42733134941003, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 231.4354188838175, "num_env_steps_trained_throughput_per_sec": 265.1864174710409, "timesteps_total": 14550, "num_env_steps_sampled_lifetime": 14550, "num_agent_steps_sampled_lifetime": 14550, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 14550, "timers": {"training_iteration_time_ms": 10387.589, "restore_workers_time_ms": 0.024, "training_step_time_ms": 646.577, "sample_time_ms": 619.663, "synch_weights_time_ms": 24.482}, "counters": {"num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 97, "num_samples_added_to_queue": 14300}, "done": false, "training_iteration": 6, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-48-16", "timestamp": 1731091696, "time_this_iter_s": 10.3863685131073, "time_total_s": 62.4483802318573, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5ebe20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.4483802318573, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.633333333333336, "ram_util_percent": 65.74666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -207136.546875, "policy_loss": -210436.0625, "entropy": 12.420865058898926, "entropy_coeff": 0.01, "var_gnorm": 16.005441665649414, "vf_loss": 336782.625, "vf_explained_var": 0.0023859143257141113}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 16950, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16950, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 113, "num_samples_added_to_queue": 16500, "learner_queue": {"size_count": 30, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 111.114, "learner_load_time_ms": 0.918, "learner_load_wait_time_ms": 2275.307, "learner_dequeue_time_ms": 15539.021}}, "env_runners": {"episode_reward_max": -195.56748075936386, "episode_reward_min": -319.26293825893663, "episode_reward_mean": -253.77754732341378, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -319.26293825893663}, "policy_reward_max": {"default_policy": -195.56748075936386}, "policy_reward_mean": {"default_policy": -253.77754732341378}, "custom_metrics": {"num_consolidated_mean": 2.4226, "num_consolidated_min": 2.25, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.7439999999999999, "num_overloaded_min": 0.63, "num_overloaded_max": 0.87, "num_moves_mean": 4.176, "num_moves_min": 3.99, "num_moves_max": 4.33, "mean_accuracy_mean": 41.095744, "mean_accuracy_min": 40.8264, "mean_accuracy_max": 41.571200000000005, "num_model_switches_mean": 2.4962, "num_model_switches_min": 2.25, "num_model_switches_max": 2.8, "num_slav_mean": 0.19218799999999997, "num_slav_min": 0.16635999999999998, "num_slav_max": 0.23392000000000002, "cpu_conserved_cost_mean": 4.8452, "cpu_conserved_cost_min": 4.5, "cpu_conserved_cost_max": 5.16, "mean_cluster_cpu_util_mean": 0.734305353195164, "mean_cluster_cpu_util_min": 0.713139378238342, "mean_cluster_cpu_util_max": 0.7543474093264247, "mean_cluster_mem_util_mean": 0.5193408735827665, "mean_cluster_mem_util_min": 0.5107265873015873, "mean_cluster_mem_util_max": 0.5269121882086167, "oversub_cores_mean": 0.9602245250431778, "oversub_cores_min": 0.9267702936096718, "oversub_cores_max": 0.9906735751295337, "reward_consolidation_mean_mean": -0.08523947323413726, "reward_consolidation_mean_min": -0.16885240294167964, "reward_consolidation_mean_max": -0.0014879425346332375, "reward_illegal_mean_mean": -1.2399999999999998, "reward_illegal_mean_min": -1.4499999999999997, "reward_illegal_mean_max": -1.0499999999999998, "reward_accuracy_mean_mean": 1.429799999999998, "reward_accuracy_mean_min": 0.9199999999999975, "reward_accuracy_mean_max": 1.8599999999999988, "reward_sla_mean_mean": -2.642336, "reward_sla_mean_min": -3.6384, "reward_sla_mean_max": -1.568, "reward_consolidation_sum_mean": -8.523947323413728, "reward_consolidation_sum_min": -16.885240294167964, "reward_consolidation_sum_max": -0.14879425346332376, "reward_illegal_sum_mean": -124.0, "reward_illegal_sum_min": -144.99999999999997, "reward_illegal_sum_max": -104.99999999999999, "reward_accuracy_sum_mean": 142.97999999999982, "reward_accuracy_sum_min": 91.99999999999974, "reward_accuracy_sum_max": 185.9999999999999, "reward_sla_sum_mean": -264.23359999999997, "reward_sla_sum_min": -363.84, "reward_sla_sum_max": -156.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3967.0, "global_timestep_min": 1900, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-278.7033897725329, -204.99984949546786, -260.20496322900647, -296.35962031811204, -266.6094578416283, -265.44518898580463, -262.13360697793735, -258.0577219086709, -251.73860099196165, -265.7925808106723, -252.98002394390292, -244.7607354198734, -248.34071831708576, -231.63795450658444, -245.95985291602537, -241.81526594834966, -308.8639062767232, -247.9134256883871, -240.7415153069951, -238.31638447066854, -307.6195108602704, -267.83317940824355, -239.34882161792373, -243.68846245938082, -207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3804085965959581, "mean_inference_ms": 1.622961104180199, "mean_action_processing_ms": 0.1626604006542721, "mean_env_wait_ms": 1.8370208763573777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012560129165649414, "StateBufferConnector_ms": 0.006874799728393555, "ViewRequirementAgentConnector_ms": 0.14554882049560547}, "num_episodes": 24, "episode_return_max": -195.56748075936386, "episode_return_min": -319.26293825893663, "episode_return_mean": -253.77754732341378, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16950, "num_agent_steps_trained": 16500, "num_env_steps_sampled": 16950, "num_env_steps_trained": 16500, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 229.59986884086473, "num_env_steps_trained_throughput_per_sec": 210.46654643745933, "timesteps_total": 16950, "num_env_steps_sampled_lifetime": 16950, "num_agent_steps_sampled_lifetime": 16950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 16950, "timers": {"training_iteration_time_ms": 10396.93, "restore_workers_time_ms": 0.024, "training_step_time_ms": 647.973, "sample_time_ms": 626.201, "synch_weights_time_ms": 19.532}, "counters": {"num_env_steps_sampled": 16950, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16950, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 113, "num_samples_added_to_queue": 16500}, "done": false, "training_iteration": 7, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-48-26", "timestamp": 1731091706, "time_this_iter_s": 10.482927322387695, "time_total_s": 72.931307554245, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6cb1b520>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.931307554245, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.56, "ram_util_percent": 65.92666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -188552.5, "policy_loss": -191353.46875, "entropy": 12.419573783874512, "entropy_coeff": 0.01, "var_gnorm": 16.00758934020996, "vf_loss": 286928.3125, "vf_explained_var": 0.0029833316802978516}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 34.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 19350, "num_env_steps_trained": 18700, "num_agent_steps_sampled": 19350, "num_agent_steps_trained": 18700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 129, "num_samples_added_to_queue": 19250, "learner_queue": {"size_count": 34, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 109.304, "learner_load_time_ms": 0.85, "learner_load_wait_time_ms": 2339.623, "learner_dequeue_time_ms": 16291.312}}, "env_runners": {"episode_reward_max": -195.56748075936386, "episode_reward_min": -319.26293825893663, "episode_reward_mean": -252.74054687874127, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -319.26293825893663}, "policy_reward_max": {"default_policy": -195.56748075936386}, "policy_reward_mean": {"default_policy": -252.74054687874127}, "custom_metrics": {"num_consolidated_mean": 2.416699999999999, "num_consolidated_min": 2.25, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.7532000000000001, "num_overloaded_min": 0.63, "num_overloaded_max": 0.9, "num_moves_mean": 4.174800000000001, "num_moves_min": 3.99, "num_moves_max": 4.37, "mean_accuracy_mean": 41.100303999999994, "mean_accuracy_min": 40.7808, "mean_accuracy_max": 41.571200000000005, "num_model_switches_mean": 2.4981, "num_model_switches_min": 2.16, "num_model_switches_max": 2.8, "num_slav_mean": 0.1921688, "num_slav_min": 0.16635999999999998, "num_slav_max": 0.23392000000000002, "cpu_conserved_cost_mean": 4.833399999999998, "cpu_conserved_cost_min": 4.5, "cpu_conserved_cost_max": 5.16, "mean_cluster_cpu_util_mean": 0.7334078324697757, "mean_cluster_cpu_util_min": 0.713139378238342, "mean_cluster_cpu_util_max": 0.7500280656303974, "mean_cluster_mem_util_mean": 0.5189425663265307, "mean_cluster_mem_util_min": 0.5106923469387755, "mean_cluster_mem_util_max": 0.526039739229025, "oversub_cores_mean": 0.9586286701208983, "oversub_cores_min": 0.9267702936096718, "oversub_cores_max": 0.9906735751295337, "reward_consolidation_mean_mean": -0.08486413545407913, "reward_consolidation_mean_min": -0.16885240294167964, "reward_consolidation_mean_max": -0.0014879425346332375, "reward_illegal_mean_mean": -1.2553333333333332, "reward_illegal_mean_min": -1.5, "reward_illegal_mean_max": -1.0499999999999998, "reward_accuracy_mean_mean": 1.412999999999998, "reward_accuracy_mean_min": 0.9199999999999975, "reward_accuracy_mean_max": 2.2200000000000006, "reward_sla_mean_mean": -2.6002080000000003, "reward_sla_mean_min": -3.6384, "reward_sla_mean_max": -1.568, "reward_consolidation_sum_mean": -8.486413545407913, "reward_consolidation_sum_min": -16.885240294167964, "reward_consolidation_sum_max": -0.14879425346332376, "reward_illegal_sum_mean": -125.5333333333333, "reward_illegal_sum_min": -150.0, "reward_illegal_sum_max": -104.99999999999999, "reward_accuracy_sum_mean": 141.29999999999984, "reward_accuracy_sum_min": 91.99999999999974, "reward_accuracy_sum_max": 222.00000000000009, "reward_sla_sum_mean": -260.0208, "reward_sla_sum_min": -363.84, "reward_sla_sum_max": -156.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4767.0, "global_timestep_min": 2700, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-207.09901829998307, -248.69440396784685, -243.14240807251574, -265.00600307850175, -231.32094749444133, -273.8733333333334, -195.56748075936386, -224.46729946981336, -291.6735248845565, -260.56021207456814, -239.67290576363973, -285.13463998631823, -259.1381015905592, -283.8697554301354, -273.28731315204396, -293.73650761074055, -251.80354027706505, -244.3438891739353, -273.50955361723993, -247.39586454592077, -223.0143800239442, -200.6211527278949, -245.67513596716267, -283.6097178040022, -289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38236973220842835, "mean_inference_ms": 1.6342536791491773, "mean_action_processing_ms": 0.16358201856126078, "mean_env_wait_ms": 1.844584287336403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01271367073059082, "StateBufferConnector_ms": 0.006930112838745117, "ViewRequirementAgentConnector_ms": 0.14744281768798828}, "num_episodes": 24, "episode_return_max": -195.56748075936386, "episode_return_min": -319.26293825893663, "episode_return_mean": -252.74054687874127, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19350, "num_agent_steps_trained": 18700, "num_env_steps_sampled": 19350, "num_env_steps_trained": 18700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 228.5509867364621, "num_env_steps_trained_throughput_per_sec": 209.50507117509028, "timesteps_total": 19350, "num_env_steps_sampled_lifetime": 19350, "num_agent_steps_sampled_lifetime": 19350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 19350, "timers": {"training_iteration_time_ms": 10409.933, "restore_workers_time_ms": 0.022, "training_step_time_ms": 640.638, "sample_time_ms": 617.484, "synch_weights_time_ms": 20.769}, "counters": {"num_env_steps_sampled": 19350, "num_env_steps_trained": 18700, "num_agent_steps_sampled": 19350, "num_agent_steps_trained": 18700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 129, "num_samples_added_to_queue": 19250}, "done": false, "training_iteration": 8, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-48-37", "timestamp": 1731091717, "time_this_iter_s": 10.533713579177856, "time_total_s": 83.46502113342285, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5e8070>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.46502113342285, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 20.02666666666666, "ram_util_percent": 66.10666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -206980.28125, "policy_loss": -210192.5, "entropy": 12.417679786682129, "entropy_coeff": 0.01, "var_gnorm": 16.010236740112305, "vf_loss": 328051.9375, "vf_explained_var": 0.00400012731552124}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 21750, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 21750, "num_agent_steps_trained": 21450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 145, "num_samples_added_to_queue": 21450, "learner_queue": {"size_count": 39, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 111.911, "learner_load_time_ms": 0.85, "learner_load_wait_time_ms": 2275.472, "learner_dequeue_time_ms": 16291.312}}, "env_runners": {"episode_reward_max": -188.36937232768926, "episode_reward_min": -319.26293825893663, "episode_reward_mean": -251.04901700017103, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -319.26293825893663}, "policy_reward_max": {"default_policy": -188.36937232768926}, "policy_reward_mean": {"default_policy": -251.04901700017103}, "custom_metrics": {"num_consolidated_mean": 2.4161, "num_consolidated_min": 2.25, "num_consolidated_max": 2.61, "num_overloaded_mean": 0.7551000000000002, "num_overloaded_min": 0.63, "num_overloaded_max": 0.91, "num_moves_mean": 4.171, "num_moves_min": 3.99, "num_moves_max": 4.37, "mean_accuracy_mean": 41.102584, "mean_accuracy_min": 40.72, "mean_accuracy_max": 41.571200000000005, "num_model_switches_mean": 2.4987, "num_model_switches_min": 2.16, "num_model_switches_max": 2.8, "num_slav_mean": 0.19111359999999997, "num_slav_min": 0.16616, "num_slav_max": 0.21811999999999998, "cpu_conserved_cost_mean": 4.8322, "cpu_conserved_cost_min": 4.5, "cpu_conserved_cost_max": 5.22, "mean_cluster_cpu_util_mean": 0.7336974127806561, "mean_cluster_cpu_util_min": 0.713139378238342, "mean_cluster_cpu_util_max": 0.7638553540587218, "mean_cluster_mem_util_mean": 0.5190248911564626, "mean_cluster_mem_util_min": 0.5106923469387755, "mean_cluster_mem_util_max": 0.5304907029478458, "oversub_cores_mean": 0.9588773747841104, "oversub_cores_min": 0.9267702936096718, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08579817000171039, "reward_consolidation_mean_min": -0.16885240294167964, "reward_consolidation_mean_max": -0.0014879425346332375, "reward_illegal_mean_mean": -1.2585, "reward_illegal_mean_min": -1.5166666666666664, "reward_illegal_mean_max": -1.0499999999999998, "reward_accuracy_mean_mean": 1.4159999999999986, "reward_accuracy_mean_min": 0.9199999999999975, "reward_accuracy_mean_max": 2.2200000000000006, "reward_sla_mean_mean": -2.582192, "reward_sla_mean_min": -3.6384, "reward_sla_mean_max": -1.568, "reward_consolidation_sum_mean": -8.579817000171039, "reward_consolidation_sum_min": -16.885240294167964, "reward_consolidation_sum_max": -0.14879425346332376, "reward_illegal_sum_mean": -125.84999999999998, "reward_illegal_sum_min": -151.66666666666663, "reward_illegal_sum_max": -104.99999999999999, "reward_accuracy_sum_mean": 141.59999999999985, "reward_accuracy_sum_min": 91.99999999999974, "reward_accuracy_sum_max": 222.00000000000009, "reward_sla_sum_mean": -258.2192, "reward_sla_sum_min": -363.84, "reward_sla_sum_max": -156.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5578.0, "global_timestep_min": 3700, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-289.1919069608345, -198.1118932786047, -281.84803146912947, -243.86456644433053, -235.4036805199249, -204.91595690097503, -263.0113836155292, -278.10621173251246, -241.9187925431846, -276.2888763468444, -224.0899435608004, -254.8391482811698, -308.64291089447596, -223.64269881990757, -266.5985257396954, -284.45343595006, -284.382842483325, -256.5508568496664, -220.81480075252279, -223.04550367709928, -274.1082948520609, -259.752529502309, -260.56946810330084, -208.42426543526642, -244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840160714213421, "mean_inference_ms": 1.6439328412295944, "mean_action_processing_ms": 0.16438990768681314, "mean_env_wait_ms": 1.8519069575659841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012791872024536133, "StateBufferConnector_ms": 0.006920576095581055, "ViewRequirementAgentConnector_ms": 0.14726924896240234}, "num_episodes": 24, "episode_return_max": -188.36937232768926, "episode_return_min": -319.26293825893663, "episode_return_mean": -251.04901700017103, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21750, "num_agent_steps_trained": 21450, "num_env_steps_sampled": 21750, "num_env_steps_trained": 21450, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 225.85271021894408, "num_env_steps_trained_throughput_per_sec": 258.7895637925401, "timesteps_total": 21750, "num_env_steps_sampled_lifetime": 21750, "num_agent_steps_sampled_lifetime": 21750, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 21750, "timers": {"training_iteration_time_ms": 10433.986, "restore_workers_time_ms": 0.028, "training_step_time_ms": 660.071, "sample_time_ms": 634.983, "synch_weights_time_ms": 22.589}, "counters": {"num_env_steps_sampled": 21750, "num_env_steps_trained": 21450, "num_agent_steps_sampled": 21750, "num_agent_steps_trained": 21450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 145, "num_samples_added_to_queue": 21450}, "done": false, "training_iteration": 9, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-48-48", "timestamp": 1731091728, "time_this_iter_s": 10.641778707504272, "time_total_s": 94.10679984092712, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5eb4f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.10679984092712, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.953333333333333, "ram_util_percent": 66.18666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -190619.671875, "policy_loss": -193408.671875, "entropy": 12.416129112243652, "entropy_coeff": 0.01, "var_gnorm": 16.012224197387695, "vf_loss": 285728.125, "vf_explained_var": 0.0045354366302490234}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 24150, "num_env_steps_trained": 23650, "num_agent_steps_sampled": 24150, "num_agent_steps_trained": 23650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 161, "num_samples_added_to_queue": 23650, "learner_queue": {"size_count": 43, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 108.007, "learner_load_time_ms": 0.772, "learner_load_wait_time_ms": 2348.218, "learner_dequeue_time_ms": 16789.124}}, "env_runners": {"episode_reward_max": -188.36937232768926, "episode_reward_min": -319.26293825893663, "episode_reward_mean": -247.13260253121263, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -319.26293825893663}, "policy_reward_max": {"default_policy": -188.36937232768926}, "policy_reward_mean": {"default_policy": -247.13260253121263}, "custom_metrics": {"num_consolidated_mean": 2.4131, "num_consolidated_min": 2.24, "num_consolidated_max": 2.61, "num_overloaded_mean": 0.7582, "num_overloaded_min": 0.63, "num_overloaded_max": 0.91, "num_moves_mean": 4.1775, "num_moves_min": 4.0, "num_moves_max": 4.37, "mean_accuracy_mean": 41.087232000000014, "mean_accuracy_min": 40.72, "mean_accuracy_max": 41.4952, "num_model_switches_mean": 2.495, "num_model_switches_min": 2.16, "num_model_switches_max": 2.74, "num_slav_mean": 0.18859080000000003, "num_slav_min": 0.16407999999999998, "num_slav_max": 0.22404, "cpu_conserved_cost_mean": 4.8262, "cpu_conserved_cost_min": 4.48, "cpu_conserved_cost_max": 5.22, "mean_cluster_cpu_util_mean": 0.7335768557858376, "mean_cluster_cpu_util_min": 0.7126500863557856, "mean_cluster_cpu_util_max": 0.7638553540587218, "mean_cluster_mem_util_mean": 0.5189433900226758, "mean_cluster_mem_util_min": 0.5104102040816326, "mean_cluster_mem_util_max": 0.5304907029478458, "oversub_cores_mean": 0.9587150259067359, "oversub_cores_min": 0.9267702936096718, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08789935864545934, "reward_consolidation_mean_min": -0.16651958269197895, "reward_consolidation_mean_max": -0.0014879425346332375, "reward_illegal_mean_mean": -1.2636666666666665, "reward_illegal_mean_min": -1.5166666666666664, "reward_illegal_mean_max": -1.0499999999999998, "reward_accuracy_mean_mean": 1.3931999999999989, "reward_accuracy_mean_min": 0.7799999999999976, "reward_accuracy_mean_max": 2.2200000000000006, "reward_sla_mean_mean": -2.51296, "reward_sla_mean_min": -3.6384, "reward_sla_mean_max": -1.4848, "reward_consolidation_sum_mean": -8.789935864545933, "reward_consolidation_sum_min": -16.651958269197895, "reward_consolidation_sum_max": -0.14879425346332376, "reward_illegal_sum_mean": -126.36666666666667, "reward_illegal_sum_min": -151.66666666666663, "reward_illegal_sum_max": -104.99999999999999, "reward_accuracy_sum_mean": 139.31999999999985, "reward_accuracy_sum_min": 77.99999999999976, "reward_accuracy_sum_max": 222.00000000000009, "reward_sla_sum_mean": -251.296, "reward_sla_sum_min": -363.84, "reward_sla_sum_max": -148.48, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5910.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-244.5709286813752, -233.33122969043964, -319.26293825893663, -283.5228766889003, -250.49499230374548, -223.13526594834977, -248.24042756969376, -265.17031982213103, -261.28548657431185, -250.94879425346323, -220.6324337266974, -253.978628356422, -206.95363434239786, -274.6892560287327, -273.85510518214465, -212.54854113220438, -315.3124645117154, -223.08749444159412, -303.24805883359, -280.4582486745342, -276.1817102787755, -223.44318453907985, -220.16516846245926, -232.61017273815634, -205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847497407082845, "mean_inference_ms": 1.6485102456842586, "mean_action_processing_ms": 0.16494850431752173, "mean_env_wait_ms": 1.857010582180552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012724161148071289, "StateBufferConnector_ms": 0.006847858428955078, "ViewRequirementAgentConnector_ms": 0.14550209045410156}, "num_episodes": 24, "episode_return_max": -188.36937232768926, "episode_return_min": -319.26293825893663, "episode_return_mean": -247.13260253121263, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24150, "num_agent_steps_trained": 23650, "num_env_steps_sampled": 24150, "num_env_steps_trained": 23650, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 227.93515894073445, "num_env_steps_trained_throughput_per_sec": 208.9405623623399, "timesteps_total": 24150, "num_env_steps_sampled_lifetime": 24150, "num_agent_steps_sampled_lifetime": 24150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 24150, "timers": {"training_iteration_time_ms": 10443.52, "restore_workers_time_ms": 0.023, "training_step_time_ms": 655.39, "sample_time_ms": 628.207, "synch_weights_time_ms": 24.826}, "counters": {"num_env_steps_sampled": 24150, "num_env_steps_trained": 23650, "num_agent_steps_sampled": 24150, "num_agent_steps_trained": 23650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 161, "num_samples_added_to_queue": 23650}, "done": false, "training_iteration": 10, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-48-58", "timestamp": 1731091738, "time_this_iter_s": 10.550931692123413, "time_total_s": 104.65773153305054, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f20e80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.65773153305054, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.85, "ram_util_percent": 66.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -189305.390625, "policy_loss": -192069.609375, "entropy": 12.413976669311523, "entropy_coeff": 0.01, "var_gnorm": 16.01503562927246, "vf_loss": 283250.5625, "vf_explained_var": 0.005276679992675781}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 48.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 26550, "num_env_steps_trained": 26400, "num_agent_steps_sampled": 26550, "num_agent_steps_trained": 26400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 177, "num_samples_added_to_queue": 26400, "learner_queue": {"size_count": 48, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 102.311, "learner_load_time_ms": 0.772, "learner_load_wait_time_ms": 2302.895, "learner_dequeue_time_ms": 16789.124}}, "env_runners": {"episode_reward_max": -188.36937232768926, "episode_reward_min": -312.04840430990265, "episode_reward_mean": -243.74482397810846, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -312.04840430990265}, "policy_reward_max": {"default_policy": -188.36937232768926}, "policy_reward_mean": {"default_policy": -243.74482397810846}, "custom_metrics": {"num_consolidated_mean": 2.4116999999999997, "num_consolidated_min": 2.23, "num_consolidated_max": 2.61, "num_overloaded_mean": 0.7591, "num_overloaded_min": 0.63, "num_overloaded_max": 0.96, "num_moves_mean": 4.175999999999999, "num_moves_min": 3.99, "num_moves_max": 4.37, "mean_accuracy_mean": 41.082824, "mean_accuracy_min": 40.72, "mean_accuracy_max": 41.4952, "num_model_switches_mean": 2.4922, "num_model_switches_min": 2.16, "num_model_switches_max": 2.74, "num_slav_mean": 0.187664, "num_slav_min": 0.16304, "num_slav_max": 0.22404, "cpu_conserved_cost_mean": 4.8233999999999995, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.22, "mean_cluster_cpu_util_mean": 0.7336601269430051, "mean_cluster_cpu_util_min": 0.7114913644214163, "mean_cluster_cpu_util_max": 0.7638553540587218, "mean_cluster_mem_util_mean": 0.5189645538548753, "mean_cluster_mem_util_min": 0.5097365079365079, "mean_cluster_mem_util_max": 0.5304907029478458, "oversub_cores_mean": 0.9588324697754748, "oversub_cores_min": 0.9208981001727115, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08841757311441775, "reward_consolidation_mean_min": -0.16651958269197895, "reward_consolidation_mean_max": -0.025328373524884658, "reward_illegal_mean_mean": -1.2651666666666666, "reward_illegal_mean_min": -1.5999999999999996, "reward_illegal_mean_max": -1.0499999999999998, "reward_accuracy_mean_mean": 1.3881999999999983, "reward_accuracy_mean_min": 0.7799999999999976, "reward_accuracy_mean_max": 2.2200000000000006, "reward_sla_mean_mean": -2.472064, "reward_sla_mean_min": -3.4224, "reward_sla_mean_max": -1.4848, "reward_consolidation_sum_mean": -8.841757311441775, "reward_consolidation_sum_min": -16.651958269197895, "reward_consolidation_sum_max": -2.5328373524884658, "reward_illegal_sum_mean": -126.51666666666667, "reward_illegal_sum_min": -159.99999999999997, "reward_illegal_sum_max": -104.99999999999999, "reward_accuracy_sum_mean": 138.81999999999985, "reward_accuracy_sum_min": 77.99999999999976, "reward_accuracy_sum_max": 222.00000000000009, "reward_sla_sum_mean": -247.20640000000003, "reward_sla_sum_min": -342.24, "reward_sla_sum_max": -148.48, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4838.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-205.8104498033178, -293.2843475286476, -264.175707200274, -238.69851547802284, -266.62557550880786, -261.148537711647, -253.79047716777845, -236.39187959637417, -227.38029758850698, -213.40309902514107, -255.47014195313815, -277.8467384983752, -271.7019120916709, -244.34487429451008, -253.47877886095418, -310.4193911407564, -261.35286129639144, -216.05480759363795, -257.97826235676405, -241.70367025825237, -237.88468958440205, -240.9655686676928, -265.46224730631076, -256.5070258252095, -257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38540091893147477, "mean_inference_ms": 1.6523876525897896, "mean_action_processing_ms": 0.16541674817717714, "mean_env_wait_ms": 1.8616879795388428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012409210205078125, "StateBufferConnector_ms": 0.0068209171295166016, "ViewRequirementAgentConnector_ms": 0.1443161964416504}, "num_episodes": 24, "episode_return_max": -188.36937232768926, "episode_return_min": -312.04840430990265, "episode_return_mean": -243.74482397810846, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26550, "num_agent_steps_trained": 26400, "num_env_steps_sampled": 26550, "num_env_steps_trained": 26400, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 224.82045047799357, "num_env_steps_trained_throughput_per_sec": 257.606766172701, "timesteps_total": 26550, "num_env_steps_sampled_lifetime": 26550, "num_agent_steps_sampled_lifetime": 26550, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 26550, "timers": {"training_iteration_time_ms": 10462.016, "restore_workers_time_ms": 0.027, "training_step_time_ms": 658.795, "sample_time_ms": 632.784, "synch_weights_time_ms": 23.733}, "counters": {"num_env_steps_sampled": 26550, "num_env_steps_trained": 26400, "num_agent_steps_sampled": 26550, "num_agent_steps_trained": 26400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 177, "num_samples_added_to_queue": 26400}, "done": false, "training_iteration": 11, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-49-09", "timestamp": 1731091749, "time_this_iter_s": 10.69123387336731, "time_total_s": 115.34896540641785, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6cb1ab60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.34896540641785, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.84666666666667, "ram_util_percent": 66.59333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -189192.1875, "policy_loss": -191942.546875, "entropy": 12.412522315979004, "entropy_coeff": 0.01, "var_gnorm": 16.017349243164062, "vf_loss": 281863.03125, "vf_explained_var": 0.005855441093444824}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 28950, "num_env_steps_trained": 28600, "num_agent_steps_sampled": 28950, "num_agent_steps_trained": 28600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 193, "num_samples_added_to_queue": 28600, "learner_queue": {"size_count": 52, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 104.685, "learner_load_time_ms": 0.769, "learner_load_wait_time_ms": 2353.595, "learner_dequeue_time_ms": 17258.1}}, "env_runners": {"episode_reward_max": -188.36937232768926, "episode_reward_min": -312.04840430990265, "episode_reward_mean": -241.30884887976742, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -312.04840430990265}, "policy_reward_max": {"default_policy": -188.36937232768926}, "policy_reward_mean": {"default_policy": -241.30884887976742}, "custom_metrics": {"num_consolidated_mean": 2.4143999999999997, "num_consolidated_min": 2.23, "num_consolidated_max": 2.61, "num_overloaded_mean": 0.7626, "num_overloaded_min": 0.6, "num_overloaded_max": 0.96, "num_moves_mean": 4.1665, "num_moves_min": 3.99, "num_moves_max": 4.31, "mean_accuracy_mean": 41.089816, "mean_accuracy_min": 40.6288, "mean_accuracy_max": 41.4952, "num_model_switches_mean": 2.4814, "num_model_switches_min": 2.25, "num_model_switches_max": 2.74, "num_slav_mean": 0.1858624, "num_slav_min": 0.15811999999999998, "num_slav_max": 0.22404, "cpu_conserved_cost_mean": 4.828799999999999, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.22, "mean_cluster_cpu_util_mean": 0.7340813773747843, "mean_cluster_cpu_util_min": 0.7112307426597582, "mean_cluster_cpu_util_max": 0.7638553540587218, "mean_cluster_mem_util_mean": 0.5190440731292516, "mean_cluster_mem_util_min": 0.5097365079365079, "mean_cluster_mem_util_max": 0.5304907029478458, "oversub_cores_mean": 0.9590224525043177, "oversub_cores_min": 0.9208981001727115, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08653648879767413, "reward_consolidation_mean_min": -0.16651958269197895, "reward_consolidation_mean_max": -0.025328373524884658, "reward_illegal_mean_mean": -1.271, "reward_illegal_mean_min": -1.5999999999999996, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.378799999999999, "reward_accuracy_mean_min": 0.7799999999999976, "reward_accuracy_mean_max": 1.959999999999997, "reward_sla_mean_mean": -2.4343519999999996, "reward_sla_mean_min": -3.3423999999999996, "reward_sla_mean_max": -1.4848, "reward_consolidation_sum_mean": -8.653648879767413, "reward_consolidation_sum_min": -16.651958269197895, "reward_consolidation_sum_max": -2.5328373524884658, "reward_illegal_sum_mean": -127.09999999999998, "reward_illegal_sum_min": -159.99999999999997, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 137.87999999999985, "reward_accuracy_sum_min": 77.99999999999976, "reward_accuracy_sum_max": 195.99999999999972, "reward_sla_sum_mean": -243.4352, "reward_sla_sum_min": -334.23999999999995, "reward_sla_sum_max": -148.48, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3766.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-257.53533778005766, -273.70339661364824, -246.77364802462813, -238.24147426030436, -300.5025277920302, -189.9073610398496, -231.93283735248843, -251.84175132546602, -230.47657602189147, -240.79863861809494, -222.20682743287165, -258.06025654181633, -258.4588062254146, -215.79936377629545, -260.72379339832395, -188.36937232768926, -246.51208482982727, -284.6793158884896, -250.3022336240805, -271.8714451855652, -210.14898922524398, -231.35635710620832, -250.47749615187283, -267.0187583376092, -225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38594420875264374, "mean_inference_ms": 1.6555122164972198, "mean_action_processing_ms": 0.16585608872821608, "mean_env_wait_ms": 1.8660870055514507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01220250129699707, "StateBufferConnector_ms": 0.006743907928466797, "ViewRequirementAgentConnector_ms": 0.14305830001831055}, "num_episodes": 24, "episode_return_max": -188.36937232768926, "episode_return_min": -312.04840430990265, "episode_return_mean": -241.30884887976742, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28950, "num_agent_steps_trained": 28600, "num_env_steps_sampled": 28950, "num_env_steps_trained": 28600, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 229.0584408935253, "num_env_steps_trained_throughput_per_sec": 209.97023748573153, "timesteps_total": 28950, "num_env_steps_sampled_lifetime": 28950, "num_agent_steps_sampled_lifetime": 28950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 28950, "timers": {"training_iteration_time_ms": 10482.882, "restore_workers_time_ms": 0.027, "training_step_time_ms": 653.135, "sample_time_ms": 626.655, "synch_weights_time_ms": 23.697}, "counters": {"num_env_steps_sampled": 28950, "num_env_steps_trained": 28600, "num_agent_steps_sampled": 28950, "num_agent_steps_trained": 28600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 193, "num_samples_added_to_queue": 28600}, "done": false, "training_iteration": 12, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-49-20", "timestamp": 1731091760, "time_this_iter_s": 10.495695352554321, "time_total_s": 125.84466075897217, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f21150>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.84466075897217, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.886666666666667, "ram_util_percent": 66.69333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -180853.78125, "policy_loss": -183522.015625, "entropy": 12.409382820129395, "entropy_coeff": 0.01, "var_gnorm": 16.020267486572266, "vf_loss": 273648.375, "vf_explained_var": 0.005652487277984619}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 56.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363636687}}, "num_env_steps_sampled": 31350, "num_env_steps_trained": 30800, "num_agent_steps_sampled": 31350, "num_agent_steps_trained": 30800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 209, "num_samples_added_to_queue": 31350, "learner_queue": {"size_count": 56, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 105.824, "learner_load_time_ms": 0.769, "learner_load_wait_time_ms": 2279.598, "learner_dequeue_time_ms": 17258.1}}, "env_runners": {"episode_reward_max": -188.38226098854122, "episode_reward_min": -312.04840430990265, "episode_reward_mean": -238.80332125876518, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -312.04840430990265}, "policy_reward_max": {"default_policy": -188.38226098854122}, "policy_reward_mean": {"default_policy": -238.80332125876518}, "custom_metrics": {"num_consolidated_mean": 2.4087, "num_consolidated_min": 2.23, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.7585999999999999, "num_overloaded_min": 0.6, "num_overloaded_max": 0.96, "num_moves_mean": 4.1626, "num_moves_min": 3.96, "num_moves_max": 4.35, "mean_accuracy_mean": 41.096351999999996, "mean_accuracy_min": 40.6288, "mean_accuracy_max": 41.449600000000004, "num_model_switches_mean": 2.4723, "num_model_switches_min": 2.23, "num_model_switches_max": 2.72, "num_slav_mean": 0.1850808, "num_slav_min": 0.15811999999999998, "num_slav_max": 0.22404, "cpu_conserved_cost_mean": 4.8174, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.18, "mean_cluster_cpu_util_mean": 0.7332988618307428, "mean_cluster_cpu_util_min": 0.7112307426597582, "mean_cluster_cpu_util_max": 0.762427115716753, "mean_cluster_mem_util_mean": 0.5186908072562358, "mean_cluster_mem_util_min": 0.5097365079365079, "mean_cluster_mem_util_max": 0.5300941609977325, "oversub_cores_mean": 0.9575682210708117, "oversub_cores_min": 0.9208981001727115, "oversub_cores_max": 0.9996545768566495, "reward_consolidation_mean_mean": -0.08574787925431858, "reward_consolidation_mean_min": -0.16651958269197895, "reward_consolidation_mean_max": -0.02688301693175998, "reward_illegal_mean_mean": -1.264333333333333, "reward_illegal_mean_min": -1.5999999999999996, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.3839999999999986, "reward_accuracy_mean_min": 0.7799999999999976, "reward_accuracy_mean_max": 1.9600000000000002, "reward_sla_mean_mean": -2.4219519999999997, "reward_sla_mean_min": -3.5888, "reward_sla_mean_max": -1.4848, "reward_consolidation_sum_mean": -8.574787925431856, "reward_consolidation_sum_min": -16.651958269197895, "reward_consolidation_sum_max": -2.688301693175998, "reward_illegal_sum_mean": -126.43333333333332, "reward_illegal_sum_min": -159.99999999999997, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 138.39999999999986, "reward_accuracy_sum_min": 77.99999999999976, "reward_accuracy_sum_max": 196.00000000000003, "reward_sla_sum_mean": -242.19519999999994, "reward_sla_sum_min": -358.88, "reward_sla_sum_max": -148.48, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2694.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-225.62039336411848, -279.38756285274513, -237.45293996921478, -273.1584128612964, -312.04840430990265, -221.34529160253166, -216.55754403967853, -213.93603557379893, -213.98685821788956, -223.29645972293483, -239.9454968359842, -255.31318282880102, -219.99501282709093, -229.3163194800752, -208.7602873268342, -218.86151872755275, -192.14649563878933, -240.55911065503673, -226.22391653839588, -263.13891568325647, -217.66917051479405, -244.029642551736, -266.9045014537371, -260.58069095262533, -277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864580044565665, "mean_inference_ms": 1.6576341739690377, "mean_action_processing_ms": 0.16619823922256832, "mean_env_wait_ms": 1.8692958156251682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012521028518676758, "StateBufferConnector_ms": 0.006769895553588867, "ViewRequirementAgentConnector_ms": 0.14280128479003906}, "num_episodes": 24, "episode_return_max": -188.38226098854122, "episode_return_min": -312.04840430990265, "episode_return_mean": -238.80332125876518, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31350, "num_agent_steps_trained": 30800, "num_env_steps_sampled": 31350, "num_env_steps_trained": 30800, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 227.7865047318913, "num_env_steps_trained_throughput_per_sec": 208.80429600423372, "timesteps_total": 31350, "num_env_steps_sampled_lifetime": 31350, "num_agent_steps_sampled_lifetime": 31350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 31350, "timers": {"training_iteration_time_ms": 10472.107, "restore_workers_time_ms": 0.022, "training_step_time_ms": 650.013, "sample_time_ms": 624.657, "synch_weights_time_ms": 23.031}, "counters": {"num_env_steps_sampled": 31350, "num_env_steps_trained": 30800, "num_agent_steps_sampled": 31350, "num_agent_steps_trained": 30800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 209, "num_samples_added_to_queue": 31350}, "done": false, "training_iteration": 13, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-49-30", "timestamp": 1731091770, "time_this_iter_s": 10.575989484786987, "time_total_s": 136.42065024375916, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5eb9d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.42065024375916, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 20.02, "ram_util_percent": 66.87999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -183746.421875, "policy_loss": -186354.5625, "entropy": 12.40593147277832, "entropy_coeff": 0.01, "var_gnorm": 16.023950576782227, "vf_loss": 267637.3125, "vf_explained_var": 0.008285760879516602}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 61.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 33750, "num_env_steps_trained": 33550, "num_agent_steps_sampled": 33750, "num_agent_steps_trained": 33550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 225, "num_samples_added_to_queue": 33550, "learner_queue": {"size_count": 61, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 110.709, "learner_load_time_ms": 0.693, "learner_load_wait_time_ms": 2354.859, "learner_dequeue_time_ms": 17517.738}}, "env_runners": {"episode_reward_max": -188.38226098854122, "episode_reward_min": -304.35183170856874, "episode_reward_mean": -238.97847231058665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.35183170856874}, "policy_reward_max": {"default_policy": -188.38226098854122}, "policy_reward_mean": {"default_policy": -238.97847231058665}, "custom_metrics": {"num_consolidated_mean": 2.4093, "num_consolidated_min": 2.23, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.759, "num_overloaded_min": 0.6, "num_overloaded_max": 0.96, "num_moves_mean": 4.1586, "num_moves_min": 3.96, "num_moves_max": 4.35, "mean_accuracy_mean": 41.113072, "mean_accuracy_min": 40.6288, "mean_accuracy_max": 41.4344, "num_model_switches_mean": 2.4796, "num_model_switches_min": 2.23, "num_model_switches_max": 2.72, "num_slav_mean": 0.185794, "num_slav_min": 0.15232, "num_slav_max": 0.22331999999999996, "cpu_conserved_cost_mean": 4.8186, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.18, "mean_cluster_cpu_util_mean": 0.7334596960276337, "mean_cluster_cpu_util_min": 0.7112307426597582, "mean_cluster_cpu_util_max": 0.762427115716753, "mean_cluster_mem_util_mean": 0.5186958735827665, "mean_cluster_mem_util_min": 0.5097365079365079, "mean_cluster_mem_util_max": 0.5300941609977325, "oversub_cores_mean": 0.9573782383419689, "oversub_cores_min": 0.9208981001727115, "oversub_cores_max": 0.9996545768566495, "reward_consolidation_mean_mean": -0.08297672310586636, "reward_consolidation_mean_min": -0.15093039165383967, "reward_consolidation_mean_max": -0.013827603899435692, "reward_illegal_mean_mean": -1.2649999999999997, "reward_illegal_mean_min": -1.5999999999999996, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.4011999999999984, "reward_accuracy_mean_min": 0.8799999999999975, "reward_accuracy_mean_max": 1.9600000000000002, "reward_sla_mean_mean": -2.4430080000000003, "reward_sla_mean_min": -3.5888, "reward_sla_mean_max": -1.6864, "reward_consolidation_sum_mean": -8.297672310586638, "reward_consolidation_sum_min": -15.093039165383967, "reward_consolidation_sum_max": -1.3827603899435692, "reward_illegal_sum_mean": -126.5, "reward_illegal_sum_min": -159.99999999999997, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 140.1199999999999, "reward_accuracy_sum_min": 87.99999999999974, "reward_accuracy_sum_max": 196.00000000000003, "reward_sla_sum_mean": -244.30079999999998, "reward_sla_sum_min": -358.88, "reward_sla_sum_max": -168.64, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1934.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-277.69552591072335, -226.015064135454, -259.7147460236019, -222.89488626646158, -250.5585496835986, -194.47954506584577, -236.67230032495291, -248.83303916538384, -241.6816281853943, -274.2626646143321, -241.36817855310386, -264.26362921156124, -239.37269026851354, -237.06738840431007, -243.6137574824695, -233.5526252779205, -239.99870360868843, -242.66059175645648, -238.5186557208825, -232.39921669232095, -241.14258594150826, -199.26251410980015, -244.46637249871728, -279.9347665469473, -229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.387044572270216, "mean_inference_ms": 1.659606182594747, "mean_action_processing_ms": 0.16647759977760898, "mean_env_wait_ms": 1.8721823187697355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013036966323852539, "StateBufferConnector_ms": 0.0068149566650390625, "ViewRequirementAgentConnector_ms": 0.14429330825805664}, "num_episodes": 24, "episode_return_max": -188.38226098854122, "episode_return_min": -304.35183170856874, "episode_return_mean": -238.97847231058665, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33750, "num_agent_steps_trained": 33550, "num_env_steps_sampled": 33750, "num_env_steps_trained": 33550, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 225.3376327402487, "num_env_steps_trained_throughput_per_sec": 258.1993708482016, "timesteps_total": 33750, "num_env_steps_sampled_lifetime": 33750, "num_agent_steps_sampled_lifetime": 33750, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 33750, "timers": {"training_iteration_time_ms": 10502.439, "restore_workers_time_ms": 0.027, "training_step_time_ms": 663.43, "sample_time_ms": 637.573, "synch_weights_time_ms": 23.481}, "counters": {"num_env_steps_sampled": 33750, "num_env_steps_trained": 33550, "num_agent_steps_sampled": 33750, "num_agent_steps_trained": 33550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 225, "num_samples_added_to_queue": 33550}, "done": false, "training_iteration": 14, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-49-41", "timestamp": 1731091781, "time_this_iter_s": 10.667799949645996, "time_total_s": 147.08845019340515, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f595a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.08845019340515, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 19.52, "ram_util_percent": 66.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -179276.5, "policy_loss": -181772.53125, "entropy": 12.402168273925781, "entropy_coeff": 0.01, "var_gnorm": 16.027462005615234, "vf_loss": 256425.75, "vf_explained_var": 0.00899040699005127}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 65.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363636687}}, "num_env_steps_sampled": 36150, "num_env_steps_trained": 35750, "num_agent_steps_sampled": 36150, "num_agent_steps_trained": 35750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 241, "num_samples_added_to_queue": 35750, "learner_queue": {"size_count": 65, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 110.119, "learner_load_time_ms": 0.693, "learner_load_wait_time_ms": 2360.822, "learner_dequeue_time_ms": 17517.738}}, "env_runners": {"episode_reward_max": -188.38226098854122, "episode_reward_min": -304.35183170856874, "episode_reward_mean": -237.70411763297423, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.35183170856874}, "policy_reward_max": {"default_policy": -188.38226098854122}, "policy_reward_mean": {"default_policy": -237.70411763297423}, "custom_metrics": {"num_consolidated_mean": 2.4065, "num_consolidated_min": 2.23, "num_consolidated_max": 2.56, "num_overloaded_mean": 0.7572, "num_overloaded_min": 0.6, "num_overloaded_max": 0.9, "num_moves_mean": 4.1644000000000005, "num_moves_min": 3.96, "num_moves_max": 4.41, "mean_accuracy_mean": 41.122952000000005, "mean_accuracy_min": 40.6288, "mean_accuracy_max": 41.48, "num_model_switches_mean": 2.4763, "num_model_switches_min": 2.23, "num_model_switches_max": 2.72, "num_slav_mean": 0.18412519999999996, "num_slav_min": 0.15232, "num_slav_max": 0.22331999999999996, "cpu_conserved_cost_mean": 4.813, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.12, "mean_cluster_cpu_util_mean": 0.7334257599309154, "mean_cluster_cpu_util_min": 0.7112307426597582, "mean_cluster_cpu_util_max": 0.7544140759930916, "mean_cluster_mem_util_mean": 0.5185671819727892, "mean_cluster_mem_util_min": 0.5100060657596373, "mean_cluster_mem_util_max": 0.5283534013605443, "oversub_cores_mean": 0.9567599309153714, "oversub_cores_min": 0.9264248704663212, "oversub_cores_max": 0.9972366148531953, "reward_consolidation_mean_mean": -0.08237717632974187, "reward_consolidation_mean_min": -0.14891226269882005, "reward_consolidation_mean_max": -0.013827603899435692, "reward_illegal_mean_mean": -1.2619999999999998, "reward_illegal_mean_min": -1.4999999999999998, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.4165999999999985, "reward_accuracy_mean_min": 0.9599999999999982, "reward_accuracy_mean_max": 1.9600000000000002, "reward_sla_mean_mean": -2.449264, "reward_sla_mean_min": -3.5888, "reward_sla_mean_max": -1.7008, "reward_consolidation_sum_mean": -8.237717632974187, "reward_consolidation_sum_min": -14.891226269882004, "reward_consolidation_sum_max": -1.3827603899435692, "reward_illegal_sum_mean": -126.2, "reward_illegal_sum_min": -149.99999999999997, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 141.65999999999988, "reward_accuracy_sum_min": 95.99999999999982, "reward_accuracy_sum_max": 196.00000000000003, "reward_sla_sum_mean": -244.92639999999994, "reward_sla_sum_min": -358.88, "reward_sla_sum_max": -170.08, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2578.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-229.0771848811356, -196.8125226611941, -280.49459209851193, -227.85580297588513, -247.89378484692995, -235.50437831366526, -205.387699675047, -261.13664785360027, -223.18779887121602, -235.56631776979626, -285.80797331965135, -229.24348554814418, -223.14321532409775, -217.26947494441612, -289.6450590046177, -259.3445972293483, -251.58364973490671, -239.09561826577732, -219.91980844877725, -245.83218744655377, -211.3470463485548, -273.0076449461262, -258.76837010432683, -267.7957140413887, -229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875406097671219, "mean_inference_ms": 1.6609117085618295, "mean_action_processing_ms": 0.1666959268667499, "mean_env_wait_ms": 1.8741805150191397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01292729377746582, "StateBufferConnector_ms": 0.006742954254150391, "ViewRequirementAgentConnector_ms": 0.14267802238464355}, "num_episodes": 24, "episode_return_max": -188.38226098854122, "episode_return_min": -304.35183170856874, "episode_return_mean": -237.70411763297423, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36150, "num_agent_steps_trained": 35750, "num_env_steps_sampled": 36150, "num_env_steps_trained": 35750, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 225.54350990896975, "num_env_steps_trained_throughput_per_sec": 206.7482174165556, "timesteps_total": 36150, "num_env_steps_sampled_lifetime": 36150, "num_agent_steps_sampled_lifetime": 36150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 36150, "timers": {"training_iteration_time_ms": 10546.049, "restore_workers_time_ms": 0.027, "training_step_time_ms": 662.216, "sample_time_ms": 638.232, "synch_weights_time_ms": 21.529}, "counters": {"num_env_steps_sampled": 36150, "num_env_steps_trained": 35750, "num_agent_steps_sampled": 36150, "num_agent_steps_trained": 35750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 241, "num_samples_added_to_queue": 35750}, "done": false, "training_iteration": 15, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-49-52", "timestamp": 1731091792, "time_this_iter_s": 10.659358978271484, "time_total_s": 157.74780917167664, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f59d80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 157.74780917167664, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.75, "ram_util_percent": 66.93125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -186753.5, "policy_loss": -189443.96875, "entropy": 12.396927833557129, "entropy_coeff": 0.01, "var_gnorm": 16.031522750854492, "vf_loss": 275865.625, "vf_explained_var": 0.010224878787994385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 37950, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 37950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 256, "num_samples_added_to_queue": 37950, "learner_queue": {"size_count": 69, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 104.984, "learner_load_time_ms": 0.632, "learner_load_wait_time_ms": 2328.534, "learner_dequeue_time_ms": 17744.25}}, "env_runners": {"episode_reward_max": -162.5503779716094, "episode_reward_min": -304.35183170856874, "episode_reward_mean": -236.04805684966647, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.35183170856874}, "policy_reward_max": {"default_policy": -162.5503779716094}, "policy_reward_mean": {"default_policy": -236.04805684966647}, "custom_metrics": {"num_consolidated_mean": 2.4057, "num_consolidated_min": 2.2, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.7562000000000001, "num_overloaded_min": 0.6, "num_overloaded_max": 0.9, "num_moves_mean": 4.1672, "num_moves_min": 3.96, "num_moves_max": 4.41, "mean_accuracy_mean": 41.13192, "mean_accuracy_min": 40.7048, "mean_accuracy_max": 41.48, "num_model_switches_mean": 2.4667, "num_model_switches_min": 2.19, "num_model_switches_max": 2.72, "num_slav_mean": 0.18418679999999998, "num_slav_min": 0.15232, "num_slav_max": 0.22331999999999996, "cpu_conserved_cost_mean": 4.8114, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.2, "mean_cluster_cpu_util_mean": 0.7334458601036269, "mean_cluster_cpu_util_min": 0.707855267702936, "mean_cluster_cpu_util_max": 0.7641904145077721, "mean_cluster_mem_util_mean": 0.518568985260771, "mean_cluster_mem_util_min": 0.5083727891156462, "mean_cluster_mem_util_max": 0.5300786848072562, "oversub_cores_mean": 0.9566804835924008, "oversub_cores_min": 0.917789291882556, "oversub_cores_max": 1.0003454231433506, "reward_consolidation_mean_mean": -0.08327523516333174, "reward_consolidation_mean_min": -0.1549931588848984, "reward_consolidation_mean_max": -0.00616897554301361, "reward_illegal_mean_mean": -1.260333333333333, "reward_illegal_mean_min": -1.4999999999999998, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.432599999999999, "reward_accuracy_mean_min": 0.9599999999999982, "reward_accuracy_mean_max": 1.9600000000000002, "reward_sla_mean_mean": -2.449472, "reward_sla_mean_min": -3.5888, "reward_sla_mean_max": -1.3104, "reward_consolidation_sum_mean": -8.327523516333173, "reward_consolidation_sum_min": -15.49931588848984, "reward_consolidation_sum_max": -0.616897554301361, "reward_illegal_sum_mean": -126.03333333333332, "reward_illegal_sum_min": -149.99999999999997, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 143.25999999999988, "reward_accuracy_sum_min": 95.99999999999982, "reward_accuracy_sum_max": 196.00000000000003, "reward_sla_sum_mean": -244.9472, "reward_sla_sum_min": -358.88, "reward_sla_sum_max": -131.04, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3378.0, "global_timestep_min": 1500, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-229.18115272789458, -209.02556182657767, -229.44894133743819, -260.1462185736275, -218.03649050795278, -288.9963844706687, -188.38226098854122, -192.8847237899778, -257.2594869163674, -226.0186420386524, -230.38104669061045, -222.0851582007867, -207.9721669232086, -243.27088079356935, -304.35183170856874, -217.19349067898077, -198.5048742945099, -221.74199076449483, -301.0830135112022, -247.72878741234825, -240.2649427056609, -244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38827506813651314, "mean_inference_ms": 1.6630426310803204, "mean_action_processing_ms": 0.16695519324429392, "mean_env_wait_ms": 1.8770991190096742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01328277587890625, "StateBufferConnector_ms": 0.007009744644165039, "ViewRequirementAgentConnector_ms": 0.14853405952453613}, "num_episodes": 24, "episode_return_max": -162.5503779716094, "episode_return_min": -304.35183170856874, "episode_return_mean": -236.04805684966647, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 37950, "num_env_steps_sampled": 38400, "num_env_steps_trained": 37950, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 222.31899753590451, "num_env_steps_trained_throughput_per_sec": 217.37857536843998, "timesteps_total": 38400, "num_env_steps_sampled_lifetime": 38400, "num_agent_steps_sampled_lifetime": 38400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 10521.102, "restore_workers_time_ms": 0.024, "training_step_time_ms": 674.057, "sample_time_ms": 649.756, "synch_weights_time_ms": 21.918}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 37950, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 37950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 256, "num_samples_added_to_queue": 37950}, "done": false, "training_iteration": 16, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-50-02", "timestamp": 1731091802, "time_this_iter_s": 10.137397527694702, "time_total_s": 167.88520669937134, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f58550>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 167.88520669937134, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.45, "ram_util_percent": 66.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -165130.359375, "policy_loss": -167259.09375, "entropy": 12.390548706054688, "entropy_coeff": 0.01, "var_gnorm": 16.03607940673828, "vf_loss": 219687.09375, "vf_explained_var": 0.012149393558502197}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 40650, "num_env_steps_trained": 40150, "num_agent_steps_sampled": 40650, "num_agent_steps_trained": 40150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 271, "num_samples_added_to_queue": 40150, "learner_queue": {"size_count": 73, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 102.535, "learner_load_time_ms": 0.632, "learner_load_wait_time_ms": 2389.42, "learner_dequeue_time_ms": 17744.25}}, "env_runners": {"episode_reward_max": -162.5503779716094, "episode_reward_min": -300.4247169488627, "episode_reward_mean": -231.2504541474261, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -300.4247169488627}, "policy_reward_max": {"default_policy": -162.5503779716094}, "policy_reward_mean": {"default_policy": -231.2504541474261}, "custom_metrics": {"num_consolidated_mean": 2.4114, "num_consolidated_min": 2.2, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7656000000000001, "num_overloaded_min": 0.64, "num_overloaded_max": 0.9, "num_moves_mean": 4.1714, "num_moves_min": 3.96, "num_moves_max": 4.41, "mean_accuracy_mean": 41.12584, "mean_accuracy_min": 40.7048, "mean_accuracy_max": 41.48, "num_model_switches_mean": 2.4765, "num_model_switches_min": 2.19, "num_model_switches_max": 2.77, "num_slav_mean": 0.18083000000000002, "num_slav_min": 0.13576, "num_slav_max": 0.22331999999999996, "cpu_conserved_cost_mean": 4.8228, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.734434348013817, "mean_cluster_cpu_util_min": 0.707855267702936, "mean_cluster_cpu_util_max": 0.7641904145077721, "mean_cluster_mem_util_mean": 0.518865422335601, "mean_cluster_mem_util_min": 0.5083727891156462, "mean_cluster_mem_util_max": 0.5300786848072562, "oversub_cores_mean": 0.9578860103626943, "oversub_cores_min": 0.917789291882556, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08487254147426042, "reward_consolidation_mean_min": -0.2034487771506757, "reward_consolidation_mean_max": -0.00616897554301361, "reward_illegal_mean_mean": -1.276, "reward_illegal_mean_min": -1.5, "reward_illegal_mean_max": -1.0666666666666667, "reward_accuracy_mean_mean": 1.396799999999999, "reward_accuracy_mean_min": 0.8799999999999987, "reward_accuracy_mean_max": 1.88, "reward_sla_mean_mean": -2.3484320000000003, "reward_sla_mean_min": -3.4368, "reward_sla_mean_max": -1.2624000000000002, "reward_consolidation_sum_mean": -8.487254147426041, "reward_consolidation_sum_min": -20.344877715067568, "reward_consolidation_sum_max": -0.616897554301361, "reward_illegal_sum_mean": -127.6, "reward_illegal_sum_min": -150.0, "reward_illegal_sum_max": -106.66666666666666, "reward_accuracy_sum_mean": 139.6799999999999, "reward_accuracy_sum_min": 87.99999999999987, "reward_accuracy_sum_max": 188.0, "reward_sla_sum_mean": -234.84319999999997, "reward_sla_sum_min": -343.68, "reward_sla_sum_max": -126.24000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4067.0, "global_timestep_min": 2000, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-244.3422575679834, -242.7578929365488, -258.70187104498, -226.32215837181454, -205.2873576192918, -212.00987514964936, -231.56830169317598, -213.07609372327693, -263.88541132204534, -254.84615358303395, -279.33127415768774, -219.25780742260974, -259.82682743287154, -236.18897212245594, -265.5866598255513, -266.42386865058984, -203.02951599110648, -274.04827774927327, -220.98702240465198, -204.14587993843, -253.6680314691294, -243.32778860954335, -207.2073815631949, -224.20281169830668, -228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38892680170008714, "mean_inference_ms": 1.6636153625233447, "mean_action_processing_ms": 0.16712869465577174, "mean_env_wait_ms": 1.8790909865830365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013126373291015625, "StateBufferConnector_ms": 0.007075309753417969, "ViewRequirementAgentConnector_ms": 0.15140247344970703}, "num_episodes": 21, "episode_return_max": -162.5503779716094, "episode_return_min": -300.4247169488627, "episode_return_mean": -231.2504541474261, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40650, "num_agent_steps_trained": 40150, "num_env_steps_sampled": 40650, "num_env_steps_trained": 40150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 224.75170862267638, "num_env_steps_trained_throughput_per_sec": 219.7572262088391, "timesteps_total": 40650, "num_env_steps_sampled_lifetime": 40650, "num_agent_steps_sampled_lifetime": 40650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 40650, "timers": {"training_iteration_time_ms": 10476.91, "restore_workers_time_ms": 0.026, "training_step_time_ms": 664.296, "sample_time_ms": 639.206, "synch_weights_time_ms": 22.485}, "counters": {"num_env_steps_sampled": 40650, "num_env_steps_trained": 40150, "num_agent_steps_sampled": 40650, "num_agent_steps_trained": 40150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 271, "num_samples_added_to_queue": 40150}, "done": false, "training_iteration": 17, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-50-12", "timestamp": 1731091812, "time_this_iter_s": 10.026329040527344, "time_total_s": 177.91153573989868, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f58640>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.91153573989868, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.959999999999997, "ram_util_percent": 66.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -175119.953125, "policy_loss": -177460.53125, "entropy": 12.383861541748047, "entropy_coeff": 0.01, "var_gnorm": 16.04047393798828, "vf_loss": 240868.015625, "vf_explained_var": 0.014308452606201172}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 42900, "num_env_steps_trained": 42350, "num_agent_steps_sampled": 42900, "num_agent_steps_trained": 42350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 286, "num_samples_added_to_queue": 42900, "learner_queue": {"size_count": 77, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 101.613, "learner_load_time_ms": 0.585, "learner_load_wait_time_ms": 2335.721, "learner_dequeue_time_ms": 17996.587}}, "env_runners": {"episode_reward_max": -162.5503779716094, "episode_reward_min": -300.4247169488627, "episode_reward_mean": -230.89258180263386, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -300.4247169488627}, "policy_reward_max": {"default_policy": -162.5503779716094}, "policy_reward_mean": {"default_policy": -230.89258180263386}, "custom_metrics": {"num_consolidated_mean": 2.4166, "num_consolidated_min": 2.2, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7639999999999999, "num_overloaded_min": 0.64, "num_overloaded_max": 0.9, "num_moves_mean": 4.1690000000000005, "num_moves_min": 3.89, "num_moves_max": 4.41, "mean_accuracy_mean": 41.10425600000001, "mean_accuracy_min": 40.552800000000005, "mean_accuracy_max": 41.54080000000001, "num_model_switches_mean": 2.4759, "num_model_switches_min": 2.19, "num_model_switches_max": 2.77, "num_slav_mean": 0.17748600000000006, "num_slav_min": 0.13576, "num_slav_max": 0.2168, "cpu_conserved_cost_mean": 4.8332, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.7351786286701207, "mean_cluster_cpu_util_min": 0.707855267702936, "mean_cluster_cpu_util_max": 0.7677964594127806, "mean_cluster_mem_util_mean": 0.5191703707482993, "mean_cluster_mem_util_min": 0.5083727891156462, "mean_cluster_mem_util_max": 0.5310375283446711, "oversub_cores_mean": 0.9593747841105355, "oversub_cores_min": 0.917789291882556, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08612848469300508, "reward_consolidation_mean_min": -0.2034487771506757, "reward_consolidation_mean_max": -0.00616897554301361, "reward_illegal_mean_mean": -1.2733333333333332, "reward_illegal_mean_min": -1.5, "reward_illegal_mean_max": -1.0666666666666664, "reward_accuracy_mean_mean": 1.3893999999999986, "reward_accuracy_mean_min": 0.8799999999999987, "reward_accuracy_mean_max": 1.84, "reward_sla_mean_mean": -2.338864, "reward_sla_mean_min": -3.2832000000000003, "reward_sla_mean_max": -1.2528, "reward_consolidation_sum_mean": -8.612848469300507, "reward_consolidation_sum_min": -20.344877715067568, "reward_consolidation_sum_max": -0.616897554301361, "reward_illegal_sum_mean": -127.33333333333331, "reward_illegal_sum_min": -150.0, "reward_illegal_sum_max": -106.66666666666664, "reward_accuracy_sum_mean": 138.93999999999986, "reward_accuracy_sum_min": 87.99999999999987, "reward_accuracy_sum_max": 184.0, "reward_sla_sum_mean": -233.88639999999998, "reward_sla_sum_min": -328.32000000000005, "reward_sla_sum_max": -125.28, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4867.0, "global_timestep_min": 2800, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-228.34364631434912, -221.15945271079227, -254.45381905250576, -248.20351291260465, -231.64959808448785, -212.25252608175177, -232.64693689071316, -225.70715238583892, -206.62095091499955, -198.79537882674862, -248.97008038310233, -258.6890131691466, -231.46174448435087, -234.06991961689755, -227.544792201129, -243.15060372840748, -226.66032153240977, -249.46607491021032, -252.68740208654003, -284.09406875320695, -230.78596545236888, -229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38970735072632195, "mean_inference_ms": 1.6662603486089915, "mean_action_processing_ms": 0.16743203665079454, "mean_env_wait_ms": 1.8826029412918706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012685775756835938, "StateBufferConnector_ms": 0.007101297378540039, "ViewRequirementAgentConnector_ms": 0.15150880813598633}, "num_episodes": 24, "episode_return_max": -162.5503779716094, "episode_return_min": -300.4247169488627, "episode_return_mean": -230.89258180263386, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42900, "num_agent_steps_trained": 42350, "num_env_steps_sampled": 42900, "num_env_steps_trained": 42350, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 219.83475560020858, "num_env_steps_trained_throughput_per_sec": 214.94953880909284, "timesteps_total": 42900, "num_env_steps_sampled_lifetime": 42900, "num_agent_steps_sampled_lifetime": 42900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 42900, "timers": {"training_iteration_time_ms": 10450.312, "restore_workers_time_ms": 0.028, "training_step_time_ms": 676.982, "sample_time_ms": 653.074, "synch_weights_time_ms": 21.425}, "counters": {"num_env_steps_sampled": 42900, "num_env_steps_trained": 42350, "num_agent_steps_sampled": 42900, "num_agent_steps_trained": 42350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 286, "num_samples_added_to_queue": 42900}, "done": false, "training_iteration": 18, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-50-23", "timestamp": 1731091823, "time_this_iter_s": 10.252587795257568, "time_total_s": 188.16412353515625, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5e9450>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.16412353515625, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.17142857142857, "ram_util_percent": 67.28571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -164092.140625, "policy_loss": -166078.65625, "entropy": 12.377808570861816, "entropy_coeff": 0.01, "var_gnorm": 16.044126510620117, "vf_loss": 205459.25, "vf_explained_var": 0.019161581993103027}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 45150, "num_env_steps_trained": 44550, "num_agent_steps_sampled": 45150, "num_agent_steps_trained": 44550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 301, "num_samples_added_to_queue": 45100, "learner_queue": {"size_count": 81, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 111.869, "learner_load_time_ms": 0.353, "learner_load_wait_time_ms": 2395.086, "learner_dequeue_time_ms": 19486.44}}, "env_runners": {"episode_reward_max": -162.5503779716094, "episode_reward_min": -300.4247169488627, "episode_reward_mean": -227.0219991106551, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -300.4247169488627}, "policy_reward_max": {"default_policy": -162.5503779716094}, "policy_reward_mean": {"default_policy": -227.0219991106551}, "custom_metrics": {"num_consolidated_mean": 2.4233, "num_consolidated_min": 2.2, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7756999999999998, "num_overloaded_min": 0.64, "num_overloaded_max": 0.9, "num_moves_mean": 4.163, "num_moves_min": 3.89, "num_moves_max": 4.41, "mean_accuracy_mean": 41.117024, "mean_accuracy_min": 40.552800000000005, "mean_accuracy_max": 41.54080000000001, "num_model_switches_mean": 2.4797, "num_model_switches_min": 2.19, "num_model_switches_max": 2.77, "num_slav_mean": 0.17527040000000002, "num_slav_min": 0.13576, "num_slav_max": 0.2168, "cpu_conserved_cost_mean": 4.8466, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.736391378238342, "mean_cluster_cpu_util_min": 0.707855267702936, "mean_cluster_cpu_util_max": 0.7677964594127806, "mean_cluster_mem_util_mean": 0.5195201780045352, "mean_cluster_mem_util_min": 0.5083727891156462, "mean_cluster_mem_util_max": 0.5310375283446711, "oversub_cores_mean": 0.9605699481865285, "oversub_cores_min": 0.917789291882556, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08508265777321716, "reward_consolidation_mean_min": -0.2034487771506757, "reward_consolidation_mean_max": -0.00616897554301361, "reward_illegal_mean_mean": -1.292833333333333, "reward_illegal_mean_min": -1.5, "reward_illegal_mean_max": -1.0666666666666664, "reward_accuracy_mean_mean": 1.3627999999999982, "reward_accuracy_mean_min": 0.8799999999999987, "reward_accuracy_mean_max": 1.82, "reward_sla_mean_mean": -2.2551039999999998, "reward_sla_mean_min": -3.2832000000000003, "reward_sla_mean_max": -1.2528, "reward_consolidation_sum_mean": -8.508265777321714, "reward_consolidation_sum_min": -20.344877715067568, "reward_consolidation_sum_max": -0.616897554301361, "reward_illegal_sum_mean": -129.2833333333333, "reward_illegal_sum_min": -150.0, "reward_illegal_sum_max": -106.66666666666664, "reward_accuracy_sum_mean": 136.27999999999986, "reward_accuracy_sum_min": 87.99999999999987, "reward_accuracy_sum_max": 182.0, "reward_sla_sum_mean": -225.5104, "reward_sla_sum_min": -328.32000000000005, "reward_sla_sum_max": -125.28, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5566.0, "global_timestep_min": 3500, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-229.39096630750808, -219.58725842312293, -236.3514999144861, -255.8692149820421, -211.89012485035053, -260.0243030613988, -239.64777492731304, -258.31086711133895, -215.92767573114423, -237.2910039336412, -203.54278775440386, -238.1553275183853, -184.1986283564221, -223.52748417992146, -246.66739524542504, -202.7153035744826, -245.50717632974167, -222.83055584060205, -162.5503779716094, -253.58102616726504, -300.4247169488627, -257.36356422096816, -277.4772327689411, -221.3662322558576, -219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39041296154955896, "mean_inference_ms": 1.6673610697563397, "mean_action_processing_ms": 0.16765732349357296, "mean_env_wait_ms": 1.8848568165049597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012962102890014648, "StateBufferConnector_ms": 0.0072824954986572266, "ViewRequirementAgentConnector_ms": 0.15568757057189941}, "num_episodes": 21, "episode_return_max": -162.5503779716094, "episode_return_min": -300.4247169488627, "episode_return_mean": -227.0219991106551, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45150, "num_agent_steps_trained": 44550, "num_env_steps_sampled": 45150, "num_env_steps_trained": 44550, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 223.43787545478972, "num_env_steps_trained_throughput_per_sec": 218.4725893335722, "timesteps_total": 45150, "num_env_steps_sampled_lifetime": 45150, "num_agent_steps_sampled_lifetime": 45150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 45150, "timers": {"training_iteration_time_ms": 10394.664, "restore_workers_time_ms": 0.024, "training_step_time_ms": 664.927, "sample_time_ms": 639.079, "synch_weights_time_ms": 23.035}, "counters": {"num_env_steps_sampled": 45150, "num_env_steps_trained": 44550, "num_agent_steps_sampled": 45150, "num_agent_steps_trained": 44550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 301, "num_samples_added_to_queue": 45100}, "done": false, "training_iteration": 19, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-50-33", "timestamp": 1731091833, "time_this_iter_s": 10.09572458267212, "time_total_s": 198.25984811782837, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f655d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.25984811782837, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.933333333333334, "ram_util_percent": 67.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -153368.71875, "policy_loss": -155168.734375, "entropy": 12.372772216796875, "entropy_coeff": 0.01, "var_gnorm": 16.047178268432617, "vf_loss": 186805.96875, "vf_explained_var": 0.018862545490264893}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 85.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 47400, "num_env_steps_trained": 46750, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 46750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 316, "num_samples_added_to_queue": 47300, "learner_queue": {"size_count": 85, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 120.025, "learner_load_time_ms": 0.353, "learner_load_wait_time_ms": 2398.89, "learner_dequeue_time_ms": 19486.44}}, "env_runners": {"episode_reward_max": -165.96592782623594, "episode_reward_min": -291.6016076620491, "episode_reward_mean": -223.58640694373184, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -291.6016076620491}, "policy_reward_max": {"default_policy": -165.96592782623594}, "policy_reward_mean": {"default_policy": -223.58640694373184}, "custom_metrics": {"num_consolidated_mean": 2.4197, "num_consolidated_min": 2.2, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.7750000000000001, "num_overloaded_min": 0.64, "num_overloaded_max": 0.9, "num_moves_mean": 4.1643, "num_moves_min": 3.89, "num_moves_max": 4.41, "mean_accuracy_mean": 41.10227999999999, "mean_accuracy_min": 40.552800000000005, "mean_accuracy_max": 41.54080000000001, "num_model_switches_mean": 2.4808000000000003, "num_model_switches_min": 2.1, "num_model_switches_max": 2.77, "num_slav_mean": 0.17241199999999998, "num_slav_min": 0.13576, "num_slav_max": 0.20912, "cpu_conserved_cost_mean": 4.8394, "cpu_conserved_cost_min": 4.4, "cpu_conserved_cost_max": 5.24, "mean_cluster_cpu_util_mean": 0.735985822970639, "mean_cluster_cpu_util_min": 0.707855267702936, "mean_cluster_cpu_util_max": 0.7677964594127806, "mean_cluster_mem_util_mean": 0.5193061853741497, "mean_cluster_mem_util_min": 0.5083727891156462, "mean_cluster_mem_util_max": 0.5310375283446711, "oversub_cores_mean": 0.959810017271157, "oversub_cores_min": 0.917789291882556, "oversub_cores_max": 1.0010362694300519, "reward_consolidation_mean_mean": -0.08588540277065175, "reward_consolidation_mean_min": -0.2034487771506757, "reward_consolidation_mean_max": -0.01327090815802986, "reward_illegal_mean_mean": -1.2916666666666663, "reward_illegal_mean_min": -1.5, "reward_illegal_mean_max": -1.0666666666666664, "reward_accuracy_mean_mean": 1.3421999999999985, "reward_accuracy_mean_min": 0.839999999999996, "reward_accuracy_mean_max": 1.9999999999999998, "reward_sla_mean_mean": -2.2005120000000002, "reward_sla_mean_min": -3.2832000000000003, "reward_sla_mean_max": -1.2416, "reward_consolidation_sum_mean": -8.58854027706517, "reward_consolidation_sum_min": -20.344877715067568, "reward_consolidation_sum_max": -1.327090815802986, "reward_illegal_sum_mean": -129.16666666666666, "reward_illegal_sum_min": -150.0, "reward_illegal_sum_max": -106.66666666666664, "reward_accuracy_sum_mean": 134.21999999999986, "reward_accuracy_sum_min": 83.9999999999996, "reward_accuracy_sum_max": 199.99999999999997, "reward_sla_sum_mean": -220.05120000000002, "reward_sla_sum_min": -328.32000000000005, "reward_sla_sum_max": -124.16, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5898.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968, -223.1512604754576, -228.83052505558393, -253.2446348554811, -236.8622712502136, -240.08554814434754, -188.4974380023944, -247.59434581836828, -174.5664169659654, -215.70252095091502, -193.50559261159577, -234.3711852231915, -235.14583205062416, -198.43690097485896, -214.83235847443152, -249.82342055755086, -196.03696254489503, -247.297461946297, -235.3720403625791, -221.80944757995564, -230.90323242688558, -178.08492218231578, -185.4377253292284, -203.52965965452387, -227.51757824525393], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-219.21944244911919, -237.2504292799728, -233.01517359329566, -260.18912262698814, -180.19831024456974, -262.3104190183002, -253.10523003249526, -263.38473063109274, -248.15264922182328, -252.38118009235518, -199.27260817513277, -203.11201983923405, -208.57597400376278, -254.83525568667707, -237.1703232426886, -193.67009748589024, -228.23768086198078, -219.56448435094924, -224.97457499572428, -167.24131691465735, -194.82750128270914, -219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968, -223.1512604754576, -228.83052505558393, -253.2446348554811, -236.8622712502136, -240.08554814434754, -188.4974380023944, -247.59434581836828, -174.5664169659654, -215.70252095091502, -193.50559261159577, -234.3711852231915, -235.14583205062416, -198.43690097485896, -214.83235847443152, -249.82342055755086, -196.03696254489503, -247.297461946297, -235.3720403625791, -221.80944757995564, -230.90323242688558, -178.08492218231578, -185.4377253292284, -203.52965965452387, -227.51757824525393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39114399777383824, "mean_inference_ms": 1.6700524438734987, "mean_action_processing_ms": 0.16791434827640955, "mean_env_wait_ms": 1.887444471498813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013155221939086914, "StateBufferConnector_ms": 0.0073394775390625, "ViewRequirementAgentConnector_ms": 0.15598249435424805}, "num_episodes": 24, "episode_return_max": -165.96592782623594, "episode_return_min": -291.6016076620491, "episode_return_mean": -223.58640694373184, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 46750, "num_env_steps_sampled": 47400, "num_env_steps_trained": 46750, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 220.5417050207863, "num_env_steps_trained_throughput_per_sec": 215.64077824254662, "timesteps_total": 47400, "num_env_steps_sampled_lifetime": 47400, "num_agent_steps_sampled_lifetime": 47400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 47400, "timers": {"training_iteration_time_ms": 10361.948, "restore_workers_time_ms": 0.023, "training_step_time_ms": 692.955, "sample_time_ms": 665.199, "synch_weights_time_ms": 25.312}, "counters": {"num_env_steps_sampled": 47400, "num_env_steps_trained": 46750, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 46750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 316, "num_samples_added_to_queue": 47300}, "done": false, "training_iteration": 20, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-50-43", "timestamp": 1731091843, "time_this_iter_s": 10.221058368682861, "time_total_s": 208.48090648651123, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6cb1b970>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.48090648651123, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.986666666666668, "ram_util_percent": 67.40666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -164565.796875, "policy_loss": -166728.59375, "entropy": 12.36506175994873, "entropy_coeff": 0.01, "var_gnorm": 16.050901412963867, "vf_loss": 223081.1875, "vf_explained_var": 0.016809046268463135}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 90.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 49650, "num_env_steps_trained": 49500, "num_agent_steps_sampled": 49650, "num_agent_steps_trained": 49500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 331, "num_samples_added_to_queue": 49500, "learner_queue": {"size_count": 90, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 122.166, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 2322.156, "learner_dequeue_time_ms": 19614.889}}, "env_runners": {"episode_reward_max": -148.96153583034055, "episode_reward_min": -291.6016076620491, "episode_reward_mean": -222.66570699504024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -291.6016076620491}, "policy_reward_max": {"default_policy": -148.96153583034055}, "policy_reward_mean": {"default_policy": -222.66570699504024}, "custom_metrics": {"num_consolidated_mean": 2.4218, "num_consolidated_min": 2.23, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.7781, "num_overloaded_min": 0.6, "num_overloaded_max": 0.9, "num_moves_mean": 4.165500000000001, "num_moves_min": 3.89, "num_moves_max": 4.33, "mean_accuracy_mean": 41.107296, "mean_accuracy_min": 40.552800000000005, "mean_accuracy_max": 41.556, "num_model_switches_mean": 2.4876, "num_model_switches_min": 2.1, "num_model_switches_max": 2.72, "num_slav_mean": 0.1720712, "num_slav_min": 0.13576, "num_slav_max": 0.20692, "cpu_conserved_cost_mean": 4.8436, "cpu_conserved_cost_min": 4.46, "cpu_conserved_cost_max": 5.2, "mean_cluster_cpu_util_mean": 0.7358696899827288, "mean_cluster_cpu_util_min": 0.7104034542314337, "mean_cluster_cpu_util_max": 0.7677964594127806, "mean_cluster_mem_util_mean": 0.5192179433106576, "mean_cluster_mem_util_min": 0.5087786281179139, "mean_cluster_mem_util_max": 0.5310375283446711, "oversub_cores_mean": 0.9594645941278066, "oversub_cores_min": 0.9208981001727115, "oversub_cores_max": 0.9989637305699481, "reward_consolidation_mean_mean": -0.08071973661706869, "reward_consolidation_mean_min": -0.2034487771506757, "reward_consolidation_mean_max": -0.01327090815802986, "reward_illegal_mean_mean": -1.296833333333333, "reward_illegal_mean_min": -1.4999999999999998, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.3167999999999989, "reward_accuracy_mean_min": 0.7799999999999977, "reward_accuracy_mean_max": 1.9999999999999998, "reward_sla_mean_mean": -2.1659040000000003, "reward_sla_mean_min": -3.2832000000000003, "reward_sla_mean_max": -1.2416, "reward_consolidation_sum_mean": -8.071973661706869, "reward_consolidation_sum_min": -20.344877715067568, "reward_consolidation_sum_max": -1.327090815802986, "reward_illegal_sum_mean": -129.6833333333333, "reward_illegal_sum_min": -149.99999999999997, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 131.67999999999986, "reward_accuracy_sum_min": 77.99999999999977, "reward_accuracy_sum_max": 199.99999999999997, "reward_sla_sum_mean": -216.59040000000002, "reward_sla_sum_min": -328.32000000000005, "reward_sla_sum_max": -124.16, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4965.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968, -223.1512604754576, -228.83052505558393, -253.2446348554811, -236.8622712502136, -240.08554814434754, -188.4974380023944, -247.59434581836828, -174.5664169659654, -215.70252095091502, -193.50559261159577, -234.3711852231915, -235.14583205062416, -198.43690097485896, -214.83235847443152, -249.82342055755086, -196.03696254489503, -247.297461946297, -235.3720403625791, -221.80944757995564, -230.90323242688558, -178.08492218231578, -185.4377253292284, -203.52965965452387, -227.51757824525393, -257.3158406020182, -207.6618642038653, -191.34712160082105, -234.34307166068058, -267.17118522319146, -208.7591106550367, -225.9801607662047, -223.8924029416795, -218.9468958440226, -206.02984436463163, -201.26247990422436, -211.1106276723107, -261.2274431332309, -148.96153583034055, -199.87556353685656, -197.75215324097815, -238.5775200957758, -219.81869334701528, -275.5217342226783, -216.21870702924602, -236.84457328544562], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-219.11020352317425, -218.3537574824699, -224.23386351975367, -233.60076620489124, -211.10719001197214, -165.96592782623594, -260.2843543697622, -194.4015734564735, -204.98009235505378, -190.67821104840093, -251.25894988883192, -263.9371198905422, -247.24492902343073, -190.73207114759694, -184.31164015734564, -217.6125568667696, -225.37912433726683, -198.03110312981016, -213.3646348554814, -202.99780742260987, -243.43553959295377, -227.5775953480418, -286.1590832905764, -186.91087737301183, -261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968, -223.1512604754576, -228.83052505558393, -253.2446348554811, -236.8622712502136, -240.08554814434754, -188.4974380023944, -247.59434581836828, -174.5664169659654, -215.70252095091502, -193.50559261159577, -234.3711852231915, -235.14583205062416, -198.43690097485896, -214.83235847443152, -249.82342055755086, -196.03696254489503, -247.297461946297, -235.3720403625791, -221.80944757995564, -230.90323242688558, -178.08492218231578, -185.4377253292284, -203.52965965452387, -227.51757824525393, -257.3158406020182, -207.6618642038653, -191.34712160082105, -234.34307166068058, -267.17118522319146, -208.7591106550367, -225.9801607662047, -223.8924029416795, -218.9468958440226, -206.02984436463163, -201.26247990422436, -211.1106276723107, -261.2274431332309, -148.96153583034055, -199.87556353685656, -197.75215324097815, -238.5775200957758, -219.81869334701528, -275.5217342226783, -216.21870702924602, -236.84457328544562]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3917073528355797, "mean_inference_ms": 1.6725802609395641, "mean_action_processing_ms": 0.16816491000622613, "mean_env_wait_ms": 1.889779831772571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012925148010253906, "StateBufferConnector_ms": 0.0071849822998046875, "ViewRequirementAgentConnector_ms": 0.15174031257629395}, "num_episodes": 21, "episode_return_max": -148.96153583034055, "episode_return_min": -291.6016076620491, "episode_return_mean": -222.66570699504024, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49650, "num_agent_steps_trained": 49500, "num_env_steps_sampled": 49650, "num_env_steps_trained": 49500, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 222.3019617759736, "num_env_steps_trained_throughput_per_sec": 271.70239772618993, "timesteps_total": 49650, "num_env_steps_sampled_lifetime": 49650, "num_agent_steps_sampled_lifetime": 49650, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 49650, "timers": {"training_iteration_time_ms": 10306.567, "restore_workers_time_ms": 0.023, "training_step_time_ms": 667.182, "sample_time_ms": 643.195, "synch_weights_time_ms": 21.646}, "counters": {"num_env_steps_sampled": 49650, "num_env_steps_trained": 49500, "num_agent_steps_sampled": 49650, "num_agent_steps_trained": 49500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 331, "num_samples_added_to_queue": 49500}, "done": false, "training_iteration": 21, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-50-53", "timestamp": 1731091853, "time_this_iter_s": 10.140849351882935, "time_total_s": 218.62175583839417, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba6d5ea1a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.62175583839417, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.935714285714283, "ram_util_percent": 67.38571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -163569.5625, "policy_loss": -165739.6875, "entropy": 12.360148429870605, "entropy_coeff": 0.01, "var_gnorm": 16.054765701293945, "vf_loss": 223810.9375, "vf_explained_var": 0.0172346830368042}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 94.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 52050, "num_env_steps_trained": 51700, "num_agent_steps_sampled": 52050, "num_agent_steps_trained": 51700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 347, "num_samples_added_to_queue": 51700, "learner_queue": {"size_count": 94, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 112.049, "learner_load_time_ms": 0.322, "learner_load_wait_time_ms": 2393.948, "learner_dequeue_time_ms": 19614.889}}, "env_runners": {"episode_reward_max": -148.96153583034055, "episode_reward_min": -291.6016076620491, "episode_reward_mean": -222.30534386865062, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -291.6016076620491}, "policy_reward_max": {"default_policy": -148.96153583034055}, "policy_reward_mean": {"default_policy": -222.30534386865062}, "custom_metrics": {"num_consolidated_mean": 2.4156, "num_consolidated_min": 2.19, "num_consolidated_max": 2.6, "num_overloaded_mean": 0.7814, "num_overloaded_min": 0.6, "num_overloaded_max": 0.92, "num_moves_mean": 4.168200000000001, "num_moves_min": 3.97, "num_moves_max": 4.36, "mean_accuracy_mean": 41.123712000000005, "mean_accuracy_min": 40.6136, "mean_accuracy_max": 41.556, "num_model_switches_mean": 2.4788, "num_model_switches_min": 2.1, "num_model_switches_max": 2.72, "num_slav_mean": 0.17115359999999996, "num_slav_min": 0.14455999999999997, "num_slav_max": 0.20692, "cpu_conserved_cost_mean": 4.8312, "cpu_conserved_cost_min": 4.38, "cpu_conserved_cost_max": 5.2, "mean_cluster_cpu_util_mean": 0.7357471044905008, "mean_cluster_cpu_util_min": 0.7104034542314337, "mean_cluster_cpu_util_max": 0.7677964594127806, "mean_cluster_mem_util_mean": 0.5190212069160998, "mean_cluster_mem_util_min": 0.5087786281179139, "mean_cluster_mem_util_max": 0.5310375283446711, "oversub_cores_mean": 0.9583937823834198, "oversub_cores_min": 0.9208981001727115, "oversub_cores_max": 0.9989637305699481, "reward_consolidation_mean_mean": -0.08147210535317267, "reward_consolidation_mean_min": -0.182228493244399, "reward_consolidation_mean_max": -0.02169659654523697, "reward_illegal_mean_mean": -1.3023333333333331, "reward_illegal_mean_min": -1.5333333333333328, "reward_illegal_mean_max": -1.0, "reward_accuracy_mean_mean": 1.3247999999999984, "reward_accuracy_mean_min": 0.7799999999999977, "reward_accuracy_mean_max": 2.0000000000000004, "reward_sla_mean_mean": -2.1640479999999997, "reward_sla_mean_min": -3.3583999999999996, "reward_sla_mean_max": -1.2416, "reward_consolidation_sum_mean": -8.147210535317269, "reward_consolidation_sum_min": -18.2228493244399, "reward_consolidation_sum_max": -2.169659654523697, "reward_illegal_sum_mean": -130.23333333333332, "reward_illegal_sum_min": -153.3333333333333, "reward_illegal_sum_max": -100.0, "reward_accuracy_sum_mean": 132.47999999999988, "reward_accuracy_sum_min": 77.99999999999977, "reward_accuracy_sum_max": 200.00000000000006, "reward_sla_sum_mean": -216.40479999999997, "reward_sla_sum_min": -335.84, "reward_sla_sum_max": -124.16, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3888.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "oversub_cores": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968, -223.1512604754576, -228.83052505558393, -253.2446348554811, -236.8622712502136, -240.08554814434754, -188.4974380023944, -247.59434581836828, -174.5664169659654, -215.70252095091502, -193.50559261159577, -234.3711852231915, -235.14583205062416, -198.43690097485896, -214.83235847443152, -249.82342055755086, -196.03696254489503, -247.297461946297, -235.3720403625791, -221.80944757995564, -230.90323242688558, -178.08492218231578, -185.4377253292284, -203.52965965452387, -227.51757824525393, -257.3158406020182, -207.6618642038653, -191.34712160082105, -234.34307166068058, -267.17118522319146, -208.7591106550367, -225.9801607662047, -223.8924029416795, -218.9468958440226, -206.02984436463163, -201.26247990422436, -211.1106276723107, -261.2274431332309, -148.96153583034055, -199.87556353685656, -197.75215324097815, -238.5775200957758, -219.81869334701528, -275.5217342226783, -216.21870702924602, -236.84457328544562, -184.65145886779553, -196.86050282195976, -236.72719685308698, -221.55778689926447, -254.54805541303205, -242.96913972977612, -226.8746639302206, -214.9256199760561, -214.91589533093878, -201.76445014537373, -203.72899606635883, -208.8228493244397, -229.8127039507438, -218.72844535659317, -215.01776637591917, -230.89624764836654, -218.62082777492733, -224.0425277920301, -221.9379852916026, -214.00627330254846, -257.08647853600144, -200.16784333846422, -189.4466803488968, -197.5222644090988], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-261.8809132888659, -228.30975200957766, -220.67173935351457, -271.5976637591928, -272.61314520266836, -257.7608517188302, -228.6655378826749, -253.39927826235672, -248.78873610398475, -291.6016076620491, -217.23785873097304, -212.10664272276375, -208.70645459209862, -235.40446724816155, -237.74321874465528, -229.36742945100048, -204.78079356935194, -184.6712091670943, -236.19586796647852, -274.40465195826914, -201.20473063109296, -182.83962373866956, -207.55516333162316, -247.45553617239614, -203.04616042414915, -198.44956045835482, -247.49279288524025, -195.08368736103978, -205.46342739866603, -214.0185428424832, -217.12687190011968, -223.1512604754576, -228.83052505558393, -253.2446348554811, -236.8622712502136, -240.08554814434754, -188.4974380023944, -247.59434581836828, -174.5664169659654, -215.70252095091502, -193.50559261159577, -234.3711852231915, -235.14583205062416, -198.43690097485896, -214.83235847443152, -249.82342055755086, -196.03696254489503, -247.297461946297, -235.3720403625791, -221.80944757995564, -230.90323242688558, -178.08492218231578, -185.4377253292284, -203.52965965452387, -227.51757824525393, -257.3158406020182, -207.6618642038653, -191.34712160082105, -234.34307166068058, -267.17118522319146, -208.7591106550367, -225.9801607662047, -223.8924029416795, -218.9468958440226, -206.02984436463163, -201.26247990422436, -211.1106276723107, -261.2274431332309, -148.96153583034055, -199.87556353685656, -197.75215324097815, -238.5775200957758, -219.81869334701528, -275.5217342226783, -216.21870702924602, -236.84457328544562, -184.65145886779553, -196.86050282195976, -236.72719685308698, -221.55778689926447, -254.54805541303205, -242.96913972977612, -226.8746639302206, -214.9256199760561, -214.91589533093878, -201.76445014537373, -203.72899606635883, -208.8228493244397, -229.8127039507438, -218.72844535659317, -215.01776637591917, -230.89624764836654, -218.62082777492733, -224.0425277920301, -221.9379852916026, -214.00627330254846, -257.08647853600144, -200.16784333846422, -189.4466803488968, -197.5222644090988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39203450609769314, "mean_inference_ms": 1.674894097932297, "mean_action_processing_ms": 0.16838568762280354, "mean_env_wait_ms": 1.8916347023114064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012645959854125977, "StateBufferConnector_ms": 0.00702977180480957, "ViewRequirementAgentConnector_ms": 0.14934492111206055}, "num_episodes": 24, "episode_return_max": -148.96153583034055, "episode_return_min": -291.6016076620491, "episode_return_mean": -222.30534386865062, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52050, "num_agent_steps_trained": 51700, "num_env_steps_sampled": 52050, "num_env_steps_trained": 51700, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 227.29819777127256, "num_env_steps_trained_throughput_per_sec": 208.3566812903332, "timesteps_total": 52050, "num_env_steps_sampled_lifetime": 52050, "num_agent_steps_sampled_lifetime": 52050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 52050, "timers": {"training_iteration_time_ms": 10314.681, "restore_workers_time_ms": 0.024, "training_step_time_ms": 659.337, "sample_time_ms": 633.427, "synch_weights_time_ms": 22.995}, "counters": {"num_env_steps_sampled": 52050, "num_env_steps_trained": 51700, "num_agent_steps_sampled": 52050, "num_agent_steps_trained": 51700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 347, "num_samples_added_to_queue": 51700}, "done": true, "training_iteration": 22, "trial_id": "dd6f8_00000", "date": "2024-11-08_18-51-04", "timestamp": 1731091864, "time_this_iter_s": 10.576546907424927, "time_total_s": 229.1983027458191, "pid": 278894, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 1.0, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x79ba61f66e30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x79ba68dc57e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.1983027458191, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.639999999999997, "ram_util_percent": 67.16666666666666}}
