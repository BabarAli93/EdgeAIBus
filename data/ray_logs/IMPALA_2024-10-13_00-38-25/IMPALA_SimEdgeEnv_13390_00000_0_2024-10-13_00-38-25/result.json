{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -503131.0, "policy_loss": -506203.0, "entropy": 29.818601608276367, "entropy_coeff": 0.01, "var_gnorm": 16.000411987304688, "vf_loss": 323601.5625, "vf_explained_var": 0.00013077259063720703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454546}}, "num_env_steps_sampled": 2250, "num_env_steps_trained": 1650, "num_agent_steps_sampled": 2250, "num_agent_steps_trained": 1650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 15, "num_samples_added_to_queue": 2200, "learner_queue": {"size_count": 3, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.179, "learner_load_time_ms": 0.066, "learner_load_wait_time_ms": 2556.336, "learner_dequeue_time_ms": 2812.291}}, "env_runners": {"episode_reward_max": -234.81498370343266, "episode_reward_min": -289.75012336653566, "episode_reward_mean": -264.7892056819681, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 2100, "policy_reward_min": {"default_policy": -289.75012336653566}, "policy_reward_max": {"default_policy": -234.81498370343266}, "policy_reward_mean": {"default_policy": -264.7892056819681}, "custom_metrics": {"num_consolidated_mean": 0.6809523809523809, "num_consolidated_min": 0.55, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0685714285714287, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 10.01952380952381, "num_moves_min": 9.82, "num_moves_max": 10.25, "mean_accuracy_mean": 41.091857142857144, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.290000000000006, "num_model_switches_mean": 6.0390476190476186, "num_model_switches_min": 5.68, "num_model_switches_max": 6.35, "num_slav_mean": 0.16265476190476194, "num_slav_min": 0.1436, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.731428571428571, "cpu_conserved_cost_min": 2.2, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5722368730826078, "mean_cluster_cpu_util_min": 0.5545035364432848, "mean_cluster_cpu_util_max": 0.5940802852164182, "mean_cluster_mem_util_mean": 0.3669616745874561, "mean_cluster_mem_util_min": 0.3595602946769425, "mean_cluster_mem_util_max": 0.37668749497689374, "reward_consolidation_mean_mean": -0.5138444377720627, "reward_consolidation_mean_min": -0.7551897712388438, "reward_consolidation_mean_max": -0.3379449572024735, "reward_illegal_mean_mean": -1.7809523809523808, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8670634920634922, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2201587301587302, "reward_sla_mean_min": -1.896, "reward_sla_mean_max": -0.7486666666666666, "reward_consolidation_sum_mean": -51.38444377720628, "reward_consolidation_sum_min": -75.51897712388438, "reward_consolidation_sum_max": -33.79449572024735, "reward_illegal_sum_mean": -178.09523809523807, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 86.70634920634923, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -122.01587301587298, "reward_sla_sum_min": -189.6, "reward_sla_sum_max": -74.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 400.0, "global_timestep_min": 100, "global_timestep_max": 700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2574755570859948, "mean_inference_ms": 2.2428569082572514, "mean_action_processing_ms": 0.10120069721355686, "mean_env_wait_ms": 1.904986881437272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008404822576613654, "StateBufferConnector_ms": 0.0037681488763718378, "ViewRequirementAgentConnector_ms": 0.09123824891589936}, "num_episodes": 21, "episode_return_max": -234.81498370343266, "episode_return_min": -289.75012336653566, "episode_return_mean": -264.7892056819681, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2250, "num_agent_steps_trained": 1650, "num_env_steps_sampled": 2250, "num_env_steps_trained": 1650, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 214.8681292775558, "num_env_steps_trained_throughput_per_sec": 157.5699614702076, "timesteps_total": 2250, "num_env_steps_sampled_lifetime": 2250, "num_agent_steps_sampled_lifetime": 2250, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 2250, "timers": {"training_iteration_time_ms": 10471.553, "restore_workers_time_ms": 0.013, "training_step_time_ms": 689.1, "sample_time_ms": 672.988, "synch_weights_time_ms": 14.842}, "counters": {"num_env_steps_sampled": 2250, "num_env_steps_trained": 1650, "num_agent_steps_sampled": 2250, "num_agent_steps_trained": 1650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 15, "num_samples_added_to_queue": 2200}, "done": false, "training_iteration": 1, "trial_id": "13390_00000", "date": "2024-10-13_00-38-36", "timestamp": 1728776316, "time_this_iter_s": 10.478345394134521, "time_total_s": 10.478345394134521, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e372196aa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.478345394134521, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 61.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -482118.84375, "policy_loss": -484961.96875, "entropy": 29.818185806274414, "entropy_coeff": 0.01, "var_gnorm": 16.000377655029297, "vf_loss": 300713.71875, "vf_explained_var": 0.00043141841888427734}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272725}}, "num_env_steps_sampled": 4350, "num_env_steps_trained": 3850, "num_agent_steps_sampled": 4350, "num_agent_steps_trained": 3850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 29, "num_samples_added_to_queue": 3850, "learner_queue": {"size_count": 7, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 109.831, "learner_load_time_ms": 0.066, "learner_load_wait_time_ms": 2536.501, "learner_dequeue_time_ms": 2812.291}}, "env_runners": {"episode_reward_max": -217.27074537756238, "episode_reward_min": -289.75012336653566, "episode_reward_mean": -259.0561501227862, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 4200, "policy_reward_min": {"default_policy": -289.75012336653566}, "policy_reward_max": {"default_policy": -217.27074537756238}, "policy_reward_mean": {"default_policy": -259.0561501227862}, "custom_metrics": {"num_consolidated_mean": 0.689047619047619, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.052142857142857, "num_overloaded_min": 0.93, "num_overloaded_max": 1.2, "num_moves_mean": 9.977380952380953, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.08039682539682, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.302666666666674, "num_model_switches_mean": 6.01952380952381, "num_model_switches_min": 5.68, "num_model_switches_max": 6.38, "num_slav_mean": 0.1596420634920635, "num_slav_min": 0.13768333333333335, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.7395238095238095, "cpu_conserved_cost_min": 2.1, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.571809058422154, "mean_cluster_cpu_util_min": 0.5545035364432848, "mean_cluster_cpu_util_max": 0.5964702007998269, "mean_cluster_mem_util_mean": 0.3665772591804956, "mean_cluster_mem_util_min": 0.3578292412956743, "mean_cluster_mem_util_max": 0.3768065174804099, "reward_consolidation_mean_mean": -0.5355535647199268, "reward_consolidation_mean_min": -0.7551897712388438, "reward_consolidation_mean_max": -0.27789210758780347, "reward_illegal_mean_mean": -1.7535714285714283, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.905357142857143, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2067936507936508, "reward_sla_mean_min": -1.896, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": -53.55535647199269, "reward_consolidation_sum_min": -75.51897712388438, "reward_consolidation_sum_max": -27.78921075878035, "reward_illegal_sum_mean": -175.35714285714283, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 90.53571428571429, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -120.67936507936507, "reward_sla_sum_min": -189.6, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 750.0, "global_timestep_min": 100, "global_timestep_max": 1400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26007711309181786, "mean_inference_ms": 2.255393552682526, "mean_action_processing_ms": 0.10165459549303198, "mean_env_wait_ms": 1.919413516725633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00803413845243908, "StateBufferConnector_ms": 0.003742604028610956, "ViewRequirementAgentConnector_ms": 0.09319384892781575}, "num_episodes": 21, "episode_return_max": -217.27074537756238, "episode_return_min": -289.75012336653566, "episode_return_mean": -259.0561501227862, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4350, "num_agent_steps_trained": 3850, "num_env_steps_sampled": 4350, "num_env_steps_trained": 3850, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 206.1552087772304, "num_env_steps_trained_throughput_per_sec": 215.97212348090804, "timesteps_total": 4350, "num_env_steps_sampled_lifetime": 4350, "num_agent_steps_sampled_lifetime": 4350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 4350, "timers": {"training_iteration_time_ms": 10329.032, "restore_workers_time_ms": 0.014, "training_step_time_ms": 737.378, "sample_time_ms": 709.276, "synch_weights_time_ms": 26.368}, "counters": {"num_env_steps_sampled": 4350, "num_env_steps_trained": 3850, "num_agent_steps_sampled": 4350, "num_agent_steps_trained": 3850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 29, "num_samples_added_to_queue": 3850}, "done": false, "training_iteration": 2, "trial_id": "13390_00000", "date": "2024-10-13_00-38-47", "timestamp": 1728776327, "time_this_iter_s": 10.191848993301392, "time_total_s": 20.670194387435913, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.670194387435913, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.30666666666667, "ram_util_percent": 61.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -509502.625, "policy_loss": -512712.5625, "entropy": 29.817808151245117, "entropy_coeff": 0.01, "var_gnorm": 16.000104904174805, "vf_loss": 337393.59375, "vf_explained_var": 0.0007025003433227539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 6450, "num_env_steps_trained": 6050, "num_agent_steps_sampled": 6450, "num_agent_steps_trained": 6050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 43, "num_samples_added_to_queue": 6050, "learner_queue": {"size_count": 11, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 106.594, "learner_load_time_ms": 0.244, "learner_load_wait_time_ms": 2591.41, "learner_dequeue_time_ms": 11850.065}}, "env_runners": {"episode_reward_max": -217.27074537756238, "episode_reward_min": -291.4607389807793, "episode_reward_mean": -258.5163476736353, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 6300, "policy_reward_min": {"default_policy": -291.4607389807793}, "policy_reward_max": {"default_policy": -217.27074537756238}, "policy_reward_mean": {"default_policy": -258.5163476736353}, "custom_metrics": {"num_consolidated_mean": 0.6825396825396826, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0493650793650793, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.995079365079366, "num_moves_min": 9.7, "num_moves_max": 10.33, "mean_accuracy_mean": 41.08864021164021, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 6.014285714285714, "num_model_switches_min": 5.59, "num_model_switches_max": 6.38, "num_slav_mean": 0.16034682539682535, "num_slav_min": 0.13768333333333335, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.71015873015873, "cpu_conserved_cost_min": 2.1, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.571126804993155, "mean_cluster_cpu_util_min": 0.5545035364432848, "mean_cluster_cpu_util_max": 0.5964702007998269, "mean_cluster_mem_util_mean": 0.36607286649540266, "mean_cluster_mem_util_min": 0.3578292412956743, "mean_cluster_mem_util_max": 0.3768065174804099, "reward_consolidation_mean_mean": -0.5374174449903227, "reward_consolidation_mean_min": -0.7853400956471412, "reward_consolidation_mean_max": -0.27789210758780347, "reward_illegal_mean_mean": -1.7489417989417988, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.9105820105820108, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2093862433862432, "reward_sla_mean_min": -1.896, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": -53.74174449903228, "reward_consolidation_sum_min": -78.53400956471413, "reward_consolidation_sum_max": -27.78921075878035, "reward_illegal_sum_mean": -174.8941798941799, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 91.05820105820108, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -120.93862433862432, "reward_sla_sum_min": -189.6, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1100.0, "global_timestep_min": 100, "global_timestep_max": 2100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2633671331238465, "mean_inference_ms": 2.2717807577542364, "mean_action_processing_ms": 0.10233599066607427, "mean_env_wait_ms": 1.9361764615905948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008024488176618303, "StateBufferConnector_ms": 0.0038703282674153647, "ViewRequirementAgentConnector_ms": 0.09863868592277406}, "num_episodes": 21, "episode_return_max": -217.27074537756238, "episode_return_min": -291.4607389807793, "episode_return_mean": -258.5163476736353, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6450, "num_agent_steps_trained": 6050, "num_env_steps_sampled": 6450, "num_env_steps_trained": 6050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 200.42000185628888, "num_env_steps_trained_throughput_per_sec": 209.9638114684931, "timesteps_total": 6450, "num_env_steps_sampled_lifetime": 6450, "num_agent_steps_sampled_lifetime": 6450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 6450, "timers": {"training_iteration_time_ms": 10378.69, "restore_workers_time_ms": 0.017, "training_step_time_ms": 750.836, "sample_time_ms": 734.987, "synch_weights_time_ms": 14.19}, "counters": {"num_env_steps_sampled": 6450, "num_env_steps_trained": 6050, "num_agent_steps_sampled": 6450, "num_agent_steps_trained": 6050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 43, "num_samples_added_to_queue": 6050}, "done": false, "training_iteration": 3, "trial_id": "13390_00000", "date": "2024-10-13_00-38-57", "timestamp": 1728776337, "time_this_iter_s": 10.485655784606934, "time_total_s": 31.155850172042847, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 31.155850172042847, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.08, "ram_util_percent": 61.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -544898.25, "policy_loss": -548605.75, "entropy": 29.817581176757812, "entropy_coeff": 0.01, "var_gnorm": 15.999813079833984, "vf_loss": 387152.90625, "vf_explained_var": 0.0008409619331359863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545503}}, "num_env_steps_sampled": 8550, "num_env_steps_trained": 8250, "num_agent_steps_sampled": 8550, "num_agent_steps_trained": 8250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 57, "num_samples_added_to_queue": 8250, "learner_queue": {"size_count": 15, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 102.012, "learner_load_time_ms": 0.244, "learner_load_wait_time_ms": 2589.237, "learner_dequeue_time_ms": 11850.065}}, "env_runners": {"episode_reward_max": -217.27074537756238, "episode_reward_min": -310.7873374150901, "episode_reward_mean": -261.88550544741935, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 8400, "policy_reward_min": {"default_policy": -310.7873374150901}, "policy_reward_max": {"default_policy": -217.27074537756238}, "policy_reward_mean": {"default_policy": -261.88550544741935}, "custom_metrics": {"num_consolidated_mean": 0.6736904761904763, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0486904761904765, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.991071428571427, "num_moves_min": 9.7, "num_moves_max": 10.34, "mean_accuracy_mean": 41.09472222222222, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 6.002142857142858, "num_model_switches_min": 5.58, "num_model_switches_max": 6.38, "num_slav_mean": 0.16046428571428573, "num_slav_min": 0.13768333333333335, "num_slav_max": 0.1834333333333333, "cpu_conserved_cost_mean": 2.6904761904761907, "cpu_conserved_cost_min": 2.1, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5711639000806452, "mean_cluster_cpu_util_min": 0.5545035364432848, "mean_cluster_cpu_util_max": 0.5964702007998269, "mean_cluster_mem_util_mean": 0.36619609464164415, "mean_cluster_mem_util_min": 0.3578292412956743, "mean_cluster_mem_util_max": 0.3768065174804099, "reward_consolidation_mean_mean": -0.5470534671726074, "reward_consolidation_mean_min": -0.7853400956471412, "reward_consolidation_mean_max": -0.27789210758780347, "reward_illegal_mean_mean": -1.7478174603174603, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.9267857142857145, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2507698412698416, "reward_sla_mean_min": -2.04, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": -54.705346717260724, "reward_consolidation_sum_min": -78.53400956471413, "reward_consolidation_sum_max": -27.78921075878035, "reward_illegal_sum_mean": -174.78174603174602, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 92.67857142857144, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -125.07698412698416, "reward_sla_sum_min": -204.0, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1450.0, "global_timestep_min": 100, "global_timestep_max": 2800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-276.29950957994413, -254.05087270401162, -273.69150141643064, -273.4047549422767, -289.75012336653566, -234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.26568194751376034, "mean_inference_ms": 2.2860562612083877, "mean_action_processing_ms": 0.10281720242073558, "mean_env_wait_ms": 1.948056552122388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007844538915724982, "StateBufferConnector_ms": 0.0038703282674153647, "ViewRequirementAgentConnector_ms": 0.09902942748296828}, "num_episodes": 21, "episode_return_max": -217.27074537756238, "episode_return_min": -310.7873374150901, "episode_return_mean": -261.88550544741935, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8550, "num_agent_steps_trained": 8250, "num_env_steps_sampled": 8550, "num_env_steps_trained": 8250, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 200.6101501050705, "num_env_steps_trained_throughput_per_sec": 210.1630143957881, "timesteps_total": 8550, "num_env_steps_sampled_lifetime": 8550, "num_agent_steps_sampled_lifetime": 8550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 8550, "timers": {"training_iteration_time_ms": 10401.036, "restore_workers_time_ms": 0.014, "training_step_time_ms": 751.156, "sample_time_ms": 735.48, "synch_weights_time_ms": 14.236}, "counters": {"num_env_steps_sampled": 8550, "num_env_steps_trained": 8250, "num_agent_steps_sampled": 8550, "num_agent_steps_trained": 8250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 57, "num_samples_added_to_queue": 8250}, "done": false, "training_iteration": 4, "trial_id": "13390_00000", "date": "2024-10-13_00-39-08", "timestamp": 1728776348, "time_this_iter_s": 10.477690696716309, "time_total_s": 41.633540868759155, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3fd90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.633540868759155, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.18, "ram_util_percent": 61.513333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -501418.625, "policy_loss": -504514.15625, "entropy": 29.817293167114258, "entropy_coeff": 0.01, "var_gnorm": 15.999678611755371, "vf_loss": 325953.46875, "vf_explained_var": 0.001201927661895752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 10650, "num_env_steps_trained": 10450, "num_agent_steps_sampled": 10650, "num_agent_steps_trained": 10450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 71, "num_samples_added_to_queue": 10450, "learner_queue": {"size_count": 19, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.257, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 2696.794, "learner_dequeue_time_ms": 15420.261}}, "env_runners": {"episode_reward_max": -217.27074537756238, "episode_reward_min": -310.7873374150901, "episode_reward_mean": -259.839747631667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -310.7873374150901}, "policy_reward_max": {"default_policy": -217.27074537756238}, "policy_reward_mean": {"default_policy": -259.839747631667}, "custom_metrics": {"num_consolidated_mean": 0.6790999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0496, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.9892, "num_moves_min": 9.7, "num_moves_max": 10.34, "mean_accuracy_mean": 41.09474333333333, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.9956000000000005, "num_model_switches_min": 5.58, "num_model_switches_max": 6.41, "num_slav_mean": 0.1610248333333333, "num_slav_min": 0.13768333333333335, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.7075999999999993, "cpu_conserved_cost_min": 2.1, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5716235049728704, "mean_cluster_cpu_util_min": 0.5535040516724825, "mean_cluster_cpu_util_max": 0.599650783548961, "mean_cluster_mem_util_mean": 0.3662701733043429, "mean_cluster_mem_util_min": 0.35726178151640403, "mean_cluster_mem_util_max": 0.3813832552957892, "reward_consolidation_mean_mean": -0.5378974763166712, "reward_consolidation_mean_min": -0.8308286880501997, "reward_consolidation_mean_max": -0.27789210758780347, "reward_illegal_mean_mean": -1.7493333333333327, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.9098333333333337, "reward_accuracy_mean_min": 0.5249999999999997, "reward_accuracy_mean_max": 1.4916666666666694, "reward_sla_mean_mean": -1.2209999999999999, "reward_sla_mean_min": -2.04, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": -53.789747631667126, "reward_consolidation_sum_min": -83.08286880501997, "reward_consolidation_sum_max": -27.78921075878035, "reward_illegal_sum_mean": -174.9333333333333, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 90.98333333333336, "reward_accuracy_sum_min": 52.49999999999997, "reward_accuracy_sum_max": 149.16666666666694, "reward_sla_sum_mean": -122.1, "reward_sla_sum_min": -204.0, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1875.0, "global_timestep_min": 100, "global_timestep_max": 3500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-234.81498370343266, -253.59408449846168, -286.4333577020317, -265.05071735355926, -250.7257638063905, -279.28564379055064, -257.4148923208138, -269.3411922385697, -250.97719699046561, -272.6196168022175, -243.75022997959115, -272.42186786073285, -264.95278564683645, -237.8611623869139, -274.02304060434363, -280.1100216272199, -241.38603368972537, -263.78007858905215, -241.76635901184918, -217.27074537756238, -244.56660879100775, -242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2677151559152328, "mean_inference_ms": 2.2958470201033494, "mean_action_processing_ms": 0.10326193523624089, "mean_env_wait_ms": 1.9590060672193874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007634639739990234, "StateBufferConnector_ms": 0.003876924514770508, "ViewRequirementAgentConnector_ms": 0.09951043128967285}, "num_episodes": 21, "episode_return_max": -217.27074537756238, "episode_return_min": -310.7873374150901, "episode_return_mean": -259.839747631667, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10650, "num_agent_steps_trained": 10450, "num_env_steps_sampled": 10650, "num_env_steps_trained": 10450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.2372107255926, "num_env_steps_trained_throughput_per_sec": 208.72469695062082, "timesteps_total": 10650, "num_env_steps_sampled_lifetime": 10650, "num_agent_steps_sampled_lifetime": 10650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 10650, "timers": {"training_iteration_time_ms": 10428.871, "restore_workers_time_ms": 0.014, "training_step_time_ms": 749.856, "sample_time_ms": 731.122, "synch_weights_time_ms": 17.136}, "counters": {"num_env_steps_sampled": 10650, "num_env_steps_trained": 10450, "num_agent_steps_sampled": 10650, "num_agent_steps_trained": 10450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 71, "num_samples_added_to_queue": 10450}, "done": false, "training_iteration": 5, "trial_id": "13390_00000", "date": "2024-10-13_00-39-18", "timestamp": 1728776358, "time_this_iter_s": 10.54941987991333, "time_total_s": 52.182960748672485, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0a9b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.182960748672485, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.27333333333333, "ram_util_percent": 61.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -496377.84375, "policy_loss": -499397.5625, "entropy": 29.81713104248047, "entropy_coeff": 0.01, "var_gnorm": 15.999544143676758, "vf_loss": 318370.90625, "vf_explained_var": 0.0015355348587036133}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 22.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 12600, "num_env_steps_trained": 12100, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 84, "num_samples_added_to_queue": 12100, "learner_queue": {"size_count": 22, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.51, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 2750.481, "learner_dequeue_time_ms": 15420.261}}, "env_runners": {"episode_reward_max": -225.59598221084985, "episode_reward_min": -310.7873374150901, "episode_reward_mean": -259.76340954643746, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -310.7873374150901}, "policy_reward_max": {"default_policy": -225.59598221084985}, "policy_reward_mean": {"default_policy": -259.76340954643746}, "custom_metrics": {"num_consolidated_mean": 0.6735000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0482, "num_overloaded_min": 0.91, "num_overloaded_max": 1.2, "num_moves_mean": 9.9773, "num_moves_min": 9.58, "num_moves_max": 10.34, "mean_accuracy_mean": 41.098859999999995, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.981099999999999, "num_model_switches_min": 5.58, "num_model_switches_max": 6.41, "num_slav_mean": 0.1621365, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.18098333333333333, "cpu_conserved_cost_mean": 2.6814, "cpu_conserved_cost_min": 2.1, "cpu_conserved_cost_max": 3.62, "mean_cluster_cpu_util_mean": 0.5707346295589235, "mean_cluster_cpu_util_min": 0.5535040516724825, "mean_cluster_cpu_util_max": 0.599650783548961, "mean_cluster_mem_util_mean": 0.36595867442915986, "mean_cluster_mem_util_min": 0.35726178151640403, "mean_cluster_mem_util_max": 0.3813832552957892, "reward_consolidation_mean_mean": -0.5409874287977093, "reward_consolidation_mean_min": -0.8308286880501997, "reward_consolidation_mean_max": -0.27789210758780347, "reward_illegal_mean_mean": -1.7469999999999999, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5166666666666664, "reward_accuracy_mean_mean": 0.9186666666666667, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.325000000000001, "reward_sla_mean_mean": -1.2283133333333334, "reward_sla_mean_min": -2.04, "reward_sla_mean_max": -0.6859999999999999, "reward_consolidation_sum_mean": -54.09874287977093, "reward_consolidation_sum_min": -83.08286880501997, "reward_consolidation_sum_max": -27.78921075878035, "reward_illegal_sum_mean": -174.69999999999993, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -151.66666666666663, "reward_accuracy_sum_mean": 91.86666666666667, "reward_accuracy_sum_min": 54.1666666666667, "reward_accuracy_sum_max": 132.5000000000001, "reward_sla_sum_mean": -122.83133333333333, "reward_sla_sum_min": -204.0, "reward_sla_sum_max": -68.6, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2575.0, "global_timestep_min": 800, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-242.30454780834006, -236.3892107587803, -266.67932620548896, -266.3417496725455, -279.0068415120777, -253.87728228091, -250.1491272959882, -256.3012032044836, -242.64753419232994, -261.2429681074657, -270.60240336288035, -262.5507478144322, -278.3135885954491, -247.15659020987513, -261.70102653142027, -235.75101282402744, -255.02033872490748, -268.946723933108, -288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27212235691680087, "mean_inference_ms": 2.3253988870414126, "mean_action_processing_ms": 0.10430161854127044, "mean_env_wait_ms": 1.9836218647697106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007462978363037109, "StateBufferConnector_ms": 0.003936052322387695, "ViewRequirementAgentConnector_ms": 0.10187673568725586}, "num_episodes": 21, "episode_return_max": -225.59598221084985, "episode_return_min": -310.7873374150901, "episode_return_mean": -259.76340954643746, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12100, "num_env_steps_sampled": 12600, "num_env_steps_trained": 12100, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 185.72557089732308, "num_env_steps_trained_throughput_per_sec": 157.15240614388878, "timesteps_total": 12600, "num_env_steps_sampled_lifetime": 12600, "num_agent_steps_sampled_lifetime": 12600, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 12600, "timers": {"training_iteration_time_ms": 10440.621, "restore_workers_time_ms": 0.018, "training_step_time_ms": 832.895, "sample_time_ms": 815.134, "synch_weights_time_ms": 16.05}, "counters": {"num_env_steps_sampled": 12600, "num_env_steps_trained": 12100, "num_agent_steps_sampled": 12600, "num_agent_steps_trained": 12100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 84, "num_samples_added_to_queue": 12100}, "done": false, "training_iteration": 6, "trial_id": "13390_00000", "date": "2024-10-13_00-39-29", "timestamp": 1728776369, "time_this_iter_s": 10.517168521881104, "time_total_s": 62.70012927055359, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0a800>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.70012927055359, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.019999999999996, "ram_util_percent": 62.080000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -523121.0625, "policy_loss": -526487.5, "entropy": 29.816850662231445, "entropy_coeff": 0.01, "var_gnorm": 15.999537467956543, "vf_loss": 353044.125, "vf_explained_var": 0.0016907453536987305}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 26.0, "diff_num_grad_updates_vs_sampler_policy": 0.3636363636363633}}, "num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 97, "num_samples_added_to_queue": 14300, "learner_queue": {"size_count": 26, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.147, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 2874.45, "learner_dequeue_time_ms": 17367.372}}, "env_runners": {"episode_reward_max": -225.59598221084985, "episode_reward_min": -310.7873374150901, "episode_reward_mean": -261.09826638033434, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -310.7873374150901}, "policy_reward_max": {"default_policy": -225.59598221084985}, "policy_reward_mean": {"default_policy": -261.09826638033434}, "custom_metrics": {"num_consolidated_mean": 0.6715000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0437, "num_overloaded_min": 0.9, "num_overloaded_max": 1.18, "num_moves_mean": 9.982899999999997, "num_moves_min": 9.58, "num_moves_max": 10.34, "mean_accuracy_mean": 41.112413333333336, "mean_accuracy_min": 40.85933333333333, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.9863, "num_model_switches_min": 5.58, "num_model_switches_max": 6.41, "num_slav_mean": 0.163225, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.19188333333333335, "cpu_conserved_cost_mean": 2.6688000000000005, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.58, "mean_cluster_cpu_util_mean": 0.5703860239281856, "mean_cluster_cpu_util_min": 0.550052687755364, "mean_cluster_cpu_util_max": 0.599650783548961, "mean_cluster_mem_util_mean": 0.36573534830219, "mean_cluster_mem_util_min": 0.35726178151640403, "mean_cluster_mem_util_max": 0.3813832552957892, "reward_consolidation_mean_mean": -0.5466526638033448, "reward_consolidation_mean_min": -0.8338181181272656, "reward_consolidation_mean_max": -0.2809598221085017, "reward_illegal_mean_mean": -1.7394999999999996, "reward_illegal_mean_min": -1.9666666666666668, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.9325833333333334, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.3750000000000009, "reward_sla_mean_mean": -1.2574133333333335, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.7166666666666667, "reward_consolidation_sum_mean": -54.66526638033448, "reward_consolidation_sum_min": -83.38181181272655, "reward_consolidation_sum_max": -28.095982210850167, "reward_illegal_sum_mean": -173.95, "reward_illegal_sum_min": -196.66666666666669, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 93.25833333333335, "reward_accuracy_sum_min": 54.1666666666667, "reward_accuracy_sum_max": 137.50000000000009, "reward_sla_sum_mean": -125.74133333333334, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -71.66666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3182.0, "global_timestep_min": 1500, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-288.963127113223, -245.36994121051498, -239.21474915471063, -264.84075664808546, -247.593146303573, -251.61406073898064, -274.6979499832462, -239.25617289591497, -275.874102165768, -253.59780986323054, -291.4607389807793, -275.5255597185415, -239.2872582168206, -234.19306405921574, -248.5067592677205, -258.5224527094946, -260.23400956471403, -243.14478966767163, -250.30808736178358, -271.3149471503853, -287.2841694842973, -269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27566305402618024, "mean_inference_ms": 2.354534436481114, "mean_action_processing_ms": 0.10522956681176358, "mean_env_wait_ms": 2.004243886139844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007490873336791992, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.10347914695739746}, "num_episodes": 18, "episode_return_max": -225.59598221084985, "episode_return_min": -310.7873374150901, "episode_return_mean": -261.09826638033434, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 183.90966950983486, "num_env_steps_trained_throughput_per_sec": 207.48783226750598, "timesteps_total": 14550, "num_env_steps_sampled_lifetime": 14550, "num_agent_steps_sampled_lifetime": 14550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 14550, "timers": {"training_iteration_time_ms": 10463.824, "restore_workers_time_ms": 0.015, "training_step_time_ms": 827.526, "sample_time_ms": 808.29, "synch_weights_time_ms": 17.204}, "counters": {"num_env_steps_sampled": 14550, "num_env_steps_trained": 14300, "num_agent_steps_sampled": 14550, "num_agent_steps_trained": 14300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 97, "num_samples_added_to_queue": 14300}, "done": false, "training_iteration": 7, "trial_id": "13390_00000", "date": "2024-10-13_00-39-39", "timestamp": 1728776379, "time_this_iter_s": 10.616944789886475, "time_total_s": 73.31707406044006, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b790>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.31707406044006, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 23.320000000000004, "ram_util_percent": 64.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -500858.1875, "policy_loss": -503989.46875, "entropy": 29.816442489624023, "entropy_coeff": 0.01, "var_gnorm": 15.999897956848145, "vf_loss": 329528.40625, "vf_explained_var": 0.001861870288848877}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 30.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 16650, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16650, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 111, "num_samples_added_to_queue": 16500, "learner_queue": {"size_count": 30, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.215, "learner_load_time_ms": 0.292, "learner_load_wait_time_ms": 2785.482, "learner_dequeue_time_ms": 17367.372}}, "env_runners": {"episode_reward_max": -225.59598221084985, "episode_reward_min": -310.7873374150901, "episode_reward_mean": -261.64832657101937, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -310.7873374150901}, "policy_reward_max": {"default_policy": -225.59598221084985}, "policy_reward_mean": {"default_policy": -261.64832657101937}, "custom_metrics": {"num_consolidated_mean": 0.6711, "num_consolidated_min": 0.52, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0485, "num_overloaded_min": 0.9, "num_overloaded_max": 1.18, "num_moves_mean": 9.9818, "num_moves_min": 9.58, "num_moves_max": 10.34, "mean_accuracy_mean": 41.11349, "mean_accuracy_min": 40.85933333333333, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 5.9979000000000005, "num_model_switches_min": 5.58, "num_model_switches_max": 6.41, "num_slav_mean": 0.16355350000000002, "num_slav_min": 0.14359999999999998, "num_slav_max": 0.19188333333333335, "cpu_conserved_cost_mean": 2.6690000000000005, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.58, "mean_cluster_cpu_util_mean": 0.5704131151551785, "mean_cluster_cpu_util_min": 0.550052687755364, "mean_cluster_cpu_util_max": 0.599650783548961, "mean_cluster_mem_util_mean": 0.36580686177667265, "mean_cluster_mem_util_min": 0.35726178151640403, "mean_cluster_mem_util_max": 0.3813832552957892, "reward_consolidation_mean_mean": -0.5419965990435286, "reward_consolidation_mean_min": -0.8338181181272656, "reward_consolidation_mean_max": -0.2809598221085017, "reward_illegal_mean_mean": -1.7474999999999996, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.9265000000000002, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.3750000000000009, "reward_sla_mean_mean": -1.2534866666666666, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": -54.19965990435286, "reward_consolidation_sum_min": -83.38181181272655, "reward_consolidation_sum_max": -28.095982210850167, "reward_illegal_sum_mean": -174.75, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 92.65000000000003, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 137.50000000000009, "reward_sla_sum_mean": -125.34866666666665, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3882.0, "global_timestep_min": 2200, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-269.97187242986377, -277.3863992202016, -252.39678637789757, -269.88743793597115, -266.4709707880225, -281.309619543696, -264.2748484571566, -258.84916994121045, -283.3959822108502, -251.68741965944753, -283.3850954948368, -284.6033080508086, -253.42215419293905, -246.44385451887032, -266.5280148649059, -261.2450759998779, -283.4431539187914, -310.7873374150901, -287.7649364890799, -252.6667732797219, -252.01611380182143, -254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2781511353671875, "mean_inference_ms": 2.375826328190917, "mean_action_processing_ms": 0.105882874243408, "mean_env_wait_ms": 2.0193714846000392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007230043411254883, "StateBufferConnector_ms": 0.003947019577026367, "ViewRequirementAgentConnector_ms": 0.10144639015197754}, "num_episodes": 21, "episode_return_max": -225.59598221084985, "episode_return_min": -310.7873374150901, "episode_return_mean": -261.64832657101937, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16650, "num_agent_steps_trained": 16500, "num_env_steps_sampled": 16650, "num_env_steps_trained": 16500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.8623177056943, "num_env_steps_trained_throughput_per_sec": 212.52242807263212, "timesteps_total": 16650, "num_env_steps_sampled_lifetime": 16650, "num_agent_steps_sampled_lifetime": 16650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 16650, "timers": {"training_iteration_time_ms": 10449.828, "restore_workers_time_ms": 0.017, "training_step_time_ms": 742.33, "sample_time_ms": 724.004, "synch_weights_time_ms": 16.701}, "counters": {"num_env_steps_sampled": 16650, "num_env_steps_trained": 16500, "num_agent_steps_sampled": 16650, "num_agent_steps_trained": 16500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 111, "num_samples_added_to_queue": 16500}, "done": false, "training_iteration": 8, "trial_id": "13390_00000", "date": "2024-10-13_00-39-50", "timestamp": 1728776390, "time_this_iter_s": 10.362386703491211, "time_total_s": 83.67946076393127, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0ba60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.67946076393127, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.613333333333333, "ram_util_percent": 64.26000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -498609.0625, "policy_loss": -501627.5625, "entropy": 29.81601905822754, "entropy_coeff": 0.01, "var_gnorm": 16.00043296813965, "vf_loss": 318250.46875, "vf_explained_var": 0.0024979710578918457}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 33.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 18750, "num_env_steps_trained": 18150, "num_agent_steps_sampled": 18750, "num_agent_steps_trained": 18150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 125, "num_samples_added_to_queue": 18700, "learner_queue": {"size_count": 33, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.406, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 2735.121, "learner_dequeue_time_ms": 18253.792}}, "env_runners": {"episode_reward_max": -225.59598221084985, "episode_reward_min": -299.6259374333665, "episode_reward_mean": -259.9419242742695, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.6259374333665}, "policy_reward_max": {"default_policy": -225.59598221084985}, "policy_reward_mean": {"default_policy": -259.9419242742695}, "custom_metrics": {"num_consolidated_mean": 0.6789000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0523, "num_overloaded_min": 0.9, "num_overloaded_max": 1.18, "num_moves_mean": 9.990000000000002, "num_moves_min": 9.58, "num_moves_max": 10.41, "mean_accuracy_mean": 41.118809999999996, "mean_accuracy_min": 40.872, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 5.998699999999999, "num_model_switches_min": 5.6, "num_model_switches_max": 6.41, "num_slav_mean": 0.1641058333333333, "num_slav_min": 0.14359999999999998, "num_slav_max": 0.19188333333333335, "cpu_conserved_cost_mean": 2.6872, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.58, "mean_cluster_cpu_util_mean": 0.5705473729548254, "mean_cluster_cpu_util_min": 0.550052687755364, "mean_cluster_cpu_util_max": 0.599650783548961, "mean_cluster_mem_util_mean": 0.3657818937128648, "mean_cluster_mem_util_min": 0.35726178151640403, "mean_cluster_mem_util_max": 0.3813832552957892, "reward_consolidation_mean_mean": -0.533489242742697, "reward_consolidation_mean_min": -0.8338181181272656, "reward_consolidation_mean_max": -0.2809598221085017, "reward_illegal_mean_mean": -1.753833333333333, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.9159166666666672, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.3750000000000009, "reward_sla_mean_mean": -1.2280133333333334, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": -53.348924274269706, "reward_consolidation_sum_min": -83.38181181272655, "reward_consolidation_sum_max": -28.095982210850167, "reward_illegal_sum_mean": -175.3833333333333, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 91.5916666666667, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 137.50000000000009, "reward_sla_sum_mean": -122.80133333333335, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4582.0, "global_timestep_min": 2900, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-254.60098084011085, -250.69266197569218, -239.0002589174204, -261.6694842974199, -262.56570105699205, -225.59598221084985, -259.70505650491936, -249.02983337902447, -261.1907155259068, -257.2521947059003, -258.26974626092783, -263.55162204148763, -253.51380486764734, -245.42867586585012, -279.21753937067825, -260.847040726187, -248.82633951689053, -231.06567364220643, -286.08286880502, -261.18718511072507, -283.00605562155386, -261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798295088859239, "mean_inference_ms": 2.389411273662323, "mean_action_processing_ms": 0.10631849027014867, "mean_env_wait_ms": 2.029907105205122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007054567337036133, "StateBufferConnector_ms": 0.0038976669311523438, "ViewRequirementAgentConnector_ms": 0.10027003288269043}, "num_episodes": 21, "episode_return_max": -225.59598221084985, "episode_return_min": -299.6259374333665, "episode_return_mean": -259.9419242742695, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18750, "num_agent_steps_trained": 18150, "num_env_steps_sampled": 18750, "num_env_steps_trained": 18150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 206.35497455294401, "num_env_steps_trained_throughput_per_sec": 162.13605143445602, "timesteps_total": 18750, "num_env_steps_sampled_lifetime": 18750, "num_agent_steps_sampled_lifetime": 18750, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 18750, "timers": {"training_iteration_time_ms": 10419.475, "restore_workers_time_ms": 0.016, "training_step_time_ms": 717.404, "sample_time_ms": 699.054, "synch_weights_time_ms": 16.73}, "counters": {"num_env_steps_sampled": 18750, "num_env_steps_trained": 18150, "num_agent_steps_sampled": 18750, "num_agent_steps_trained": 18150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 125, "num_samples_added_to_queue": 18700}, "done": false, "training_iteration": 9, "trial_id": "13390_00000", "date": "2024-10-13_00-40-00", "timestamp": 1728776400, "time_this_iter_s": 10.188586473464966, "time_total_s": 93.86804723739624, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c08f40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.86804723739624, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.49333333333333, "ram_util_percent": 64.18000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -527860.25, "policy_loss": -531365.875, "entropy": 29.815383911132812, "entropy_coeff": 0.01, "var_gnorm": 16.001300811767578, "vf_loss": 366963.09375, "vf_explained_var": 0.0024137496948242188}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 37.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 20850, "num_env_steps_trained": 20350, "num_agent_steps_sampled": 20850, "num_agent_steps_trained": 20350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 139, "num_samples_added_to_queue": 20350, "learner_queue": {"size_count": 37, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.247, "learner_load_time_ms": 0.265, "learner_load_wait_time_ms": 2639.733, "learner_dequeue_time_ms": 18253.792}}, "env_runners": {"episode_reward_max": -233.83490511438026, "episode_reward_min": -299.6259374333665, "episode_reward_mean": -261.14642788388306, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.6259374333665}, "policy_reward_max": {"default_policy": -233.83490511438026}, "policy_reward_mean": {"default_policy": -261.14642788388306}, "custom_metrics": {"num_consolidated_mean": 0.6724999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0448, "num_overloaded_min": 0.9, "num_overloaded_max": 1.18, "num_moves_mean": 10.0064, "num_moves_min": 9.58, "num_moves_max": 10.41, "mean_accuracy_mean": 41.116213333333334, "mean_accuracy_min": 40.88466666666666, "mean_accuracy_max": 41.328, "num_model_switches_mean": 6.0187, "num_model_switches_min": 5.61, "num_model_switches_max": 6.39, "num_slav_mean": 0.16355116666666666, "num_slav_min": 0.14298333333333335, "num_slav_max": 0.19188333333333335, "cpu_conserved_cost_mean": 2.6639999999999993, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.3, "mean_cluster_cpu_util_mean": 0.5697254403287118, "mean_cluster_cpu_util_min": 0.5466191691685076, "mean_cluster_cpu_util_max": 0.587701492792888, "mean_cluster_mem_util_mean": 0.36548187202380944, "mean_cluster_mem_util_min": 0.35548671926576536, "mean_cluster_mem_util_max": 0.37503640603920885, "reward_consolidation_mean_mean": -0.5465409455054984, "reward_consolidation_mean_min": -0.8338181181272656, "reward_consolidation_mean_max": -0.3064834445155198, "reward_illegal_mean_mean": -1.7413333333333332, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.9380833333333336, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.3750000000000009, "reward_sla_mean_mean": -1.2616733333333334, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": -54.65409455054983, "reward_consolidation_sum_min": -83.38181181272655, "reward_consolidation_sum_max": -30.64834445155198, "reward_illegal_sum_mean": -174.13333333333335, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 93.80833333333338, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 137.50000000000009, "reward_sla_sum_mean": -126.16733333333332, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5282.0, "global_timestep_min": 3600, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-261.8708489445306, -252.69780072496852, -254.66454658990517, -247.5036613969355, -269.8986109841907, -251.60025891742046, -271.2969691431357, -257.93179505924627, -279.07147643851454, -257.3160528800754, -244.0040604343719, -250.85189923543192, -244.8665082701269, -262.8469919887903, -238.66356574979415, -256.9387462304669, -245.193146303573, -246.6236132687561, -256.47878095586213, -248.6204818910108, -261.31989399616174, -261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2810162414992354, "mean_inference_ms": 2.3989484896216693, "mean_action_processing_ms": 0.10661082603666326, "mean_env_wait_ms": 2.0374348510854072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007076263427734375, "StateBufferConnector_ms": 0.0039098262786865234, "ViewRequirementAgentConnector_ms": 0.09955430030822754}, "num_episodes": 21, "episode_return_max": -233.83490511438026, "episode_return_min": -299.6259374333665, "episode_return_mean": -261.14642788388306, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20850, "num_agent_steps_trained": 20350, "num_env_steps_sampled": 20850, "num_env_steps_trained": 20350, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.24341666569367, "num_env_steps_trained_throughput_per_sec": 212.9216746021553, "timesteps_total": 20850, "num_env_steps_sampled_lifetime": 20850, "num_agent_steps_sampled_lifetime": 20850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 20850, "timers": {"training_iteration_time_ms": 10410.772, "restore_workers_time_ms": 0.015, "training_step_time_ms": 744.077, "sample_time_ms": 729.108, "synch_weights_time_ms": 13.488}, "counters": {"num_env_steps_sampled": 20850, "num_env_steps_trained": 20350, "num_agent_steps_sampled": 20850, "num_agent_steps_trained": 20350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 139, "num_samples_added_to_queue": 20350}, "done": false, "training_iteration": 10, "trial_id": "13390_00000", "date": "2024-10-13_00-40-10", "timestamp": 1728776410, "time_this_iter_s": 10.34418797492981, "time_total_s": 104.21223521232605, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2691e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.21223521232605, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.414285714285715, "ram_util_percent": 59.24285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -525823.75, "policy_loss": -529324.5, "entropy": 29.814790725708008, "entropy_coeff": 0.01, "var_gnorm": 16.001998901367188, "vf_loss": 366472.9375, "vf_explained_var": 0.0025841593742370605}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363636687}}, "num_env_steps_sampled": 22950, "num_env_steps_trained": 22550, "num_agent_steps_sampled": 22950, "num_agent_steps_trained": 22550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 153, "num_samples_added_to_queue": 22550, "learner_queue": {"size_count": 41, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.541, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 2610.591, "learner_dequeue_time_ms": 18849.473}}, "env_runners": {"episode_reward_max": -233.83490511438026, "episode_reward_min": -301.7239727070577, "episode_reward_mean": -264.0265177739193, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -301.7239727070577}, "policy_reward_max": {"default_policy": -233.83490511438026}, "policy_reward_mean": {"default_policy": -264.0265177739193}, "custom_metrics": {"num_consolidated_mean": 0.6736, "num_consolidated_min": 0.53, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0416999999999998, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 10.0103, "num_moves_min": 9.69, "num_moves_max": 10.41, "mean_accuracy_mean": 41.12400333333333, "mean_accuracy_min": 40.88466666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.025, "num_model_switches_min": 5.61, "num_model_switches_max": 6.41, "num_slav_mean": 0.16354766666666667, "num_slav_min": 0.14298333333333335, "num_slav_max": 0.19188333333333335, "cpu_conserved_cost_mean": 2.6794, "cpu_conserved_cost_min": 1.92, "cpu_conserved_cost_max": 3.32, "mean_cluster_cpu_util_mean": 0.5702246103361577, "mean_cluster_cpu_util_min": 0.5466191691685076, "mean_cluster_cpu_util_max": 0.587701492792888, "mean_cluster_mem_util_mean": 0.36574132267896614, "mean_cluster_mem_util_min": 0.35548671926576536, "mean_cluster_mem_util_max": 0.37518517914549787, "reward_consolidation_mean_mean": -0.5606685110725274, "reward_consolidation_mean_min": -0.8919141612598618, "reward_consolidation_mean_max": -0.3064834445155198, "reward_illegal_mean_mean": -1.7361666666666664, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.466666666666666, "reward_accuracy_mean_mean": 0.9604166666666668, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.5333333333333337, "reward_sla_mean_mean": -1.3038466666666664, "reward_sla_mean_min": -2.046, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": -56.06685110725275, "reward_consolidation_sum_min": -89.19141612598618, "reward_consolidation_sum_max": -30.64834445155198, "reward_illegal_sum_mean": -173.61666666666665, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -146.6666666666666, "reward_accuracy_sum_mean": 96.0416666666667, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 153.33333333333337, "reward_sla_sum_mean": -130.38466666666667, "reward_sla_sum_min": -204.6, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5982.0, "global_timestep_min": 4300, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-261.58696883852673, -262.22372292789896, -295.5484784793931, -245.03446038563456, -277.47624661122796, -262.84259648481515, -286.1357336501262, -266.9176794906942, -253.07945718724287, -253.91379877547277, -263.5967681013736, -248.06024856072358, -247.8510280544638, -267.9825855189008, -266.6518200371622, -299.6259374333665, -277.97802552621147, -262.1932620548905, -241.7024703768008, -261.71794754637654, -267.74346766578316, -249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28090923145435653, "mean_inference_ms": 2.3984154729073897, "mean_action_processing_ms": 0.10653867281381371, "mean_env_wait_ms": 2.037825091558419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070056915283203125, "StateBufferConnector_ms": 0.0039000511169433594, "ViewRequirementAgentConnector_ms": 0.09831357002258301}, "num_episodes": 21, "episode_return_max": -233.83490511438026, "episode_return_min": -301.7239727070577, "episode_return_mean": -264.0265177739193, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22950, "num_agent_steps_trained": 22550, "num_env_steps_sampled": 22950, "num_env_steps_trained": 22550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.9822974823976, "num_env_steps_trained_throughput_per_sec": 219.98145450536893, "timesteps_total": 22950, "num_env_steps_sampled_lifetime": 22950, "num_agent_steps_sampled_lifetime": 22950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 22950, "timers": {"training_iteration_time_ms": 10363.702, "restore_workers_time_ms": 0.014, "training_step_time_ms": 723.93, "sample_time_ms": 710.685, "synch_weights_time_ms": 11.853}, "counters": {"num_env_steps_sampled": 22950, "num_env_steps_trained": 22550, "num_agent_steps_sampled": 22950, "num_agent_steps_trained": 22550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 153, "num_samples_added_to_queue": 22550}, "done": false, "training_iteration": 11, "trial_id": "13390_00000", "date": "2024-10-13_00-40-20", "timestamp": 1728776420, "time_this_iter_s": 10.014057159423828, "time_total_s": 114.22629237174988, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0a230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.22629237174988, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 16.999999999999996, "ram_util_percent": 52.87999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -513198.6875, "policy_loss": -516447.0625, "entropy": 29.814023971557617, "entropy_coeff": 0.01, "var_gnorm": 16.002887725830078, "vf_loss": 341233.71875, "vf_explained_var": 0.0034897923469543457}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 45.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 25050, "num_env_steps_trained": 24750, "num_agent_steps_sampled": 25050, "num_agent_steps_trained": 24750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 167, "num_samples_added_to_queue": 24750, "learner_queue": {"size_count": 45, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.855, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 2540.574, "learner_dequeue_time_ms": 18849.473}}, "env_runners": {"episode_reward_max": -233.83490511438026, "episode_reward_min": -305.0548569862012, "episode_reward_mean": -264.3201148374911, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -305.0548569862012}, "policy_reward_max": {"default_policy": -233.83490511438026}, "policy_reward_mean": {"default_policy": -264.3201148374911}, "custom_metrics": {"num_consolidated_mean": 0.6761000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0433000000000001, "num_overloaded_min": 0.88, "num_overloaded_max": 1.18, "num_moves_mean": 9.993, "num_moves_min": 9.56, "num_moves_max": 10.41, "mean_accuracy_mean": 41.12254666666668, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.004099999999998, "num_model_switches_min": 5.41, "num_model_switches_max": 6.41, "num_slav_mean": 0.16340700000000002, "num_slav_min": 0.14298333333333335, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.7042, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5711494468557956, "mean_cluster_cpu_util_min": 0.5466191691685076, "mean_cluster_cpu_util_max": 0.5960804503754309, "mean_cluster_mem_util_mean": 0.36616323336096046, "mean_cluster_mem_util_min": 0.35548671926576536, "mean_cluster_mem_util_max": 0.37595640015499876, "reward_consolidation_mean_mean": -0.5598844817082458, "reward_consolidation_mean_min": -0.9475564287672487, "reward_consolidation_mean_max": -0.3064834445155198, "reward_illegal_mean_mean": -1.7388333333333332, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.466666666666666, "reward_accuracy_mean_mean": 0.9574166666666669, "reward_accuracy_mean_min": 0.5166666666666662, "reward_accuracy_mean_max": 1.5333333333333337, "reward_sla_mean_mean": -1.3019000000000003, "reward_sla_mean_min": -2.1106666666666665, "reward_sla_mean_max": -0.6806666666666666, "reward_consolidation_sum_mean": -55.98844817082458, "reward_consolidation_sum_min": -94.75564287672486, "reward_consolidation_sum_max": -30.64834445155198, "reward_illegal_sum_mean": -173.88333333333333, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -146.6666666666666, "reward_accuracy_sum_mean": 95.7416666666667, "reward_accuracy_sum_min": 51.66666666666662, "reward_accuracy_sum_max": 153.33333333333337, "reward_sla_sum_mean": -130.18999999999997, "reward_sla_sum_min": -211.06666666666666, "reward_sla_sum_max": -68.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5505.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-249.77948155594126, -258.4629077949372, -258.5325474428096, -297.0769167504341, -272.51926954826524, -236.27475402845022, -253.56698041365863, -295.33339730116666, -275.42328429132766, -243.62729903439015, -274.3977428493098, -244.32464284626374, -263.04800633586154, -250.86856437905482, -244.7696244174356, -266.46907916780884, -262.5483444515518, -276.461049681684, -241.188571080447, -258.68441012519395, -268.30892198970395, -297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28016174647549463, "mean_inference_ms": 2.388555610142765, "mean_action_processing_ms": 0.10622394634466964, "mean_env_wait_ms": 2.0328876484032277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067713260650634766, "StateBufferConnector_ms": 0.003789663314819336, "ViewRequirementAgentConnector_ms": 0.09588861465454102}, "num_episodes": 21, "episode_return_max": -233.83490511438026, "episode_return_min": -305.0548569862012, "episode_return_mean": -264.3201148374911, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25050, "num_agent_steps_trained": 24750, "num_env_steps_sampled": 25050, "num_env_steps_trained": 24750, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.07805179694034, "num_env_steps_trained_throughput_per_sec": 217.9865304539375, "timesteps_total": 25050, "num_env_steps_sampled_lifetime": 25050, "num_agent_steps_sampled_lifetime": 25050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 25050, "timers": {"training_iteration_time_ms": 10354.288, "restore_workers_time_ms": 0.015, "training_step_time_ms": 702.236, "sample_time_ms": 685.923, "synch_weights_time_ms": 14.765}, "counters": {"num_env_steps_sampled": 25050, "num_env_steps_trained": 24750, "num_agent_steps_sampled": 25050, "num_agent_steps_trained": 24750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 167, "num_samples_added_to_queue": 24750}, "done": false, "training_iteration": 12, "trial_id": "13390_00000", "date": "2024-10-13_00-40-31", "timestamp": 1728776431, "time_this_iter_s": 10.102100372314453, "time_total_s": 124.32839274406433, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0a740>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.32839274406433, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.42857142857143, "ram_util_percent": 52.564285714285724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -504847.03125, "policy_loss": -507970.875, "entropy": 29.813081741333008, "entropy_coeff": 0.01, "var_gnorm": 16.004108428955078, "vf_loss": 328779.90625, "vf_explained_var": 0.004262685775756836}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 27150, "num_env_steps_trained": 26950, "num_agent_steps_sampled": 27150, "num_agent_steps_trained": 26950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 181, "num_samples_added_to_queue": 26950, "learner_queue": {"size_count": 49, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.706, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2622.713, "learner_dequeue_time_ms": 19184.932}}, "env_runners": {"episode_reward_max": -217.64776569496473, "episode_reward_min": -311.0821773432027, "episode_reward_mean": -264.6262213287032, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -311.0821773432027}, "policy_reward_max": {"default_policy": -217.64776569496473}, "policy_reward_mean": {"default_policy": -264.6262213287032}, "custom_metrics": {"num_consolidated_mean": 0.6764999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0351, "num_overloaded_min": 0.87, "num_overloaded_max": 1.16, "num_moves_mean": 9.990499999999999, "num_moves_min": 9.56, "num_moves_max": 10.41, "mean_accuracy_mean": 41.11925333333335, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.015399999999999, "num_model_switches_min": 5.41, "num_model_switches_max": 6.41, "num_slav_mean": 0.1635705, "num_slav_min": 0.13571666666666668, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6967999999999996, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5702684867835875, "mean_cluster_cpu_util_min": 0.5466191691685076, "mean_cluster_cpu_util_max": 0.5960804503754309, "mean_cluster_mem_util_mean": 0.36591471068163556, "mean_cluster_mem_util_min": 0.35548671926576536, "mean_cluster_mem_util_max": 0.37595640015499876, "reward_consolidation_mean_mean": -0.5736122132870328, "reward_consolidation_mean_min": -0.9475564287672487, "reward_consolidation_mean_max": -0.2991726826890859, "reward_illegal_mean_mean": -1.7251666666666665, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9835833333333336, "reward_accuracy_mean_min": 0.5500000000000004, "reward_accuracy_mean_max": 1.533333333333334, "reward_sla_mean_mean": -1.3310666666666666, "reward_sla_mean_min": -2.202, "reward_sla_mean_max": -0.782, "reward_consolidation_sum_mean": -57.36122132870328, "reward_consolidation_sum_min": -94.75564287672486, "reward_consolidation_sum_max": -29.917268268908593, "reward_illegal_sum_mean": -172.51666666666665, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 98.35833333333338, "reward_accuracy_sum_min": 55.00000000000004, "reward_accuracy_sum_max": 153.3333333333334, "reward_sla_sum_mean": -133.10666666666668, "reward_sla_sum_min": -220.2, "reward_sla_sum_max": -78.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4567.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-297.59170855036695, -264.8447043772274, -240.782210850163, -269.42817326144575, -270.2816930153216, -259.7177921959241, -277.54143287946613, -241.08507417222566, -261.0984647720003, -240.95398275914576, -250.58760242468523, -271.9004477748332, -245.61841664382084, -252.2240519053275, -255.96746169545207, -280.48158031009154, -241.11733832891636, -263.6886289561056, -252.95063510920227, -263.3967833318099, -284.4588534527398, -290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27942941859289844, "mean_inference_ms": 2.381483807580394, "mean_action_processing_ms": 0.10592751024941091, "mean_env_wait_ms": 2.028461989265934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067670345306396484, "StateBufferConnector_ms": 0.0037322044372558594, "ViewRequirementAgentConnector_ms": 0.09457015991210938}, "num_episodes": 21, "episode_return_max": -217.64776569496473, "episode_return_min": -311.0821773432027, "episode_return_mean": -264.6262213287032, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27150, "num_agent_steps_trained": 26950, "num_env_steps_sampled": 27150, "num_env_steps_trained": 26950, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.75410076531162, "num_env_steps_trained_throughput_per_sec": 214.50429603985026, "timesteps_total": 27150, "num_env_steps_sampled_lifetime": 27150, "num_agent_steps_sampled_lifetime": 27150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 27150, "timers": {"training_iteration_time_ms": 10332.109, "restore_workers_time_ms": 0.015, "training_step_time_ms": 729.3, "sample_time_ms": 712.25, "synch_weights_time_ms": 15.48}, "counters": {"num_env_steps_sampled": 27150, "num_env_steps_trained": 26950, "num_agent_steps_sampled": 27150, "num_agent_steps_trained": 26950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 181, "num_samples_added_to_queue": 26950}, "done": false, "training_iteration": 13, "trial_id": "13390_00000", "date": "2024-10-13_00-40-41", "timestamp": 1728776441, "time_this_iter_s": 10.267921924591064, "time_total_s": 134.5963146686554, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069f5b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 134.5963146686554, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.933333333333334, "ram_util_percent": 52.65333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -499152.1875, "policy_loss": -502260.28125, "entropy": 29.81217384338379, "entropy_coeff": 0.01, "var_gnorm": 16.005125045776367, "vf_loss": 327206.125, "vf_explained_var": 0.004344284534454346}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 52.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 29250, "num_env_steps_trained": 28600, "num_agent_steps_sampled": 29250, "num_agent_steps_trained": 28600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 195, "num_samples_added_to_queue": 29150, "learner_queue": {"size_count": 52, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.822, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2613.782, "learner_dequeue_time_ms": 19184.932}}, "env_runners": {"episode_reward_max": -217.64776569496473, "episode_reward_min": -311.0821773432027, "episode_reward_mean": -264.21557674616946, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -311.0821773432027}, "policy_reward_max": {"default_policy": -217.64776569496473}, "policy_reward_mean": {"default_policy": -264.21557674616946}, "custom_metrics": {"num_consolidated_mean": 0.6690999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0361, "num_overloaded_min": 0.87, "num_overloaded_max": 1.16, "num_moves_mean": 9.999699999999999, "num_moves_min": 9.56, "num_moves_max": 10.33, "mean_accuracy_mean": 41.11045, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.0136, "num_model_switches_min": 5.41, "num_model_switches_max": 6.41, "num_slav_mean": 0.16271516666666666, "num_slav_min": 0.13571666666666668, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6746000000000003, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5698646995555452, "mean_cluster_cpu_util_min": 0.5466191691685076, "mean_cluster_cpu_util_max": 0.5960804503754309, "mean_cluster_mem_util_mean": 0.36577152121365414, "mean_cluster_mem_util_min": 0.35548671926576536, "mean_cluster_mem_util_max": 0.37595640015499876, "reward_consolidation_mean_mean": -0.5697291007950289, "reward_consolidation_mean_min": -0.9475564287672487, "reward_consolidation_mean_max": -0.26525236833287646, "reward_illegal_mean_mean": -1.726833333333333, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9803333333333337, "reward_accuracy_mean_min": 0.46666666666666673, "reward_accuracy_mean_max": 1.533333333333334, "reward_sla_mean_mean": -1.3259266666666667, "reward_sla_mean_min": -2.202, "reward_sla_mean_max": -0.6206666666666666, "reward_consolidation_sum_mean": -56.972910079502896, "reward_consolidation_sum_min": -94.75564287672486, "reward_consolidation_sum_max": -26.525236833287646, "reward_illegal_sum_mean": -172.68333333333328, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 98.03333333333337, "reward_accuracy_sum_min": 46.66666666666667, "reward_accuracy_sum_max": 153.3333333333334, "reward_sla_sum_mean": -132.59266666666667, "reward_sla_sum_min": -220.2, "reward_sla_sum_max": -62.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3629.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-290.63835937737963, -251.12545310548586, -262.77072405495124, -288.71563252002795, -258.9710195254194, -253.09749307015133, -274.60364921258633, -262.28216211276606, -242.3813061622345, -267.7007828444363, -233.83490511438026, -278.47775442444157, -278.65517073319324, -255.05481129489166, -239.74170702732332, -269.0866124463126, -255.20088641140444, -279.67468396844237, -278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2788754301919571, "mean_inference_ms": 2.3758739048333184, "mean_action_processing_ms": 0.10569940693424758, "mean_env_wait_ms": 2.0251429601014483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067288875579833984, "StateBufferConnector_ms": 0.003669261932373047, "ViewRequirementAgentConnector_ms": 0.09374690055847168}, "num_episodes": 21, "episode_return_max": -217.64776569496473, "episode_return_min": -311.0821773432027, "episode_return_mean": -264.21557674616946, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29250, "num_agent_steps_trained": 28600, "num_env_steps_sampled": 29250, "num_env_steps_trained": 28600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 205.63565783337583, "num_env_steps_trained_throughput_per_sec": 161.57087401193817, "timesteps_total": 29250, "num_env_steps_sampled_lifetime": 29250, "num_agent_steps_sampled_lifetime": 29250, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 29250, "timers": {"training_iteration_time_ms": 10306.526, "restore_workers_time_ms": 0.013, "training_step_time_ms": 728.102, "sample_time_ms": 711.708, "synch_weights_time_ms": 14.952}, "counters": {"num_env_steps_sampled": 29250, "num_env_steps_trained": 28600, "num_agent_steps_sampled": 29250, "num_agent_steps_trained": 28600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 195, "num_samples_added_to_queue": 29150}, "done": false, "training_iteration": 14, "trial_id": "13390_00000", "date": "2024-10-13_00-40-51", "timestamp": 1728776451, "time_this_iter_s": 10.22323226928711, "time_total_s": 144.8195469379425, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b3a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 144.8195469379425, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.459999999999997, "ram_util_percent": 52.87333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -525235.9375, "policy_loss": -528667.5625, "entropy": 29.811782836914062, "entropy_coeff": 0.01, "var_gnorm": 16.005809783935547, "vf_loss": 359553.25, "vf_explained_var": 0.004539310932159424}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272734}}, "num_env_steps_sampled": 30900, "num_env_steps_trained": 30250, "num_agent_steps_sampled": 30900, "num_agent_steps_trained": 30250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 206, "num_samples_added_to_queue": 30800, "learner_queue": {"size_count": 55, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.281, "learner_load_time_ms": 0.329, "learner_load_wait_time_ms": 2841.915, "learner_dequeue_time_ms": 19184.932}}, "env_runners": {"episode_reward_max": -217.64776569496473, "episode_reward_min": -311.0821773432027, "episode_reward_mean": -264.1528781869687, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -311.0821773432027}, "policy_reward_max": {"default_policy": -217.64776569496473}, "policy_reward_mean": {"default_policy": -264.1528781869687}, "custom_metrics": {"num_consolidated_mean": 0.6713000000000002, "num_consolidated_min": 0.52, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0418, "num_overloaded_min": 0.87, "num_overloaded_max": 1.16, "num_moves_mean": 9.9913, "num_moves_min": 9.56, "num_moves_max": 10.33, "mean_accuracy_mean": 41.11754333333333, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.009699999999999, "num_model_switches_min": 5.41, "num_model_switches_max": 6.41, "num_slav_mean": 0.16263149999999998, "num_slav_min": 0.13571666666666668, "num_slav_max": 0.19096666666666667, "cpu_conserved_cost_mean": 2.6936, "cpu_conserved_cost_min": 2.02, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5706230628211549, "mean_cluster_cpu_util_min": 0.550402776364712, "mean_cluster_cpu_util_max": 0.5960804503754309, "mean_cluster_mem_util_mean": 0.36603798049778985, "mean_cluster_mem_util_min": 0.3557797285369844, "mean_cluster_mem_util_max": 0.37595640015499876, "reward_consolidation_mean_mean": -0.5595087818696886, "reward_consolidation_mean_min": -0.9475564287672487, "reward_consolidation_mean_max": -0.26525236833287646, "reward_illegal_mean_mean": -1.736333333333333, "reward_illegal_mean_min": -1.9333333333333331, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9693333333333338, "reward_accuracy_mean_min": 0.46666666666666673, "reward_accuracy_mean_max": 1.533333333333334, "reward_sla_mean_mean": -1.3150199999999999, "reward_sla_mean_min": -2.202, "reward_sla_mean_max": -0.6206666666666666, "reward_consolidation_sum_mean": -55.95087818696886, "reward_consolidation_sum_min": -94.75564287672486, "reward_consolidation_sum_max": -26.525236833287646, "reward_illegal_sum_mean": -173.63333333333333, "reward_illegal_sum_min": -193.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 96.93333333333338, "reward_accuracy_sum_min": 46.66666666666667, "reward_accuracy_sum_max": 153.3333333333334, "reward_sla_sum_mean": -131.502, "reward_sla_sum_min": -220.2, "reward_sla_sum_max": -62.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2832.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-278.329818148588, -257.3300191903499, -282.06790337811077, -250.4045965457369, -240.49983246519824, -280.8114441499892, -275.4249565932558, -279.6068506503394, -259.84606597825086, -293.0800511742667, -251.93236467757154, -258.0835328520515, -246.69469371592157, -260.45817112918417, -270.2887721222089, -271.39141612598604, -301.7239727070577, -275.93096652350033, -279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2791353922713307, "mean_inference_ms": 2.3792430315685955, "mean_action_processing_ms": 0.1056999610629681, "mean_env_wait_ms": 2.026298080606133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007234334945678711, "StateBufferConnector_ms": 0.0038940906524658203, "ViewRequirementAgentConnector_ms": 0.1007390022277832}, "num_episodes": 18, "episode_return_max": -217.64776569496473, "episode_return_min": -311.0821773432027, "episode_return_mean": -264.1528781869687, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30900, "num_agent_steps_trained": 30250, "num_env_steps_sampled": 30900, "num_env_steps_trained": 30250, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 161.95508285423642, "num_env_steps_trained_throughput_per_sec": 161.95508285423642, "timesteps_total": 30900, "num_env_steps_sampled_lifetime": 30900, "num_agent_steps_sampled_lifetime": 30900, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 30900, "timers": {"training_iteration_time_ms": 10271.307, "restore_workers_time_ms": 0.019, "training_step_time_ms": 935.177, "sample_time_ms": 914.631, "synch_weights_time_ms": 18.628}, "counters": {"num_env_steps_sampled": 30900, "num_env_steps_trained": 30250, "num_agent_steps_sampled": 30900, "num_agent_steps_trained": 30250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 206, "num_samples_added_to_queue": 30800}, "done": false, "training_iteration": 15, "trial_id": "13390_00000", "date": "2024-10-13_00-41-01", "timestamp": 1728776461, "time_this_iter_s": 10.199404001235962, "time_total_s": 155.01895093917847, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c08460>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.01895093917847, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 31.871428571428574, "ram_util_percent": 55.271428571428565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -493042.84375, "policy_loss": -495998.90625, "entropy": 29.811172485351562, "entropy_coeff": 0.01, "var_gnorm": 16.006834030151367, "vf_loss": 312004.0625, "vf_explained_var": 0.005621373653411865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363636687}}, "num_env_steps_sampled": 32850, "num_env_steps_trained": 32450, "num_agent_steps_sampled": 32850, "num_agent_steps_trained": 32450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 219, "num_samples_added_to_queue": 32450, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.713, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 2899.984, "learner_dequeue_time_ms": 19740.794}}, "env_runners": {"episode_reward_max": -217.64776569496473, "episode_reward_min": -311.0821773432027, "episode_reward_mean": -261.7835835389441, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -311.0821773432027}, "policy_reward_max": {"default_policy": -217.64776569496473}, "policy_reward_mean": {"default_policy": -261.7835835389441}, "custom_metrics": {"num_consolidated_mean": 0.6686, "num_consolidated_min": 0.52, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0468000000000002, "num_overloaded_min": 0.87, "num_overloaded_max": 1.18, "num_moves_mean": 9.986699999999999, "num_moves_min": 9.56, "num_moves_max": 10.33, "mean_accuracy_mean": 41.10975333333334, "mean_accuracy_min": 40.82766666666666, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 6.0093000000000005, "num_model_switches_min": 5.41, "num_model_switches_max": 6.34, "num_slav_mean": 0.161693, "num_slav_min": 0.13571666666666668, "num_slav_max": 0.17799999999999996, "cpu_conserved_cost_mean": 2.6778000000000004, "cpu_conserved_cost_min": 2.02, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5703708850599368, "mean_cluster_cpu_util_min": 0.550402776364712, "mean_cluster_cpu_util_max": 0.5960804503754309, "mean_cluster_mem_util_mean": 0.3658312781598927, "mean_cluster_mem_util_min": 0.3557797285369844, "mean_cluster_mem_util_max": 0.37595640015499876, "reward_consolidation_mean_mean": -0.5450591687227757, "reward_consolidation_mean_min": -0.9475564287672487, "reward_consolidation_mean_max": -0.26525236833287646, "reward_illegal_mean_mean": -1.7446666666666664, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9455833333333338, "reward_accuracy_mean_min": 0.46666666666666673, "reward_accuracy_mean_max": 1.533333333333334, "reward_sla_mean_mean": -1.2736933333333333, "reward_sla_mean_min": -2.202, "reward_sla_mean_max": -0.6206666666666666, "reward_consolidation_sum_mean": -54.50591687227756, "reward_consolidation_sum_min": -94.75564287672486, "reward_consolidation_sum_max": -26.525236833287646, "reward_illegal_sum_mean": -174.46666666666664, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 94.55833333333338, "reward_accuracy_sum_min": 46.66666666666667, "reward_accuracy_sum_max": 153.3333333333334, "reward_sla_sum_mean": -127.36933333333333, "reward_sla_sum_min": -220.2, "reward_sla_sum_max": -62.06666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2029.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-279.487699899479, -251.95969417283473, -258.81715860976556, -254.53399433427734, -255.02277864083575, -305.0548569862012, -262.49646958481827, -266.06705351975376, -260.8977002040875, -284.83582198665823, -281.15445490267746, -278.9268238447713, -303.08724298638384, -275.45564287672477, -250.45507630448685, -253.01671083493247, -236.48923512747857, -266.5854549331382, -266.5200919918361, -258.2448627737669, -264.6884096378201, -264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27989720479853886, "mean_inference_ms": 2.3856088604622574, "mean_action_processing_ms": 0.10583789573348644, "mean_env_wait_ms": 2.029867907635377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007626056671142578, "StateBufferConnector_ms": 0.003887653350830078, "ViewRequirementAgentConnector_ms": 0.10153532028198242}, "num_episodes": 18, "episode_return_max": -217.64776569496473, "episode_return_min": -311.0821773432027, "episode_return_mean": -261.7835835389441, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32850, "num_agent_steps_trained": 32450, "num_env_steps_sampled": 32850, "num_env_steps_trained": 32450, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 189.88950394123978, "num_env_steps_trained_throughput_per_sec": 214.2343121388346, "timesteps_total": 32850, "num_env_steps_sampled_lifetime": 32850, "num_agent_steps_sampled_lifetime": 32850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 32850, "timers": {"training_iteration_time_ms": 10248.284, "restore_workers_time_ms": 0.013, "training_step_time_ms": 787.756, "sample_time_ms": 772.766, "synch_weights_time_ms": 13.514}, "counters": {"num_env_steps_sampled": 32850, "num_env_steps_trained": 32450, "num_agent_steps_sampled": 32850, "num_agent_steps_trained": 32450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 219, "num_samples_added_to_queue": 32450}, "done": false, "training_iteration": 16, "trial_id": "13390_00000", "date": "2024-10-13_00-41-12", "timestamp": 1728776472, "time_this_iter_s": 10.280284643173218, "time_total_s": 165.29923558235168, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2951e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.29923558235168, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.926666666666666, "ram_util_percent": 54.67333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -480104.53125, "policy_loss": -483039.875, "entropy": 29.810514450073242, "entropy_coeff": 0.01, "var_gnorm": 16.007644653320312, "vf_loss": 309932.0625, "vf_explained_var": 0.005142927169799805}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 34800, "num_env_steps_trained": 34650, "num_agent_steps_sampled": 34800, "num_agent_steps_trained": 34650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 232, "num_samples_added_to_queue": 34650, "learner_queue": {"size_count": 63, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 101.097, "learner_load_time_ms": 0.35, "learner_load_wait_time_ms": 2950.735, "learner_dequeue_time_ms": 19740.794}}, "env_runners": {"episode_reward_max": -217.64776569496473, "episode_reward_min": -311.0821773432027, "episode_reward_mean": -259.5674843888024, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -311.0821773432027}, "policy_reward_max": {"default_policy": -217.64776569496473}, "policy_reward_mean": {"default_policy": -259.5674843888024}, "custom_metrics": {"num_consolidated_mean": 0.6659999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0532, "num_overloaded_min": 0.87, "num_overloaded_max": 1.21, "num_moves_mean": 10.0074, "num_moves_min": 9.69, "num_moves_max": 10.33, "mean_accuracy_mean": 41.09575666666667, "mean_accuracy_min": 40.87833333333333, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 6.028600000000001, "num_model_switches_min": 5.64, "num_model_switches_max": 6.34, "num_slav_mean": 0.16078283333333332, "num_slav_min": 0.13571666666666668, "num_slav_max": 0.1816833333333333, "cpu_conserved_cost_mean": 2.6636, "cpu_conserved_cost_min": 2.02, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5697410461282136, "mean_cluster_cpu_util_min": 0.550402776364712, "mean_cluster_cpu_util_max": 0.5901091746145665, "mean_cluster_mem_util_mean": 0.36567670970930566, "mean_cluster_mem_util_min": 0.3557797285369844, "mean_cluster_mem_util_max": 0.3754662197896036, "reward_consolidation_mean_mean": -0.5297081772213593, "reward_consolidation_mean_min": -0.8754884400986934, "reward_consolidation_mean_max": -0.26525236833287646, "reward_illegal_mean_mean": -1.755333333333333, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9133333333333339, "reward_accuracy_mean_min": 0.4249999999999997, "reward_accuracy_mean_max": 1.533333333333334, "reward_sla_mean_mean": -1.2239666666666666, "reward_sla_mean_min": -2.202, "reward_sla_mean_max": -0.5573333333333333, "reward_consolidation_sum_mean": -52.97081772213592, "reward_consolidation_sum_min": -87.54884400986934, "reward_consolidation_sum_max": -26.525236833287646, "reward_illegal_sum_mean": -175.53333333333333, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 91.33333333333337, "reward_accuracy_sum_min": 42.49999999999997, "reward_accuracy_sum_max": 153.3333333333334, "reward_sla_sum_mean": -122.39666666666668, "reward_sla_sum_min": -220.2, "reward_sla_sum_max": -55.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2183.0, "global_timestep_min": 500, "global_timestep_max": 3800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-264.9128758110206, -250.41803588290833, -248.22796612750898, -281.356669408145, -279.8588382223033, -291.10125803405515, -270.5324987054128, -255.37010265314183, -261.1106673977272, -311.0821773432027, -217.64776569496473, -289.11793840811487, -252.19519936641345, -257.31726826890844, -242.67931097505246, -258.67628925645005, -240.7893356483594, -272.51181577264, -267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2810672130078157, "mean_inference_ms": 2.397404387447639, "mean_action_processing_ms": 0.10615253281098433, "mean_env_wait_ms": 2.0371163759409434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007893562316894531, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.10394072532653809}, "num_episodes": 21, "episode_return_max": -217.64776569496473, "episode_return_min": -311.0821773432027, "episode_return_mean": -259.5674843888024, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34800, "num_agent_steps_trained": 34650, "num_env_steps_sampled": 34800, "num_env_steps_trained": 34650, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 179.90758537187642, "num_env_steps_trained_throughput_per_sec": 202.97266041955288, "timesteps_total": 34800, "num_env_steps_sampled_lifetime": 34800, "num_agent_steps_sampled_lifetime": 34800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 34800, "timers": {"training_iteration_time_ms": 10271.871, "restore_workers_time_ms": 0.014, "training_step_time_ms": 766.538, "sample_time_ms": 750.252, "synch_weights_time_ms": 14.724}, "counters": {"num_env_steps_sampled": 34800, "num_env_steps_trained": 34650, "num_agent_steps_sampled": 34800, "num_agent_steps_trained": 34650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 232, "num_samples_added_to_queue": 34650}, "done": false, "training_iteration": 17, "trial_id": "13390_00000", "date": "2024-10-13_00-41-23", "timestamp": 1728776483, "time_this_iter_s": 10.85195803642273, "time_total_s": 176.1511936187744, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.1511936187744, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.09333333333333, "ram_util_percent": 53.613333333333344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -485741.3125, "policy_loss": -488689.9375, "entropy": 29.809608459472656, "entropy_coeff": 0.01, "var_gnorm": 16.008522033691406, "vf_loss": 311255.53125, "vf_explained_var": 0.006133019924163818}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 66.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 36750, "num_env_steps_trained": 36300, "num_agent_steps_sampled": 36750, "num_agent_steps_trained": 36300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 245, "num_samples_added_to_queue": 36300, "learner_queue": {"size_count": 66, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.132, "learner_load_time_ms": 0.364, "learner_load_wait_time_ms": 2807.602, "learner_dequeue_time_ms": 20244.172}}, "env_runners": {"episode_reward_max": -222.38942703097862, "episode_reward_min": -308.3608882390568, "episode_reward_mean": -258.6083369277162, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -308.3608882390568}, "policy_reward_max": {"default_policy": -222.38942703097862}, "policy_reward_mean": {"default_policy": -258.6083369277162}, "custom_metrics": {"num_consolidated_mean": 0.6632000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0522, "num_overloaded_min": 0.89, "num_overloaded_max": 1.21, "num_moves_mean": 10.0034, "num_moves_min": 9.69, "num_moves_max": 10.33, "mean_accuracy_mean": 41.08879000000001, "mean_accuracy_min": 40.88466666666666, "mean_accuracy_max": 41.26466666666666, "num_model_switches_mean": 6.0269, "num_model_switches_min": 5.64, "num_model_switches_max": 6.43, "num_slav_mean": 0.16001966666666667, "num_slav_min": 0.13713333333333336, "num_slav_max": 0.1816833333333333, "cpu_conserved_cost_mean": 2.6536, "cpu_conserved_cost_min": 2.12, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5698218447940215, "mean_cluster_cpu_util_min": 0.5462514022336283, "mean_cluster_cpu_util_max": 0.5901091746145665, "mean_cluster_mem_util_mean": 0.36565190138924775, "mean_cluster_mem_util_min": 0.3557797285369844, "mean_cluster_mem_util_max": 0.3754662197896036, "reward_consolidation_mean_mean": -0.5298800359438302, "reward_consolidation_mean_min": -0.8223488379176948, "reward_consolidation_mean_max": -0.26525236833287646, "reward_illegal_mean_mean": -1.7536666666666667, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.9060833333333336, "reward_accuracy_mean_min": 0.4249999999999997, "reward_accuracy_mean_max": 1.4750000000000014, "reward_sla_mean_mean": -1.20862, "reward_sla_mean_min": -1.8646666666666665, "reward_sla_mean_max": -0.5573333333333333, "reward_consolidation_sum_mean": -52.988003594383024, "reward_consolidation_sum_min": -82.23488379176948, "reward_consolidation_sum_max": -26.525236833287646, "reward_illegal_sum_mean": -175.36666666666667, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 90.60833333333333, "reward_accuracy_sum_min": 42.49999999999997, "reward_accuracy_sum_max": 147.50000000000014, "reward_sla_sum_mean": -120.86200000000001, "reward_sla_sum_min": -186.46666666666664, "reward_sla_sum_max": -55.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2778.0, "global_timestep_min": 900, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-267.1271741448108, -248.59278381918406, -273.3360382588562, -253.22731121873932, -230.25857016662076, -266.4543635200582, -278.3798562246794, -243.35097627097988, -269.0707788845228, -276.53189558012707, -253.69156233817645, -243.33413140820613, -255.6928721557159, -275.6952054585884, -246.96678546407125, -248.8000791982697, -272.8682171251026, -261.7373846294432, -273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822485736526758, "mean_inference_ms": 2.4076014898780405, "mean_action_processing_ms": 0.10649160733838951, "mean_env_wait_ms": 2.044276603813207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007905721664428711, "StateBufferConnector_ms": 0.00401616096496582, "ViewRequirementAgentConnector_ms": 0.10461544990539551}, "num_episodes": 18, "episode_return_max": -222.38942703097862, "episode_return_min": -308.3608882390568, "episode_return_mean": -258.6083369277162, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36750, "num_agent_steps_trained": 36300, "num_env_steps_sampled": 36750, "num_env_steps_trained": 36300, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 192.78872558452827, "num_env_steps_trained_throughput_per_sec": 163.128921648447, "timesteps_total": 36750, "num_env_steps_sampled_lifetime": 36750, "num_agent_steps_sampled_lifetime": 36750, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 36750, "timers": {"training_iteration_time_ms": 10248.156, "restore_workers_time_ms": 0.017, "training_step_time_ms": 787.145, "sample_time_ms": 771.1, "synch_weights_time_ms": 14.537}, "counters": {"num_env_steps_sampled": 36750, "num_env_steps_trained": 36300, "num_agent_steps_sampled": 36750, "num_agent_steps_trained": 36300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 245, "num_samples_added_to_queue": 36300}, "done": false, "training_iteration": 18, "trial_id": "13390_00000", "date": "2024-10-13_00-41-33", "timestamp": 1728776493, "time_this_iter_s": 10.131324052810669, "time_total_s": 186.28251767158508, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c12a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.28251767158508, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.880000000000003, "ram_util_percent": 52.58666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -488917.5, "policy_loss": -491849.125, "entropy": 29.80857276916504, "entropy_coeff": 0.01, "var_gnorm": 16.009552001953125, "vf_loss": 309557.1875, "vf_explained_var": 0.007005810737609863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 69.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 38550, "num_env_steps_trained": 37950, "num_agent_steps_sampled": 38550, "num_agent_steps_trained": 37950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 257, "num_samples_added_to_queue": 38500, "learner_queue": {"size_count": 69, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 91.431, "learner_load_time_ms": 0.364, "learner_load_wait_time_ms": 2935.226, "learner_dequeue_time_ms": 20244.172}}, "env_runners": {"episode_reward_max": -222.38942703097862, "episode_reward_min": -308.3608882390568, "episode_reward_mean": -258.0214857900026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -308.3608882390568}, "policy_reward_max": {"default_policy": -222.38942703097862}, "policy_reward_mean": {"default_policy": -258.0214857900026}, "custom_metrics": {"num_consolidated_mean": 0.6616999999999998, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0551000000000001, "num_overloaded_min": 0.89, "num_overloaded_max": 1.21, "num_moves_mean": 9.9947, "num_moves_min": 9.69, "num_moves_max": 10.27, "mean_accuracy_mean": 41.09791, "mean_accuracy_min": 40.88466666666666, "mean_accuracy_max": 41.397666666666666, "num_model_switches_mean": 6.0302, "num_model_switches_min": 5.54, "num_model_switches_max": 6.43, "num_slav_mean": 0.159953, "num_slav_min": 0.13713333333333336, "num_slav_max": 0.1816833333333333, "cpu_conserved_cost_mean": 2.6624, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5704602324698468, "mean_cluster_cpu_util_min": 0.5462514022336283, "mean_cluster_cpu_util_max": 0.5901091746145665, "mean_cluster_mem_util_mean": 0.36578267345503607, "mean_cluster_mem_util_min": 0.35644849647664983, "mean_cluster_mem_util_max": 0.3754662197896036, "reward_consolidation_mean_mean": -0.5272181912333608, "reward_consolidation_mean_min": -0.8067898808979865, "reward_consolidation_mean_max": -0.3021167260653691, "reward_illegal_mean_mean": -1.7584999999999997, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.895416666666667, "reward_accuracy_mean_min": 0.4249999999999997, "reward_accuracy_mean_max": 1.2916666666666674, "reward_sla_mean_mean": -1.1899133333333334, "reward_sla_mean_min": -1.7766666666666666, "reward_sla_mean_max": -0.5573333333333333, "reward_consolidation_sum_mean": -52.72181912333609, "reward_consolidation_sum_min": -80.67898808979865, "reward_consolidation_sum_max": -30.211672606536908, "reward_illegal_sum_mean": -175.84999999999997, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 89.54166666666669, "reward_accuracy_sum_min": 42.49999999999997, "reward_accuracy_sum_max": 129.16666666666674, "reward_sla_sum_mean": -118.99133333333333, "reward_sla_sum_min": -177.66666666666666, "reward_sla_sum_max": -55.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3367.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-273.4037253647688, -255.534841146547, -263.41152944043364, -260.64062566633146, -263.4634286758659, -249.9399951262602, -255.4257546681286, -237.11772518200354, -266.2504858509246, -267.33556002315004, -267.1926863443906, -229.453196868622, -257.03481677784885, -257.7835054372656, -260.42216637728814, -284.42186786073285, -273.7690060617136, -268.8685004112216, -253.95350147735206, -251.73567272838022, -308.3608882390568, -247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.283815099151025, "mean_inference_ms": 2.4219164952209007, "mean_action_processing_ms": 0.10695068181205, "mean_env_wait_ms": 2.053812223575919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00823068618774414, "StateBufferConnector_ms": 0.004212856292724609, "ViewRequirementAgentConnector_ms": 0.10979652404785156}, "num_episodes": 18, "episode_return_max": -222.38942703097862, "episode_return_min": -308.3608882390568, "episode_return_mean": -258.0214857900026, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38550, "num_agent_steps_trained": 37950, "num_env_steps_sampled": 38550, "num_env_steps_trained": 37950, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 173.7597551244906, "num_env_steps_trained_throughput_per_sec": 159.27977553078304, "timesteps_total": 38550, "num_env_steps_sampled_lifetime": 38550, "num_agent_steps_sampled_lifetime": 38550, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 38550, "timers": {"training_iteration_time_ms": 10266.405, "restore_workers_time_ms": 0.018, "training_step_time_ms": 888.042, "sample_time_ms": 869.877, "synch_weights_time_ms": 16.486}, "counters": {"num_env_steps_sampled": 38550, "num_env_steps_trained": 37950, "num_agent_steps_sampled": 38550, "num_agent_steps_trained": 37950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 257, "num_samples_added_to_queue": 38500}, "done": false, "training_iteration": 19, "trial_id": "13390_00000", "date": "2024-10-13_00-41-43", "timestamp": 1728776503, "time_this_iter_s": 10.371237993240356, "time_total_s": 196.65375566482544, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b51780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.65375566482544, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.02, "ram_util_percent": 53.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -475661.65625, "policy_loss": -478432.125, "entropy": 29.806718826293945, "entropy_coeff": 0.01, "var_gnorm": 16.011383056640625, "vf_loss": 293440.28125, "vf_explained_var": 0.008018016815185547}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 73.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 40650, "num_env_steps_trained": 40150, "num_agent_steps_sampled": 40650, "num_agent_steps_trained": 40150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 271, "num_samples_added_to_queue": 40150, "learner_queue": {"size_count": 73, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.703, "learner_load_time_ms": 0.346, "learner_load_wait_time_ms": 2886.244, "learner_dequeue_time_ms": 20556.216}}, "env_runners": {"episode_reward_max": -218.96930153218187, "episode_reward_min": -293.3399189740778, "episode_reward_mean": -257.8804204209692, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -293.3399189740778}, "policy_reward_max": {"default_policy": -218.96930153218187}, "policy_reward_mean": {"default_policy": -257.8804204209692}, "custom_metrics": {"num_consolidated_mean": 0.6627, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0506, "num_overloaded_min": 0.89, "num_overloaded_max": 1.21, "num_moves_mean": 10.000000000000002, "num_moves_min": 9.69, "num_moves_max": 10.32, "mean_accuracy_mean": 41.09012, "mean_accuracy_min": 40.87199999999999, "mean_accuracy_max": 41.397666666666666, "num_model_switches_mean": 6.024500000000001, "num_model_switches_min": 5.54, "num_model_switches_max": 6.43, "num_slav_mean": 0.15966616666666666, "num_slav_min": 0.13713333333333336, "num_slav_max": 0.1816833333333333, "cpu_conserved_cost_mean": 2.6670000000000003, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.570294509139906, "mean_cluster_cpu_util_min": 0.5462514022336283, "mean_cluster_cpu_util_max": 0.5901091746145665, "mean_cluster_mem_util_mean": 0.36584548255008753, "mean_cluster_mem_util_min": 0.35644849647664983, "mean_cluster_mem_util_max": 0.3754662197896036, "reward_consolidation_mean_mean": -0.532807537543026, "reward_consolidation_mean_min": -0.8067898808979865, "reward_consolidation_mean_max": -0.29492415242620856, "reward_illegal_mean_mean": -1.751, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.9005833333333335, "reward_accuracy_mean_min": 0.40833333333333227, "reward_accuracy_mean_max": 1.325000000000001, "reward_sla_mean_mean": -1.1955799999999999, "reward_sla_mean_min": -1.9206666666666665, "reward_sla_mean_max": -0.5573333333333333, "reward_consolidation_sum_mean": -53.2807537543026, "reward_consolidation_sum_min": -80.67898808979865, "reward_consolidation_sum_max": -29.492415242620858, "reward_illegal_sum_mean": -175.1, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 90.05833333333338, "reward_accuracy_sum_min": 40.83333333333323, "reward_accuracy_sum_max": 132.5000000000001, "reward_sla_sum_mean": -119.55799999999999, "reward_sla_sum_min": -192.06666666666666, "reward_sla_sum_max": -55.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4078.0, "global_timestep_min": 2200, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-247.1973438118736, -269.1575619117241, -285.50024064089666, -250.18853148131203, -259.9202534344632, -274.67885710804455, -262.5227481799626, -276.9143013798774, -233.78322519723397, -249.87522617198206, -242.8272502969933, -230.2527064485666, -249.123783849645, -254.80262268116584, -268.5667580492854, -244.98293277285305, -265.03578238752317, -267.69061195893886, -276.93487160742023, -253.227661518779, -242.6831003076547, -243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28495743773730103, "mean_inference_ms": 2.4344704645147988, "mean_action_processing_ms": 0.10729363066404812, "mean_env_wait_ms": 2.061251284738143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007899999618530273, "StateBufferConnector_ms": 0.0040569305419921875, "ViewRequirementAgentConnector_ms": 0.1054239273071289}, "num_episodes": 21, "episode_return_max": -218.96930153218187, "episode_return_min": -293.3399189740778, "episode_return_mean": -257.8804204209692, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40650, "num_agent_steps_trained": 40150, "num_env_steps_sampled": 40650, "num_env_steps_trained": 40150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 200.61888195365862, "num_env_steps_trained_throughput_per_sec": 210.17216204668998, "timesteps_total": 40650, "num_env_steps_sampled_lifetime": 40650, "num_agent_steps_sampled_lifetime": 40650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 40650, "timers": {"training_iteration_time_ms": 10279.922, "restore_workers_time_ms": 0.016, "training_step_time_ms": 745.201, "sample_time_ms": 728.189, "synch_weights_time_ms": 15.393}, "counters": {"num_env_steps_sampled": 40650, "num_env_steps_trained": 40150, "num_agent_steps_sampled": 40650, "num_agent_steps_trained": 40150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 271, "num_samples_added_to_queue": 40150}, "done": false, "training_iteration": 20, "trial_id": "13390_00000", "date": "2024-10-13_00-41-54", "timestamp": 1728776514, "time_this_iter_s": 10.486467123031616, "time_total_s": 207.14022278785706, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c9480>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.14022278785706, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.466666666666665, "ram_util_percent": 54.35333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -479461.0625, "policy_loss": -482251.84375, "entropy": 29.80489730834961, "entropy_coeff": 0.01, "var_gnorm": 16.012901306152344, "vf_loss": 295470.5625, "vf_explained_var": 0.009051859378814697}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 42750, "num_env_steps_trained": 42350, "num_agent_steps_sampled": 42750, "num_agent_steps_trained": 42350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 285, "num_samples_added_to_queue": 42350, "learner_queue": {"size_count": 77, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.607, "learner_load_time_ms": 0.346, "learner_load_wait_time_ms": 2793.143, "learner_dequeue_time_ms": 20556.216}}, "env_runners": {"episode_reward_max": -218.96930153218187, "episode_reward_min": -293.3399189740778, "episode_reward_mean": -257.740613786591, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -293.3399189740778}, "policy_reward_max": {"default_policy": -218.96930153218187}, "policy_reward_mean": {"default_policy": -257.740613786591}, "custom_metrics": {"num_consolidated_mean": 0.6609, "num_consolidated_min": 0.53, "num_consolidated_max": 0.78, "num_overloaded_mean": 1.054, "num_overloaded_min": 0.89, "num_overloaded_max": 1.22, "num_moves_mean": 10.0054, "num_moves_min": 9.77, "num_moves_max": 10.32, "mean_accuracy_mean": 41.08087333333333, "mean_accuracy_min": 40.87199999999999, "mean_accuracy_max": 41.41666666666667, "num_model_switches_mean": 6.0158000000000005, "num_model_switches_min": 5.54, "num_model_switches_max": 6.43, "num_slav_mean": 0.1583488333333333, "num_slav_min": 0.13713333333333336, "num_slav_max": 0.1816833333333333, "cpu_conserved_cost_mean": 2.6673999999999993, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.42, "mean_cluster_cpu_util_mean": 0.570839828848328, "mean_cluster_cpu_util_min": 0.5462514022336283, "mean_cluster_cpu_util_max": 0.5901091746145665, "mean_cluster_mem_util_mean": 0.36604761206908926, "mean_cluster_mem_util_min": 0.35644849647664983, "mean_cluster_mem_util_max": 0.3754662197896036, "reward_consolidation_mean_mean": -0.5321061378659112, "reward_consolidation_mean_min": -0.8067898808979865, "reward_consolidation_mean_max": -0.29492415242620856, "reward_illegal_mean_mean": -1.7566666666666666, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.8868333333333334, "reward_accuracy_mean_min": 0.40833333333333227, "reward_accuracy_mean_max": 1.325000000000001, "reward_sla_mean_mean": -1.1754666666666669, "reward_sla_mean_min": -1.9206666666666665, "reward_sla_mean_max": -0.5573333333333333, "reward_consolidation_sum_mean": -53.21061378659114, "reward_consolidation_sum_min": -80.67898808979865, "reward_consolidation_sum_max": -29.492415242620858, "reward_illegal_sum_mean": -175.66666666666669, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 88.68333333333335, "reward_accuracy_sum_min": 40.83333333333323, "reward_accuracy_sum_max": 132.5000000000001, "reward_sla_sum_mean": -117.54666666666668, "reward_sla_sum_min": -192.06666666666666, "reward_sla_sum_max": -55.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4783.0, "global_timestep_min": 3100, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-243.15326997471726, -264.41115172560836, -254.17048036796712, -247.08219257363902, -264.8748119041089, -254.00165097931682, -244.46105272777106, -234.34448505894176, -244.14669651832216, -258.4019068506502, -255.95717810472428, -253.86283773492937, -253.4582229126685, -252.0437661823387, -245.1116726065369, -240.10080416704727, -275.41781047244814, -280.0954339151358, -260.6194858204634, -278.92892564500914, -293.3399189740778, -237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855608388914297, "mean_inference_ms": 2.4413195011128264, "mean_action_processing_ms": 0.10747826154724902, "mean_env_wait_ms": 2.0654247106482826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007416725158691406, "StateBufferConnector_ms": 0.00403904914855957, "ViewRequirementAgentConnector_ms": 0.10435676574707031}, "num_episodes": 21, "episode_return_max": -218.96930153218187, "episode_return_min": -293.3399189740778, "episode_return_mean": -257.740613786591, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42750, "num_agent_steps_trained": 42350, "num_env_steps_sampled": 42750, "num_env_steps_trained": 42350, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.07746193094383, "num_env_steps_trained_throughput_per_sec": 217.985912499084, "timesteps_total": 42750, "num_env_steps_sampled_lifetime": 42750, "num_agent_steps_sampled_lifetime": 42750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 42750, "timers": {"training_iteration_time_ms": 10289.077, "restore_workers_time_ms": 0.015, "training_step_time_ms": 722.5, "sample_time_ms": 706.561, "synch_weights_time_ms": 14.48}, "counters": {"num_env_steps_sampled": 42750, "num_env_steps_trained": 42350, "num_agent_steps_sampled": 42750, "num_agent_steps_trained": 42350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 285, "num_samples_added_to_queue": 42350}, "done": false, "training_iteration": 21, "trial_id": "13390_00000", "date": "2024-10-13_00-42-04", "timestamp": 1728776524, "time_this_iter_s": 10.103714227676392, "time_total_s": 217.24393701553345, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3d150>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 217.24393701553345, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.064285714285717, "ram_util_percent": 54.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -504030.25, "policy_loss": -507253.0625, "entropy": 29.803096771240234, "entropy_coeff": 0.01, "var_gnorm": 16.014528274536133, "vf_loss": 338672.9375, "vf_explained_var": 0.008129417896270752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 81.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 44850, "num_env_steps_trained": 44550, "num_agent_steps_sampled": 44850, "num_agent_steps_trained": 44550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 299, "num_samples_added_to_queue": 44550, "learner_queue": {"size_count": 81, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.126, "learner_load_time_ms": 0.4, "learner_load_wait_time_ms": 2590.789, "learner_dequeue_time_ms": 22423.894}}, "env_runners": {"episode_reward_max": -218.96930153218187, "episode_reward_min": -302.49644521612, "episode_reward_mean": -258.93527384324824, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -302.49644521612}, "policy_reward_max": {"default_policy": -218.96930153218187}, "policy_reward_mean": {"default_policy": -258.93527384324824}, "custom_metrics": {"num_consolidated_mean": 0.6559, "num_consolidated_min": 0.53, "num_consolidated_max": 0.78, "num_overloaded_mean": 1.0529, "num_overloaded_min": 0.89, "num_overloaded_max": 1.22, "num_moves_mean": 10.014000000000001, "num_moves_min": 9.62, "num_moves_max": 10.32, "mean_accuracy_mean": 41.08252, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.41666666666667, "num_model_switches_mean": 6.004499999999999, "num_model_switches_min": 5.54, "num_model_switches_max": 6.43, "num_slav_mean": 0.15841733333333333, "num_slav_min": 0.13713333333333336, "num_slav_max": 0.17596666666666672, "cpu_conserved_cost_mean": 2.6559999999999997, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.42, "mean_cluster_cpu_util_mean": 0.5709173621012298, "mean_cluster_cpu_util_min": 0.5462514022336283, "mean_cluster_cpu_util_max": 0.590178685559436, "mean_cluster_mem_util_mean": 0.36592951764724874, "mean_cluster_mem_util_min": 0.35644849647664983, "mean_cluster_mem_util_max": 0.37466849418037257, "reward_consolidation_mean_mean": -0.5408694050991503, "reward_consolidation_mean_min": -0.8067898808979865, "reward_consolidation_mean_max": -0.29492415242620856, "reward_illegal_mean_mean": -1.754833333333333, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.483333333333333, "reward_accuracy_mean_mean": 0.8974166666666668, "reward_accuracy_mean_min": 0.40833333333333227, "reward_accuracy_mean_max": 1.325000000000001, "reward_sla_mean_mean": -1.1910666666666665, "reward_sla_mean_min": -1.9206666666666665, "reward_sla_mean_max": -0.582, "reward_consolidation_sum_mean": -54.086940509915024, "reward_consolidation_sum_min": -80.67898808979865, "reward_consolidation_sum_max": -29.492415242620858, "reward_illegal_sum_mean": -175.4833333333333, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -148.3333333333333, "reward_accuracy_sum_mean": 89.74166666666667, "reward_accuracy_sum_min": 40.83333333333323, "reward_accuracy_sum_max": 132.5000000000001, "reward_sla_sum_mean": -119.10666666666668, "reward_sla_sum_min": -192.06666666666666, "reward_sla_sum_max": -58.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5483.0, "global_timestep_min": 3800, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-237.35683389685934, -254.1701361601022, -241.69352401839814, -272.6080538548234, -271.3941576045568, -279.5077736147918, -242.22376861920847, -264.8456547564653, -247.19021596758947, -250.11322306497283, -251.52285479301824, -257.103749733467, -284.1981236102227, -281.0516890554081, -266.99067288068477, -248.98454110694797, -256.6321118523256, -222.38942703097862, -256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28585077507885, "mean_inference_ms": 2.4425362546117997, "mean_action_processing_ms": 0.10754439179527191, "mean_env_wait_ms": 2.066783370398993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007237672805786133, "StateBufferConnector_ms": 0.003964424133300781, "ViewRequirementAgentConnector_ms": 0.10290884971618652}, "num_episodes": 21, "episode_return_max": -218.96930153218187, "episode_return_min": -302.49644521612, "episode_return_mean": -258.93527384324824, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44850, "num_agent_steps_trained": 44550, "num_env_steps_sampled": 44850, "num_env_steps_trained": 44550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.37443856660343, "num_env_steps_trained_throughput_per_sec": 210.9636975459655, "timesteps_total": 44850, "num_env_steps_sampled_lifetime": 44850, "num_agent_steps_sampled_lifetime": 44850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 44850, "timers": {"training_iteration_time_ms": 10322.674, "restore_workers_time_ms": 0.016, "training_step_time_ms": 743.491, "sample_time_ms": 725.235, "synch_weights_time_ms": 16.518}, "counters": {"num_env_steps_sampled": 44850, "num_env_steps_trained": 44550, "num_agent_steps_sampled": 44850, "num_agent_steps_trained": 44550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 299, "num_samples_added_to_queue": 44550}, "done": false, "training_iteration": 22, "trial_id": "13390_00000", "date": "2024-10-13_00-42-14", "timestamp": 1728776534, "time_this_iter_s": 10.437967777252197, "time_total_s": 227.68190479278564, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3d1b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.68190479278564, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.54, "ram_util_percent": 53.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -497165.28125, "policy_loss": -500269.21875, "entropy": 29.8012752532959, "entropy_coeff": 0.01, "var_gnorm": 16.01616859436035, "vf_loss": 326785.25, "vf_explained_var": 0.009138703346252441}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 84.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 46500, "num_env_steps_trained": 46200, "num_agent_steps_sampled": 46500, "num_agent_steps_trained": 46200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 310, "num_samples_added_to_queue": 46200, "learner_queue": {"size_count": 84, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 102.767, "learner_load_time_ms": 0.4, "learner_load_wait_time_ms": 2774.52, "learner_dequeue_time_ms": 22423.894}}, "env_runners": {"episode_reward_max": -218.96930153218187, "episode_reward_min": -302.49644521612, "episode_reward_mean": -259.6013928234182, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -302.49644521612}, "policy_reward_max": {"default_policy": -218.96930153218187}, "policy_reward_mean": {"default_policy": -259.6013928234182}, "custom_metrics": {"num_consolidated_mean": 0.6587000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.78, "num_overloaded_mean": 1.0613000000000001, "num_overloaded_min": 0.89, "num_overloaded_max": 1.22, "num_moves_mean": 10.010799999999998, "num_moves_min": 9.62, "num_moves_max": 10.32, "mean_accuracy_mean": 41.08423, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.41666666666667, "num_model_switches_mean": 5.991099999999999, "num_model_switches_min": 5.54, "num_model_switches_max": 6.35, "num_slav_mean": 0.1582875, "num_slav_min": 0.13793333333333332, "num_slav_max": 0.17596666666666672, "cpu_conserved_cost_mean": 2.6794000000000007, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.42, "mean_cluster_cpu_util_mean": 0.5719527873671559, "mean_cluster_cpu_util_min": 0.5531220745786761, "mean_cluster_cpu_util_max": 0.590178685559436, "mean_cluster_mem_util_mean": 0.366508644080628, "mean_cluster_mem_util_min": 0.3580992228536985, "mean_cluster_mem_util_max": 0.37466849418037257, "reward_consolidation_mean_mean": -0.5362805949008499, "reward_consolidation_mean_min": -0.7572833470407264, "reward_consolidation_mean_max": -0.19953333942550797, "reward_illegal_mean_mean": -1.768833333333333, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8901666666666668, "reward_accuracy_mean_min": 0.3333333333333335, "reward_accuracy_mean_max": 1.4333333333333345, "reward_sla_mean_mean": -1.1810666666666667, "reward_sla_mean_min": -1.9206666666666665, "reward_sla_mean_max": -0.528, "reward_consolidation_sum_mean": -53.62805949008498, "reward_consolidation_sum_min": -75.72833470407264, "reward_consolidation_sum_max": -19.953333942550795, "reward_illegal_sum_mean": -176.88333333333333, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 89.01666666666668, "reward_accuracy_sum_min": 33.33333333333335, "reward_accuracy_sum_max": 143.33333333333346, "reward_sla_sum_mean": -118.10666666666665, "reward_sla_sum_min": -192.06666666666666, "reward_sla_sum_max": -52.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6083.0, "global_timestep_min": 4400, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-256.37158914374476, -259.5101647933227, -237.82697919522346, -261.17485150324393, -233.43037253647682, -266.638420299126, -245.14751896189324, -254.21288494928254, -229.94180450211695, -254.65590179414514, -255.10607999025245, -250.31453897468688, -273.08437661823376, -247.65331261993953, -244.01944317524126, -268.389259496177, -276.0785220384415, -271.6433488683784, -277.60309177861035, -274.50351213865775, -275.00771269304573, -238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28631288531506177, "mean_inference_ms": 2.4477028696573924, "mean_action_processing_ms": 0.10769846086166412, "mean_env_wait_ms": 2.07009738050496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007405281066894531, "StateBufferConnector_ms": 0.0040891170501708984, "ViewRequirementAgentConnector_ms": 0.10673189163208008}, "num_episodes": 18, "episode_return_max": -218.96930153218187, "episode_return_min": -302.49644521612, "episode_return_mean": -259.6013928234182, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46500, "num_agent_steps_trained": 46200, "num_env_steps_sampled": 46500, "num_env_steps_trained": 46200, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 158.56729943724957, "num_env_steps_trained_throughput_per_sec": 158.56729943724957, "timesteps_total": 46500, "num_env_steps_sampled_lifetime": 46500, "num_agent_steps_sampled_lifetime": 46500, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 46500, "timers": {"training_iteration_time_ms": 10337.622, "restore_workers_time_ms": 0.019, "training_step_time_ms": 973.688, "sample_time_ms": 952.262, "synch_weights_time_ms": 19.168}, "counters": {"num_env_steps_sampled": 46500, "num_env_steps_trained": 46200, "num_agent_steps_sampled": 46500, "num_agent_steps_trained": 46200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 310, "num_samples_added_to_queue": 46200}, "done": false, "training_iteration": 23, "trial_id": "13390_00000", "date": "2024-10-13_00-42-25", "timestamp": 1728776545, "time_this_iter_s": 10.424825429916382, "time_total_s": 238.10673022270203, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069ca90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.10673022270203, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.733333333333338, "ram_util_percent": 54.14666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -483364.46875, "policy_loss": -486241.125, "entropy": 29.798416137695312, "entropy_coeff": 0.01, "var_gnorm": 16.017818450927734, "vf_loss": 304056.6875, "vf_explained_var": 0.011358320713043213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 88.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 48600, "num_env_steps_trained": 48400, "num_agent_steps_sampled": 48600, "num_agent_steps_trained": 48400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 324, "num_samples_added_to_queue": 48400, "learner_queue": {"size_count": 88, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 98.381, "learner_load_time_ms": 0.4, "learner_load_wait_time_ms": 2878.17, "learner_dequeue_time_ms": 22423.894}}, "env_runners": {"episode_reward_max": -218.96930153218187, "episode_reward_min": -302.49644521612, "episode_reward_mean": -259.87769191873025, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -302.49644521612}, "policy_reward_max": {"default_policy": -218.96930153218187}, "policy_reward_mean": {"default_policy": -259.87769191873025}, "custom_metrics": {"num_consolidated_mean": 0.6694999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0665000000000002, "num_overloaded_min": 0.89, "num_overloaded_max": 1.22, "num_moves_mean": 10.0176, "num_moves_min": 9.62, "num_moves_max": 10.32, "mean_accuracy_mean": 41.07897333333332, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.41666666666667, "num_model_switches_mean": 5.9773000000000005, "num_model_switches_min": 5.58, "num_model_switches_max": 6.35, "num_slav_mean": 0.15851466666666666, "num_slav_min": 0.13793333333333332, "num_slav_max": 0.1784166666666667, "cpu_conserved_cost_mean": 2.7146, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.42, "mean_cluster_cpu_util_mean": 0.5728551423007482, "mean_cluster_cpu_util_min": 0.5531220745786761, "mean_cluster_cpu_util_max": 0.5947225360051946, "mean_cluster_mem_util_mean": 0.3670224248758575, "mean_cluster_mem_util_min": 0.3580992228536985, "mean_cluster_mem_util_max": 0.3775157991044519, "reward_consolidation_mean_mean": -0.526556919187304, "reward_consolidation_mean_min": -0.8370919004538672, "reward_consolidation_mean_max": -0.19953333942550797, "reward_illegal_mean_mean": -1.7774999999999996, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8820000000000003, "reward_accuracy_mean_min": 0.3333333333333335, "reward_accuracy_mean_max": 1.4333333333333345, "reward_sla_mean_mean": -1.1767199999999998, "reward_sla_mean_min": -1.9206666666666665, "reward_sla_mean_max": -0.528, "reward_consolidation_sum_mean": -52.6556919187304, "reward_consolidation_sum_min": -83.70919004538672, "reward_consolidation_sum_max": -19.953333942550795, "reward_illegal_sum_mean": -177.75000000000003, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 88.20000000000002, "reward_accuracy_sum_min": 33.33333333333335, "reward_accuracy_sum_max": 143.33333333333346, "reward_sla_sum_mean": -117.67200000000001, "reward_sla_sum_min": -192.06666666666666, "reward_sla_sum_max": -52.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5378.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-238.8911998537877, -244.99241524262087, -257.3350635109199, -251.84747631667105, -253.02667154040623, -289.4423710743549, -270.488775168296, -276.6212951963202, -248.96472021688132, -262.5000487373966, -285.7350543726583, -290.6522403972096, -246.17340765786324, -258.81712510280545, -251.16005361113633, -264.4677053824362, -218.96930153218187, -273.287072405495, -258.5297206737944, -260.5153340034725, -231.49356057144584, -268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863774327982455, "mean_inference_ms": 2.4479728699621877, "mean_action_processing_ms": 0.10772358500480475, "mean_env_wait_ms": 2.071126668943416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007185220718383789, "StateBufferConnector_ms": 0.0039598941802978516, "ViewRequirementAgentConnector_ms": 0.10310745239257812}, "num_episodes": 21, "episode_return_max": -218.96930153218187, "episode_return_min": -302.49644521612, "episode_return_mean": -259.87769191873025, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48600, "num_agent_steps_trained": 48400, "num_env_steps_sampled": 48600, "num_env_steps_trained": 48400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.14729162876682, "num_env_steps_trained_throughput_per_sec": 213.86859123013667, "timesteps_total": 48600, "num_env_steps_sampled_lifetime": 48600, "num_agent_steps_sampled_lifetime": 48600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 48600, "timers": {"training_iteration_time_ms": 10345.067, "restore_workers_time_ms": 0.016, "training_step_time_ms": 740.366, "sample_time_ms": 723.69, "synch_weights_time_ms": 15.092}, "counters": {"num_env_steps_sampled": 48600, "num_env_steps_trained": 48400, "num_agent_steps_sampled": 48600, "num_agent_steps_trained": 48400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 324, "num_samples_added_to_queue": 48400}, "done": false, "training_iteration": 24, "trial_id": "13390_00000", "date": "2024-10-13_00-42-35", "timestamp": 1728776555, "time_this_iter_s": 10.2976393699646, "time_total_s": 248.40436959266663, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e3715ce290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.40436959266663, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.133333333333333, "ram_util_percent": 54.760000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -515105.03125, "policy_loss": -518385.28125, "entropy": 29.796680450439453, "entropy_coeff": 0.01, "var_gnorm": 16.018972396850586, "vf_loss": 344411.84375, "vf_explained_var": 0.011063635349273682}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 50700, "num_env_steps_trained": 50050, "num_agent_steps_sampled": 50700, "num_agent_steps_trained": 50050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 338, "num_samples_added_to_queue": 50600, "learner_queue": {"size_count": 91, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 96.884, "learner_load_time_ms": 0.405, "learner_load_wait_time_ms": 2874.481, "learner_dequeue_time_ms": 22778.612}}, "env_runners": {"episode_reward_max": -221.18910719181184, "episode_reward_min": -302.49644521612, "episode_reward_mean": -260.9090326845166, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -302.49644521612}, "policy_reward_max": {"default_policy": -221.18910719181184}, "policy_reward_mean": {"default_policy": -260.9090326845166}, "custom_metrics": {"num_consolidated_mean": 0.6704000000000001, "num_consolidated_min": 0.5, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0614, "num_overloaded_min": 0.87, "num_overloaded_max": 1.22, "num_moves_mean": 10.010299999999999, "num_moves_min": 9.62, "num_moves_max": 10.27, "mean_accuracy_mean": 41.07865666666667, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.41666666666667, "num_model_switches_mean": 5.972700000000001, "num_model_switches_min": 5.58, "num_model_switches_max": 6.35, "num_slav_mean": 0.15870966666666667, "num_slav_min": 0.13793333333333332, "num_slav_max": 0.1784166666666667, "cpu_conserved_cost_mean": 2.721, "cpu_conserved_cost_min": 2.08, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.5727746663491734, "mean_cluster_cpu_util_min": 0.5531220745786761, "mean_cluster_cpu_util_max": 0.5947225360051946, "mean_cluster_mem_util_mean": 0.3670227006390109, "mean_cluster_mem_util_min": 0.3580992228536985, "mean_cluster_mem_util_max": 0.3775157991044519, "reward_consolidation_mean_mean": -0.5417136601785008, "reward_consolidation_mean_min": -0.9078558591489234, "reward_consolidation_mean_max": -0.19953333942550797, "reward_illegal_mean_mean": -1.7689999999999997, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9065833333333336, "reward_accuracy_mean_min": 0.3333333333333335, "reward_accuracy_mean_max": 1.4333333333333345, "reward_sla_mean_mean": -1.20496, "reward_sla_mean_min": -1.8999999999999997, "reward_sla_mean_max": -0.528, "reward_consolidation_sum_mean": -54.171366017850076, "reward_consolidation_sum_min": -90.78558591489234, "reward_consolidation_sum_max": -19.953333942550795, "reward_illegal_sum_mean": -176.89999999999998, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 90.65833333333336, "reward_accuracy_sum_min": 33.33333333333335, "reward_accuracy_sum_max": 143.33333333333346, "reward_sla_sum_mean": -120.49599999999998, "reward_sla_sum_min": -189.99999999999997, "reward_sla_sum_max": -52.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4440.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-268.7408175698312, -264.3948399281122, -258.6043345822291, -235.7238112644308, -255.15821986658128, -262.6749977154344, -249.2857625879557, -244.71852934905118, -259.74661732005217, -251.1420725577993, -248.51965030917776, -284.76367236284983, -285.48850406652656, -264.1211703067411, -255.29139784946224, -242.48180876663923, -257.72638825428714, -256.75656279508956, -254.5376557312133, -255.83951689055394, -268.52438392884335, -268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2865083269717868, "mean_inference_ms": 2.448421262993815, "mean_action_processing_ms": 0.10774777322720201, "mean_env_wait_ms": 2.072051110971803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007200002670288086, "StateBufferConnector_ms": 0.003979682922363281, "ViewRequirementAgentConnector_ms": 0.10327506065368652}, "num_episodes": 21, "episode_return_max": -221.18910719181184, "episode_return_min": -302.49644521612, "episode_return_mean": -260.9090326845166, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50700, "num_agent_steps_trained": 50050, "num_env_steps_sampled": 50700, "num_env_steps_trained": 50050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 202.6187205263279, "num_env_steps_trained_throughput_per_sec": 159.2004232706862, "timesteps_total": 50700, "num_env_steps_sampled_lifetime": 50700, "num_agent_steps_sampled_lifetime": 50700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 50700, "timers": {"training_iteration_time_ms": 10362.696, "restore_workers_time_ms": 0.015, "training_step_time_ms": 737.376, "sample_time_ms": 718.144, "synch_weights_time_ms": 17.385}, "counters": {"num_env_steps_sampled": 50700, "num_env_steps_trained": 50050, "num_agent_steps_sampled": 50700, "num_agent_steps_trained": 50050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 338, "num_samples_added_to_queue": 50600}, "done": false, "training_iteration": 25, "trial_id": "13390_00000", "date": "2024-10-13_00-42-46", "timestamp": 1728776566, "time_this_iter_s": 10.375957489013672, "time_total_s": 258.7803270816803, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3fe20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.7803270816803, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.266666666666666, "ram_util_percent": 54.64666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -489037.75, "policy_loss": -492003.6875, "entropy": 29.794233322143555, "entropy_coeff": 0.01, "var_gnorm": 16.0203857421875, "vf_loss": 312981.875, "vf_explained_var": 0.01276707649230957}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 96.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 52950, "num_env_steps_trained": 52800, "num_agent_steps_sampled": 52950, "num_agent_steps_trained": 52800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 353, "num_samples_added_to_queue": 52800, "learner_queue": {"size_count": 96, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.65, "learner_load_time_ms": 0.405, "learner_load_wait_time_ms": 2551.86, "learner_dequeue_time_ms": 22778.612}}, "env_runners": {"episode_reward_max": -221.18910719181184, "episode_reward_min": -302.49644521612, "episode_reward_mean": -261.0686312711321, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -302.49644521612}, "policy_reward_max": {"default_policy": -221.18910719181184}, "policy_reward_mean": {"default_policy": -261.0686312711321}, "custom_metrics": {"num_consolidated_mean": 0.6701999999999999, "num_consolidated_min": 0.46, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0619999999999998, "num_overloaded_min": 0.87, "num_overloaded_max": 1.22, "num_moves_mean": 10.0166, "num_moves_min": 9.62, "num_moves_max": 10.32, "mean_accuracy_mean": 41.07777, "mean_accuracy_min": 40.821333333333335, "mean_accuracy_max": 41.32166666666667, "num_model_switches_mean": 5.990600000000001, "num_model_switches_min": 5.51, "num_model_switches_max": 6.5, "num_slav_mean": 0.15927366666666665, "num_slav_min": 0.14236666666666667, "num_slav_max": 0.1784166666666667, "cpu_conserved_cost_mean": 2.7135999999999996, "cpu_conserved_cost_min": 1.76, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.5727016162519221, "mean_cluster_cpu_util_min": 0.5509884377735831, "mean_cluster_cpu_util_max": 0.5947225360051946, "mean_cluster_mem_util_mean": 0.36713415180724185, "mean_cluster_mem_util_min": 0.3583865766454261, "mean_cluster_mem_util_max": 0.3775157991044519, "reward_consolidation_mean_mean": -0.5392629793779891, "reward_consolidation_mean_min": -0.9078558591489234, "reward_consolidation_mean_max": -0.19953333942550797, "reward_illegal_mean_mean": -1.7699999999999998, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9052500000000001, "reward_accuracy_mean_min": 0.3333333333333335, "reward_accuracy_mean_max": 1.4333333333333345, "reward_sla_mean_mean": -1.2066733333333333, "reward_sla_mean_min": -1.8999999999999997, "reward_sla_mean_max": -0.528, "reward_consolidation_sum_mean": -53.92629793779891, "reward_consolidation_sum_min": -90.78558591489234, "reward_consolidation_sum_max": -19.953333942550795, "reward_illegal_sum_mean": -176.99999999999997, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 90.52500000000002, "reward_accuracy_sum_min": 33.33333333333335, "reward_accuracy_sum_max": 143.33333333333346, "reward_sla_sum_mean": -120.66733333333333, "reward_sla_sum_min": -189.99999999999997, "reward_sla_sum_max": -52.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3502.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-268.272795394316, -236.64670870267128, -262.28075177434573, -285.91418867464745, -300.00717353559355, -259.3810015535044, -246.33617533278485, -271.96782722592815, -250.05641353681196, -231.51475220079786, -285.42214810076445, -273.4403637028238, -245.96606963355555, -261.6775686131164, -302.49644521612, -255.03062840780996, -237.53940723141108, -255.31312254409195, -263.8223186816534, -295.0489049316151, -259.5909835815894, -265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28664481647436685, "mean_inference_ms": 2.448456863921088, "mean_action_processing_ms": 0.10776220761973435, "mean_env_wait_ms": 2.0727503147376596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007269620895385742, "StateBufferConnector_ms": 0.00398564338684082, "ViewRequirementAgentConnector_ms": 0.10413503646850586}, "num_episodes": 21, "episode_return_max": -221.18910719181184, "episode_return_min": -302.49644521612, "episode_return_mean": -261.0686312711321, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52950, "num_agent_steps_trained": 52800, "num_env_steps_sampled": 52950, "num_env_steps_trained": 52800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 212.67414482919278, "num_env_steps_trained_throughput_per_sec": 259.9350659023467, "timesteps_total": 52950, "num_env_steps_sampled_lifetime": 52950, "num_agent_steps_sampled_lifetime": 52950, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 52950, "timers": {"training_iteration_time_ms": 10393.739, "restore_workers_time_ms": 0.013, "training_step_time_ms": 712.342, "sample_time_ms": 694.827, "synch_weights_time_ms": 15.777}, "counters": {"num_env_steps_sampled": 52950, "num_env_steps_trained": 52800, "num_agent_steps_sampled": 52950, "num_agent_steps_trained": 52800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 353, "num_samples_added_to_queue": 52800}, "done": false, "training_iteration": 26, "trial_id": "13390_00000", "date": "2024-10-13_00-42-56", "timestamp": 1728776576, "time_this_iter_s": 10.590783596038818, "time_total_s": 269.3711106777191, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069ded0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.3711106777191, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.80666666666667, "ram_util_percent": 53.84666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -501147.96875, "policy_loss": -504221.5, "entropy": 29.794275283813477, "entropy_coeff": 0.01, "var_gnorm": 16.021251678466797, "vf_loss": 323741.75, "vf_explained_var": 0.013301849365234375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 55050, "num_env_steps_trained": 54450, "num_agent_steps_sampled": 55050, "num_agent_steps_trained": 54450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 367, "num_samples_added_to_queue": 55000, "learner_queue": {"size_count": 99, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.198, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 2592.416, "learner_dequeue_time_ms": 22615.624}}, "env_runners": {"episode_reward_max": -221.18910719181184, "episode_reward_min": -294.8976971580004, "episode_reward_mean": -259.90249215632514, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -294.8976971580004}, "policy_reward_max": {"default_policy": -221.18910719181184}, "policy_reward_mean": {"default_policy": -259.90249215632514}, "custom_metrics": {"num_consolidated_mean": 0.675, "num_consolidated_min": 0.46, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0610000000000002, "num_overloaded_min": 0.87, "num_overloaded_max": 1.22, "num_moves_mean": 10.013100000000001, "num_moves_min": 9.71, "num_moves_max": 10.47, "mean_accuracy_mean": 41.077643333333334, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.32166666666667, "num_model_switches_mean": 5.989699999999999, "num_model_switches_min": 5.51, "num_model_switches_max": 6.5, "num_slav_mean": 0.15859633333333334, "num_slav_min": 0.14236666666666667, "num_slav_max": 0.1784166666666667, "cpu_conserved_cost_mean": 2.7314000000000003, "cpu_conserved_cost_min": 1.76, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.5730081499950405, "mean_cluster_cpu_util_min": 0.5509884377735831, "mean_cluster_cpu_util_max": 0.5947225360051946, "mean_cluster_mem_util_mean": 0.36736289690074336, "mean_cluster_mem_util_min": 0.3583865766454261, "mean_cluster_mem_util_max": 0.3775157991044519, "reward_consolidation_mean_mean": -0.5391749215632521, "reward_consolidation_mean_min": -0.9078558591489234, "reward_consolidation_mean_max": -0.19953333942550797, "reward_illegal_mean_mean": -1.7683333333333335, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9084166666666669, "reward_accuracy_mean_min": 0.3333333333333335, "reward_accuracy_mean_max": 1.4333333333333345, "reward_sla_mean_mean": -1.1999333333333333, "reward_sla_mean_min": -1.8453333333333333, "reward_sla_mean_max": -0.528, "reward_consolidation_sum_mean": -53.91749215632521, "reward_consolidation_sum_min": -90.78558591489234, "reward_consolidation_sum_max": -19.953333942550795, "reward_illegal_sum_mean": -176.83333333333331, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 90.84166666666665, "reward_accuracy_sum_min": 33.33333333333335, "reward_accuracy_sum_max": 143.33333333333346, "reward_sla_sum_mean": -119.99333333333333, "reward_sla_sum_min": -184.53333333333333, "reward_sla_sum_max": -52.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2564.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-265.03407962472176, -247.05864022662885, -252.72833470407255, -275.5878126047091, -272.23427152822194, -261.3470650948855, -258.2145115599011, -256.4603033902951, -259.7018337445548, -237.15111943708317, -243.8974595631909, -231.08666727588397, -255.77636540863253, -273.9458436138779, -280.43951689055405, -271.28469645740046, -242.05619117243904, -284.90919004538677, -244.9147857077583, -251.51402418593295, -255.3392061896492, -260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28675149601676203, "mean_inference_ms": 2.4476070227102813, "mean_action_processing_ms": 0.10774845488235045, "mean_env_wait_ms": 2.072791467639436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007308483123779297, "StateBufferConnector_ms": 0.004012584686279297, "ViewRequirementAgentConnector_ms": 0.1045985221862793}, "num_episodes": 21, "episode_return_max": -221.18910719181184, "episode_return_min": -294.8976971580004, "episode_return_mean": -259.90249215632514, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55050, "num_agent_steps_trained": 54450, "num_env_steps_sampled": 55050, "num_env_steps_trained": 54450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 206.53580260722177, "num_env_steps_trained_throughput_per_sec": 162.27813061995994, "timesteps_total": 55050, "num_env_steps_sampled_lifetime": 55050, "num_agent_steps_sampled_lifetime": 55050, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 55050, "timers": {"training_iteration_time_ms": 10326.622, "restore_workers_time_ms": 0.015, "training_step_time_ms": 734.943, "sample_time_ms": 718.271, "synch_weights_time_ms": 14.992}, "counters": {"num_env_steps_sampled": 55050, "num_env_steps_trained": 54450, "num_agent_steps_sampled": 55050, "num_agent_steps_trained": 54450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 367, "num_samples_added_to_queue": 55000}, "done": false, "training_iteration": 27, "trial_id": "13390_00000", "date": "2024-10-13_00-43-06", "timestamp": 1728776586, "time_this_iter_s": 10.178507804870605, "time_total_s": 279.5496184825897, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3d540>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.5496184825897, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.357142857142858, "ram_util_percent": 53.27857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -486385.4375, "policy_loss": -489381.8125, "entropy": 29.792648315429688, "entropy_coeff": 0.01, "var_gnorm": 16.022390365600586, "vf_loss": 316023.96875, "vf_explained_var": 0.01277315616607666}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 57150, "num_env_steps_trained": 56650, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 56650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 381, "num_samples_added_to_queue": 56650, "learner_queue": {"size_count": 103, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.925, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 2622.479, "learner_dequeue_time_ms": 22615.624}}, "env_runners": {"episode_reward_max": -221.18910719181184, "episode_reward_min": -298.7160711565992, "episode_reward_mean": -261.4257798897315, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -298.7160711565992}, "policy_reward_max": {"default_policy": -221.18910719181184}, "policy_reward_mean": {"default_policy": -261.4257798897315}, "custom_metrics": {"num_consolidated_mean": 0.6758, "num_consolidated_min": 0.46, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0554000000000001, "num_overloaded_min": 0.87, "num_overloaded_max": 1.22, "num_moves_mean": 10.0152, "num_moves_min": 9.69, "num_moves_max": 10.47, "mean_accuracy_mean": 41.07283, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 5.9956000000000005, "num_model_switches_min": 5.51, "num_model_switches_max": 6.5, "num_slav_mean": 0.1581463333333333, "num_slav_min": 0.14236666666666667, "num_slav_max": 0.17346666666666669, "cpu_conserved_cost_mean": 2.733200000000001, "cpu_conserved_cost_min": 1.76, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.572425054374286, "mean_cluster_cpu_util_min": 0.5509884377735831, "mean_cluster_cpu_util_max": 0.5927125297428523, "mean_cluster_mem_util_mean": 0.3670864949499842, "mean_cluster_mem_util_min": 0.3583865766454261, "mean_cluster_mem_util_max": 0.3749571658199146, "reward_consolidation_mean_mean": -0.5487711322306498, "reward_consolidation_mean_min": -0.9078558591489234, "reward_consolidation_mean_max": -0.2548856194218526, "reward_illegal_mean_mean": -1.7589999999999997, "reward_illegal_mean_min": -2.033333333333333, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.9285000000000002, "reward_accuracy_mean_min": 0.4166666666666663, "reward_accuracy_mean_max": 1.3499999999999985, "reward_sla_mean_mean": -1.2349866666666667, "reward_sla_mean_min": -1.8319999999999999, "reward_sla_mean_max": -0.6186666666666667, "reward_consolidation_sum_mean": -54.87711322306498, "reward_consolidation_sum_min": -90.78558591489234, "reward_consolidation_sum_max": -25.488561942185264, "reward_illegal_sum_mean": -175.89999999999992, "reward_illegal_sum_min": -203.33333333333331, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 92.85000000000002, "reward_accuracy_sum_min": 41.66666666666663, "reward_accuracy_sum_max": 134.99999999999986, "reward_sla_sum_mean": -123.49866666666667, "reward_sla_sum_min": -183.2, "reward_sla_sum_max": -61.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1931.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-260.3650035030002, -257.71083797861627, -252.02016509793157, -284.12683602912045, -247.10506564318135, -293.3393128027049, -294.6539066069631, -221.18910719181184, -281.1177525967894, -243.505367205824, -254.0955100673183, -272.6286606354137, -252.0358707240548, -254.94191416125977, -249.57236284991922, -242.80252520637237, -244.5544366261537, -270.9083462792042, -258.1699899479119, -249.45957537543018, -283.9855859148922, -255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2864496817408348, "mean_inference_ms": 2.4397586689993043, "mean_action_processing_ms": 0.10758646139879616, "mean_env_wait_ms": 2.069803724459986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007209062576293945, "StateBufferConnector_ms": 0.003925323486328125, "ViewRequirementAgentConnector_ms": 0.1026003360748291}, "num_episodes": 21, "episode_return_max": -221.18910719181184, "episode_return_min": -298.7160711565992, "episode_return_mean": -261.4257798897315, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 56650, "num_env_steps_sampled": 57150, "num_env_steps_trained": 56650, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.62688009721998, "num_env_steps_trained_throughput_per_sec": 211.2281601018495, "timesteps_total": 57150, "num_env_steps_sampled_lifetime": 57150, "num_agent_steps_sampled_lifetime": 57150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 57150, "timers": {"training_iteration_time_ms": 10356.68, "restore_workers_time_ms": 0.014, "training_step_time_ms": 752.914, "sample_time_ms": 737.746, "synch_weights_time_ms": 13.723}, "counters": {"num_env_steps_sampled": 57150, "num_env_steps_trained": 56650, "num_agent_steps_sampled": 57150, "num_agent_steps_trained": 56650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 381, "num_samples_added_to_queue": 56650}, "done": false, "training_iteration": 28, "trial_id": "13390_00000", "date": "2024-10-13_00-43-17", "timestamp": 1728776597, "time_this_iter_s": 10.426541805267334, "time_total_s": 289.97616028785706, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e3715cd690>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 289.97616028785706, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.573333333333334, "ram_util_percent": 53.33333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -489022.09375, "policy_loss": -491980.1875, "entropy": 29.789833068847656, "entropy_coeff": 0.01, "var_gnorm": 16.024126052856445, "vf_loss": 312192.34375, "vf_explained_var": 0.014846384525299072}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 59100, "num_env_steps_trained": 58850, "num_agent_steps_sampled": 59100, "num_agent_steps_trained": 58850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 394, "num_samples_added_to_queue": 58850, "learner_queue": {"size_count": 107, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.633, "learner_load_time_ms": 0.438, "learner_load_wait_time_ms": 2718.016, "learner_dequeue_time_ms": 22437.842}}, "env_runners": {"episode_reward_max": -232.35411983307438, "episode_reward_min": -298.7160711565992, "episode_reward_mean": -260.92310021627213, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -298.7160711565992}, "policy_reward_max": {"default_policy": -232.35411983307438}, "policy_reward_mean": {"default_policy": -260.92310021627213}, "custom_metrics": {"num_consolidated_mean": 0.6681000000000001, "num_consolidated_min": 0.46, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0507999999999997, "num_overloaded_min": 0.89, "num_overloaded_max": 1.21, "num_moves_mean": 10.010100000000001, "num_moves_min": 9.69, "num_moves_max": 10.47, "mean_accuracy_mean": 41.06567333333332, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.004100000000001, "num_model_switches_min": 5.51, "num_model_switches_max": 6.5, "num_slav_mean": 0.15725083333333334, "num_slav_min": 0.14268333333333333, "num_slav_max": 0.17346666666666669, "cpu_conserved_cost_mean": 2.710400000000001, "cpu_conserved_cost_min": 1.76, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.572156281734501, "mean_cluster_cpu_util_min": 0.5490237249422946, "mean_cluster_cpu_util_max": 0.5940919985535524, "mean_cluster_mem_util_mean": 0.366811356563406, "mean_cluster_mem_util_min": 0.35540084065271677, "mean_cluster_mem_util_max": 0.37609194455208245, "reward_consolidation_mean_mean": -0.5557343354960553, "reward_consolidation_mean_min": -0.8423823448780042, "reward_consolidation_mean_max": -0.2548856194218526, "reward_illegal_mean_mean": -1.751333333333333, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.934416666666667, "reward_accuracy_mean_min": 0.4166666666666663, "reward_accuracy_mean_max": 1.5083333333333346, "reward_sla_mean_mean": -1.2365799999999998, "reward_sla_mean_min": -2.0133333333333336, "reward_sla_mean_max": -0.6186666666666667, "reward_consolidation_sum_mean": -55.57343354960553, "reward_consolidation_sum_min": -84.23823448780043, "reward_consolidation_sum_max": -25.488561942185264, "reward_illegal_sum_mean": -175.13333333333333, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 93.44166666666669, "reward_accuracy_sum_min": 41.66666666666663, "reward_accuracy_sum_max": 150.83333333333346, "reward_sla_sum_mean": -123.65799999999999, "reward_sla_sum_min": -201.33333333333334, "reward_sla_sum_max": -61.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2475.0, "global_timestep_min": 700, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-255.51456943555976, -265.249608577782, -240.2540345426299, -260.93790551037165, -246.0121173352828, -259.70551646410183, -281.98369429467846, -279.30771878522035, -271.39045051631155, -238.00843156964874, -276.008190928752, -288.257101952542, -276.8039629595783, -275.12080782235216, -252.68289621980546, -262.7297480885799, -241.3242803618751, -281.1297023972704, -262.0957415699533, -259.5735873770141, -268.1163392122818, -262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28628272573394503, "mean_inference_ms": 2.4359021342702243, "mean_action_processing_ms": 0.10746790416804348, "mean_env_wait_ms": 2.0678077831496733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007239341735839844, "StateBufferConnector_ms": 0.00393986701965332, "ViewRequirementAgentConnector_ms": 0.10352253913879395}, "num_episodes": 21, "episode_return_max": -232.35411983307438, "episode_return_min": -298.7160711565992, "episode_return_mean": -260.92310021627213, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59100, "num_agent_steps_trained": 58850, "num_env_steps_sampled": 59100, "num_env_steps_trained": 58850, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 191.67984214317136, "num_env_steps_trained_throughput_per_sec": 216.2541808794754, "timesteps_total": 59100, "num_env_steps_sampled_lifetime": 59100, "num_agent_steps_sampled_lifetime": 59100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 59100, "timers": {"training_iteration_time_ms": 10338.091, "restore_workers_time_ms": 0.016, "training_step_time_ms": 798.389, "sample_time_ms": 779.788, "synch_weights_time_ms": 16.878}, "counters": {"num_env_steps_sampled": 59100, "num_env_steps_trained": 58850, "num_agent_steps_sampled": 59100, "num_agent_steps_trained": 58850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 394, "num_samples_added_to_queue": 58850}, "done": false, "training_iteration": 29, "trial_id": "13390_00000", "date": "2024-10-13_00-43-27", "timestamp": 1728776607, "time_this_iter_s": 10.192508459091187, "time_total_s": 300.16866874694824, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e3715cc910>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.16866874694824, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 54.98666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -487534.09375, "policy_loss": -490478.875, "entropy": 29.786388397216797, "entropy_coeff": 0.01, "var_gnorm": 16.02642822265625, "vf_loss": 310858.90625, "vf_explained_var": 0.01587897539138794}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 61200, "num_env_steps_trained": 61050, "num_agent_steps_sampled": 61200, "num_agent_steps_trained": 61050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 408, "num_samples_added_to_queue": 61050, "learner_queue": {"size_count": 111, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.704, "learner_load_time_ms": 0.438, "learner_load_wait_time_ms": 2649.387, "learner_dequeue_time_ms": 22437.842}}, "env_runners": {"episode_reward_max": -232.35411983307438, "episode_reward_min": -298.7160711565992, "episode_reward_mean": -260.11499850741706, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -298.7160711565992}, "policy_reward_max": {"default_policy": -232.35411983307438}, "policy_reward_mean": {"default_policy": -260.11499850741706}, "custom_metrics": {"num_consolidated_mean": 0.6663, "num_consolidated_min": 0.46, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0570000000000002, "num_overloaded_min": 0.89, "num_overloaded_max": 1.21, "num_moves_mean": 9.997899999999998, "num_moves_min": 9.69, "num_moves_max": 10.47, "mean_accuracy_mean": 41.05832666666667, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 5.9828, "num_model_switches_min": 5.51, "num_model_switches_max": 6.42, "num_slav_mean": 0.15659950000000003, "num_slav_min": 0.14268333333333333, "num_slav_max": 0.17346666666666669, "cpu_conserved_cost_mean": 2.7058, "cpu_conserved_cost_min": 1.76, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5723669920766007, "mean_cluster_cpu_util_min": 0.5490237249422946, "mean_cluster_cpu_util_max": 0.5940919985535524, "mean_cluster_mem_util_mean": 0.3669496748238325, "mean_cluster_mem_util_min": 0.35540084065271677, "mean_cluster_mem_util_max": 0.37609194455208245, "reward_consolidation_mean_mean": -0.5464266517408389, "reward_consolidation_mean_min": -0.8423823448780042, "reward_consolidation_mean_max": -0.2548856194218526, "reward_illegal_mean_mean": -1.7616666666666663, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.9180833333333335, "reward_accuracy_mean_min": 0.4166666666666663, "reward_accuracy_mean_max": 1.5083333333333346, "reward_sla_mean_mean": -1.2111399999999999, "reward_sla_mean_min": -2.0133333333333336, "reward_sla_mean_max": -0.6186666666666667, "reward_consolidation_sum_mean": -54.64266517408389, "reward_consolidation_sum_min": -84.23823448780043, "reward_consolidation_sum_max": -25.488561942185264, "reward_illegal_sum_mean": -176.16666666666663, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 91.80833333333335, "reward_accuracy_sum_min": 41.66666666666663, "reward_accuracy_sum_max": 150.83333333333346, "reward_sla_sum_mean": -121.11399999999999, "reward_sla_sum_min": -201.33333333333334, "reward_sla_sum_max": -61.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3175.0, "global_timestep_min": 1400, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-262.04055865241094, -260.22676901519986, -270.2458283834414, -240.55667245423228, -245.71294282494134, -257.616981936702, -251.42297054433573, -262.37816564622733, -260.1901580919307, -239.82698833348562, -252.16515276127797, -270.98774863687595, -267.41718602455137, -294.8976971580004, -244.0218952755185, -248.25320600688397, -269.6398671905933, -264.7561180663436, -238.87171707941147, -249.51171220567173, -248.9876785768678, -249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2861193017450295, "mean_inference_ms": 2.4327373533921564, "mean_action_processing_ms": 0.10736821471261244, "mean_env_wait_ms": 2.066187238877669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007423877716064453, "StateBufferConnector_ms": 0.003976106643676758, "ViewRequirementAgentConnector_ms": 0.10274696350097656}, "num_episodes": 21, "episode_return_max": -232.35411983307438, "episode_return_min": -298.7160711565992, "episode_return_mean": -260.11499850741706, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61200, "num_agent_steps_trained": 61050, "num_env_steps_sampled": 61200, "num_env_steps_trained": 61050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.01047453027883, "num_env_steps_trained_throughput_per_sec": 213.72525903172067, "timesteps_total": 61200, "num_env_steps_sampled_lifetime": 61200, "num_agent_steps_sampled_lifetime": 61200, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 61200, "timers": {"training_iteration_time_ms": 10320.689, "restore_workers_time_ms": 0.017, "training_step_time_ms": 734.6, "sample_time_ms": 717.895, "synch_weights_time_ms": 15.114}, "counters": {"num_env_steps_sampled": 61200, "num_env_steps_trained": 61050, "num_agent_steps_sampled": 61200, "num_agent_steps_trained": 61050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 408, "num_samples_added_to_queue": 61050}, "done": false, "training_iteration": 30, "trial_id": "13390_00000", "date": "2024-10-13_00-43-37", "timestamp": 1728776617, "time_this_iter_s": 10.31501293182373, "time_total_s": 310.483681678772, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e3715cca60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.483681678772, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.173333333333332, "ram_util_percent": 55.37333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -481313.8125, "policy_loss": -484144.84375, "entropy": 29.783817291259766, "entropy_coeff": 0.01, "var_gnorm": 16.028207778930664, "vf_loss": 299484.03125, "vf_explained_var": 0.01781463623046875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 114.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 63300, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 63300, "num_agent_steps_trained": 62700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 422, "num_samples_added_to_queue": 63250, "learner_queue": {"size_count": 114, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.124, "learner_load_time_ms": 0.44, "learner_load_wait_time_ms": 2698.806, "learner_dequeue_time_ms": 22536.282}}, "env_runners": {"episode_reward_max": -220.9947881446281, "episode_reward_min": -298.7160711565992, "episode_reward_mean": -260.4302725334307, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -298.7160711565992}, "policy_reward_max": {"default_policy": -220.9947881446281}, "policy_reward_mean": {"default_policy": -260.4302725334307}, "custom_metrics": {"num_consolidated_mean": 0.6806, "num_consolidated_min": 0.5, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0467, "num_overloaded_min": 0.89, "num_overloaded_max": 1.21, "num_moves_mean": 9.989599999999998, "num_moves_min": 9.69, "num_moves_max": 10.47, "mean_accuracy_mean": 41.055730000000004, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.971199999999999, "num_model_switches_min": 5.54, "num_model_switches_max": 6.42, "num_slav_mean": 0.15575883333333332, "num_slav_min": 0.14268333333333333, "num_slav_max": 0.17346666666666669, "cpu_conserved_cost_mean": 2.7605999999999993, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5728085789881858, "mean_cluster_cpu_util_min": 0.5490237249422946, "mean_cluster_cpu_util_max": 0.5948422582341647, "mean_cluster_mem_util_mean": 0.36705653172809194, "mean_cluster_mem_util_min": 0.35540084065271677, "mean_cluster_mem_util_max": 0.37758242522747504, "reward_consolidation_mean_mean": -0.5583893920009748, "reward_consolidation_mean_min": -0.8423823448780042, "reward_consolidation_mean_max": -0.33754439672241004, "reward_illegal_mean_mean": -1.7444999999999995, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.9418333333333335, "reward_accuracy_mean_min": 0.5333333333333321, "reward_accuracy_mean_max": 1.5083333333333346, "reward_sla_mean_mean": -1.2432466666666668, "reward_sla_mean_min": -2.0133333333333336, "reward_sla_mean_max": -0.6486666666666667, "reward_consolidation_sum_mean": -55.83893920009748, "reward_consolidation_sum_min": -84.23823448780043, "reward_consolidation_sum_max": -33.754439672241006, "reward_illegal_sum_mean": -174.44999999999993, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 94.18333333333335, "reward_accuracy_sum_min": 53.33333333333321, "reward_accuracy_sum_max": 150.83333333333346, "reward_sla_sum_mean": -124.32466666666666, "reward_sla_sum_min": -201.33333333333334, "reward_sla_sum_max": -64.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3875.0, "global_timestep_min": 2100, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-249.5376252703401, -259.01049681683867, -260.29690212921486, -239.87596332510847, -255.29303664443015, -265.6046239605226, -249.23313229157137, -270.3661427396508, -274.32096926497917, -274.8423923969659, -291.3931584879221, -237.8958969204059, -256.4441682658624, -270.1859727679795, -251.01848974991594, -254.0257729446524, -260.38195193274237, -264.54203295866444, -276.92474336714486, -278.0683968442536, -258.2008803192299, -283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.285964867610812, "mean_inference_ms": 2.4303708008110423, "mean_action_processing_ms": 0.10727673552312185, "mean_env_wait_ms": 2.064978668355092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007580280303955078, "StateBufferConnector_ms": 0.003917694091796875, "ViewRequirementAgentConnector_ms": 0.10100483894348145}, "num_episodes": 21, "episode_return_max": -220.9947881446281, "episode_return_min": -298.7160711565992, "episode_return_mean": -260.4302725334307, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63300, "num_agent_steps_trained": 62700, "num_env_steps_sampled": 63300, "num_env_steps_trained": 62700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 207.27505442181914, "num_env_steps_trained_throughput_per_sec": 162.85897133142933, "timesteps_total": 63300, "num_env_steps_sampled_lifetime": 63300, "num_agent_steps_sampled_lifetime": 63300, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 63300, "timers": {"training_iteration_time_ms": 10324.596, "restore_workers_time_ms": 0.014, "training_step_time_ms": 719.971, "sample_time_ms": 704.368, "synch_weights_time_ms": 14.062}, "counters": {"num_env_steps_sampled": 63300, "num_env_steps_trained": 62700, "num_agent_steps_sampled": 63300, "num_agent_steps_trained": 62700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 422, "num_samples_added_to_queue": 63250}, "done": false, "training_iteration": 31, "trial_id": "13390_00000", "date": "2024-10-13_00-43-48", "timestamp": 1728776628, "time_this_iter_s": 10.144828081130981, "time_total_s": 320.62850975990295, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3e980>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.62850975990295, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.071428571428573, "ram_util_percent": 55.442857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -489194.75, "policy_loss": -492177.03125, "entropy": 29.778972625732422, "entropy_coeff": 0.01, "var_gnorm": 16.031192779541016, "vf_loss": 314605.40625, "vf_explained_var": 0.01774466037750244}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272726627}}, "num_env_steps_sampled": 65400, "num_env_steps_trained": 64900, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 64900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 436, "num_samples_added_to_queue": 64900, "learner_queue": {"size_count": 118, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.995, "learner_load_time_ms": 0.44, "learner_load_wait_time_ms": 2623.499, "learner_dequeue_time_ms": 22536.282}}, "env_runners": {"episode_reward_max": -219.48096500045668, "episode_reward_min": -298.7160711565992, "episode_reward_mean": -259.9679439519935, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -298.7160711565992}, "policy_reward_max": {"default_policy": -219.48096500045668}, "policy_reward_mean": {"default_policy": -259.9679439519935}, "custom_metrics": {"num_consolidated_mean": 0.6850999999999999, "num_consolidated_min": 0.5, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0446, "num_overloaded_min": 0.88, "num_overloaded_max": 1.21, "num_moves_mean": 9.985700000000001, "num_moves_min": 9.69, "num_moves_max": 10.31, "mean_accuracy_mean": 41.05478, "mean_accuracy_min": 40.846666666666664, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.967199999999999, "num_model_switches_min": 5.54, "num_model_switches_max": 6.42, "num_slav_mean": 0.15561833333333333, "num_slav_min": 0.13955, "num_slav_max": 0.17346666666666669, "cpu_conserved_cost_mean": 2.7722, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5727977239167897, "mean_cluster_cpu_util_min": 0.5490237249422946, "mean_cluster_cpu_util_max": 0.5948422582341647, "mean_cluster_mem_util_mean": 0.3669960208046299, "mean_cluster_mem_util_min": 0.35540084065271677, "mean_cluster_mem_util_max": 0.37758242522747504, "reward_consolidation_mean_mean": -0.5590994395199366, "reward_consolidation_mean_min": -0.8423823448780042, "reward_consolidation_mean_max": -0.33754439672241004, "reward_illegal_mean_mean": -1.7409999999999994, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.4666666666666666, "reward_accuracy_mean_mean": 0.9481666666666669, "reward_accuracy_mean_min": 0.5333333333333321, "reward_accuracy_mean_max": 1.5083333333333346, "reward_sla_mean_mean": -1.2477466666666666, "reward_sla_mean_min": -2.0133333333333336, "reward_sla_mean_max": -0.6486666666666667, "reward_consolidation_sum_mean": -55.90994395199366, "reward_consolidation_sum_min": -84.23823448780043, "reward_consolidation_sum_max": -33.754439672241006, "reward_illegal_sum_mean": -174.10000000000002, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -146.66666666666666, "reward_accuracy_sum_mean": 94.81666666666669, "reward_accuracy_sum_min": 53.33333333333321, "reward_accuracy_sum_max": 150.83333333333346, "reward_sla_sum_mean": -124.77466666666668, "reward_sla_sum_min": -201.33333333333334, "reward_sla_sum_max": -64.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4575.0, "global_timestep_min": 2800, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-283.65726644125624, -298.7160711565992, -276.1190898291145, -257.3701666209752, -255.0611166956043, -263.1738249718236, -250.6390051478876, -252.88568034359824, -271.74430838587824, -257.45288312163024, -256.2132626641077, -265.9393554479271, -242.18777300557412, -256.1592890432238, -259.9774284931004, -287.59616497608835, -273.7229888208595, -253.19157452252585, -257.9553078071215, -260.914621219044, -245.4419172073471, -263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28586598856169393, "mean_inference_ms": 2.4284111614064323, "mean_action_processing_ms": 0.10719968788816919, "mean_env_wait_ms": 2.064025921999082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075910091400146484, "StateBufferConnector_ms": 0.003939628601074219, "ViewRequirementAgentConnector_ms": 0.10133981704711914}, "num_episodes": 21, "episode_return_max": -219.48096500045668, "episode_return_min": -298.7160711565992, "episode_return_mean": -259.9679439519935, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 64900, "num_env_steps_sampled": 65400, "num_env_steps_trained": 64900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.8668171562761, "num_env_steps_trained_throughput_per_sec": 212.52714178276545, "timesteps_total": 65400, "num_env_steps_sampled_lifetime": 65400, "num_agent_steps_sampled_lifetime": 65400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 65400, "timers": {"training_iteration_time_ms": 10316.924, "restore_workers_time_ms": 0.014, "training_step_time_ms": 729.538, "sample_time_ms": 713.944, "synch_weights_time_ms": 14.023}, "counters": {"num_env_steps_sampled": 65400, "num_env_steps_trained": 64900, "num_agent_steps_sampled": 65400, "num_agent_steps_trained": 64900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 436, "num_samples_added_to_queue": 64900}, "done": false, "training_iteration": 32, "trial_id": "13390_00000", "date": "2024-10-13_00-43-58", "timestamp": 1728776638, "time_this_iter_s": 10.3611581325531, "time_total_s": 330.98966789245605, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3dea0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.98966789245605, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.393333333333334, "ram_util_percent": 54.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -475162.625, "policy_loss": -478002.0625, "entropy": 29.773733139038086, "entropy_coeff": 0.01, "var_gnorm": 16.034156799316406, "vf_loss": 300319.5625, "vf_explained_var": 0.019040048122406006}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363635976}}, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67100, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 450, "num_samples_added_to_queue": 67100, "learner_queue": {"size_count": 122, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.317, "learner_load_time_ms": 0.453, "learner_load_wait_time_ms": 2658.383, "learner_dequeue_time_ms": 22526.455}}, "env_runners": {"episode_reward_max": -219.48096500045668, "episode_reward_min": -292.2478662158457, "episode_reward_mean": -259.06705382436246, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -292.2478662158457}, "policy_reward_max": {"default_policy": -219.48096500045668}, "policy_reward_mean": {"default_policy": -259.06705382436246}, "custom_metrics": {"num_consolidated_mean": 0.6801999999999999, "num_consolidated_min": 0.5, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0401999999999998, "num_overloaded_min": 0.87, "num_overloaded_max": 1.24, "num_moves_mean": 9.9739, "num_moves_min": 9.69, "num_moves_max": 10.31, "mean_accuracy_mean": 41.05972, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.9674000000000005, "num_model_switches_min": 5.47, "num_model_switches_max": 6.33, "num_slav_mean": 0.15607666666666667, "num_slav_min": 0.13955, "num_slav_max": 0.17298333333333332, "cpu_conserved_cost_mean": 2.7429999999999994, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5719943746959626, "mean_cluster_cpu_util_min": 0.5490237249422946, "mean_cluster_cpu_util_max": 0.5948422582341647, "mean_cluster_mem_util_mean": 0.3666117767085737, "mean_cluster_mem_util_min": 0.35540084065271677, "mean_cluster_mem_util_max": 0.37758242522747504, "reward_consolidation_mean_mean": -0.5649372049102929, "reward_consolidation_mean_min": -0.8423823448780042, "reward_consolidation_mean_max": -0.29599805050412753, "reward_illegal_mean_mean": -1.7336666666666667, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.9561666666666668, "reward_accuracy_mean_min": 0.5333333333333321, "reward_accuracy_mean_max": 1.5083333333333346, "reward_sla_mean_mean": -1.2482333333333333, "reward_sla_mean_min": -2.0133333333333336, "reward_sla_mean_max": -0.6486666666666667, "reward_consolidation_sum_mean": -56.49372049102928, "reward_consolidation_sum_min": -84.23823448780043, "reward_consolidation_sum_max": -29.59980505041275, "reward_illegal_sum_mean": -173.36666666666665, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 95.61666666666672, "reward_accuracy_sum_min": 53.33333333333321, "reward_accuracy_sum_max": 150.83333333333346, "reward_sla_sum_mean": -124.82333333333334, "reward_sla_sum_min": -201.33333333333334, "reward_sla_sum_max": -64.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5275.0, "global_timestep_min": 3500, "global_timestep_max": 6900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-263.63752779554653, -241.21780438027332, -240.86715708672216, -264.2509031648848, -263.1579243961129, -264.112686953608, -243.45786347436697, -271.65016905784506, -232.35411983307438, -260.720424015352, -283.0715678211336, -258.9120046300527, -234.48212860580574, -267.5608912851441, -258.80877273142613, -278.5318102896829, -244.6702549575068, -259.0447165615767, -262.1429985683388, -259.0610070364615, -251.07748332267195, -250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2857500048788238, "mean_inference_ms": 2.4264011609955163, "mean_action_processing_ms": 0.10711875636272815, "mean_env_wait_ms": 2.062716128327695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007460832595825195, "StateBufferConnector_ms": 0.0038733482360839844, "ViewRequirementAgentConnector_ms": 0.09840106964111328}, "num_episodes": 21, "episode_return_max": -219.48096500045668, "episode_return_min": -292.2478662158457, "episode_return_mean": -259.06705382436246, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67100, "num_env_steps_sampled": 67500, "num_env_steps_trained": 67100, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 197.96271008330174, "num_env_steps_trained_throughput_per_sec": 207.3895058015542, "timesteps_total": 67500, "num_env_steps_sampled_lifetime": 67500, "num_agent_steps_sampled_lifetime": 67500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 67500, "timers": {"training_iteration_time_ms": 10337.161, "restore_workers_time_ms": 0.015, "training_step_time_ms": 743.911, "sample_time_ms": 727.793, "synch_weights_time_ms": 14.488}, "counters": {"num_env_steps_sampled": 67500, "num_env_steps_trained": 67100, "num_agent_steps_sampled": 67500, "num_agent_steps_trained": 67100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 450, "num_samples_added_to_queue": 67100}, "done": false, "training_iteration": 33, "trial_id": "13390_00000", "date": "2024-10-13_00-44-09", "timestamp": 1728776649, "time_this_iter_s": 10.620091676712036, "time_total_s": 341.6097595691681, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f240b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 341.6097595691681, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.580000000000002, "ram_util_percent": 54.11333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -465276.28125, "policy_loss": -467981.875, "entropy": 29.76776123046875, "entropy_coeff": 0.01, "var_gnorm": 16.037492752075195, "vf_loss": 286932.34375, "vf_explained_var": 0.02160167694091797}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 126.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454545325}}, "num_env_steps_sampled": 69600, "num_env_steps_trained": 69300, "num_agent_steps_sampled": 69600, "num_agent_steps_trained": 69300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 464, "num_samples_added_to_queue": 69300, "learner_queue": {"size_count": 126, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.147, "learner_load_time_ms": 0.453, "learner_load_wait_time_ms": 2592.761, "learner_dequeue_time_ms": 22526.455}}, "env_runners": {"episode_reward_max": -219.48096500045668, "episode_reward_min": -292.2478662158457, "episode_reward_mean": -259.13649904048236, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -292.2478662158457}, "policy_reward_max": {"default_policy": -219.48096500045668}, "policy_reward_mean": {"default_policy": -259.13649904048236}, "custom_metrics": {"num_consolidated_mean": 0.6842999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0503, "num_overloaded_min": 0.87, "num_overloaded_max": 1.24, "num_moves_mean": 9.972800000000001, "num_moves_min": 9.69, "num_moves_max": 10.19, "mean_accuracy_mean": 41.066876666666666, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.9802, "num_model_switches_min": 5.47, "num_model_switches_max": 6.3, "num_slav_mean": 0.15628316666666664, "num_slav_min": 0.13955, "num_slav_max": 0.17298333333333332, "cpu_conserved_cost_mean": 2.764199999999999, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5726732177388443, "mean_cluster_cpu_util_min": 0.5520737100931956, "mean_cluster_cpu_util_max": 0.5948422582341647, "mean_cluster_mem_util_mean": 0.36692908038943434, "mean_cluster_mem_util_min": 0.35761486068055925, "mean_cluster_mem_util_max": 0.37758242522747504, "reward_consolidation_mean_mean": -0.5550016570714917, "reward_consolidation_mean_min": -0.8266063541381097, "reward_consolidation_mean_max": -0.29599805050412753, "reward_illegal_mean_mean": -1.7504999999999995, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.9357500000000003, "reward_accuracy_mean_min": 0.5333333333333321, "reward_accuracy_mean_max": 1.3833333333333349, "reward_sla_mean_mean": -1.2216133333333332, "reward_sla_mean_min": -1.8246666666666667, "reward_sla_mean_max": -0.588, "reward_consolidation_sum_mean": -55.50016570714917, "reward_consolidation_sum_min": -82.66063541381097, "reward_consolidation_sum_max": -29.59980505041275, "reward_illegal_sum_mean": -175.05, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 93.57500000000002, "reward_accuracy_sum_min": 53.33333333333321, "reward_accuracy_sum_max": 138.33333333333348, "reward_sla_sum_mean": -122.16133333333333, "reward_sla_sum_min": -182.46666666666667, "reward_sla_sum_max": -58.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5975.0, "global_timestep_min": 4200, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-250.14670870267108, -279.9670321971426, -250.76194218526288, -250.8072984251727, -251.62124645892334, -249.80660087118102, -259.5386030643637, -258.2460202869414, -259.91263517012396, -275.85917024581903, -267.33272411587296, -259.81655853056736, -243.20934234975147, -292.2478662158457, -271.14816777848836, -264.97785799140996, -265.69296049224766, -253.92568156203347, -249.9281062475249, -283.1310609522069, -258.6767827225927, -274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855400612126137, "mean_inference_ms": 2.4241646589395924, "mean_action_processing_ms": 0.10702815759161229, "mean_env_wait_ms": 2.061074915608613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007314920425415039, "StateBufferConnector_ms": 0.003822803497314453, "ViewRequirementAgentConnector_ms": 0.09740710258483887}, "num_episodes": 21, "episode_return_max": -219.48096500045668, "episode_return_min": -292.2478662158457, "episode_return_mean": -259.13649904048236, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69600, "num_agent_steps_trained": 69300, "num_env_steps_sampled": 69600, "num_env_steps_trained": 69300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.26927948093265, "num_env_steps_trained_throughput_per_sec": 212.94876898002468, "timesteps_total": 69600, "num_env_steps_sampled_lifetime": 69600, "num_agent_steps_sampled_lifetime": 69600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 69600, "timers": {"training_iteration_time_ms": 10341.605, "restore_workers_time_ms": 0.016, "training_step_time_ms": 743.524, "sample_time_ms": 726.286, "synch_weights_time_ms": 15.743}, "counters": {"num_env_steps_sampled": 69600, "num_env_steps_trained": 69300, "num_agent_steps_sampled": 69600, "num_agent_steps_trained": 69300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 464, "num_samples_added_to_queue": 69300}, "done": false, "training_iteration": 34, "trial_id": "13390_00000", "date": "2024-10-13_00-44-19", "timestamp": 1728776659, "time_this_iter_s": 10.34496021270752, "time_total_s": 351.9547197818756, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3e2f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 351.9547197818756, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 17.10666666666667, "ram_util_percent": 54.06000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -475350.46875, "policy_loss": -478168.96875, "entropy": 29.75694465637207, "entropy_coeff": 0.01, "var_gnorm": 16.041643142700195, "vf_loss": 298216.4375, "vf_explained_var": 0.023863554000854492}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 130.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 71700, "num_env_steps_trained": 71500, "num_agent_steps_sampled": 71700, "num_agent_steps_trained": 71500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 478, "num_samples_added_to_queue": 71500, "learner_queue": {"size_count": 130, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.257, "learner_load_time_ms": 0.441, "learner_load_wait_time_ms": 2649.32, "learner_dequeue_time_ms": 22546.348}}, "env_runners": {"episode_reward_max": -219.48096500045668, "episode_reward_min": -291.6469158366079, "episode_reward_mean": -259.11820335678806, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -291.6469158366079}, "policy_reward_max": {"default_policy": -219.48096500045668}, "policy_reward_mean": {"default_policy": -259.11820335678806}, "custom_metrics": {"num_consolidated_mean": 0.6831, "num_consolidated_min": 0.54, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0497, "num_overloaded_min": 0.87, "num_overloaded_max": 1.24, "num_moves_mean": 9.9694, "num_moves_min": 9.61, "num_moves_max": 10.22, "mean_accuracy_mean": 41.06231666666667, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.29633333333333, "num_model_switches_mean": 5.995900000000001, "num_model_switches_min": 5.47, "num_model_switches_max": 6.3, "num_slav_mean": 0.15618633333333334, "num_slav_min": 0.13955, "num_slav_max": 0.17298333333333332, "cpu_conserved_cost_mean": 2.7662000000000004, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5728845841405671, "mean_cluster_cpu_util_min": 0.5520737100931956, "mean_cluster_cpu_util_max": 0.5956324607522956, "mean_cluster_mem_util_mean": 0.36708968736904046, "mean_cluster_mem_util_min": 0.35761486068055925, "mean_cluster_mem_util_max": 0.37758242522747504, "reward_consolidation_mean_mean": -0.5545620335678821, "reward_consolidation_mean_min": -0.8266063541381097, "reward_consolidation_mean_max": -0.29599805050412753, "reward_illegal_mean_mean": -1.7494999999999998, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.9376666666666668, "reward_accuracy_mean_min": 0.5583333333333339, "reward_accuracy_mean_max": 1.3833333333333349, "reward_sla_mean_mean": -1.2247866666666665, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.588, "reward_consolidation_sum_mean": -55.45620335678821, "reward_consolidation_sum_min": -82.66063541381097, "reward_consolidation_sum_max": -29.59980505041275, "reward_illegal_sum_mean": -174.95, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 93.76666666666668, "reward_accuracy_sum_min": 55.833333333333385, "reward_accuracy_sum_max": 138.33333333333348, "reward_sla_sum_mean": -122.47866666666665, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -58.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5505.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-274.5196046178683, -258.4009473331502, -268.75327911297927, -260.1099363367754, -283.1609735295013, -239.86909135215797, -258.92211763989144, -272.8979317067227, -238.6814584665993, -279.6602363763745, -244.67430016144246, -231.38519601571775, -243.0907002954703, -276.07325535349844, -220.9947881446281, -268.70700904687897, -268.69396874714414, -285.12371074354974, -264.50127631057904, -253.79054799110514, -257.02082000670146, -261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28531354361378747, "mean_inference_ms": 2.421984924805197, "mean_action_processing_ms": 0.10693542165341735, "mean_env_wait_ms": 2.059366834863729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0071604251861572266, "StateBufferConnector_ms": 0.003793478012084961, "ViewRequirementAgentConnector_ms": 0.09783387184143066}, "num_episodes": 21, "episode_return_max": -219.48096500045668, "episode_return_min": -291.6469158366079, "episode_return_mean": -259.11820335678806, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71700, "num_agent_steps_trained": 71500, "num_env_steps_sampled": 71700, "num_env_steps_trained": 71500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 206.65915395406358, "num_env_steps_trained_throughput_per_sec": 216.50006604711425, "timesteps_total": 71700, "num_env_steps_sampled_lifetime": 71700, "num_agent_steps_sampled_lifetime": 71700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 71700, "timers": {"training_iteration_time_ms": 10321.341, "restore_workers_time_ms": 0.014, "training_step_time_ms": 717.937, "sample_time_ms": 700.96, "synch_weights_time_ms": 15.277}, "counters": {"num_env_steps_sampled": 71700, "num_env_steps_trained": 71500, "num_agent_steps_sampled": 71700, "num_agent_steps_trained": 71500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 478, "num_samples_added_to_queue": 71500}, "done": false, "training_iteration": 35, "trial_id": "13390_00000", "date": "2024-10-13_00-44-29", "timestamp": 1728776669, "time_this_iter_s": 10.173294305801392, "time_total_s": 362.128014087677, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f241cf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 362.128014087677, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.114285714285717, "ram_util_percent": 54.23571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -474872.0, "policy_loss": -477677.59375, "entropy": 29.74989128112793, "entropy_coeff": 0.01, "var_gnorm": 16.044784545898438, "vf_loss": 296920.8125, "vf_explained_var": 0.025614023208618164}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 133.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 73800, "num_env_steps_trained": 73150, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 492, "num_samples_added_to_queue": 73700, "learner_queue": {"size_count": 133, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.815, "learner_load_time_ms": 0.441, "learner_load_wait_time_ms": 2621.923, "learner_dequeue_time_ms": 22546.348}}, "env_runners": {"episode_reward_max": -219.48096500045668, "episode_reward_min": -293.1937220140729, "episode_reward_mean": -258.52894340369784, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -293.1937220140729}, "policy_reward_max": {"default_policy": -219.48096500045668}, "policy_reward_mean": {"default_policy": -258.52894340369784}, "custom_metrics": {"num_consolidated_mean": 0.6816, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0627000000000002, "num_overloaded_min": 0.87, "num_overloaded_max": 1.24, "num_moves_mean": 9.9662, "num_moves_min": 9.61, "num_moves_max": 10.35, "mean_accuracy_mean": 41.06269666666666, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.25833333333334, "num_model_switches_mean": 6.0135000000000005, "num_model_switches_min": 5.47, "num_model_switches_max": 6.36, "num_slav_mean": 0.15648216666666667, "num_slav_min": 0.13955, "num_slav_max": 0.17193333333333327, "cpu_conserved_cost_mean": 2.7704000000000004, "cpu_conserved_cost_min": 2.06, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5734060350411345, "mean_cluster_cpu_util_min": 0.5520737100931956, "mean_cluster_cpu_util_max": 0.5956324607522956, "mean_cluster_mem_util_mean": 0.3672140468584058, "mean_cluster_mem_util_min": 0.35761486068055925, "mean_cluster_mem_util_max": 0.3774847448262005, "reward_consolidation_mean_mean": -0.541902767370313, "reward_consolidation_mean_min": -0.7749040482500229, "reward_consolidation_mean_max": -0.2639526028815986, "reward_illegal_mean_mean": -1.7711666666666661, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.9153333333333336, "reward_accuracy_mean_min": 0.4500000000000003, "reward_accuracy_mean_max": 1.3833333333333349, "reward_sla_mean_mean": -1.1875533333333335, "reward_sla_mean_min": -1.8706666666666667, "reward_sla_mean_max": -0.588, "reward_consolidation_sum_mean": -54.19027673703129, "reward_consolidation_sum_min": -77.49040482500229, "reward_consolidation_sum_max": -26.39526028815986, "reward_illegal_sum_mean": -177.11666666666665, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 91.53333333333336, "reward_accuracy_sum_min": 45.00000000000003, "reward_accuracy_sum_max": 138.33333333333348, "reward_sla_sum_mean": -118.75533333333333, "reward_sla_sum_min": -187.06666666666666, "reward_sla_sum_max": -58.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4567.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-261.6947394072313, -249.2052484084192, -268.2172987297815, -229.24797892107583, -219.48096500045668, -271.6228852538912, -256.69626854305625, -261.6500593987022, -264.3502787169878, -243.80005482957128, -286.62875811020734, -248.5500959517497, -276.2763044868866, -254.50561393889546, -263.5249687776051, -266.6480489810837, -269.01155685521945, -243.635517377928, -277.3942032958664, -277.89227512260476, -258.59229644521605, -233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28508404677621985, "mean_inference_ms": 2.419720203109081, "mean_action_processing_ms": 0.10685211244203542, "mean_env_wait_ms": 2.0577049426467235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006994962692260742, "StateBufferConnector_ms": 0.003833770751953125, "ViewRequirementAgentConnector_ms": 0.09874105453491211}, "num_episodes": 21, "episode_return_max": -219.48096500045668, "episode_return_min": -293.1937220140729, "episode_return_mean": -258.52894340369784, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73150, "num_env_steps_sampled": 73800, "num_env_steps_trained": 73150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 208.5978505799838, "num_env_steps_trained_throughput_per_sec": 163.89831116998727, "timesteps_total": 73800, "num_env_steps_sampled_lifetime": 73800, "num_agent_steps_sampled_lifetime": 73800, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 73800, "timers": {"training_iteration_time_ms": 10270.107, "restore_workers_time_ms": 0.015, "training_step_time_ms": 718.603, "sample_time_ms": 702.468, "synch_weights_time_ms": 14.675}, "counters": {"num_env_steps_sampled": 73800, "num_env_steps_trained": 73150, "num_agent_steps_sampled": 73800, "num_agent_steps_trained": 73150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 492, "num_samples_added_to_queue": 73700}, "done": false, "training_iteration": 36, "trial_id": "13390_00000", "date": "2024-10-13_00-44-39", "timestamp": 1728776679, "time_this_iter_s": 10.079230308532715, "time_total_s": 372.2072443962097, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3e350>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.2072443962097, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 16.840000000000003, "ram_util_percent": 54.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -446481.46875, "policy_loss": -448931.4375, "entropy": 29.73691749572754, "entropy_coeff": 0.01, "var_gnorm": 16.050504684448242, "vf_loss": 261352.484375, "vf_explained_var": 0.030329406261444092}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 138.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 76050, "num_env_steps_trained": 75900, "num_agent_steps_sampled": 76050, "num_agent_steps_trained": 75900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 507, "num_samples_added_to_queue": 75900, "learner_queue": {"size_count": 138, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.238, "learner_load_time_ms": 0.423, "learner_load_wait_time_ms": 2492.543, "learner_dequeue_time_ms": 22345.723}}, "env_runners": {"episode_reward_max": -225.89154101556528, "episode_reward_min": -304.0076700478236, "episode_reward_mean": -256.35428438271026, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.0076700478236}, "policy_reward_max": {"default_policy": -225.89154101556528}, "policy_reward_mean": {"default_policy": -256.35428438271026}, "custom_metrics": {"num_consolidated_mean": 0.6808999999999998, "num_consolidated_min": 0.48, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0667, "num_overloaded_min": 0.87, "num_overloaded_max": 1.24, "num_moves_mean": 9.975900000000001, "num_moves_min": 9.61, "num_moves_max": 10.35, "mean_accuracy_mean": 41.06029, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.296333333333344, "num_model_switches_mean": 6.0279, "num_model_switches_min": 5.47, "num_model_switches_max": 6.39, "num_slav_mean": 0.15605983333333331, "num_slav_min": 0.1408833333333333, "num_slav_max": 0.17173333333333332, "cpu_conserved_cost_mean": 2.7638, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5733515467590324, "mean_cluster_cpu_util_min": 0.5479808773703783, "mean_cluster_cpu_util_max": 0.5956324607522956, "mean_cluster_mem_util_mean": 0.36714045290837843, "mean_cluster_mem_util_min": 0.3572192865753896, "mean_cluster_mem_util_max": 0.3774847448262005, "reward_consolidation_mean_mean": -0.5281461771604374, "reward_consolidation_mean_min": -0.8764100338115692, "reward_consolidation_mean_max": -0.2639526028815986, "reward_illegal_mean_mean": -1.777833333333333, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.8849166666666668, "reward_accuracy_mean_min": 0.4166666666666653, "reward_accuracy_mean_max": 1.3833333333333349, "reward_sla_mean_mean": -1.14248, "reward_sla_mean_min": -1.988666666666667, "reward_sla_mean_max": -0.5586666666666666, "reward_consolidation_sum_mean": -52.81461771604374, "reward_consolidation_sum_min": -87.64100338115692, "reward_consolidation_sum_max": -26.39526028815986, "reward_illegal_sum_mean": -177.78333333333327, "reward_illegal_sum_min": -206.66666666666663, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 88.49166666666667, "reward_accuracy_sum_min": 41.66666666666653, "reward_accuracy_sum_max": 138.33333333333348, "reward_sla_sum_mean": -114.248, "reward_sla_sum_min": -198.8666666666667, "reward_sla_sum_max": -55.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3629.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-233.8649639038653, -274.19040482500236, -284.935700143166, -233.46688293886464, -245.60788632002175, -256.58703280636024, -252.5787992323857, -267.64459167199715, -269.73485942307093, -236.99135520424, -261.5447287459258, -269.4017789149834, -252.9790002741478, -249.9950044168263, -245.56647171707928, -274.4147735234092, -278.0935697097081, -262.64475006853695, -240.8907216180814, -246.94110694812503, -264.5912607755337, -257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28480344251329315, "mean_inference_ms": 2.4165217927074965, "mean_action_processing_ms": 0.10674084662335864, "mean_env_wait_ms": 2.055552926545141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069696903228759766, "StateBufferConnector_ms": 0.003815174102783203, "ViewRequirementAgentConnector_ms": 0.09802746772766113}, "num_episodes": 21, "episode_return_max": -225.89154101556528, "episode_return_min": -304.0076700478236, "episode_return_mean": -256.35428438271026, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76050, "num_agent_steps_trained": 75900, "num_env_steps_sampled": 76050, "num_env_steps_trained": 75900, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 211.87190533181183, "num_env_steps_trained_throughput_per_sec": 258.95455096110334, "timesteps_total": 76050, "num_env_steps_sampled_lifetime": 76050, "num_agent_steps_sampled_lifetime": 76050, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 76050, "timers": {"training_iteration_time_ms": 10315.296, "restore_workers_time_ms": 0.015, "training_step_time_ms": 696.247, "sample_time_ms": 679.116, "synch_weights_time_ms": 15.548}, "counters": {"num_env_steps_sampled": 76050, "num_env_steps_trained": 75900, "num_agent_steps_sampled": 76050, "num_agent_steps_trained": 75900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 507, "num_samples_added_to_queue": 75900}, "done": false, "training_iteration": 37, "trial_id": "13390_00000", "date": "2024-10-13_00-44-50", "timestamp": 1728776690, "time_this_iter_s": 10.638061285018921, "time_total_s": 382.84530568122864, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c09bd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.84530568122864, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.133333333333333, "ram_util_percent": 54.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -467363.4375, "policy_loss": -470113.8125, "entropy": 29.73219871520996, "entropy_coeff": 0.01, "var_gnorm": 16.053720474243164, "vf_loss": 291391.6875, "vf_explained_var": 0.027787208557128906}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 141.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 78150, "num_env_steps_trained": 77550, "num_agent_steps_sampled": 78150, "num_agent_steps_trained": 77550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 521, "num_samples_added_to_queue": 78100, "learner_queue": {"size_count": 141, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.702, "learner_load_time_ms": 0.423, "learner_load_wait_time_ms": 2717.086, "learner_dequeue_time_ms": 22345.723}}, "env_runners": {"episode_reward_max": -225.43839897651443, "episode_reward_min": -304.0076700478236, "episode_reward_mean": -256.8645975509457, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.0076700478236}, "policy_reward_max": {"default_policy": -225.43839897651443}, "policy_reward_mean": {"default_policy": -256.8645975509457}, "custom_metrics": {"num_consolidated_mean": 0.6850999999999999, "num_consolidated_min": 0.48, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0688000000000002, "num_overloaded_min": 0.91, "num_overloaded_max": 1.21, "num_moves_mean": 9.9694, "num_moves_min": 9.61, "num_moves_max": 10.35, "mean_accuracy_mean": 41.060226666666665, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.296333333333344, "num_model_switches_mean": 6.0158000000000005, "num_model_switches_min": 5.57, "num_model_switches_max": 6.39, "num_slav_mean": 0.155088, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.16953333333333334, "cpu_conserved_cost_mean": 2.7942, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5743246026786012, "mean_cluster_cpu_util_min": 0.5479808773703783, "mean_cluster_cpu_util_max": 0.5956324607522956, "mean_cluster_mem_util_mean": 0.36752212352356556, "mean_cluster_mem_util_min": 0.3572192865753896, "mean_cluster_mem_util_max": 0.3774847448262005, "reward_consolidation_mean_mean": -0.5209593088427915, "reward_consolidation_mean_min": -0.8764100338115692, "reward_consolidation_mean_max": -0.2639526028815986, "reward_illegal_mean_mean": -1.781333333333333, "reward_illegal_mean_min": -2.0166666666666666, "reward_illegal_mean_max": -1.5166666666666664, "reward_accuracy_mean_mean": 0.8773333333333335, "reward_accuracy_mean_min": 0.4166666666666653, "reward_accuracy_mean_max": 1.358333333333334, "reward_sla_mean_mean": -1.1436866666666665, "reward_sla_mean_min": -1.988666666666667, "reward_sla_mean_max": -0.5586666666666666, "reward_consolidation_sum_mean": -52.09593088427915, "reward_consolidation_sum_min": -87.64100338115692, "reward_consolidation_sum_max": -26.39526028815986, "reward_illegal_sum_mean": -178.1333333333333, "reward_illegal_sum_min": -201.66666666666666, "reward_illegal_sum_max": -151.66666666666663, "reward_accuracy_sum_mean": 87.73333333333336, "reward_accuracy_sum_min": 41.66666666666653, "reward_accuracy_sum_max": 135.8333333333334, "reward_sla_sum_mean": -114.36866666666667, "reward_sla_sum_min": -198.8666666666667, "reward_sla_sum_max": -55.86666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2691.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-257.32288525389123, -247.08954887447055, -235.25824423527965, -253.06183252612016, -263.5337323707694, -265.9418471473391, -270.8462396052269, -262.8427091900454, -264.90430412135623, -259.17981662554445, -267.7748027658472, -242.2329708489444, -275.53226720277803, -234.33508178744387, -257.1657833013494, -259.55126260318605, -248.60766700173622, -233.52541350635093, -269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28469514786224664, "mean_inference_ms": 2.4144396917443616, "mean_action_processing_ms": 0.10668549459231215, "mean_env_wait_ms": 2.054484182088114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007073640823364258, "StateBufferConnector_ms": 0.0038585662841796875, "ViewRequirementAgentConnector_ms": 0.09917402267456055}, "num_episodes": 21, "episode_return_max": -225.43839897651443, "episode_return_min": -304.0076700478236, "episode_return_mean": -256.8645975509457, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78150, "num_agent_steps_trained": 77550, "num_env_steps_sampled": 78150, "num_env_steps_trained": 77550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 183.48158794872853, "num_env_steps_trained_throughput_per_sec": 144.16410481685813, "timesteps_total": 78150, "num_env_steps_sampled_lifetime": 78150, "num_agent_steps_sampled_lifetime": 78150, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 78150, "timers": {"training_iteration_time_ms": 10418.298, "restore_workers_time_ms": 0.019, "training_step_time_ms": 857.962, "sample_time_ms": 837.301, "synch_weights_time_ms": 18.684}, "counters": {"num_env_steps_sampled": 78150, "num_env_steps_trained": 77550, "num_agent_steps_sampled": 78150, "num_agent_steps_trained": 77550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 521, "num_samples_added_to_queue": 78100}, "done": false, "training_iteration": 38, "trial_id": "13390_00000", "date": "2024-10-13_00-45-02", "timestamp": 1728776702, "time_this_iter_s": 11.471132516860962, "time_total_s": 394.3164381980896, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3e3b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 394.3164381980896, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.25625, "ram_util_percent": 55.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -475218.34375, "policy_loss": -478001.59375, "entropy": 29.721099853515625, "entropy_coeff": 0.01, "var_gnorm": 16.05828285217285, "vf_loss": 294671.3125, "vf_explained_var": 0.03374141454696655}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 145.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 79950, "num_env_steps_trained": 79750, "num_agent_steps_sampled": 79950, "num_agent_steps_trained": 79750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 533, "num_samples_added_to_queue": 79750, "learner_queue": {"size_count": 145, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.891, "learner_load_time_ms": 0.45, "learner_load_wait_time_ms": 2867.063, "learner_dequeue_time_ms": 22308.275}}, "env_runners": {"episode_reward_max": -212.6803222760363, "episode_reward_min": -304.0076700478236, "episode_reward_mean": -256.56505638307584, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.0076700478236}, "policy_reward_max": {"default_policy": -212.6803222760363}, "policy_reward_mean": {"default_policy": -256.56505638307584}, "custom_metrics": {"num_consolidated_mean": 0.6825, "num_consolidated_min": 0.48, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0695000000000001, "num_overloaded_min": 0.91, "num_overloaded_max": 1.2, "num_moves_mean": 9.9776, "num_moves_min": 9.61, "num_moves_max": 10.35, "mean_accuracy_mean": 41.04749666666667, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.296333333333344, "num_model_switches_mean": 6.0100999999999996, "num_model_switches_min": 5.57, "num_model_switches_max": 6.39, "num_slav_mean": 0.1536395, "num_slav_min": 0.13425, "num_slav_max": 0.16953333333333334, "cpu_conserved_cost_mean": 2.7784000000000004, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.5742111193673748, "mean_cluster_cpu_util_min": 0.5479808773703783, "mean_cluster_cpu_util_max": 0.5956324607522956, "mean_cluster_mem_util_mean": 0.36744117765471174, "mean_cluster_mem_util_min": 0.3572192865753896, "mean_cluster_mem_util_max": 0.3774847448262005, "reward_consolidation_mean_mean": -0.521177230497426, "reward_consolidation_mean_min": -0.8764100338115692, "reward_consolidation_mean_max": -0.2639526028815986, "reward_illegal_mean_mean": -1.7825, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5166666666666666, "reward_accuracy_mean_mean": 0.8780000000000002, "reward_accuracy_mean_min": 0.4166666666666653, "reward_accuracy_mean_max": 1.358333333333334, "reward_sla_mean_mean": -1.1399733333333335, "reward_sla_mean_min": -1.988666666666667, "reward_sla_mean_max": -0.5053333333333333, "reward_consolidation_sum_mean": -52.117723049742615, "reward_consolidation_sum_min": -87.64100338115692, "reward_consolidation_sum_max": -26.39526028815986, "reward_illegal_sum_mean": -178.24999999999997, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -151.66666666666666, "reward_accuracy_sum_mean": 87.80000000000001, "reward_accuracy_sum_min": 41.66666666666653, "reward_accuracy_sum_max": 135.8333333333334, "reward_sla_sum_mean": -113.99733333333336, "reward_sla_sum_min": -198.8666666666667, "reward_sla_sum_max": -50.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1894.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-269.7125590179414, -277.41521520606784, -285.07158305157014, -270.7777757470529, -291.6469158366079, -269.41591885223414, -280.49620762131036, -268.2882542873679, -244.3819732553533, -246.30420360047495, -242.18651192543157, -264.2756252094182, -266.73254135063496, -262.0329312498097, -253.5131804197507, -238.06442474641327, -236.4533187121141, -266.2527003563921, -279.76987724268173, -257.8834445155198, -263.8296536598738, -261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2848038081423418, "mean_inference_ms": 2.4166878418451474, "mean_action_processing_ms": 0.10670450418725622, "mean_env_wait_ms": 2.0551894473274213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007109642028808594, "StateBufferConnector_ms": 0.0038628578186035156, "ViewRequirementAgentConnector_ms": 0.0993497371673584}, "num_episodes": 18, "episode_return_max": -212.6803222760363, "episode_return_min": -304.0076700478236, "episode_return_mean": -256.56505638307584, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79950, "num_agent_steps_trained": 79750, "num_env_steps_sampled": 79950, "num_env_steps_trained": 79750, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 174.34739297003617, "num_env_steps_trained_throughput_per_sec": 213.09125807448865, "timesteps_total": 79950, "num_env_steps_sampled_lifetime": 79950, "num_agent_steps_sampled_lifetime": 79950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 79950, "timers": {"training_iteration_time_ms": 10433.396, "restore_workers_time_ms": 0.015, "training_step_time_ms": 858.323, "sample_time_ms": 839.2, "synch_weights_time_ms": 17.39}, "counters": {"num_env_steps_sampled": 79950, "num_env_steps_trained": 79750, "num_agent_steps_sampled": 79950, "num_agent_steps_trained": 79750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 533, "num_samples_added_to_queue": 79750}, "done": false, "training_iteration": 39, "trial_id": "13390_00000", "date": "2024-10-13_00-45-12", "timestamp": 1728776712, "time_this_iter_s": 10.335670709609985, "time_total_s": 404.6521089076996, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3d420>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 404.6521089076996, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 28.899999999999995, "ram_util_percent": 58.306666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -451097.59375, "policy_loss": -453668.84375, "entropy": 29.71637725830078, "entropy_coeff": 0.01, "var_gnorm": 16.06031608581543, "vf_loss": 273468.25, "vf_explained_var": 0.03235906362533569}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 148.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 81900, "num_env_steps_trained": 81400, "num_agent_steps_sampled": 81900, "num_agent_steps_trained": 81400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 546, "num_samples_added_to_queue": 81400, "learner_queue": {"size_count": 148, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.606, "learner_load_time_ms": 0.45, "learner_load_wait_time_ms": 2991.128, "learner_dequeue_time_ms": 22308.275}}, "env_runners": {"episode_reward_max": -206.48768771512985, "episode_reward_min": -304.0076700478236, "episode_reward_mean": -254.52713028115375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.0076700478236}, "policy_reward_max": {"default_policy": -206.48768771512985}, "policy_reward_mean": {"default_policy": -254.52713028115375}, "custom_metrics": {"num_consolidated_mean": 0.6796000000000002, "num_consolidated_min": 0.48, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0743, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.979700000000001, "num_moves_min": 9.68, "num_moves_max": 10.35, "mean_accuracy_mean": 41.04566, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.296333333333344, "num_model_switches_mean": 6.0203999999999995, "num_model_switches_min": 5.68, "num_model_switches_max": 6.39, "num_slav_mean": 0.15231766666666668, "num_slav_min": 0.13425, "num_slav_max": 0.16953333333333334, "cpu_conserved_cost_mean": 2.7662, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.5740524857928836, "mean_cluster_cpu_util_min": 0.5479808773703783, "mean_cluster_cpu_util_max": 0.5943775026953436, "mean_cluster_mem_util_mean": 0.3673074865596027, "mean_cluster_mem_util_min": 0.3572192865753896, "mean_cluster_mem_util_max": 0.3762792459599873, "reward_consolidation_mean_mean": -0.5107213028115387, "reward_consolidation_mean_min": -0.8764100338115692, "reward_consolidation_mean_max": -0.2639526028815986, "reward_illegal_mean_mean": -1.7904999999999998, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333334, "reward_accuracy_mean_mean": 0.8560833333333335, "reward_accuracy_mean_min": 0.4166666666666653, "reward_accuracy_mean_max": 1.358333333333334, "reward_sla_mean_mean": -1.1001333333333332, "reward_sla_mean_min": -1.988666666666667, "reward_sla_mean_max": -0.42200000000000004, "reward_consolidation_sum_mean": -51.07213028115386, "reward_consolidation_sum_min": -87.64100338115692, "reward_consolidation_sum_max": -26.39526028815986, "reward_illegal_sum_mean": -179.04999999999993, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.33333333333334, "reward_accuracy_sum_mean": 85.60833333333333, "reward_accuracy_sum_min": 41.66666666666653, "reward_accuracy_sum_max": 135.8333333333334, "reward_sla_sum_mean": -110.01333333333334, "reward_sla_sum_min": -198.8666666666667, "reward_sla_sum_max": -42.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2282.0, "global_timestep_min": 600, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-261.4621493191994, -257.8194736361143, -251.40735934691864, -262.43013494166746, -229.95588656370882, -279.04030278107774, -236.7339455968806, -269.78592098449536, -266.5991592799049, -256.53559657619775, -239.5643638246672, -272.3527460477017, -248.25416552438384, -261.99596393432626, -253.90321666818974, -253.4252246489382, -233.07079716104647, -240.8619269548264, -293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2852328904410171, "mean_inference_ms": 2.4200092083444207, "mean_action_processing_ms": 0.1068046023548214, "mean_env_wait_ms": 2.0577059790365855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007227897644042969, "StateBufferConnector_ms": 0.003998279571533203, "ViewRequirementAgentConnector_ms": 0.10269045829772949}, "num_episodes": 21, "episode_return_max": -206.48768771512985, "episode_return_min": -304.0076700478236, "episode_return_mean": -254.52713028115375, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81900, "num_agent_steps_trained": 81400, "num_env_steps_sampled": 81900, "num_env_steps_trained": 81400, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 170.34111364435833, "num_env_steps_trained_throughput_per_sec": 144.1347884683032, "timesteps_total": 81900, "num_env_steps_sampled_lifetime": 81900, "num_agent_steps_sampled_lifetime": 81900, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 81900, "timers": {"training_iteration_time_ms": 10548.799, "restore_workers_time_ms": 0.015, "training_step_time_ms": 916.161, "sample_time_ms": 899.924, "synch_weights_time_ms": 14.783}, "counters": {"num_env_steps_sampled": 81900, "num_env_steps_trained": 81400, "num_agent_steps_sampled": 81900, "num_agent_steps_trained": 81400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 546, "num_samples_added_to_queue": 81400}, "done": false, "training_iteration": 40, "trial_id": "13390_00000", "date": "2024-10-13_00-45-23", "timestamp": 1728776723, "time_this_iter_s": 11.45952296257019, "time_total_s": 416.1116318702698, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f240d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.1116318702698, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 29.91176470588235, "ram_util_percent": 57.900000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -465737.21875, "policy_loss": -468453.375, "entropy": 29.71221923828125, "entropy_coeff": 0.01, "var_gnorm": 16.062246322631836, "vf_loss": 287957.3125, "vf_explained_var": 0.03378486633300781}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 83700, "num_env_steps_trained": 83050, "num_agent_steps_sampled": 83700, "num_agent_steps_trained": 83050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 558, "num_samples_added_to_queue": 83600, "learner_queue": {"size_count": 151, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 92.938, "learner_load_time_ms": 0.45, "learner_load_wait_time_ms": 3208.241, "learner_dequeue_time_ms": 22308.275}}, "env_runners": {"episode_reward_max": -206.48768771512985, "episode_reward_min": -304.0076700478236, "episode_reward_mean": -254.5621462426512, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.0076700478236}, "policy_reward_max": {"default_policy": -206.48768771512985}, "policy_reward_mean": {"default_policy": -254.5621462426512}, "custom_metrics": {"num_consolidated_mean": 0.6823, "num_consolidated_min": 0.48, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0724, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.9736, "num_moves_min": 9.68, "num_moves_max": 10.31, "mean_accuracy_mean": 41.046040000000005, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.296333333333344, "num_model_switches_mean": 6.0153, "num_model_switches_min": 5.68, "num_model_switches_max": 6.39, "num_slav_mean": 0.15144666666666667, "num_slav_min": 0.13425, "num_slav_max": 0.17139999999999997, "cpu_conserved_cost_mean": 2.7820000000000005, "cpu_conserved_cost_min": 1.86, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.5745921327642212, "mean_cluster_cpu_util_min": 0.5479808773703783, "mean_cluster_cpu_util_max": 0.5951218762235324, "mean_cluster_mem_util_mean": 0.3675686334998135, "mean_cluster_mem_util_min": 0.3572192865753896, "mean_cluster_mem_util_max": 0.3780613660337553, "reward_consolidation_mean_mean": -0.5139447957598466, "reward_consolidation_mean_min": -0.8764100338115692, "reward_consolidation_mean_max": -0.26958938743184385, "reward_illegal_mean_mean": -1.7873333333333334, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5333333333333334, "reward_accuracy_mean_mean": 0.8615833333333335, "reward_accuracy_mean_min": 0.4166666666666653, "reward_accuracy_mean_max": 1.358333333333334, "reward_sla_mean_mean": -1.1059266666666665, "reward_sla_mean_min": -1.988666666666667, "reward_sla_mean_max": -0.42200000000000004, "reward_consolidation_sum_mean": -51.39447957598466, "reward_consolidation_sum_min": -87.64100338115692, "reward_consolidation_sum_max": -26.958938743184383, "reward_illegal_sum_mean": -178.73333333333335, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -153.33333333333334, "reward_accuracy_sum_mean": 86.15833333333335, "reward_accuracy_sum_min": 41.66666666666653, "reward_accuracy_sum_max": 135.8333333333334, "reward_sla_sum_mean": -110.59266666666666, "reward_sla_sum_min": -198.8666666666667, "reward_sla_sum_max": -42.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2883.0, "global_timestep_min": 1200, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-293.1937220140729, -263.5058363032684, -242.72718328307275, -248.11338450759985, -231.47791282098152, -225.89154101556528, -241.91825215510656, -265.65140576928945, -241.18427305126545, -235.87726400438626, -241.07262176733977, -268.0667123579762, -243.06811965030903, -253.6299734990405, -238.1939352401838, -242.47091900453862, -242.3105425081481, -284.58248195193266, -246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28587896717340366, "mean_inference_ms": 2.426828423626929, "mean_action_processing_ms": 0.10698275166718635, "mean_env_wait_ms": 2.0619393654713694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007669925689697266, "StateBufferConnector_ms": 0.004228115081787109, "ViewRequirementAgentConnector_ms": 0.1091914176940918}, "num_episodes": 18, "episode_return_max": -206.48768771512985, "episode_return_min": -304.0076700478236, "episode_return_mean": -254.5621462426512, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83700, "num_agent_steps_trained": 83050, "num_env_steps_sampled": 83700, "num_env_steps_trained": 83050, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 162.54175767605471, "num_env_steps_trained_throughput_per_sec": 148.99661120305015, "timesteps_total": 83700, "num_env_steps_sampled_lifetime": 83700, "num_agent_steps_sampled_lifetime": 83700, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 83700, "timers": {"training_iteration_time_ms": 10643.06, "restore_workers_time_ms": 0.017, "training_step_time_ms": 954.1, "sample_time_ms": 931.223, "synch_weights_time_ms": 20.986}, "counters": {"num_env_steps_sampled": 83700, "num_env_steps_trained": 83050, "num_agent_steps_sampled": 83700, "num_agent_steps_trained": 83050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 558, "num_samples_added_to_queue": 83600}, "done": false, "training_iteration": 41, "trial_id": "13390_00000", "date": "2024-10-13_00-45-35", "timestamp": 1728776735, "time_this_iter_s": 11.118084192276001, "time_total_s": 427.2297160625458, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0bd90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 427.2297160625458, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.62, "ram_util_percent": 58.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -461219.8125, "policy_loss": -463906.84375, "entropy": 29.701091766357422, "entropy_coeff": 0.01, "var_gnorm": 16.0662899017334, "vf_loss": 285037.46875, "vf_explained_var": 0.03526175022125244}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 85500, "num_env_steps_trained": 85250, "num_agent_steps_sampled": 85500, "num_agent_steps_trained": 85250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 570, "num_samples_added_to_queue": 85250, "learner_queue": {"size_count": 155, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 113.114, "learner_load_time_ms": 0.48, "learner_load_wait_time_ms": 3186.468, "learner_dequeue_time_ms": 22607.286}}, "env_runners": {"episode_reward_max": -206.48768771512985, "episode_reward_min": -304.0076700478236, "episode_reward_mean": -254.96541280575093, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -304.0076700478236}, "policy_reward_max": {"default_policy": -206.48768771512985}, "policy_reward_mean": {"default_policy": -254.96541280575093}, "custom_metrics": {"num_consolidated_mean": 0.6783, "num_consolidated_min": 0.5, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0692999999999997, "num_overloaded_min": 0.87, "num_overloaded_max": 1.2, "num_moves_mean": 9.9623, "num_moves_min": 9.68, "num_moves_max": 10.31, "mean_accuracy_mean": 41.04414, "mean_accuracy_min": 40.78966666666666, "mean_accuracy_max": 41.28366666666667, "num_model_switches_mean": 6.007999999999999, "num_model_switches_min": 5.68, "num_model_switches_max": 6.39, "num_slav_mean": 0.15080266666666664, "num_slav_min": 0.13425, "num_slav_max": 0.17139999999999997, "cpu_conserved_cost_mean": 2.7716000000000003, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.574691781104337, "mean_cluster_cpu_util_min": 0.553933071491445, "mean_cluster_cpu_util_max": 0.5951218762235324, "mean_cluster_mem_util_mean": 0.3677328236764115, "mean_cluster_mem_util_min": 0.3594433343379547, "mean_cluster_mem_util_max": 0.3780613660337553, "reward_consolidation_mean_mean": -0.5173241280575102, "reward_consolidation_mean_min": -0.8764100338115692, "reward_consolidation_mean_max": -0.26958938743184385, "reward_illegal_mean_mean": -1.782166666666666, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.4499999999999997, "reward_accuracy_mean_mean": 0.8705833333333334, "reward_accuracy_mean_min": 0.4166666666666653, "reward_accuracy_mean_max": 1.3666666666666674, "reward_sla_mean_mean": -1.1207466666666666, "reward_sla_mean_min": -1.988666666666667, "reward_sla_mean_max": -0.42200000000000004, "reward_consolidation_sum_mean": -51.732412805751025, "reward_consolidation_sum_min": -87.64100338115692, "reward_consolidation_sum_max": -26.958938743184383, "reward_illegal_sum_mean": -178.2166666666666, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -144.99999999999997, "reward_accuracy_sum_mean": 87.05833333333334, "reward_accuracy_sum_min": 41.66666666666653, "reward_accuracy_sum_max": 136.66666666666674, "reward_sla_sum_mean": -112.07466666666666, "reward_sla_sum_min": -198.8666666666667, "reward_sla_sum_max": -42.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3478.0, "global_timestep_min": 1600, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-246.75411069481248, -304.0076700478236, -231.6026988333485, -239.0526759876938, -240.3760729842516, -297.87954552377465, -268.3589417892715, -252.69692345182605, -274.14907855859127, -290.8974382405799, -271.53087514088145, -256.73692771634813, -267.19784337019087, -234.61551372262312, -266.4894239848913, -262.7452679033779, -254.1521642450272, -243.9509214414084, -272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2866901009904386, "mean_inference_ms": 2.4340461513337046, "mean_action_processing_ms": 0.10723153107202965, "mean_env_wait_ms": 2.0673374368160715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007797718048095703, "StateBufferConnector_ms": 0.0042726993560791016, "ViewRequirementAgentConnector_ms": 0.11116194725036621}, "num_episodes": 18, "episode_return_max": -206.48768771512985, "episode_return_min": -304.0076700478236, "episode_return_mean": -254.96541280575093, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85500, "num_agent_steps_trained": 85250, "num_env_steps_sampled": 85500, "num_env_steps_trained": 85250, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 176.37693204037004, "num_env_steps_trained_throughput_per_sec": 215.57180582711894, "timesteps_total": 85500, "num_env_steps_sampled_lifetime": 85500, "num_agent_steps_sampled_lifetime": 85500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 85500, "timers": {"training_iteration_time_ms": 10628.444, "restore_workers_time_ms": 0.015, "training_step_time_ms": 822.019, "sample_time_ms": 803.392, "synch_weights_time_ms": 17.051}, "counters": {"num_env_steps_sampled": 85500, "num_env_steps_trained": 85250, "num_agent_steps_sampled": 85500, "num_agent_steps_trained": 85250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 570, "num_samples_added_to_queue": 85250}, "done": false, "training_iteration": 42, "trial_id": "13390_00000", "date": "2024-10-13_00-45-45", "timestamp": 1728776745, "time_this_iter_s": 10.222863674163818, "time_total_s": 437.4525797367096, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f242230>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.4525797367096, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.36, "ram_util_percent": 59.59333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -464751.09375, "policy_loss": -467382.0, "entropy": 29.692493438720703, "entropy_coeff": 0.01, "var_gnorm": 16.06922721862793, "vf_loss": 279421.3125, "vf_explained_var": 0.04171609878540039}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 87450, "num_env_steps_trained": 86900, "num_agent_steps_sampled": 87450, "num_agent_steps_trained": 86900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 583, "num_samples_added_to_queue": 87450, "learner_queue": {"size_count": 158, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 117.581, "learner_load_time_ms": 0.48, "learner_load_wait_time_ms": 2961.94, "learner_dequeue_time_ms": 22607.286}}, "env_runners": {"episode_reward_max": -206.48768771512985, "episode_reward_min": -292.80459959182417, "episode_reward_mean": -253.54395851229086, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -292.80459959182417}, "policy_reward_max": {"default_policy": -206.48768771512985}, "policy_reward_mean": {"default_policy": -253.54395851229086}, "custom_metrics": {"num_consolidated_mean": 0.6764000000000001, "num_consolidated_min": 0.5, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0634000000000001, "num_overloaded_min": 0.86, "num_overloaded_max": 1.2, "num_moves_mean": 9.9637, "num_moves_min": 9.68, "num_moves_max": 10.31, "mean_accuracy_mean": 41.037110000000006, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.28366666666667, "num_model_switches_mean": 6.007399999999999, "num_model_switches_min": 5.68, "num_model_switches_max": 6.37, "num_slav_mean": 0.14972283333333333, "num_slav_min": 0.13425, "num_slav_max": 0.17468333333333333, "cpu_conserved_cost_mean": 2.7538000000000005, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.574024227043436, "mean_cluster_cpu_util_min": 0.553933071491445, "mean_cluster_cpu_util_max": 0.5951218762235324, "mean_cluster_mem_util_mean": 0.3674788911492868, "mean_cluster_mem_util_min": 0.3594433343379547, "mean_cluster_mem_util_max": 0.3780613660337553, "reward_consolidation_mean_mean": -0.5200962517895763, "reward_consolidation_mean_min": -0.8334973651344848, "reward_consolidation_mean_max": -0.26958938743184385, "reward_illegal_mean_mean": -1.772333333333333, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.876916666666667, "reward_accuracy_mean_min": 0.433333333333333, "reward_accuracy_mean_max": 1.483333333333335, "reward_sla_mean_mean": -1.1199266666666665, "reward_sla_mean_min": -2.05, "reward_sla_mean_max": -0.42200000000000004, "reward_consolidation_sum_mean": -52.00962517895764, "reward_consolidation_sum_min": -83.34973651344848, "reward_consolidation_sum_max": -26.958938743184383, "reward_illegal_sum_mean": -177.23333333333332, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 87.69166666666669, "reward_accuracy_sum_min": 43.3333333333333, "reward_accuracy_sum_max": 148.33333333333348, "reward_sla_sum_mean": -111.99266666666666, "reward_sla_sum_min": -205.0, "reward_sla_sum_max": -42.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4067.0, "global_timestep_min": 2000, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-272.78830911693916, -272.32111547716937, -261.0457461390843, -234.89229035304146, -225.43839897651443, -251.9589387431843, -253.47522312589456, -273.699223247738, -243.69145877120823, -256.4148679521153, -260.5223521886136, -254.19224770781935, -239.39239087392247, -272.7964208474212, -252.50511133449083, -255.39854701635744, -274.976237472966, -269.19229035304124, -237.53562703707073, -228.2179323159399, -261.0517317006305, -212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2874510349229319, "mean_inference_ms": 2.4406825546317323, "mean_action_processing_ms": 0.10745740592036704, "mean_env_wait_ms": 2.0723816348335475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007754802703857422, "StateBufferConnector_ms": 0.004351615905761719, "ViewRequirementAgentConnector_ms": 0.11276626586914062}, "num_episodes": 18, "episode_return_max": -206.48768771512985, "episode_return_min": -292.80459959182417, "episode_return_mean": -253.54395851229086, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87450, "num_agent_steps_trained": 86900, "num_env_steps_sampled": 87450, "num_env_steps_trained": 86900, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 193.64320155715893, "num_env_steps_trained_throughput_per_sec": 163.85193977913448, "timesteps_total": 87450, "num_env_steps_sampled_lifetime": 87450, "num_agent_steps_sampled_lifetime": 87450, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 87450, "timers": {"training_iteration_time_ms": 10574.644, "restore_workers_time_ms": 0.015, "training_step_time_ms": 786.329, "sample_time_ms": 768.636, "synch_weights_time_ms": 15.782}, "counters": {"num_env_steps_sampled": 87450, "num_env_steps_trained": 86900, "num_agent_steps_sampled": 87450, "num_agent_steps_trained": 86900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 583, "num_samples_added_to_queue": 87450}, "done": false, "training_iteration": 43, "trial_id": "13390_00000", "date": "2024-10-13_00-45-55", "timestamp": 1728776755, "time_this_iter_s": 10.080051183700562, "time_total_s": 447.53263092041016, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c09990>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 447.53263092041016, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 24.093333333333337, "ram_util_percent": 59.033333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -435116.625, "policy_loss": -437428.375, "entropy": 29.680498123168945, "entropy_coeff": 0.01, "var_gnorm": 16.073328018188477, "vf_loss": 247500.96875, "vf_explained_var": 0.04594433307647705}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 162.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 89550, "num_env_steps_trained": 89100, "num_agent_steps_sampled": 89550, "num_agent_steps_trained": 89100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 597, "num_samples_added_to_queue": 89100, "learner_queue": {"size_count": 162, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.818, "learner_load_time_ms": 0.493, "learner_load_wait_time_ms": 2762.114, "learner_dequeue_time_ms": 22792.237}}, "env_runners": {"episode_reward_max": -206.48768771512985, "episode_reward_min": -292.80459959182417, "episode_reward_mean": -252.19752462761568, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -292.80459959182417}, "policy_reward_max": {"default_policy": -206.48768771512985}, "policy_reward_mean": {"default_policy": -252.19752462761568}, "custom_metrics": {"num_consolidated_mean": 0.6774, "num_consolidated_min": 0.5, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0627, "num_overloaded_min": 0.86, "num_overloaded_max": 1.2, "num_moves_mean": 9.9691, "num_moves_min": 9.72, "num_moves_max": 10.31, "mean_accuracy_mean": 41.04217666666666, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.28366666666667, "num_model_switches_mean": 6.011699999999999, "num_model_switches_min": 5.68, "num_model_switches_max": 6.37, "num_slav_mean": 0.14970666666666668, "num_slav_min": 0.13561666666666666, "num_slav_max": 0.17468333333333333, "cpu_conserved_cost_mean": 2.7544000000000004, "cpu_conserved_cost_min": 2.2, "cpu_conserved_cost_max": 3.32, "mean_cluster_cpu_util_mean": 0.5736795201789965, "mean_cluster_cpu_util_min": 0.553933071491445, "mean_cluster_cpu_util_max": 0.5951218762235324, "mean_cluster_mem_util_mean": 0.36730634241080407, "mean_cluster_mem_util_min": 0.3594433343379547, "mean_cluster_mem_util_max": 0.3780613660337553, "reward_consolidation_mean_mean": -0.517151912942825, "reward_consolidation_mean_min": -0.8334973651344848, "reward_consolidation_mean_max": -0.2842406104358951, "reward_illegal_mean_mean": -1.7711666666666666, "reward_illegal_mean_min": -1.9999999999999993, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.875916666666667, "reward_accuracy_mean_min": 0.4583333333333329, "reward_accuracy_mean_max": 1.4916666666666683, "reward_sla_mean_mean": -1.1095733333333333, "reward_sla_mean_min": -2.05, "reward_sla_mean_max": -0.42200000000000004, "reward_consolidation_sum_mean": -51.715191294282505, "reward_consolidation_sum_min": -83.34973651344848, "reward_consolidation_sum_max": -28.42406104358951, "reward_illegal_sum_mean": -177.11666666666667, "reward_illegal_sum_min": -199.99999999999994, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 87.59166666666668, "reward_accuracy_sum_min": 45.83333333333329, "reward_accuracy_sum_max": 149.16666666666683, "reward_sla_sum_mean": -110.95733333333332, "reward_sla_sum_min": -205.0, "reward_sla_sum_max": -42.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4778.0, "global_timestep_min": 2900, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-212.6803222760363, -248.35451277833616, -254.9197264613603, -273.21129184562415, -250.70671357641103, -273.4371988181181, -254.58647232629676, -266.9444850589417, -262.4462456974016, -248.03188644186548, -260.75245057723345, -269.5746900606172, -249.90917786103748, -249.91272350665562, -240.80433762831638, -206.48768771512985, -292.5015535045234, -254.32625727253324, -237.92219074598665, -242.18244539888494, -243.65652014986722, -246.2626884766517, -274.61804197508314, -241.9719851350939, -263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28807175003630997, "mean_inference_ms": 2.4477579587785665, "mean_action_processing_ms": 0.10762896405842501, "mean_env_wait_ms": 2.0766539728551825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007639169692993164, "StateBufferConnector_ms": 0.004292488098144531, "ViewRequirementAgentConnector_ms": 0.11043763160705566}, "num_episodes": 21, "episode_return_max": -206.48768771512985, "episode_return_min": -292.80459959182417, "episode_return_mean": -252.19752462761568, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89550, "num_agent_steps_trained": 89100, "num_env_steps_sampled": 89550, "num_env_steps_trained": 89100, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 200.4604927046172, "num_env_steps_trained_throughput_per_sec": 210.00623045245612, "timesteps_total": 89550, "num_env_steps_sampled_lifetime": 89550, "num_agent_steps_sampled_lifetime": 89550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 89550, "timers": {"training_iteration_time_ms": 10589.12, "restore_workers_time_ms": 0.013, "training_step_time_ms": 766.996, "sample_time_ms": 750.807, "synch_weights_time_ms": 14.59}, "counters": {"num_env_steps_sampled": 89550, "num_env_steps_trained": 89100, "num_agent_steps_sampled": 89550, "num_agent_steps_trained": 89100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 597, "num_samples_added_to_queue": 89100}, "done": false, "training_iteration": 44, "trial_id": "13390_00000", "date": "2024-10-13_00-46-06", "timestamp": 1728776766, "time_this_iter_s": 10.487239837646484, "time_total_s": 458.01987075805664, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f242290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 458.01987075805664, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.59333333333333, "ram_util_percent": 58.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -439290.5, "policy_loss": -441692.03125, "entropy": 29.66769027709961, "entropy_coeff": 0.01, "var_gnorm": 16.07763671875, "vf_loss": 256472.84375, "vf_explained_var": 0.045398831367492676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 166.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 91800, "num_env_steps_trained": 91300, "num_agent_steps_sampled": 91800, "num_agent_steps_trained": 91300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 612, "num_samples_added_to_queue": 91300, "learner_queue": {"size_count": 166, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.245, "learner_load_time_ms": 0.493, "learner_load_wait_time_ms": 2684.574, "learner_dequeue_time_ms": 22792.237}}, "env_runners": {"episode_reward_max": -216.7565688872641, "episode_reward_min": -292.80459959182417, "episode_reward_mean": -253.2964490541898, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -292.80459959182417}, "policy_reward_max": {"default_policy": -216.7565688872641}, "policy_reward_mean": {"default_policy": -253.2964490541898}, "custom_metrics": {"num_consolidated_mean": 0.6772, "num_consolidated_min": 0.5, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0610000000000002, "num_overloaded_min": 0.86, "num_overloaded_max": 1.2, "num_moves_mean": 9.9581, "num_moves_min": 9.72, "num_moves_max": 10.25, "mean_accuracy_mean": 41.047560000000004, "mean_accuracy_min": 40.80866666666666, "mean_accuracy_max": 41.315333333333335, "num_model_switches_mean": 6.0045, "num_model_switches_min": 5.67, "num_model_switches_max": 6.37, "num_slav_mean": 0.14940483333333332, "num_slav_min": 0.13561666666666666, "num_slav_max": 0.17468333333333333, "cpu_conserved_cost_mean": 2.7560000000000007, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.34, "mean_cluster_cpu_util_mean": 0.573918632641332, "mean_cluster_cpu_util_min": 0.553933071491445, "mean_cluster_cpu_util_max": 0.5951218762235324, "mean_cluster_mem_util_mean": 0.3673270769324607, "mean_cluster_mem_util_min": 0.3594433343379547, "mean_cluster_mem_util_max": 0.3780613660337553, "reward_consolidation_mean_mean": -0.526224490541899, "reward_consolidation_mean_min": -0.8334973651344848, "reward_consolidation_mean_max": -0.268596972189223, "reward_illegal_mean_mean": -1.7683333333333326, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.891166666666667, "reward_accuracy_mean_min": 0.433333333333333, "reward_accuracy_mean_max": 1.4916666666666683, "reward_sla_mean_mean": -1.1295733333333333, "reward_sla_mean_min": -2.05, "reward_sla_mean_max": -0.5433333333333333, "reward_consolidation_sum_mean": -52.62244905418989, "reward_consolidation_sum_min": -83.34973651344848, "reward_consolidation_sum_max": -26.8596972189223, "reward_illegal_sum_mean": -176.8333333333333, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 89.1166666666667, "reward_accuracy_sum_min": 43.3333333333333, "reward_accuracy_sum_max": 149.16666666666683, "reward_sla_sum_mean": -112.95733333333332, "reward_sla_sum_min": -205.0, "reward_sla_sum_max": -54.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5583.0, "global_timestep_min": 3900, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-263.6764537451643, -256.92346401047837, -272.0600322885253, -244.0555514941058, -286.2798653629413, -256.390788632002, -241.28529349051124, -264.5219226903041, -230.42657406561267, -252.87009046879265, -256.76622193792065, -266.38109598221075, -273.69362149319176, -238.5799049620762, -235.08335313290078, -243.05347406256644, -265.37249687776057, -252.69012153888312, -242.26605744920647, -264.8399951262602, -262.5484632489567, -265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2883952449854624, "mean_inference_ms": 2.4518739382554373, "mean_action_processing_ms": 0.10771768445969293, "mean_env_wait_ms": 2.0791195954891903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077304840087890625, "StateBufferConnector_ms": 0.004140377044677734, "ViewRequirementAgentConnector_ms": 0.10662102699279785}, "num_episodes": 24, "episode_return_max": -216.7565688872641, "episode_return_min": -292.80459959182417, "episode_return_mean": -253.2964490541898, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91800, "num_agent_steps_trained": 91300, "num_env_steps_sampled": 91800, "num_env_steps_trained": 91300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 210.53982836374655, "num_env_steps_trained_throughput_per_sec": 205.86116551121887, "timesteps_total": 91800, "num_env_steps_sampled_lifetime": 91800, "num_agent_steps_sampled_lifetime": 91800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 91800, "timers": {"training_iteration_time_ms": 10641.636, "restore_workers_time_ms": 0.015, "training_step_time_ms": 709.528, "sample_time_ms": 693.587, "synch_weights_time_ms": 14.459}, "counters": {"num_env_steps_sampled": 91800, "num_env_steps_trained": 91300, "num_agent_steps_sampled": 91800, "num_agent_steps_trained": 91300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 612, "num_samples_added_to_queue": 91300}, "done": false, "training_iteration": 45, "trial_id": "13390_00000", "date": "2024-10-13_00-46-16", "timestamp": 1728776776, "time_this_iter_s": 10.69784927368164, "time_total_s": 468.7177200317383, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069cc70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.7177200317383, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.019999999999996, "ram_util_percent": 58.28666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -466128.6875, "policy_loss": -468880.25, "entropy": 29.651973724365234, "entropy_coeff": 0.01, "var_gnorm": 16.08230209350586, "vf_loss": 291464.3125, "vf_explained_var": 0.043518006801605225}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 170.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 93900, "num_env_steps_trained": 93500, "num_agent_steps_sampled": 93900, "num_agent_steps_trained": 93500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 626, "num_samples_added_to_queue": 93500, "learner_queue": {"size_count": 170, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.583, "learner_load_time_ms": 0.463, "learner_load_wait_time_ms": 2658.558, "learner_dequeue_time_ms": 22487.95}}, "env_runners": {"episode_reward_max": -216.7565688872641, "episode_reward_min": -292.80459959182417, "episode_reward_mean": -253.02644003777135, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -292.80459959182417}, "policy_reward_max": {"default_policy": -216.7565688872641}, "policy_reward_mean": {"default_policy": -253.02644003777135}, "custom_metrics": {"num_consolidated_mean": 0.6755, "num_consolidated_min": 0.5, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0617, "num_overloaded_min": 0.86, "num_overloaded_max": 1.2, "num_moves_mean": 9.9644, "num_moves_min": 9.72, "num_moves_max": 10.25, "mean_accuracy_mean": 41.04401333333333, "mean_accuracy_min": 40.796, "mean_accuracy_max": 41.315333333333335, "num_model_switches_mean": 6.0075, "num_model_switches_min": 5.67, "num_model_switches_max": 6.36, "num_slav_mean": 0.1489895, "num_slav_min": 0.12949999999999998, "num_slav_max": 0.17468333333333333, "cpu_conserved_cost_mean": 2.7464, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.5735679924656601, "mean_cluster_cpu_util_min": 0.553933071491445, "mean_cluster_cpu_util_max": 0.5919544844754874, "mean_cluster_mem_util_mean": 0.3673020373288556, "mean_cluster_mem_util_min": 0.35952212983294585, "mean_cluster_mem_util_max": 0.37631420247423863, "reward_consolidation_mean_mean": -0.5255310670443815, "reward_consolidation_mean_min": -0.8334973651344848, "reward_consolidation_mean_max": -0.21464589235127485, "reward_illegal_mean_mean": -1.7694999999999999, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8858333333333336, "reward_accuracy_mean_min": 0.4000000000000003, "reward_accuracy_mean_max": 1.4916666666666683, "reward_sla_mean_mean": -1.1210666666666667, "reward_sla_mean_min": -2.05, "reward_sla_mean_max": -0.5139999999999999, "reward_consolidation_sum_mean": -52.55310670443816, "reward_consolidation_sum_min": -83.34973651344848, "reward_consolidation_sum_max": -21.464589235127484, "reward_illegal_sum_mean": -176.94999999999996, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 88.58333333333334, "reward_accuracy_sum_min": 40.00000000000003, "reward_accuracy_sum_max": 149.16666666666683, "reward_sla_sum_mean": -112.10666666666665, "reward_sla_sum_min": -205.0, "reward_sla_sum_max": -51.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6048.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-265.0406987724268, -224.1166042218769, -244.53389685948403, -248.45586219501027, -240.67357823875219, -246.41176703524292, -253.22599835511258, -262.59470894635825, -263.9807060830363, -263.616403180115, -246.9977306649608, -229.05514027232002, -256.26105577385835, -247.65980687806507, -281.74292546224376, -241.50739589996627, -292.80459959182417, -246.05146364494794, -245.52706143958076, -279.2079898869901, -232.4283347040725, -245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28838464385525353, "mean_inference_ms": 2.450365943116973, "mean_action_processing_ms": 0.10769704501141902, "mean_env_wait_ms": 2.078888393934408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007473945617675781, "StateBufferConnector_ms": 0.003901958465576172, "ViewRequirementAgentConnector_ms": 0.09956192970275879}, "num_episodes": 21, "episode_return_max": -216.7565688872641, "episode_return_min": -292.80459959182417, "episode_return_mean": -253.02644003777135, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93900, "num_agent_steps_trained": 93500, "num_env_steps_sampled": 93900, "num_env_steps_trained": 93500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.799831958692, "num_env_steps_trained_throughput_per_sec": 212.4569668138678, "timesteps_total": 93900, "num_env_steps_sampled_lifetime": 93900, "num_agent_steps_sampled_lifetime": 93900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 93900, "timers": {"training_iteration_time_ms": 10670.417, "restore_workers_time_ms": 0.014, "training_step_time_ms": 730.667, "sample_time_ms": 715.625, "synch_weights_time_ms": 13.6}, "counters": {"num_env_steps_sampled": 93900, "num_env_steps_trained": 93500, "num_agent_steps_sampled": 93900, "num_agent_steps_trained": 93500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 626, "num_samples_added_to_queue": 93500}, "done": false, "training_iteration": 46, "trial_id": "13390_00000", "date": "2024-10-13_00-46-27", "timestamp": 1728776787, "time_this_iter_s": 10.366509437561035, "time_total_s": 479.0842294692993, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c8b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.0842294692993, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 57.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -428810.65625, "policy_loss": -431080.5, "entropy": 29.620365142822266, "entropy_coeff": 0.01, "var_gnorm": 16.08736801147461, "vf_loss": 243273.5625, "vf_explained_var": 0.054200828075408936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 174.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 95700, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 95700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 640, "num_samples_added_to_queue": 95700, "learner_queue": {"size_count": 174, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.259, "learner_load_time_ms": 0.463, "learner_load_wait_time_ms": 2536.587, "learner_dequeue_time_ms": 22487.95}}, "env_runners": {"episode_reward_max": -208.50321971427678, "episode_reward_min": -287.08289317371833, "episode_reward_mean": -253.04377995065326, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -287.08289317371833}, "policy_reward_max": {"default_policy": -208.50321971427678}, "policy_reward_mean": {"default_policy": -253.04377995065326}, "custom_metrics": {"num_consolidated_mean": 0.6807999999999998, "num_consolidated_min": 0.5, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0687, "num_overloaded_min": 0.86, "num_overloaded_max": 1.2, "num_moves_mean": 9.97, "num_moves_min": 9.64, "num_moves_max": 10.29, "mean_accuracy_mean": 41.04224, "mean_accuracy_min": 40.796, "mean_accuracy_max": 41.315333333333335, "num_model_switches_mean": 6.006199999999999, "num_model_switches_min": 5.67, "num_model_switches_max": 6.3, "num_slav_mean": 0.1479665, "num_slav_min": 0.12949999999999998, "num_slav_max": 0.17468333333333333, "cpu_conserved_cost_mean": 2.7786, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5743612053285938, "mean_cluster_cpu_util_min": 0.553995287643835, "mean_cluster_cpu_util_max": 0.6029093698736672, "mean_cluster_mem_util_mean": 0.3676475695987255, "mean_cluster_mem_util_min": 0.36045377827291264, "mean_cluster_mem_util_max": 0.38017516540371427, "reward_consolidation_mean_mean": -0.5261577995065339, "reward_consolidation_mean_min": -0.7938289317371837, "reward_consolidation_mean_max": -0.21464589235127485, "reward_illegal_mean_mean": -1.7811666666666666, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8853333333333336, "reward_accuracy_mean_min": 0.4000000000000003, "reward_accuracy_mean_max": 1.4916666666666683, "reward_sla_mean_mean": -1.1084466666666666, "reward_sla_mean_min": -2.05, "reward_sla_mean_max": -0.5139999999999999, "reward_consolidation_sum_mean": -52.6157799506534, "reward_consolidation_sum_min": -79.38289317371837, "reward_consolidation_sum_max": -21.464589235127484, "reward_illegal_sum_mean": -178.11666666666665, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 88.53333333333336, "reward_accuracy_sum_min": 40.00000000000003, "reward_accuracy_sum_max": 149.16666666666683, "reward_sla_sum_mean": -110.84466666666664, "reward_sla_sum_min": -205.0, "reward_sla_sum_max": -51.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5103.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-245.96127509214392, -259.87134850284787, -278.9635078741356, -217.06917968868964, -261.8993176764444, -259.7192147186936, -233.69072771025603, -238.1138688354807, -249.2668463858172, -267.69916841816683, -246.0841755764719, -250.91958024916974, -255.77100429498287, -235.94046422370442, -266.63258704194453, -253.477614304426, -240.01846842730495, -271.0221298242404, -263.63076852782586, -246.20904383319618, -253.41170306740966, -245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28822188933375814, "mean_inference_ms": 2.4455518116886354, "mean_action_processing_ms": 0.10760788132524411, "mean_env_wait_ms": 2.07730754130544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007523536682128906, "StateBufferConnector_ms": 0.003896474838256836, "ViewRequirementAgentConnector_ms": 0.09949707984924316}, "num_episodes": 21, "episode_return_max": -208.50321971427678, "episode_return_min": -287.08289317371833, "episode_return_mean": -253.04377995065326, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 95700, "num_env_steps_sampled": 96000, "num_env_steps_trained": 95700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.47992910153218, "num_env_steps_trained_throughput_per_sec": 219.45516382065276, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 10610.938, "restore_workers_time_ms": 0.014, "training_step_time_ms": 714.705, "sample_time_ms": 696.937, "synch_weights_time_ms": 16.034}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 95700, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 95700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 640, "num_samples_added_to_queue": 95700}, "done": false, "training_iteration": 47, "trial_id": "13390_00000", "date": "2024-10-13_00-46-37", "timestamp": 1728776797, "time_this_iter_s": 10.054344177246094, "time_total_s": 489.1385736465454, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c3e1d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 489.1385736465454, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 16.82857142857143, "ram_util_percent": 57.435714285714276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -429289.59375, "policy_loss": -431567.625, "entropy": 29.59490394592285, "entropy_coeff": 0.01, "var_gnorm": 16.092905044555664, "vf_loss": 244080.390625, "vf_explained_var": 0.06171143054962158}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 178.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 98100, "num_env_steps_trained": 97900, "num_agent_steps_sampled": 98100, "num_agent_steps_trained": 97900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 654, "num_samples_added_to_queue": 97900, "learner_queue": {"size_count": 178, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.955, "learner_load_time_ms": 0.472, "learner_load_wait_time_ms": 2638.781, "learner_dequeue_time_ms": 22527.449}}, "env_runners": {"episode_reward_max": -208.50321971427678, "episode_reward_min": -287.08289317371833, "episode_reward_mean": -253.13177245727854, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -287.08289317371833}, "policy_reward_max": {"default_policy": -208.50321971427678}, "policy_reward_mean": {"default_policy": -253.13177245727854}, "custom_metrics": {"num_consolidated_mean": 0.679, "num_consolidated_min": 0.5, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0812000000000002, "num_overloaded_min": 0.97, "num_overloaded_max": 1.2, "num_moves_mean": 9.974899999999998, "num_moves_min": 9.64, "num_moves_max": 10.38, "mean_accuracy_mean": 41.03615999999999, "mean_accuracy_min": 40.789666666666655, "mean_accuracy_max": 41.315333333333335, "num_model_switches_mean": 6.006399999999998, "num_model_switches_min": 5.52, "num_model_switches_max": 6.36, "num_slav_mean": 0.14755850000000004, "num_slav_min": 0.12841666666666665, "num_slav_max": 0.1654333333333333, "cpu_conserved_cost_mean": 2.7811999999999997, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5753224998896737, "mean_cluster_cpu_util_min": 0.5574939495161599, "mean_cluster_cpu_util_max": 0.6029093698736672, "mean_cluster_mem_util_mean": 0.36816616585220585, "mean_cluster_mem_util_min": 0.35936491701110823, "mean_cluster_mem_util_max": 0.38017516540371427, "reward_consolidation_mean_mean": -0.516164391239453, "reward_consolidation_mean_min": -0.7938289317371837, "reward_consolidation_mean_max": -0.21464589235127485, "reward_illegal_mean_mean": -1.8019999999999998, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.6166666666666665, "reward_accuracy_mean_mean": 0.8556666666666668, "reward_accuracy_mean_min": 0.4000000000000003, "reward_accuracy_mean_max": 1.3416666666666675, "reward_sla_mean_mean": -1.06882, "reward_sla_mean_min": -1.7853333333333332, "reward_sla_mean_max": -0.5139999999999999, "reward_consolidation_sum_mean": -51.6164391239453, "reward_consolidation_sum_min": -79.38289317371837, "reward_consolidation_sum_max": -21.464589235127484, "reward_illegal_sum_mean": -180.2, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -161.66666666666666, "reward_accuracy_sum_mean": 85.56666666666666, "reward_accuracy_sum_min": 40.00000000000003, "reward_accuracy_sum_max": 134.16666666666674, "reward_sla_sum_mean": -106.882, "reward_sla_sum_min": -178.53333333333333, "reward_sla_sum_max": -51.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4159.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-245.9871180968046, -232.8781077705686, -266.0749672545613, -232.69453836546944, -236.2813914526788, -240.84581924517954, -247.34783880105977, -245.94785403149635, -261.31266563099695, -256.64659599744107, -260.6419872673551, -221.71432270248854, -238.14708641749672, -278.0606902433822, -246.18915592920885, -242.32636388558893, -280.57016052880056, -269.8874927655426, -241.6569191873038, -259.443120411831, -265.3612172164854, -267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28798511187339065, "mean_inference_ms": 2.441345706257585, "mean_action_processing_ms": 0.10750436111919592, "mean_env_wait_ms": 2.0752857451305227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007509708404541016, "StateBufferConnector_ms": 0.0038585662841796875, "ViewRequirementAgentConnector_ms": 0.09936809539794922}, "num_episodes": 21, "episode_return_max": -208.50321971427678, "episode_return_min": -287.08289317371833, "episode_return_mean": -253.13177245727854, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98100, "num_agent_steps_trained": 97900, "num_env_steps_sampled": 98100, "num_env_steps_trained": 97900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.0684430983124, "num_env_steps_trained_throughput_per_sec": 210.64313086489872, "timesteps_total": 98100, "num_env_steps_sampled_lifetime": 98100, "num_agent_steps_sampled_lifetime": 98100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 98100, "timers": {"training_iteration_time_ms": 10510.829, "restore_workers_time_ms": 0.016, "training_step_time_ms": 754.369, "sample_time_ms": 738.001, "synch_weights_time_ms": 14.76}, "counters": {"num_env_steps_sampled": 98100, "num_env_steps_trained": 97900, "num_agent_steps_sampled": 98100, "num_agent_steps_trained": 97900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 654, "num_samples_added_to_queue": 97900}, "done": false, "training_iteration": 48, "trial_id": "13390_00000", "date": "2024-10-13_00-46-47", "timestamp": 1728776807, "time_this_iter_s": 10.457176685333252, "time_total_s": 499.59575033187866, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c14340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 499.59575033187866, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.279999999999998, "ram_util_percent": 57.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -447426.90625, "policy_loss": -449973.0, "entropy": 29.577266693115234, "entropy_coeff": 0.01, "var_gnorm": 16.098896026611328, "vf_loss": 270878.53125, "vf_explained_var": 0.05429357290267944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 182.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 100350, "num_env_steps_trained": 100100, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 100100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 669, "num_samples_added_to_queue": 100100, "learner_queue": {"size_count": 182, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.955, "learner_load_time_ms": 0.472, "learner_load_wait_time_ms": 2605.157, "learner_dequeue_time_ms": 22527.449}}, "env_runners": {"episode_reward_max": -208.50321971427678, "episode_reward_min": -287.08289317371833, "episode_reward_mean": -253.67431268086133, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -287.08289317371833}, "policy_reward_max": {"default_policy": -208.50321971427678}, "policy_reward_mean": {"default_policy": -253.67431268086133}, "custom_metrics": {"num_consolidated_mean": 0.6769, "num_consolidated_min": 0.5, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0766, "num_overloaded_min": 0.93, "num_overloaded_max": 1.2, "num_moves_mean": 9.9633, "num_moves_min": 9.64, "num_moves_max": 10.38, "mean_accuracy_mean": 41.02856, "mean_accuracy_min": 40.789666666666655, "mean_accuracy_max": 41.315333333333335, "num_model_switches_mean": 5.988499999999999, "num_model_switches_min": 5.46, "num_model_switches_max": 6.36, "num_slav_mean": 0.1464855, "num_slav_min": 0.12331666666666666, "num_slav_max": 0.1654333333333333, "cpu_conserved_cost_mean": 2.7721999999999993, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5750918800096358, "mean_cluster_cpu_util_min": 0.5576587951081567, "mean_cluster_cpu_util_max": 0.6029093698736672, "mean_cluster_mem_util_mean": 0.3681319594455927, "mean_cluster_mem_util_min": 0.35936491701110823, "mean_cluster_mem_util_max": 0.38017516540371427, "reward_consolidation_mean_mean": -0.5325864601419478, "reward_consolidation_mean_min": -0.8164112522464895, "reward_consolidation_mean_max": -0.21464589235127485, "reward_illegal_mean_mean": -1.7943333333333333, "reward_illegal_mean_min": -2.0, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8799166666666666, "reward_accuracy_mean_min": 0.4000000000000003, "reward_accuracy_mean_max": 1.4000000000000012, "reward_sla_mean_mean": -1.08974, "reward_sla_mean_min": -1.8339999999999999, "reward_sla_mean_max": -0.5139999999999999, "reward_consolidation_sum_mean": -53.258646014194774, "reward_consolidation_sum_min": -81.64112522464895, "reward_consolidation_sum_max": -21.464589235127484, "reward_illegal_sum_mean": -179.4333333333333, "reward_illegal_sum_min": -200.0, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 87.99166666666667, "reward_accuracy_sum_min": 40.00000000000003, "reward_accuracy_sum_max": 140.0000000000001, "reward_sla_sum_mean": -108.97399999999998, "reward_sla_sum_min": -183.39999999999998, "reward_sla_sum_max": -51.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3214.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-267.8842121295197, -254.96759876938063, -234.83928843400628, -255.814286149441, -216.7565688872641, -254.40141643059474, -267.2832891650676, -250.85505802796294, -272.21161777696545, -229.82935818940555, -281.0397575314506, -242.46861920862636, -265.91818514118614, -243.15869505620006, -287.08289317371833, -258.0880837064788, -254.92842304060417, -250.73542294922177, -269.6048371866338, -254.95288312163038, -265.5458497060524, -266.18853452739927, -245.8612080782232, -255.5436321544975, -254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28770837118698683, "mean_inference_ms": 2.4370896922856637, "mean_action_processing_ms": 0.1073991111462462, "mean_env_wait_ms": 2.0732108511042178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007260560989379883, "StateBufferConnector_ms": 0.003826141357421875, "ViewRequirementAgentConnector_ms": 0.0982356071472168}, "num_episodes": 21, "episode_return_max": -208.50321971427678, "episode_return_min": -287.08289317371833, "episode_return_mean": -253.67431268086133, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 100100, "num_env_steps_sampled": 100350, "num_env_steps_trained": 100100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 214.80976686390525, "num_env_steps_trained_throughput_per_sec": 210.0362164891518, "timesteps_total": 100350, "num_env_steps_sampled_lifetime": 100350, "num_agent_steps_sampled_lifetime": 100350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 100350, "timers": {"training_iteration_time_ms": 10525.846, "restore_workers_time_ms": 0.015, "training_step_time_ms": 703.221, "sample_time_ms": 686.932, "synch_weights_time_ms": 14.646}, "counters": {"num_env_steps_sampled": 100350, "num_env_steps_trained": 100100, "num_agent_steps_sampled": 100350, "num_agent_steps_trained": 100100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 669, "num_samples_added_to_queue": 100100}, "done": false, "training_iteration": 49, "trial_id": "13390_00000", "date": "2024-10-13_00-46-58", "timestamp": 1728776818, "time_this_iter_s": 10.488522291183472, "time_total_s": 510.08427262306213, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c17d30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 510.08427262306213, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.093333333333337, "ram_util_percent": 57.65333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -418729.5625, "policy_loss": -420926.34375, "entropy": 29.56363296508789, "entropy_coeff": 0.01, "var_gnorm": 16.104738235473633, "vf_loss": 235938.375, "vf_explained_var": 0.06144136190414429}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 186.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 102600, "num_env_steps_trained": 102300, "num_agent_steps_sampled": 102600, "num_agent_steps_trained": 102300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 684, "num_samples_added_to_queue": 102300, "learner_queue": {"size_count": 186, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.441, "learner_load_time_ms": 0.46, "learner_load_wait_time_ms": 2492.32, "learner_dequeue_time_ms": 22518.624}}, "env_runners": {"episode_reward_max": -206.94962990039286, "episode_reward_min": -285.01432270248876, "episode_reward_mean": -251.74773870663125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -285.01432270248876}, "policy_reward_max": {"default_policy": -206.94962990039286}, "policy_reward_mean": {"default_policy": -251.74773870663125}, "custom_metrics": {"num_consolidated_mean": 0.6896000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0731, "num_overloaded_min": 0.93, "num_overloaded_max": 1.24, "num_moves_mean": 9.962200000000001, "num_moves_min": 9.52, "num_moves_max": 10.38, "mean_accuracy_mean": 41.02235333333333, "mean_accuracy_min": 40.789666666666655, "mean_accuracy_max": 41.26466666666667, "num_model_switches_mean": 5.978400000000001, "num_model_switches_min": 5.46, "num_model_switches_max": 6.36, "num_slav_mean": 0.14521216666666667, "num_slav_min": 0.12331666666666666, "num_slav_max": 0.1636, "cpu_conserved_cost_mean": 2.8221999999999996, "cpu_conserved_cost_min": 2.14, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5760961477099226, "mean_cluster_cpu_util_min": 0.5576587951081567, "mean_cluster_cpu_util_max": 0.6029093698736672, "mean_cluster_mem_util_mean": 0.36857328255152266, "mean_cluster_mem_util_min": 0.35936491701110823, "mean_cluster_mem_util_max": 0.38017516540371427, "reward_consolidation_mean_mean": -0.53423405373298, "reward_consolidation_mean_min": -0.8164112522464895, "reward_consolidation_mean_max": -0.21464589235127485, "reward_illegal_mean_mean": -1.7884999999999993, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8857500000000003, "reward_accuracy_mean_min": 0.4000000000000003, "reward_accuracy_mean_max": 1.4000000000000012, "reward_sla_mean_mean": -1.0804933333333333, "reward_sla_mean_min": -1.8339999999999999, "reward_sla_mean_max": -0.5139999999999999, "reward_consolidation_sum_mean": -53.42340537329801, "reward_consolidation_sum_min": -81.64112522464895, "reward_consolidation_sum_max": -21.464589235127484, "reward_illegal_sum_mean": -178.84999999999997, "reward_illegal_sum_min": -206.66666666666666, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 88.57500000000002, "reward_accuracy_sum_min": 40.00000000000003, "reward_accuracy_sum_max": 140.0000000000001, "reward_sla_sum_mean": -108.04933333333332, "reward_sla_sum_min": -183.39999999999998, "reward_sla_sum_max": -51.39999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2227.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-254.4858905236222, -256.8232050930578, -247.13316579853162, -265.10699381644264, -236.4438849797435, -250.87062353407038, -267.57988973163947, -255.65672119162917, -251.78567425142387, -226.19792256846065, -275.42038137012986, -243.3292911754851, -248.56950562003104, -257.74566694081454, -240.71098419080678, -242.72909013372308, -265.91168783697344, -252.67434585275203, -208.50321971427678, -238.73730238508628, -257.25825032745433, -241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28739550735973657, "mean_inference_ms": 2.4341520321364287, "mean_action_processing_ms": 0.1072738487016694, "mean_env_wait_ms": 2.070769842859214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069255828857421875, "StateBufferConnector_ms": 0.0038001537322998047, "ViewRequirementAgentConnector_ms": 0.09819889068603516}, "num_episodes": 24, "episode_return_max": -206.94962990039286, "episode_return_min": -285.01432270248876, "episode_return_mean": -251.74773870663125, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102600, "num_agent_steps_trained": 102300, "num_env_steps_sampled": 102600, "num_env_steps_trained": 102300, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.82369398571922, "num_env_steps_trained_throughput_per_sec": 209.07205634159212, "timesteps_total": 102600, "num_env_steps_sampled_lifetime": 102600, "num_agent_steps_sampled_lifetime": 102600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 102600, "timers": {"training_iteration_time_ms": 10433.353, "restore_workers_time_ms": 0.014, "training_step_time_ms": 691.288, "sample_time_ms": 674.637, "synch_weights_time_ms": 14.997}, "counters": {"num_env_steps_sampled": 102600, "num_env_steps_trained": 102300, "num_agent_steps_sampled": 102600, "num_agent_steps_trained": 102300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 684, "num_samples_added_to_queue": 102300}, "done": false, "training_iteration": 50, "trial_id": "13390_00000", "date": "2024-10-13_00-47-08", "timestamp": 1728776828, "time_this_iter_s": 10.539732933044434, "time_total_s": 520.6240055561066, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b850>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.6240055561066, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.026666666666664, "ram_util_percent": 57.80666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -414676.375, "policy_loss": -416856.375, "entropy": 29.54166030883789, "entropy_coeff": 0.01, "var_gnorm": 16.10984230041504, "vf_loss": 234246.578125, "vf_explained_var": 0.06486213207244873}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 190.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 104700, "num_env_steps_trained": 104500, "num_agent_steps_sampled": 104700, "num_agent_steps_trained": 104500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 698, "num_samples_added_to_queue": 104500, "learner_queue": {"size_count": 190, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.771, "learner_load_time_ms": 0.46, "learner_load_wait_time_ms": 2553.286, "learner_dequeue_time_ms": 22518.624}}, "env_runners": {"episode_reward_max": -206.94962990039286, "episode_reward_min": -286.60184897499136, "episode_reward_mean": -251.5721078314903, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -286.60184897499136}, "policy_reward_max": {"default_policy": -206.94962990039286}, "policy_reward_mean": {"default_policy": -251.5721078314903}, "custom_metrics": {"num_consolidated_mean": 0.6915, "num_consolidated_min": 0.55, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0733, "num_overloaded_min": 0.93, "num_overloaded_max": 1.24, "num_moves_mean": 9.946200000000001, "num_moves_min": 9.52, "num_moves_max": 10.38, "mean_accuracy_mean": 41.02482333333333, "mean_accuracy_min": 40.789666666666655, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 5.9505, "num_model_switches_min": 5.37, "num_model_switches_max": 6.36, "num_slav_mean": 0.1445495, "num_slav_min": 0.12331666666666666, "num_slav_max": 0.1636, "cpu_conserved_cost_mean": 2.8144, "cpu_conserved_cost_min": 2.14, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5759156695052022, "mean_cluster_cpu_util_min": 0.5576587951081567, "mean_cluster_cpu_util_max": 0.6029093698736672, "mean_cluster_mem_util_mean": 0.3683850353572864, "mean_cluster_mem_util_min": 0.3589816760670513, "mean_cluster_mem_util_max": 0.38017516540371427, "reward_consolidation_mean_mean": -0.5347510783149045, "reward_consolidation_mean_min": -0.8164112522464895, "reward_consolidation_mean_max": -0.28717673398519605, "reward_illegal_mean_mean": -1.7888333333333333, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8962500000000004, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.4000000000000012, "reward_sla_mean_mean": -1.0883866666666666, "reward_sla_mean_min": -1.8339999999999999, "reward_sla_mean_max": -0.5213333333333333, "reward_consolidation_sum_mean": -53.47510783149046, "reward_consolidation_sum_min": -81.64112522464895, "reward_consolidation_sum_max": -28.717673398519604, "reward_illegal_sum_mean": -178.88333333333324, "reward_illegal_sum_min": -206.66666666666666, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 89.62500000000001, "reward_accuracy_sum_min": 54.16666666666669, "reward_accuracy_sum_max": 140.0000000000001, "reward_sla_sum_mean": -108.83866666666665, "reward_sla_sum_min": -183.39999999999998, "reward_sla_sum_max": -52.13333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2069.0, "global_timestep_min": 200, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-241.02551402723194, -264.2501964726308, -269.17270705778435, -245.76066892077122, -259.699616193, -273.42123732066165, -264.6460903469494, -252.09755399189737, -258.3760425233786, -253.59020073715277, -250.21220871790175, -254.37237808035573, -262.7327576228333, -270.5569587864387, -241.06963660178505, -256.77671570867204, -257.5794754637667, -265.94810685674247, -237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28712434231586736, "mean_inference_ms": 2.4305806276077493, "mean_action_processing_ms": 0.10715776209005236, "mean_env_wait_ms": 2.0685450501435465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006815195083618164, "StateBufferConnector_ms": 0.0037789344787597656, "ViewRequirementAgentConnector_ms": 0.09769725799560547}, "num_episodes": 21, "episode_return_max": -206.94962990039286, "episode_return_min": -286.60184897499136, "episode_return_mean": -251.5721078314903, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104700, "num_agent_steps_trained": 104500, "num_env_steps_sampled": 104700, "num_env_steps_trained": 104500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 207.74324179368242, "num_env_steps_trained_throughput_per_sec": 217.6357771171911, "timesteps_total": 104700, "num_env_steps_sampled_lifetime": 104700, "num_agent_steps_sampled_lifetime": 104700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 104700, "timers": {"training_iteration_time_ms": 10336.808, "restore_workers_time_ms": 0.014, "training_step_time_ms": 716.26, "sample_time_ms": 699.048, "synch_weights_time_ms": 15.647}, "counters": {"num_env_steps_sampled": 104700, "num_env_steps_trained": 104500, "num_agent_steps_sampled": 104700, "num_agent_steps_trained": 104500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 698, "num_samples_added_to_queue": 104500}, "done": false, "training_iteration": 51, "trial_id": "13390_00000", "date": "2024-10-13_00-47-19", "timestamp": 1728776839, "time_this_iter_s": 10.119025707244873, "time_total_s": 530.7430312633514, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f240730>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 530.7430312633514, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.32, "ram_util_percent": 57.77999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -415409.375, "policy_loss": -417676.0, "entropy": 29.528209686279297, "entropy_coeff": 0.01, "var_gnorm": 16.113182067871094, "vf_loss": 242903.15625, "vf_explained_var": 0.05888628959655762}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 193.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 106500, "num_env_steps_trained": 106150, "num_agent_steps_sampled": 106500, "num_agent_steps_trained": 106150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 710, "num_samples_added_to_queue": 106150, "learner_queue": {"size_count": 193, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.428, "learner_load_time_ms": 0.536, "learner_load_wait_time_ms": 2678.713, "learner_dequeue_time_ms": 22441.893}}, "env_runners": {"episode_reward_max": -206.94962990039286, "episode_reward_min": -286.60184897499136, "episode_reward_mean": -249.39288153766475, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -286.60184897499136}, "policy_reward_max": {"default_policy": -206.94962990039286}, "policy_reward_mean": {"default_policy": -249.39288153766475}, "custom_metrics": {"num_consolidated_mean": 0.6874999999999999, "num_consolidated_min": 0.55, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0663999999999998, "num_overloaded_min": 0.93, "num_overloaded_max": 1.24, "num_moves_mean": 9.9469, "num_moves_min": 9.52, "num_moves_max": 10.38, "mean_accuracy_mean": 41.01887, "mean_accuracy_min": 40.789666666666655, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 5.94, "num_model_switches_min": 5.37, "num_model_switches_max": 6.36, "num_slav_mean": 0.143127, "num_slav_min": 0.12331666666666666, "num_slav_max": 0.1636, "cpu_conserved_cost_mean": 2.7933999999999997, "cpu_conserved_cost_min": 2.22, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.575190916142959, "mean_cluster_cpu_util_min": 0.5576587951081567, "mean_cluster_cpu_util_max": 0.5948204263138179, "mean_cluster_mem_util_mean": 0.36792749080412757, "mean_cluster_mem_util_min": 0.3589816760670513, "mean_cluster_mem_util_max": 0.3787348056416659, "reward_consolidation_mean_mean": -0.5388754820433155, "reward_consolidation_mean_min": -0.8164112522464895, "reward_consolidation_mean_max": -0.28717673398519605, "reward_illegal_mean_mean": -1.777333333333333, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.9008333333333334, "reward_accuracy_mean_min": 0.541666666666667, "reward_accuracy_mean_max": 1.4000000000000012, "reward_sla_mean_mean": -1.0785533333333333, "reward_sla_mean_min": -1.8339999999999999, "reward_sla_mean_max": -0.5213333333333333, "reward_consolidation_sum_mean": -53.887548204331544, "reward_consolidation_sum_min": -81.64112522464895, "reward_consolidation_sum_max": -28.717673398519604, "reward_illegal_sum_mean": -177.73333333333332, "reward_illegal_sum_min": -206.66666666666666, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 90.08333333333336, "reward_accuracy_sum_min": 54.16666666666669, "reward_accuracy_sum_max": 140.0000000000001, "reward_sla_sum_mean": -107.8553333333333, "reward_sla_sum_min": -183.39999999999998, "reward_sla_sum_max": -52.13333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2675.0, "global_timestep_min": 900, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-237.57541502939466, -252.10627798592702, -246.08048981083806, -255.94650461482206, -248.57568917725166, -265.20028024003153, -239.06484510646067, -247.94568217125095, -278.6542599530902, -257.135965152761, -239.09163239818446, -237.67995674556033, -263.09235736696195, -233.5439946388865, -245.38267690151991, -265.1643242255324, -244.82059764232835, -255.7238965548751, -280.04112522464874, -254.06192086265196, -240.2961862986992, -260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28705107905325955, "mean_inference_ms": 2.4305279316730073, "mean_action_processing_ms": 0.1071215502366822, "mean_env_wait_ms": 2.0679440404242184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007119894027709961, "StateBufferConnector_ms": 0.00393986701965332, "ViewRequirementAgentConnector_ms": 0.10241842269897461}, "num_episodes": 18, "episode_return_max": -206.94962990039286, "episode_return_min": -286.60184897499136, "episode_return_mean": -249.39288153766475, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106500, "num_agent_steps_trained": 106150, "num_env_steps_sampled": 106500, "num_env_steps_trained": 106150, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 170.7480828023399, "num_env_steps_trained_throughput_per_sec": 156.51907590214492, "timesteps_total": 106500, "num_env_steps_sampled_lifetime": 106500, "num_agent_steps_sampled_lifetime": 106500, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 106500, "timers": {"training_iteration_time_ms": 10370.448, "restore_workers_time_ms": 0.019, "training_step_time_ms": 916.622, "sample_time_ms": 898.56, "synch_weights_time_ms": 16.443}, "counters": {"num_env_steps_sampled": 106500, "num_env_steps_trained": 106150, "num_agent_steps_sampled": 106500, "num_agent_steps_trained": 106150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 710, "num_samples_added_to_queue": 106150}, "done": false, "training_iteration": 52, "trial_id": "13390_00000", "date": "2024-10-13_00-47-29", "timestamp": 1728776849, "time_this_iter_s": 10.55281662940979, "time_total_s": 541.2958478927612, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c09120>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 541.2958478927612, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 28.419999999999998, "ram_util_percent": 59.14666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -435058.78125, "policy_loss": -437485.8125, "entropy": 29.512603759765625, "entropy_coeff": 0.01, "var_gnorm": 16.117145538330078, "vf_loss": 258933.25, "vf_explained_var": 0.06407690048217773}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 197.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 108600, "num_env_steps_trained": 108350, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 724, "num_samples_added_to_queue": 108350, "learner_queue": {"size_count": 197, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.646, "learner_load_time_ms": 0.536, "learner_load_wait_time_ms": 2802.618, "learner_dequeue_time_ms": 22441.893}}, "env_runners": {"episode_reward_max": -206.94962990039286, "episode_reward_min": -299.82206281031995, "episode_reward_mean": -249.30737305431168, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.82206281031995}, "policy_reward_max": {"default_policy": -206.94962990039286}, "policy_reward_mean": {"default_policy": -249.30737305431168}, "custom_metrics": {"num_consolidated_mean": 0.6858, "num_consolidated_min": 0.54, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.072, "num_overloaded_min": 0.93, "num_overloaded_max": 1.24, "num_moves_mean": 9.947199999999999, "num_moves_min": 9.52, "num_moves_max": 10.33, "mean_accuracy_mean": 41.01779333333333, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 5.9347, "num_model_switches_min": 5.37, "num_model_switches_max": 6.31, "num_slav_mean": 0.14188083333333334, "num_slav_min": 0.12251666666666665, "num_slav_max": 0.1636, "cpu_conserved_cost_mean": 2.7932, "cpu_conserved_cost_min": 2.24, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5757197081331623, "mean_cluster_cpu_util_min": 0.5576810501176734, "mean_cluster_cpu_util_max": 0.5948204263138179, "mean_cluster_mem_util_mean": 0.3680329697734578, "mean_cluster_mem_util_min": 0.3589816760670513, "mean_cluster_mem_util_max": 0.3787348056416659, "reward_consolidation_mean_mean": -0.5322070638764508, "reward_consolidation_mean_min": -0.743271802369856, "reward_consolidation_mean_max": -0.28717673398519605, "reward_illegal_mean_mean": -1.7866666666666662, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8868333333333335, "reward_accuracy_mean_min": 0.516666666666667, "reward_accuracy_mean_max": 1.2583333333333335, "reward_sla_mean_mean": -1.0610333333333333, "reward_sla_mean_min": -1.764, "reward_sla_mean_max": -0.5213333333333333, "reward_consolidation_sum_mean": -53.22070638764509, "reward_consolidation_sum_min": -74.3271802369856, "reward_consolidation_sum_max": -28.717673398519604, "reward_illegal_sum_mean": -178.66666666666663, "reward_illegal_sum_min": -206.66666666666666, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 88.68333333333335, "reward_accuracy_sum_min": 51.6666666666667, "reward_accuracy_sum_max": 125.83333333333334, "reward_sla_sum_mean": -106.10333333333332, "reward_sla_sum_min": -176.4, "reward_sla_sum_max": -52.13333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3375.0, "global_timestep_min": 1600, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-260.0758871729263, -252.65699838557367, -264.44223400042637, -257.73696426939574, -230.4314295287703, -232.85848183008923, -245.56288038015168, -260.6496116238692, -255.9111943708306, -250.52916628590566, -235.84835054372655, -285.01432270248876, -255.15885345273975, -266.85014773523403, -238.03867312437154, -257.56051357031885, -226.4242712236133, -266.14492674160033, -237.17539370678352, -241.3634256297785, -250.8578969813273, -254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2869837999068956, "mean_inference_ms": 2.429276314064836, "mean_action_processing_ms": 0.10707992616099499, "mean_env_wait_ms": 2.067247656765434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007122039794921875, "StateBufferConnector_ms": 0.003922462463378906, "ViewRequirementAgentConnector_ms": 0.10233736038208008}, "num_episodes": 21, "episode_return_max": -206.94962990039286, "episode_return_min": -299.82206281031995, "episode_return_mean": -249.30737305431168, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108350, "num_env_steps_sampled": 108600, "num_env_steps_trained": 108350, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.79790888974105, "num_env_steps_trained_throughput_per_sec": 211.40733312258587, "timesteps_total": 108600, "num_env_steps_sampled_lifetime": 108600, "num_agent_steps_sampled_lifetime": 108600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 108600, "timers": {"training_iteration_time_ms": 10404.086, "restore_workers_time_ms": 0.014, "training_step_time_ms": 726.495, "sample_time_ms": 711.837, "synch_weights_time_ms": 13.143}, "counters": {"num_env_steps_sampled": 108600, "num_env_steps_trained": 108350, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 724, "num_samples_added_to_queue": 108350}, "done": false, "training_iteration": 53, "trial_id": "13390_00000", "date": "2024-10-13_00-47-40", "timestamp": 1728776860, "time_this_iter_s": 10.416652917861938, "time_total_s": 551.7125008106232, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2428c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 551.7125008106232, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.34, "ram_util_percent": 61.04000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -438951.0625, "policy_loss": -441395.9375, "entropy": 29.486785888671875, "entropy_coeff": 0.01, "var_gnorm": 16.122346878051758, "vf_loss": 260707.015625, "vf_explained_var": 0.0701150894165039}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 201.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 110700, "num_env_steps_trained": 110550, "num_agent_steps_sampled": 110700, "num_agent_steps_trained": 110550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 738, "num_samples_added_to_queue": 110550, "learner_queue": {"size_count": 201, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 88.655, "learner_load_time_ms": 0.536, "learner_load_wait_time_ms": 2757.74, "learner_dequeue_time_ms": 22487.439}}, "env_runners": {"episode_reward_max": -206.94962990039286, "episode_reward_min": -299.82206281031995, "episode_reward_mean": -248.99181574217909, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.82206281031995}, "policy_reward_max": {"default_policy": -206.94962990039286}, "policy_reward_mean": {"default_policy": -248.99181574217909}, "custom_metrics": {"num_consolidated_mean": 0.6839, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0739999999999998, "num_overloaded_min": 0.93, "num_overloaded_max": 1.24, "num_moves_mean": 9.949499999999999, "num_moves_min": 9.52, "num_moves_max": 10.33, "mean_accuracy_mean": 41.01418333333334, "mean_accuracy_min": 40.764333333333326, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 5.934399999999999, "num_model_switches_min": 5.37, "num_model_switches_max": 6.33, "num_slav_mean": 0.1400615, "num_slav_min": 0.1143, "num_slav_max": 0.1615833333333333, "cpu_conserved_cost_mean": 2.7838, "cpu_conserved_cost_min": 2.14, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5755516152827116, "mean_cluster_cpu_util_min": 0.5565283398118035, "mean_cluster_cpu_util_max": 0.5948204263138179, "mean_cluster_mem_util_mean": 0.36765048295373, "mean_cluster_mem_util_min": 0.3589816760670513, "mean_cluster_mem_util_max": 0.3787348056416659, "reward_consolidation_mean_mean": -0.5263414907551252, "reward_consolidation_mean_min": -0.7365425386091566, "reward_consolidation_mean_max": -0.28717673398519605, "reward_illegal_mean_mean": -1.7899999999999998, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8842500000000002, "reward_accuracy_mean_min": 0.5166666666666664, "reward_accuracy_mean_max": 1.3750000000000013, "reward_sla_mean_mean": -1.0578266666666667, "reward_sla_mean_min": -1.764, "reward_sla_mean_max": -0.518, "reward_consolidation_sum_mean": -52.63414907551251, "reward_consolidation_sum_min": -73.65425386091566, "reward_consolidation_sum_max": -28.717673398519604, "reward_illegal_sum_mean": -178.99999999999991, "reward_illegal_sum_min": -206.66666666666666, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 88.42500000000001, "reward_accuracy_sum_min": 51.666666666666636, "reward_accuracy_sum_max": 137.50000000000014, "reward_sla_sum_mean": -105.78266666666667, "reward_sla_sum_min": -176.4, "reward_sla_sum_max": -51.800000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4075.0, "global_timestep_min": 2300, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-254.2932833775016, -246.16963050961033, -233.8715982820066, -245.30252825245955, -235.3912028998749, -232.87031587925287, -265.3010935453409, -252.69250662523962, -229.15014468914677, -271.84885924030567, -254.33697340765764, -279.1019281732613, -256.7938651801759, -255.26762009199172, -228.62255323037544, -259.5433823753387, -206.94962990039286, -264.2477139114805, -259.5815772640044, -260.0386944469826, -245.84169179688678, -222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28696013476933274, "mean_inference_ms": 2.428910269684449, "mean_action_processing_ms": 0.10706060656328492, "mean_env_wait_ms": 2.0670095332582683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00718235969543457, "StateBufferConnector_ms": 0.003946781158447266, "ViewRequirementAgentConnector_ms": 0.10254716873168945}, "num_episodes": 21, "episode_return_max": -206.94962990039286, "episode_return_min": -299.82206281031995, "episode_return_mean": -248.99181574217909, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110700, "num_agent_steps_trained": 110550, "num_env_steps_sampled": 110700, "num_env_steps_trained": 110550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.4330586310899, "num_env_steps_trained_throughput_per_sec": 214.16796618495133, "timesteps_total": 110700, "num_env_steps_sampled_lifetime": 110700, "num_agent_steps_sampled_lifetime": 110700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 110700, "timers": {"training_iteration_time_ms": 10383.729, "restore_workers_time_ms": 0.013, "training_step_time_ms": 736.194, "sample_time_ms": 720.527, "synch_weights_time_ms": 14.071}, "counters": {"num_env_steps_sampled": 110700, "num_env_steps_trained": 110550, "num_agent_steps_sampled": 110700, "num_agent_steps_trained": 110550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 738, "num_samples_added_to_queue": 110550}, "done": false, "training_iteration": 54, "trial_id": "13390_00000", "date": "2024-10-13_00-47-50", "timestamp": 1728776870, "time_this_iter_s": 10.282495737075806, "time_total_s": 561.994996547699, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f240d90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 561.994996547699, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.12142857142857, "ram_util_percent": 60.528571428571425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -416653.9375, "policy_loss": -418824.6875, "entropy": 29.461671829223633, "entropy_coeff": 0.01, "var_gnorm": 16.127117156982422, "vf_loss": 233278.21875, "vf_explained_var": 0.07880181074142456}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 204.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 112800, "num_env_steps_trained": 112200, "num_agent_steps_sampled": 112800, "num_agent_steps_trained": 112200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 752, "num_samples_added_to_queue": 112750, "learner_queue": {"size_count": 204, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.274, "learner_load_time_ms": 0.536, "learner_load_wait_time_ms": 2628.908, "learner_dequeue_time_ms": 22487.439}}, "env_runners": {"episode_reward_max": -220.01767339851946, "episode_reward_min": -299.82206281031995, "episode_reward_mean": -248.04503399433415, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.82206281031995}, "policy_reward_max": {"default_policy": -220.01767339851946}, "policy_reward_mean": {"default_policy": -248.04503399433415}, "custom_metrics": {"num_consolidated_mean": 0.6753999999999999, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0786000000000002, "num_overloaded_min": 0.93, "num_overloaded_max": 1.26, "num_moves_mean": 9.9475, "num_moves_min": 9.64, "num_moves_max": 10.27, "mean_accuracy_mean": 41.001326666666664, "mean_accuracy_min": 40.764333333333326, "mean_accuracy_max": 41.35333333333333, "num_model_switches_mean": 5.9292, "num_model_switches_min": 5.37, "num_model_switches_max": 6.33, "num_slav_mean": 0.13863683333333332, "num_slav_min": 0.1143, "num_slav_max": 0.1590333333333333, "cpu_conserved_cost_mean": 2.7594, "cpu_conserved_cost_min": 2.14, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.5753231430946748, "mean_cluster_cpu_util_min": 0.5565283398118035, "mean_cluster_cpu_util_max": 0.5948204263138179, "mean_cluster_mem_util_mean": 0.36749224952818677, "mean_cluster_mem_util_min": 0.3575500635064152, "mean_cluster_mem_util_max": 0.37596807044547764, "reward_consolidation_mean_mean": -0.5170770066100095, "reward_consolidation_mean_min": -0.7365425386091566, "reward_consolidation_mean_max": -0.28110755734259346, "reward_illegal_mean_mean": -1.7976666666666663, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8601666666666667, "reward_accuracy_mean_min": 0.4583333333333332, "reward_accuracy_mean_max": 1.3750000000000013, "reward_sla_mean_mean": -1.0258733333333334, "reward_sla_mean_min": -1.764, "reward_sla_mean_max": -0.512, "reward_consolidation_sum_mean": -51.70770066100094, "reward_consolidation_sum_min": -73.65425386091566, "reward_consolidation_sum_max": -28.110755734259346, "reward_illegal_sum_mean": -179.7666666666666, "reward_illegal_sum_min": -209.99999999999994, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 86.0166666666667, "reward_accuracy_sum_min": 45.83333333333332, "reward_accuracy_sum_max": 137.50000000000014, "reward_sla_sum_mean": -102.58733333333332, "reward_sla_sum_min": -176.4, "reward_sla_sum_max": -51.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4782.0, "global_timestep_min": 3100, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-222.49607359346925, -227.25180480672552, -244.8680830972613, -256.0674830180632, -260.35982515458886, -251.72080782235201, -246.6817661214168, -234.07339547351424, -245.98996618843074, -276.7259252490175, -247.52044838405052, -262.5424715952358, -247.54449419720348, -250.52479210454155, -286.60184897499136, -247.13319321331736, -245.19660056657196, -220.01767339851946, -246.91357031892525, -268.3465503061317, -221.55708367601807, -239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28693079093531465, "mean_inference_ms": 2.43093040970336, "mean_action_processing_ms": 0.10706181443141218, "mean_env_wait_ms": 2.0672178724151102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007309675216674805, "StateBufferConnector_ms": 0.00400996208190918, "ViewRequirementAgentConnector_ms": 0.10426592826843262}, "num_episodes": 21, "episode_return_max": -220.01767339851946, "episode_return_min": -299.82206281031995, "episode_return_mean": -248.04503399433415, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112800, "num_agent_steps_trained": 112200, "num_env_steps_sampled": 112800, "num_env_steps_trained": 112200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 206.32441543193084, "num_env_steps_trained_throughput_per_sec": 162.11204069651708, "timesteps_total": 112800, "num_env_steps_sampled_lifetime": 112800, "num_agent_steps_sampled_lifetime": 112800, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 112800, "timers": {"training_iteration_time_ms": 10332.863, "restore_workers_time_ms": 0.014, "training_step_time_ms": 721.799, "sample_time_ms": 706.219, "synch_weights_time_ms": 14.074}, "counters": {"num_env_steps_sampled": 112800, "num_env_steps_trained": 112200, "num_agent_steps_sampled": 112800, "num_agent_steps_trained": 112200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 752, "num_samples_added_to_queue": 112750}, "done": false, "training_iteration": 55, "trial_id": "13390_00000", "date": "2024-10-13_00-48-00", "timestamp": 1728776880, "time_this_iter_s": 10.189748525619507, "time_total_s": 572.1847450733185, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c09f60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 572.1847450733185, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.62, "ram_util_percent": 60.106666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -394649.46875, "policy_loss": -396592.90625, "entropy": 29.423431396484375, "entropy_coeff": 0.01, "var_gnorm": 16.133825302124023, "vf_loss": 210529.546875, "vf_explained_var": 0.08997583389282227}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 208.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 115050, "num_env_steps_trained": 114400, "num_agent_steps_sampled": 115050, "num_agent_steps_trained": 114400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 767, "num_samples_added_to_queue": 114950, "learner_queue": {"size_count": 208, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.489, "learner_load_time_ms": 0.538, "learner_load_wait_time_ms": 2585.878, "learner_dequeue_time_ms": 22510.232}}, "env_runners": {"episode_reward_max": -219.27221968381596, "episode_reward_min": -299.82206281031995, "episode_reward_mean": -246.29405370251905, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.82206281031995}, "policy_reward_max": {"default_policy": -219.27221968381596}, "policy_reward_mean": {"default_policy": -246.29405370251905}, "custom_metrics": {"num_consolidated_mean": 0.6788, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0889, "num_overloaded_min": 0.93, "num_overloaded_max": 1.26, "num_moves_mean": 9.949399999999999, "num_moves_min": 9.72, "num_moves_max": 10.27, "mean_accuracy_mean": 40.997463333333336, "mean_accuracy_min": 40.764333333333326, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 5.9228999999999985, "num_model_switches_min": 5.33, "num_model_switches_max": 6.33, "num_slav_mean": 0.136769, "num_slav_min": 0.11230000000000001, "num_slav_max": 0.15839999999999999, "cpu_conserved_cost_mean": 2.7882, "cpu_conserved_cost_min": 2.14, "cpu_conserved_cost_max": 3.66, "mean_cluster_cpu_util_mean": 0.5764438579813788, "mean_cluster_cpu_util_min": 0.5565283398118035, "mean_cluster_cpu_util_max": 0.6026514572092316, "mean_cluster_mem_util_mean": 0.3678099781763972, "mean_cluster_mem_util_min": 0.3575500635064152, "mean_cluster_mem_util_max": 0.3795947060047648, "reward_consolidation_mean_mean": -0.4986472036918579, "reward_consolidation_mean_min": -0.7365425386091566, "reward_consolidation_mean_max": -0.2634539583904475, "reward_illegal_mean_mean": -1.8148333333333333, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8178333333333334, "reward_accuracy_mean_min": 0.4583333333333332, "reward_accuracy_mean_max": 1.3750000000000013, "reward_sla_mean_mean": -0.9672933333333333, "reward_sla_mean_min": -1.676, "reward_sla_mean_max": -0.512, "reward_consolidation_sum_mean": -49.86472036918578, "reward_consolidation_sum_min": -73.65425386091566, "reward_consolidation_sum_max": -26.345395839044752, "reward_illegal_sum_mean": -181.48333333333335, "reward_illegal_sum_min": -209.99999999999994, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 81.78333333333333, "reward_accuracy_sum_min": 45.83333333333332, "reward_accuracy_sum_max": 137.50000000000014, "reward_sla_sum_mean": -96.7293333333333, "reward_sla_sum_min": -167.6, "reward_sla_sum_max": -51.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5482.0, "global_timestep_min": 3800, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-239.1542538609156, -227.72481038106545, -220.54464954765578, -230.18345974595613, -262.7650705169209, -261.93339120899185, -248.1193335160986, -269.1985896615797, -247.13535288921378, -240.28012123427433, -233.59713972402443, -252.19988424868242, -258.56512534649244, -232.69995735477764, -254.42608669164466, -254.93457613695205, -268.5488531481313, -239.35810716135123, -244.66451003685765, -266.62615675165245, -222.69624112827077, -268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2868371051010985, "mean_inference_ms": 2.430282932932848, "mean_action_processing_ms": 0.1070438350828671, "mean_env_wait_ms": 2.066874840652641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007211208343505859, "StateBufferConnector_ms": 0.003985166549682617, "ViewRequirementAgentConnector_ms": 0.10309410095214844}, "num_episodes": 21, "episode_return_max": -219.27221968381596, "episode_return_min": -299.82206281031995, "episode_return_mean": -246.29405370251905, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115050, "num_agent_steps_trained": 114400, "num_env_steps_sampled": 115050, "num_env_steps_trained": 114400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.18582736987898, "num_env_steps_trained_throughput_per_sec": 208.44836453943722, "timesteps_total": 115050, "num_env_steps_sampled_lifetime": 115050, "num_agent_steps_sampled_lifetime": 115050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 115050, "timers": {"training_iteration_time_ms": 10352.776, "restore_workers_time_ms": 0.015, "training_step_time_ms": 705.111, "sample_time_ms": 687.569, "synch_weights_time_ms": 15.937}, "counters": {"num_env_steps_sampled": 115050, "num_env_steps_trained": 114400, "num_agent_steps_sampled": 115050, "num_agent_steps_trained": 114400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 767, "num_samples_added_to_queue": 114950}, "done": false, "training_iteration": 56, "trial_id": "13390_00000", "date": "2024-10-13_00-48-11", "timestamp": 1728776891, "time_this_iter_s": 10.566559076309204, "time_total_s": 582.7513041496277, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069fb50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 582.7513041496277, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.10666666666667, "ram_util_percent": 59.100000000000016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -384581.0, "policy_loss": -386427.21875, "entropy": 29.39287567138672, "entropy_coeff": 0.01, "var_gnorm": 16.139616012573242, "vf_loss": 200787.9375, "vf_explained_var": 0.09380918741226196}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 212.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 117150, "num_env_steps_trained": 116600, "num_agent_steps_sampled": 117150, "num_agent_steps_trained": 116600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 781, "num_samples_added_to_queue": 117150, "learner_queue": {"size_count": 212, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.316, "learner_load_time_ms": 0.538, "learner_load_wait_time_ms": 2523.818, "learner_dequeue_time_ms": 22510.232}}, "env_runners": {"episode_reward_max": -218.10926619756913, "episode_reward_min": -299.82206281031995, "episode_reward_mean": -244.7736042523378, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -299.82206281031995}, "policy_reward_max": {"default_policy": -218.10926619756913}, "policy_reward_mean": {"default_policy": -244.7736042523378}, "custom_metrics": {"num_consolidated_mean": 0.6825, "num_consolidated_min": 0.51, "num_consolidated_max": 0.83, "num_overloaded_mean": 1.0876000000000001, "num_overloaded_min": 0.93, "num_overloaded_max": 1.26, "num_moves_mean": 9.9489, "num_moves_min": 9.55, "num_moves_max": 10.27, "mean_accuracy_mean": 40.995246666666674, "mean_accuracy_min": 40.65033333333333, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 5.919200000000002, "num_model_switches_min": 5.33, "num_model_switches_max": 6.33, "num_slav_mean": 0.13585433333333333, "num_slav_min": 0.11230000000000001, "num_slav_max": 0.15839999999999999, "cpu_conserved_cost_mean": 2.8051999999999992, "cpu_conserved_cost_min": 2.14, "cpu_conserved_cost_max": 3.66, "mean_cluster_cpu_util_mean": 0.5766529906667697, "mean_cluster_cpu_util_min": 0.5565283398118035, "mean_cluster_cpu_util_max": 0.6026514572092316, "mean_cluster_mem_util_mean": 0.3680095343867504, "mean_cluster_mem_util_min": 0.3575500635064152, "mean_cluster_mem_util_max": 0.3795947060047648, "reward_consolidation_mean_mean": -0.4982427091900455, "reward_consolidation_mean_min": -0.7185677297511347, "reward_consolidation_mean_max": -0.2634539583904475, "reward_illegal_mean_mean": -1.8126666666666664, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8218333333333334, "reward_accuracy_mean_min": 0.4583333333333332, "reward_accuracy_mean_max": 1.3750000000000013, "reward_sla_mean_mean": -0.95866, "reward_sla_mean_min": -1.676, "reward_sla_mean_max": -0.512, "reward_consolidation_sum_mean": -49.82427091900454, "reward_consolidation_sum_min": -71.85677297511347, "reward_consolidation_sum_max": -26.345395839044752, "reward_illegal_sum_mean": -181.2666666666666, "reward_illegal_sum_min": -209.99999999999994, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 82.18333333333334, "reward_accuracy_sum_min": 45.83333333333332, "reward_accuracy_sum_max": 137.50000000000014, "reward_sla_sum_mean": -95.866, "reward_sla_sum_min": -167.6, "reward_sla_sum_max": -51.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6175.0, "global_timestep_min": 4400, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-268.89529684120737, -253.59152273904152, -246.70221755155495, -234.75862499619222, -223.14382405799742, -235.11435620944889, -259.4795272472508, -252.4321179445002, -230.01676871059104, -299.82206281031995, -241.52795089707257, -256.76981936702293, -244.9862286393128, -255.61253464924295, -255.85028480916256, -278.0362240701819, -232.77830881233047, -277.29463279417575, -228.36477504645276, -248.76113497212827, -247.58087057175035, -281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28657537405382905, "mean_inference_ms": 2.425663746750499, "mean_action_processing_ms": 0.10695506249515578, "mean_env_wait_ms": 2.065142345321131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006857633590698242, "StateBufferConnector_ms": 0.0037887096405029297, "ViewRequirementAgentConnector_ms": 0.09812426567077637}, "num_episodes": 21, "episode_return_max": -218.10926619756913, "episode_return_min": -299.82206281031995, "episode_return_mean": -244.7736042523378, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117150, "num_agent_steps_trained": 116600, "num_env_steps_sampled": 117150, "num_env_steps_trained": 116600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.78692447506648, "num_env_steps_trained_throughput_per_sec": 211.39582564054584, "timesteps_total": 117150, "num_env_steps_sampled_lifetime": 117150, "num_agent_steps_sampled_lifetime": 117150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 117150, "timers": {"training_iteration_time_ms": 10390.995, "restore_workers_time_ms": 0.015, "training_step_time_ms": 763.714, "sample_time_ms": 745.634, "synch_weights_time_ms": 16.51}, "counters": {"num_env_steps_sampled": 117150, "num_env_steps_trained": 116600, "num_agent_steps_sampled": 117150, "num_agent_steps_trained": 116600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 781, "num_samples_added_to_queue": 117150}, "done": false, "training_iteration": 57, "trial_id": "13390_00000", "date": "2024-10-13_00-48-21", "timestamp": 1728776901, "time_this_iter_s": 10.42167854309082, "time_total_s": 593.1729826927185, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b530d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 593.1729826927185, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.69333333333333, "ram_util_percent": 59.53333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -385272.65625, "policy_loss": -387152.5, "entropy": 29.33295440673828, "entropy_coeff": 0.01, "var_gnorm": 16.145633697509766, "vf_loss": 204118.578125, "vf_explained_var": 0.09965550899505615}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 216.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 119250, "num_env_steps_trained": 118800, "num_agent_steps_sampled": 119250, "num_agent_steps_trained": 118800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 795, "num_samples_added_to_queue": 118800, "learner_queue": {"size_count": 216, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 98.138, "learner_load_time_ms": 0.538, "learner_load_wait_time_ms": 2558.166, "learner_dequeue_time_ms": 22510.232}}, "env_runners": {"episode_reward_max": -212.6000243686983, "episode_reward_min": -281.0848000243686, "episode_reward_mean": -243.38075125651088, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -281.0848000243686}, "policy_reward_max": {"default_policy": -212.6000243686983}, "policy_reward_mean": {"default_policy": -243.38075125651088}, "custom_metrics": {"num_consolidated_mean": 0.6846999999999999, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0782, "num_overloaded_min": 0.93, "num_overloaded_max": 1.26, "num_moves_mean": 9.9326, "num_moves_min": 9.55, "num_moves_max": 10.27, "mean_accuracy_mean": 40.99860333333333, "mean_accuracy_min": 40.65033333333333, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 5.920300000000001, "num_model_switches_min": 5.33, "num_model_switches_max": 6.41, "num_slav_mean": 0.135257, "num_slav_min": 0.11230000000000001, "num_slav_max": 0.1554, "cpu_conserved_cost_mean": 2.8227999999999995, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.66, "mean_cluster_cpu_util_mean": 0.5767634952209301, "mean_cluster_cpu_util_min": 0.5524610973466196, "mean_cluster_cpu_util_max": 0.6026514572092316, "mean_cluster_mem_util_mean": 0.36820177826394274, "mean_cluster_mem_util_min": 0.35751880292201266, "mean_cluster_mem_util_max": 0.3795947060047648, "reward_consolidation_mean_mean": -0.5109875125651101, "reward_consolidation_mean_min": -0.763113101221481, "reward_consolidation_mean_max": -0.2634539583904475, "reward_illegal_mean_mean": -1.797, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.8353333333333333, "reward_accuracy_mean_min": 0.4583333333333332, "reward_accuracy_mean_max": 1.4000000000000017, "reward_sla_mean_mean": -0.9611533333333333, "reward_sla_mean_min": -1.8186666666666667, "reward_sla_mean_max": -0.512, "reward_consolidation_sum_mean": -51.09875125651102, "reward_consolidation_sum_min": -76.3113101221481, "reward_consolidation_sum_max": -26.345395839044752, "reward_illegal_sum_mean": -179.7, "reward_illegal_sum_min": -209.99999999999994, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 83.53333333333332, "reward_accuracy_sum_min": 45.83333333333332, "reward_accuracy_sum_max": 140.00000000000017, "reward_sla_sum_mean": -96.11533333333331, "reward_sla_sum_min": -181.86666666666667, "reward_sla_sum_max": -51.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5237.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-281.0848000243686, -222.57839410277487, -246.5567729751133, -261.5290901337231, -245.17167443418927, -248.5318194279446, -244.24194766821998, -226.66956044960236, -280.70675317554605, -245.86271589143732, -242.56444606902443, -254.70289682902305, -239.50631149288716, -273.604444241372, -265.1808005117427, -226.4637424228579, -232.82367114441482, -256.3175119558924, -261.4455176825368, -254.77491547107726, -245.04075360199823, -229.71062779859275, -234.89353315666008, -250.71114867952107, -251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863603636647402, "mean_inference_ms": 2.423469400970014, "mean_action_processing_ms": 0.1068908197546225, "mean_env_wait_ms": 2.063966789883492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006899118423461914, "StateBufferConnector_ms": 0.003814220428466797, "ViewRequirementAgentConnector_ms": 0.09822297096252441}, "num_episodes": 21, "episode_return_max": -212.6000243686983, "episode_return_min": -281.0848000243686, "episode_return_mean": -243.38075125651088, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119250, "num_agent_steps_trained": 118800, "num_env_steps_sampled": 119250, "num_env_steps_trained": 118800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 201.4738498124675, "num_env_steps_trained_throughput_per_sec": 211.06784266068024, "timesteps_total": 119250, "num_env_steps_sampled_lifetime": 119250, "num_agent_steps_sampled_lifetime": 119250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 119250, "timers": {"training_iteration_time_ms": 10388.894, "restore_workers_time_ms": 0.017, "training_step_time_ms": 725.917, "sample_time_ms": 710.304, "synch_weights_time_ms": 14.021}, "counters": {"num_env_steps_sampled": 119250, "num_env_steps_trained": 118800, "num_agent_steps_sampled": 119250, "num_agent_steps_trained": 118800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 795, "num_samples_added_to_queue": 118800}, "done": false, "training_iteration": 58, "trial_id": "13390_00000", "date": "2024-10-13_00-48-32", "timestamp": 1728776912, "time_this_iter_s": 10.434092044830322, "time_total_s": 603.6070747375488, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2405b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.6070747375488, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 19.12666666666667, "ram_util_percent": 61.760000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -380858.15625, "policy_loss": -382710.53125, "entropy": 29.298995971679688, "entropy_coeff": 0.01, "var_gnorm": 16.151161193847656, "vf_loss": 201352.90625, "vf_explained_var": 0.09789919853210449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 220.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 121500, "num_env_steps_trained": 121000, "num_agent_steps_sampled": 121500, "num_agent_steps_trained": 121000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 810, "num_samples_added_to_queue": 121000, "learner_queue": {"size_count": 220, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.09, "learner_load_time_ms": 0.551, "learner_load_wait_time_ms": 2639.563, "learner_dequeue_time_ms": 22519.253}}, "env_runners": {"episode_reward_max": -203.81542234000418, "episode_reward_min": -277.76330683237387, "episode_reward_mean": -240.7844020835236, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -277.76330683237387}, "policy_reward_max": {"default_policy": -203.81542234000418}, "policy_reward_mean": {"default_policy": -240.7844020835236}, "custom_metrics": {"num_consolidated_mean": 0.6872, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0852, "num_overloaded_min": 0.95, "num_overloaded_max": 1.26, "num_moves_mean": 9.9282, "num_moves_min": 9.55, "num_moves_max": 10.24, "mean_accuracy_mean": 40.99689333333334, "mean_accuracy_min": 40.65033333333333, "mean_accuracy_max": 41.195, "num_model_switches_mean": 5.8975, "num_model_switches_min": 5.33, "num_model_switches_max": 6.41, "num_slav_mean": 0.13348933333333335, "num_slav_min": 0.10836666666666668, "num_slav_max": 0.1554, "cpu_conserved_cost_mean": 2.8348, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.66, "mean_cluster_cpu_util_mean": 0.5772575425846732, "mean_cluster_cpu_util_min": 0.5524610973466196, "mean_cluster_cpu_util_max": 0.6026514572092316, "mean_cluster_mem_util_mean": 0.36854999732878374, "mean_cluster_mem_util_min": 0.35751880292201266, "mean_cluster_mem_util_max": 0.3795947060047648, "reward_consolidation_mean_mean": -0.49488735416857055, "reward_consolidation_mean_min": -0.763113101221481, "reward_consolidation_mean_max": -0.2634539583904475, "reward_illegal_mean_mean": -1.8086666666666662, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5833333333333328, "reward_accuracy_mean_mean": 0.8032499999999999, "reward_accuracy_mean_min": 0.4583333333333332, "reward_accuracy_mean_max": 1.4000000000000017, "reward_sla_mean_mean": -0.90754, "reward_sla_mean_min": -1.8186666666666667, "reward_sla_mean_max": -0.512, "reward_consolidation_sum_mean": -49.488735416857054, "reward_consolidation_sum_min": -76.3113101221481, "reward_consolidation_sum_max": -26.345395839044752, "reward_illegal_sum_mean": -180.86666666666665, "reward_illegal_sum_min": -209.99999999999994, "reward_illegal_sum_max": -158.3333333333333, "reward_accuracy_sum_mean": 80.325, "reward_accuracy_sum_min": 45.83333333333332, "reward_accuracy_sum_max": 140.00000000000017, "reward_sla_sum_mean": -90.75399999999999, "reward_sla_sum_min": -181.86666666666667, "reward_sla_sum_max": -51.199999999999996, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4159.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-251.71149897956067, -243.4774224009259, -243.52830119711234, -237.3574705291052, -266.8436138779738, -228.101925127174, -248.77863778975885, -235.4236894209387, -250.44893539248824, -238.73072588260374, -256.26417801334185, -242.09949130342068, -234.05504888970103, -233.6978951536749, -247.7130524840841, -250.34520698163206, -225.57115050717348, -233.1698711505071, -226.2083188644185, -226.6706996862529, -233.61206250571124, -247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28610706713741635, "mean_inference_ms": 2.4194115745818525, "mean_action_processing_ms": 0.10680573444891422, "mean_env_wait_ms": 2.062292097519952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072133541107177734, "StateBufferConnector_ms": 0.0038433074951171875, "ViewRequirementAgentConnector_ms": 0.09782719612121582}, "num_episodes": 24, "episode_return_max": -203.81542234000418, "episode_return_min": -277.76330683237387, "episode_return_mean": -240.7844020835236, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121500, "num_agent_steps_trained": 121000, "num_env_steps_sampled": 121500, "num_env_steps_trained": 121000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 212.15709993261103, "num_env_steps_trained_throughput_per_sec": 207.44249771188635, "timesteps_total": 121500, "num_env_steps_sampled_lifetime": 121500, "num_agent_steps_sampled_lifetime": 121500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 121500, "timers": {"training_iteration_time_ms": 10401.99, "restore_workers_time_ms": 0.013, "training_step_time_ms": 712.268, "sample_time_ms": 697.71, "synch_weights_time_ms": 12.975}, "counters": {"num_env_steps_sampled": 121500, "num_env_steps_trained": 121000, "num_agent_steps_sampled": 121500, "num_agent_steps_trained": 121000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 810, "num_samples_added_to_queue": 121000}, "done": false, "training_iteration": 59, "trial_id": "13390_00000", "date": "2024-10-13_00-48-42", "timestamp": 1728776922, "time_this_iter_s": 10.617087602615356, "time_total_s": 614.2241623401642, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b59c30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 614.2241623401642, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 16.88666666666667, "ram_util_percent": 61.11333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -372103.4375, "policy_loss": -373856.1875, "entropy": 29.2393741607666, "entropy_coeff": 0.01, "var_gnorm": 16.157958984375, "vf_loss": 191355.609375, "vf_explained_var": 0.11373591423034668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 224.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 123750, "num_env_steps_trained": 123200, "num_agent_steps_sampled": 123750, "num_agent_steps_trained": 123200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 825, "num_samples_added_to_queue": 123750, "learner_queue": {"size_count": 224, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.833, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 2487.527, "learner_dequeue_time_ms": 22187.966}}, "env_runners": {"episode_reward_max": -203.81542234000418, "episode_reward_min": -277.76330683237387, "episode_reward_mean": -241.70914475006836, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -277.76330683237387}, "policy_reward_max": {"default_policy": -203.81542234000418}, "policy_reward_mean": {"default_policy": -241.70914475006836}, "custom_metrics": {"num_consolidated_mean": 0.6835, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0812, "num_overloaded_min": 0.95, "num_overloaded_max": 1.21, "num_moves_mean": 9.9312, "num_moves_min": 9.55, "num_moves_max": 10.24, "mean_accuracy_mean": 41.001896666666674, "mean_accuracy_min": 40.65033333333333, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 5.912999999999999, "num_model_switches_min": 5.35, "num_model_switches_max": 6.41, "num_slav_mean": 0.13241833333333333, "num_slav_min": 0.10836666666666668, "num_slav_max": 0.1554, "cpu_conserved_cost_mean": 2.8007999999999997, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5759210892434712, "mean_cluster_cpu_util_min": 0.5524610973466196, "mean_cluster_cpu_util_max": 0.5952042375600991, "mean_cluster_mem_util_mean": 0.3680268783565113, "mean_cluster_mem_util_min": 0.35751880292201266, "mean_cluster_mem_util_max": 0.3770431143976578, "reward_consolidation_mean_mean": -0.5068547808340187, "reward_consolidation_mean_min": -0.763113101221481, "reward_consolidation_mean_max": -0.2959980505041275, "reward_illegal_mean_mean": -1.8019999999999996, "reward_illegal_mean_min": -2.016666666666666, "reward_illegal_mean_max": -1.5833333333333328, "reward_accuracy_mean_mean": 0.8269166666666663, "reward_accuracy_mean_min": 0.4749999999999997, "reward_accuracy_mean_max": 1.4000000000000017, "reward_sla_mean_mean": -0.9351533333333332, "reward_sla_mean_min": -1.8186666666666667, "reward_sla_mean_max": -0.524, "reward_consolidation_sum_mean": -50.685478083401875, "reward_consolidation_sum_min": -76.3113101221481, "reward_consolidation_sum_max": -29.599805050412748, "reward_illegal_sum_mean": -180.19999999999996, "reward_illegal_sum_min": -201.66666666666663, "reward_illegal_sum_max": -158.3333333333333, "reward_accuracy_sum_mean": 82.69166666666666, "reward_accuracy_sum_min": 47.49999999999997, "reward_accuracy_sum_max": 140.00000000000017, "reward_sla_sum_mean": -93.51533333333333, "reward_sla_sum_min": -181.86666666666667, "reward_sla_sum_max": -52.400000000000006, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3221.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-247.74513387553674, -233.2389990557129, -233.2835572207499, -241.13249261323813, -255.80272624813432, -219.27221968381596, -250.95661153248636, -235.08148283529803, -243.16291084102468, -261.84158518383134, -233.62349447135134, -254.6569070029545, -248.24945018124214, -259.46540863261146, -219.4915257851288, -240.45136312406694, -240.21702458192445, -242.9368607024276, -222.01551372262333, -249.1021444454595, -218.10926619756913, -220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2859080398607148, "mean_inference_ms": 2.416868035931281, "mean_action_processing_ms": 0.10674199987765431, "mean_env_wait_ms": 2.0610714941853456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074100494384765625, "StateBufferConnector_ms": 0.0038247108459472656, "ViewRequirementAgentConnector_ms": 0.09701728820800781}, "num_episodes": 21, "episode_return_max": -203.81542234000418, "episode_return_min": -277.76330683237387, "episode_return_mean": -241.70914475006836, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123750, "num_agent_steps_trained": 123200, "num_env_steps_sampled": 123750, "num_env_steps_trained": 123200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 211.57316501073595, "num_env_steps_trained_throughput_per_sec": 206.8715391216085, "timesteps_total": 123750, "num_env_steps_sampled_lifetime": 123750, "num_agent_steps_sampled_lifetime": 123750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 123750, "timers": {"training_iteration_time_ms": 10413.184, "restore_workers_time_ms": 0.015, "training_step_time_ms": 719.992, "sample_time_ms": 702.938, "synch_weights_time_ms": 15.526}, "counters": {"num_env_steps_sampled": 123750, "num_env_steps_trained": 123200, "num_agent_steps_sampled": 123750, "num_agent_steps_trained": 123200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 825, "num_samples_added_to_queue": 123750}, "done": false, "training_iteration": 60, "trial_id": "13390_00000", "date": "2024-10-13_00-48-53", "timestamp": 1728776933, "time_this_iter_s": 10.652606010437012, "time_total_s": 624.8767683506012, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069d6f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 624.8767683506012, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.733333333333334, "ram_util_percent": 60.97333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -366200.3125, "policy_loss": -367953.1875, "entropy": 29.203449249267578, "entropy_coeff": 0.01, "var_gnorm": 16.166820526123047, "vf_loss": 191348.46875, "vf_explained_var": 0.10472583770751953}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 228.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 125850, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125850, "num_agent_steps_trained": 125400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 839, "num_samples_added_to_queue": 125400, "learner_queue": {"size_count": 228, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.508, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 2488.602, "learner_dequeue_time_ms": 22187.966}}, "env_runners": {"episode_reward_max": -203.81542234000418, "episode_reward_min": -277.76330683237387, "episode_reward_mean": -241.77137463827705, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -277.76330683237387}, "policy_reward_max": {"default_policy": -203.81542234000418}, "policy_reward_mean": {"default_policy": -241.77137463827705}, "custom_metrics": {"num_consolidated_mean": 0.6831, "num_consolidated_min": 0.49, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.079, "num_overloaded_min": 0.93, "num_overloaded_max": 1.27, "num_moves_mean": 9.921100000000001, "num_moves_min": 9.55, "num_moves_max": 10.24, "mean_accuracy_mean": 41.01177666666668, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.245666666666665, "num_model_switches_mean": 5.892500000000001, "num_model_switches_min": 5.35, "num_model_switches_max": 6.41, "num_slav_mean": 0.13114816666666668, "num_slav_min": 0.10836666666666668, "num_slav_max": 0.1554, "cpu_conserved_cost_mean": 2.8016, "cpu_conserved_cost_min": 1.82, "cpu_conserved_cost_max": 3.38, "mean_cluster_cpu_util_mean": 0.5759774052809088, "mean_cluster_cpu_util_min": 0.5524610973466196, "mean_cluster_cpu_util_max": 0.5936978764538303, "mean_cluster_mem_util_mean": 0.367899714570955, "mean_cluster_mem_util_min": 0.35751880292201266, "mean_cluster_mem_util_max": 0.3770431143976578, "reward_consolidation_mean_mean": -0.5134770797161047, "reward_consolidation_mean_min": -0.763113101221481, "reward_consolidation_mean_max": -0.2959980505041275, "reward_illegal_mean_mean": -1.7983333333333333, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5499999999999994, "reward_accuracy_mean_mean": 0.8470833333333333, "reward_accuracy_mean_min": 0.4749999999999997, "reward_accuracy_mean_max": 1.4000000000000017, "reward_sla_mean_mean": -0.9529866666666666, "reward_sla_mean_min": -1.8186666666666667, "reward_sla_mean_max": -0.45399999999999996, "reward_consolidation_sum_mean": -51.34770797161046, "reward_consolidation_sum_min": -76.3113101221481, "reward_consolidation_sum_max": -29.599805050412748, "reward_illegal_sum_mean": -179.8333333333333, "reward_illegal_sum_min": -211.66666666666669, "reward_illegal_sum_max": -154.99999999999994, "reward_accuracy_sum_mean": 84.70833333333334, "reward_accuracy_sum_min": 47.49999999999997, "reward_accuracy_sum_max": 140.00000000000017, "reward_sla_sum_mean": -95.29866666666665, "reward_sla_sum_min": -181.86666666666667, "reward_sla_sum_max": -45.4, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2283.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-220.64912120381354, -238.73346126899975, -237.50976270979913, -231.2628986566753, -238.03174022967494, -238.81143805781474, -250.3705747966736, -251.03095433915135, -223.9017819610708, -277.76330683237387, -229.58556154619382, -255.0121569344177, -238.85885954491445, -237.8316153400956, -215.99278381918415, -271.6553565445185, -267.3426574065613, -268.4273508178743, -235.85501538274076, -253.4428767248469, -250.77304517347463, -235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28571111105400254, "mean_inference_ms": 2.41455079828229, "mean_action_processing_ms": 0.10667679805636117, "mean_env_wait_ms": 2.05984869528682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007299184799194336, "StateBufferConnector_ms": 0.003777027130126953, "ViewRequirementAgentConnector_ms": 0.09554839134216309}, "num_episodes": 21, "episode_return_max": -203.81542234000418, "episode_return_min": -277.76330683237387, "episode_return_mean": -241.77137463827705, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125850, "num_agent_steps_trained": 125400, "num_env_steps_sampled": 125850, "num_env_steps_trained": 125400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.2615607955402, "num_env_steps_trained_throughput_per_sec": 219.22639702389924, "timesteps_total": 125850, "num_env_steps_sampled_lifetime": 125850, "num_agent_steps_sampled_lifetime": 125850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 125850, "timers": {"training_iteration_time_ms": 10405.849, "restore_workers_time_ms": 0.015, "training_step_time_ms": 710.38, "sample_time_ms": 694.451, "synch_weights_time_ms": 14.48}, "counters": {"num_env_steps_sampled": 125850, "num_env_steps_trained": 125400, "num_agent_steps_sampled": 125850, "num_agent_steps_trained": 125400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 839, "num_samples_added_to_queue": 125400}, "done": false, "training_iteration": 61, "trial_id": "13390_00000", "date": "2024-10-13_00-49-03", "timestamp": 1728776943, "time_this_iter_s": 10.04631233215332, "time_total_s": 634.9230806827545, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f240760>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 634.9230806827545, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.040000000000003, "ram_util_percent": 59.77999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -352156.40625, "policy_loss": -353716.15625, "entropy": 29.137760162353516, "entropy_coeff": 0.01, "var_gnorm": 16.17530059814453, "vf_loss": 171999.140625, "vf_explained_var": 0.12820744514465332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 232.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 127950, "num_env_steps_trained": 127600, "num_agent_steps_sampled": 127950, "num_agent_steps_trained": 127600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 853, "num_samples_added_to_queue": 127600, "learner_queue": {"size_count": 232, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.472, "learner_load_time_ms": 0.495, "learner_load_wait_time_ms": 2604.376, "learner_dequeue_time_ms": 22187.966}}, "env_runners": {"episode_reward_max": -203.81542234000418, "episode_reward_min": -276.4882664717169, "episode_reward_mean": -240.80079155624594, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -276.4882664717169}, "policy_reward_max": {"default_policy": -203.81542234000418}, "policy_reward_mean": {"default_policy": -240.80079155624594}, "custom_metrics": {"num_consolidated_mean": 0.6873, "num_consolidated_min": 0.52, "num_consolidated_max": 0.84, "num_overloaded_mean": 1.0871000000000002, "num_overloaded_min": 0.93, "num_overloaded_max": 1.27, "num_moves_mean": 9.8997, "num_moves_min": 9.56, "num_moves_max": 10.24, "mean_accuracy_mean": 41.01500666666666, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.27733333333334, "num_model_switches_mean": 5.878099999999998, "num_model_switches_min": 5.35, "num_model_switches_max": 6.34, "num_slav_mean": 0.12946816666666666, "num_slav_min": 0.10836666666666668, "num_slav_max": 0.1554, "cpu_conserved_cost_mean": 2.817200000000001, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.5767796597819302, "mean_cluster_cpu_util_min": 0.55665130519054, "mean_cluster_cpu_util_max": 0.6000436706847352, "mean_cluster_mem_util_mean": 0.36792636651633215, "mean_cluster_mem_util_min": 0.35929925514509603, "mean_cluster_mem_util_max": 0.3770431143976578, "reward_consolidation_mean_mean": -0.5031512488957934, "reward_consolidation_mean_min": -0.763113101221481, "reward_consolidation_mean_max": -0.27813381461512693, "reward_illegal_mean_mean": -1.8118333333333332, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5499999999999994, "reward_accuracy_mean_mean": 0.8299166666666666, "reward_accuracy_mean_min": 0.4083333333333329, "reward_accuracy_mean_max": 1.4000000000000017, "reward_sla_mean_mean": -0.9229400000000001, "reward_sla_mean_min": -1.8186666666666667, "reward_sla_mean_max": -0.4446666666666666, "reward_consolidation_sum_mean": -50.31512488957933, "reward_consolidation_sum_min": -76.3113101221481, "reward_consolidation_sum_max": -27.81338146151269, "reward_illegal_sum_mean": -181.1833333333333, "reward_illegal_sum_min": -211.66666666666669, "reward_illegal_sum_max": -154.99999999999994, "reward_accuracy_sum_mean": 82.99166666666667, "reward_accuracy_sum_min": 40.833333333333286, "reward_accuracy_sum_max": 140.00000000000017, "reward_sla_sum_mean": -92.294, "reward_sla_sum_min": -181.86666666666667, "reward_sla_sum_max": -44.46666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1969.0, "global_timestep_min": 100, "global_timestep_max": 3600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-235.23313838374582, -230.27462304669643, -235.55582259587553, -219.17449511102978, -236.17254866124463, -234.0532882512413, -276.4882664717169, -250.14464345548132, -212.6000243686983, -227.9403972097839, -252.9558926558835, -261.72480124280355, -258.595141490755, -243.6529440433761, -237.49649090742915, -253.11895275518575, -264.97851899235434, -217.58862895610568, -252.05743397605778, -227.43488683785674, -218.31180663437812, -251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855751761840913, "mean_inference_ms": 2.4125884782752482, "mean_action_processing_ms": 0.10662829430376497, "mean_env_wait_ms": 2.058858766772182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007222175598144531, "StateBufferConnector_ms": 0.0037293434143066406, "ViewRequirementAgentConnector_ms": 0.09510636329650879}, "num_episodes": 21, "episode_return_max": -203.81542234000418, "episode_return_min": -276.4882664717169, "episode_return_mean": -240.80079155624594, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127950, "num_agent_steps_trained": 127600, "num_env_steps_sampled": 127950, "num_env_steps_trained": 127600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 193.01514796350074, "num_env_steps_trained_throughput_per_sec": 202.2063454855722, "timesteps_total": 127950, "num_env_steps_sampled_lifetime": 127950, "num_agent_steps_sampled_lifetime": 127950, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 127950, "timers": {"training_iteration_time_ms": 10439.662, "restore_workers_time_ms": 0.015, "training_step_time_ms": 808.898, "sample_time_ms": 790.476, "synch_weights_time_ms": 16.661}, "counters": {"num_env_steps_sampled": 127950, "num_env_steps_trained": 127600, "num_agent_steps_sampled": 127950, "num_agent_steps_trained": 127600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 853, "num_samples_added_to_queue": 127600}, "done": false, "training_iteration": 62, "trial_id": "13390_00000", "date": "2024-10-13_00-49-14", "timestamp": 1728776954, "time_this_iter_s": 10.918896675109863, "time_total_s": 645.8419773578644, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069feb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 645.8419773578644, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.493333333333332, "ram_util_percent": 59.966666666666654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -358129.46875, "policy_loss": -359795.4375, "entropy": 29.08536720275879, "entropy_coeff": 0.01, "var_gnorm": 16.18186378479004, "vf_loss": 182593.625, "vf_explained_var": 0.12310636043548584}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 235.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 129900, "num_env_steps_trained": 129250, "num_agent_steps_sampled": 129900, "num_agent_steps_trained": 129250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 866, "num_samples_added_to_queue": 129800, "learner_queue": {"size_count": 235, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.58, "learner_load_time_ms": 0.501, "learner_load_wait_time_ms": 2803.283, "learner_dequeue_time_ms": 21902.952}}, "env_runners": {"episode_reward_max": -203.81542234000418, "episode_reward_min": -272.95528953059807, "episode_reward_mean": -239.57649562886456, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.95528953059807}, "policy_reward_max": {"default_policy": -203.81542234000418}, "policy_reward_mean": {"default_policy": -239.57649562886456}, "custom_metrics": {"num_consolidated_mean": 0.6794, "num_consolidated_min": 0.52, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0871000000000002, "num_overloaded_min": 0.93, "num_overloaded_max": 1.27, "num_moves_mean": 9.8987, "num_moves_min": 9.56, "num_moves_max": 10.28, "mean_accuracy_mean": 41.02001, "mean_accuracy_min": 40.77066666666666, "mean_accuracy_max": 41.27733333333334, "num_model_switches_mean": 5.8483, "num_model_switches_min": 5.47, "num_model_switches_max": 6.34, "num_slav_mean": 0.12642483333333335, "num_slav_min": 0.10495000000000002, "num_slav_max": 0.14866666666666664, "cpu_conserved_cost_mean": 2.7796000000000003, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.5762017085739614, "mean_cluster_cpu_util_min": 0.55665130519054, "mean_cluster_cpu_util_max": 0.6000436706847352, "mean_cluster_mem_util_mean": 0.36748566804622695, "mean_cluster_mem_util_min": 0.35929925514509603, "mean_cluster_mem_util_max": 0.37601685772410226, "reward_consolidation_mean_mean": -0.5120816229553139, "reward_consolidation_mean_min": -0.7391215084224316, "reward_consolidation_mean_max": -0.27813381461512693, "reward_illegal_mean_mean": -1.8118333333333332, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5499999999999994, "reward_accuracy_mean_mean": 0.8424166666666667, "reward_accuracy_mean_min": 0.4083333333333329, "reward_accuracy_mean_max": 1.2916666666666674, "reward_sla_mean_mean": -0.9142666666666668, "reward_sla_mean_min": -1.4280000000000002, "reward_sla_mean_max": -0.4446666666666666, "reward_consolidation_sum_mean": -51.208162295531395, "reward_consolidation_sum_min": -73.91215084224316, "reward_consolidation_sum_max": -27.81338146151269, "reward_illegal_sum_mean": -181.18333333333328, "reward_illegal_sum_min": -211.66666666666669, "reward_illegal_sum_max": -154.99999999999994, "reward_accuracy_sum_mean": 84.24166666666667, "reward_accuracy_sum_min": 40.833333333333286, "reward_accuracy_sum_max": 129.16666666666674, "reward_sla_sum_mean": -91.42666666666665, "reward_sla_sum_min": -142.8, "reward_sla_sum_max": -44.46666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2662.0, "global_timestep_min": 800, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-251.66324895671502, -248.388083706479, -224.03510920222973, -236.55066861616262, -244.75254500593965, -254.18966767187538, -241.2738676170457, -227.20654299552206, -244.26252398793753, -249.93296171068246, -220.3950988455328, -203.81542234000418, -239.79372810624733, -238.2989186390083, -237.11290627189365, -234.727975265771, -215.3614822260804, -233.60497426056213, -248.92124036674892, -242.96014499375534, -223.62382040269264, -245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28554388757300964, "mean_inference_ms": 2.4108247581424918, "mean_action_processing_ms": 0.10660190547432558, "mean_env_wait_ms": 2.0584305115565176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007224559783935547, "StateBufferConnector_ms": 0.003777027130126953, "ViewRequirementAgentConnector_ms": 0.09731793403625488}, "num_episodes": 21, "episode_return_max": -203.81542234000418, "episode_return_min": -272.95528953059807, "episode_return_mean": -239.57649562886456, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129900, "num_agent_steps_trained": 129250, "num_env_steps_sampled": 129900, "num_env_steps_trained": 129250, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 183.07496645446943, "num_env_steps_trained_throughput_per_sec": 154.90958699993567, "timesteps_total": 129900, "num_env_steps_sampled_lifetime": 129900, "num_agent_steps_sampled_lifetime": 129900, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 129900, "timers": {"training_iteration_time_ms": 10464.155, "restore_workers_time_ms": 0.017, "training_step_time_ms": 727.79, "sample_time_ms": 711.532, "synch_weights_time_ms": 14.761}, "counters": {"num_env_steps_sampled": 129900, "num_env_steps_trained": 129250, "num_agent_steps_sampled": 129900, "num_agent_steps_trained": 129250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 866, "num_samples_added_to_queue": 129800}, "done": false, "training_iteration": 63, "trial_id": "13390_00000", "date": "2024-10-13_00-49-25", "timestamp": 1728776965, "time_this_iter_s": 10.664736270904541, "time_total_s": 656.5067136287689, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069d750>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 656.5067136287689, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 27.93125, "ram_util_percent": 62.79375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -335065.0, "policy_loss": -336524.1875, "entropy": 29.027381896972656, "entropy_coeff": 0.01, "var_gnorm": 16.189037322998047, "vf_loss": 161884.4375, "vf_explained_var": 0.13108736276626587}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 131450, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 131450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 880, "num_samples_added_to_queue": 132000, "learner_queue": {"size_count": 239, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.419, "learner_load_time_ms": 0.501, "learner_load_wait_time_ms": 2758.028, "learner_dequeue_time_ms": 21902.952}}, "env_runners": {"episode_reward_max": -206.40759389564099, "episode_reward_min": -272.95528953059807, "episode_reward_mean": -237.35556657223785, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.95528953059807}, "policy_reward_max": {"default_policy": -206.40759389564099}, "policy_reward_mean": {"default_policy": -237.35556657223785}, "custom_metrics": {"num_consolidated_mean": 0.6835000000000001, "num_consolidated_min": 0.52, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.0786, "num_overloaded_min": 0.9, "num_overloaded_max": 1.27, "num_moves_mean": 9.8799, "num_moves_min": 9.56, "num_moves_max": 10.28, "mean_accuracy_mean": 41.01716, "mean_accuracy_min": 40.77066666666666, "mean_accuracy_max": 41.27733333333334, "num_model_switches_mean": 5.8219, "num_model_switches_min": 5.47, "num_model_switches_max": 6.34, "num_slav_mean": 0.12429766666666664, "num_slav_min": 0.10475000000000001, "num_slav_max": 0.14866666666666664, "cpu_conserved_cost_mean": 2.7846, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.36, "mean_cluster_cpu_util_mean": 0.5761085494098109, "mean_cluster_cpu_util_min": 0.55665130519054, "mean_cluster_cpu_util_max": 0.6000436706847352, "mean_cluster_mem_util_mean": 0.36705417298142895, "mean_cluster_mem_util_min": 0.35929925514509603, "mean_cluster_mem_util_max": 0.37601685772410226, "reward_consolidation_mean_mean": -0.5250556657223797, "reward_consolidation_mean_min": -0.7750214749154712, "reward_consolidation_mean_max": -0.27813381461512693, "reward_illegal_mean_mean": -1.7976666666666665, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.867, "reward_accuracy_mean_min": 0.4083333333333329, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.9178333333333333, "reward_sla_mean_min": -1.4280000000000002, "reward_sla_mean_max": -0.42533333333333334, "reward_consolidation_sum_mean": -52.50556657223797, "reward_consolidation_sum_min": -77.50214749154712, "reward_consolidation_sum_max": -27.81338146151269, "reward_illegal_sum_mean": -179.76666666666668, "reward_illegal_sum_min": -211.66666666666669, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 86.7, "reward_accuracy_sum_min": 40.833333333333286, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -91.78333333333335, "reward_sla_sum_min": -142.8, "reward_sla_sum_max": -42.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3375.0, "global_timestep_min": 1600, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-245.05534131408206, -247.99444393676308, -243.7384629443481, -252.36354138109573, -256.6995887782142, -267.90895854275186, -255.16219805659605, -242.41862682384453, -237.97850680800505, -248.75266380334443, -243.84331536141815, -265.5836912485911, -254.97953029333803, -236.6999238478173, -240.0987632885558, -242.53424411343605, -233.90728928691095, -268.79681988485794, -217.52574248377954, -244.7793627585364, -248.60417923177687, -243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855010208661632, "mean_inference_ms": 2.412605115550433, "mean_action_processing_ms": 0.10659627908391489, "mean_env_wait_ms": 2.058518166078782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006968975067138672, "StateBufferConnector_ms": 0.0037450790405273438, "ViewRequirementAgentConnector_ms": 0.09713387489318848}, "num_episodes": 21, "episode_return_max": -206.40759389564099, "episode_return_min": -272.95528953059807, "episode_return_mean": -237.35556657223785, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 131450, "num_env_steps_sampled": 132000, "num_env_steps_trained": 131450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 207.00887927437216, "num_env_steps_trained_throughput_per_sec": 216.8664449541042, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 132000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 10451.373, "restore_workers_time_ms": 0.014, "training_step_time_ms": 716.458, "sample_time_ms": 699.76, "synch_weights_time_ms": 15.179}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 131450, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 131450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 880, "num_samples_added_to_queue": 132000}, "done": false, "training_iteration": 64, "trial_id": "13390_00000", "date": "2024-10-13_00-49-35", "timestamp": 1728776975, "time_this_iter_s": 10.156490087509155, "time_total_s": 666.6632037162781, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069db10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 666.6632037162781, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.185714285714287, "ram_util_percent": 62.04285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -320441.8125, "policy_loss": -321787.34375, "entropy": 28.94919776916504, "entropy_coeff": 0.01, "var_gnorm": 16.19732093811035, "vf_loss": 150474.859375, "vf_explained_var": 0.1382792592048645}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454546746}}, "num_env_steps_sampled": 134100, "num_env_steps_trained": 133650, "num_agent_steps_sampled": 134100, "num_agent_steps_trained": 133650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 894, "num_samples_added_to_queue": 133650, "learner_queue": {"size_count": 243, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.45, "learner_load_time_ms": 0.439, "learner_load_wait_time_ms": 2560.272, "learner_dequeue_time_ms": 21701.858}}, "env_runners": {"episode_reward_max": -204.24975783605936, "episode_reward_min": -272.95528953059807, "episode_reward_mean": -233.69629946084245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.95528953059807}, "policy_reward_max": {"default_policy": -204.24975783605936}, "policy_reward_mean": {"default_policy": -233.69629946084245}, "custom_metrics": {"num_consolidated_mean": 0.6862999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.078, "num_overloaded_min": 0.89, "num_overloaded_max": 1.27, "num_moves_mean": 9.861199999999998, "num_moves_min": 9.56, "num_moves_max": 10.28, "mean_accuracy_mean": 40.99879333333333, "mean_accuracy_min": 40.656666666666666, "mean_accuracy_max": 41.27733333333334, "num_model_switches_mean": 5.7936999999999985, "num_model_switches_min": 5.47, "num_model_switches_max": 6.31, "num_slav_mean": 0.12070299999999999, "num_slav_min": 0.10175000000000001, "num_slav_max": 0.14503333333333335, "cpu_conserved_cost_mean": 2.8113999999999995, "cpu_conserved_cost_min": 1.98, "cpu_conserved_cost_max": 3.48, "mean_cluster_cpu_util_mean": 0.5770633676884561, "mean_cluster_cpu_util_min": 0.5590563373619999, "mean_cluster_cpu_util_max": 0.6000436706847352, "mean_cluster_mem_util_mean": 0.36739540561403883, "mean_cluster_mem_util_min": 0.35935224676368444, "mean_cluster_mem_util_max": 0.37601685772410226, "reward_consolidation_mean_mean": -0.5246796612750922, "reward_consolidation_mean_min": -0.7986624630661916, "reward_consolidation_mean_max": -0.27813381461512693, "reward_illegal_mean_mean": -1.7966666666666666, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8602500000000001, "reward_accuracy_mean_min": 0.4083333333333329, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.8758666666666666, "reward_sla_mean_min": -1.4966666666666666, "reward_sla_mean_max": -0.42533333333333334, "reward_consolidation_sum_mean": -52.46796612750923, "reward_consolidation_sum_min": -79.86624630661916, "reward_consolidation_sum_max": -27.81338146151269, "reward_illegal_sum_mean": -179.6666666666666, "reward_illegal_sum_min": -211.66666666666669, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 86.025, "reward_accuracy_sum_min": 40.833333333333286, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -87.58666666666666, "reward_sla_sum_min": -149.66666666666666, "reward_sla_sum_max": -42.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4075.0, "global_timestep_min": 2300, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-243.65021170306733, -239.59465411678678, -266.68607633494764, -236.81540406348043, -250.59579335343733, -232.8898534832006, -220.43955953577614, -256.0080020713394, -229.93932194096664, -240.0911998537879, -241.7637942063419, -235.6070455999267, -258.02602272381125, -240.9604892016203, -223.54286149441046, -225.83598342928488, -231.5144536842425, -246.38522038441621, -245.92495354716863, -240.51893752474925, -244.3503853300436, -217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28549429480260896, "mean_inference_ms": 2.4124003140366135, "mean_action_processing_ms": 0.10658311318519219, "mean_env_wait_ms": 2.058460216195517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006938934326171875, "StateBufferConnector_ms": 0.003804445266723633, "ViewRequirementAgentConnector_ms": 0.09959197044372559}, "num_episodes": 21, "episode_return_max": -204.24975783605936, "episode_return_min": -272.95528953059807, "episode_return_mean": -233.69629946084245, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134100, "num_agent_steps_trained": 133650, "num_env_steps_sampled": 134100, "num_env_steps_trained": 133650, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.6239012370857, "num_env_steps_trained_throughput_per_sec": 215.41551558170883, "timesteps_total": 134100, "num_env_steps_sampled_lifetime": 134100, "num_agent_steps_sampled_lifetime": 134100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 134100, "timers": {"training_iteration_time_ms": 10454.84, "restore_workers_time_ms": 0.014, "training_step_time_ms": 741.525, "sample_time_ms": 725.011, "synch_weights_time_ms": 15.007}, "counters": {"num_env_steps_sampled": 134100, "num_env_steps_trained": 133650, "num_agent_steps_sampled": 134100, "num_agent_steps_trained": 133650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 894, "num_samples_added_to_queue": 133650}, "done": false, "training_iteration": 65, "trial_id": "13390_00000", "date": "2024-10-13_00-49-45", "timestamp": 1728776985, "time_this_iter_s": 10.225045204162598, "time_total_s": 676.8882489204407, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069fca0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 676.8882489204407, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.473333333333336, "ram_util_percent": 62.053333333333356}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -357840.90625, "policy_loss": -359541.0625, "entropy": 28.870973587036133, "entropy_coeff": 0.01, "var_gnorm": 16.20528221130371, "vf_loss": 185893.625, "vf_explained_var": 0.13633602857589722}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 0.2727272727272805}}, "num_env_steps_sampled": 136200, "num_env_steps_trained": 135850, "num_agent_steps_sampled": 136200, "num_agent_steps_trained": 135850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 908, "num_samples_added_to_queue": 135850, "learner_queue": {"size_count": 247, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.102, "learner_load_time_ms": 0.439, "learner_load_wait_time_ms": 2615.96, "learner_dequeue_time_ms": 21701.858}}, "env_runners": {"episode_reward_max": -204.24975783605936, "episode_reward_min": -272.95528953059807, "episode_reward_mean": -233.39728075786647, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.95528953059807}, "policy_reward_max": {"default_policy": -204.24975783605936}, "policy_reward_mean": {"default_policy": -233.39728075786647}, "custom_metrics": {"num_consolidated_mean": 0.681, "num_consolidated_min": 0.52, "num_consolidated_max": 0.91, "num_overloaded_mean": 1.0811, "num_overloaded_min": 0.89, "num_overloaded_max": 1.24, "num_moves_mean": 9.856, "num_moves_min": 9.58, "num_moves_max": 10.28, "mean_accuracy_mean": 40.984733333333324, "mean_accuracy_min": 40.656666666666666, "mean_accuracy_max": 41.27733333333334, "num_model_switches_mean": 5.7752, "num_model_switches_min": 5.47, "num_model_switches_max": 6.31, "num_slav_mean": 0.1191505, "num_slav_min": 0.10175000000000001, "num_slav_max": 0.13931666666666667, "cpu_conserved_cost_mean": 2.7882, "cpu_conserved_cost_min": 2.12, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5768054414511167, "mean_cluster_cpu_util_min": 0.5590563373619999, "mean_cluster_cpu_util_max": 0.6047403670549582, "mean_cluster_mem_util_mean": 0.3672866633567984, "mean_cluster_mem_util_min": 0.35935224676368444, "mean_cluster_mem_util_max": 0.37766405662475955, "reward_consolidation_mean_mean": -0.5190561409119987, "reward_consolidation_mean_min": -0.7986624630661916, "reward_consolidation_mean_max": -0.27813381461512693, "reward_illegal_mean_mean": -1.8018333333333334, "reward_illegal_mean_min": -2.0666666666666664, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8425833333333334, "reward_accuracy_mean_min": 0.4083333333333329, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.8556666666666668, "reward_sla_mean_min": -1.4966666666666666, "reward_sla_mean_max": -0.42533333333333334, "reward_consolidation_sum_mean": -51.90561409119985, "reward_consolidation_sum_min": -79.86624630661916, "reward_consolidation_sum_max": -27.81338146151269, "reward_illegal_sum_mean": -180.18333333333328, "reward_illegal_sum_min": -206.66666666666666, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 84.25833333333334, "reward_accuracy_sum_min": 40.833333333333286, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -85.56666666666666, "reward_sla_sum_min": -149.66666666666666, "reward_sla_sum_max": -42.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4775.0, "global_timestep_min": 3000, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.76324895671513, -234.21681440190062, -242.24671479484599, -235.4042614761336, -226.5461756373937, -234.68596972189206, -225.02638520820014, -231.98989308233573, -247.5309299704529, -249.4105546924975, -272.95528953059807, -254.07671570867217, -237.77946023333013, -261.5774985531083, -230.56169849827884, -225.3184501507814, -227.63669925980082, -242.88926254226433, -226.2067927746808, -222.41629656705945, -232.4573121325657, -208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855194503600064, "mean_inference_ms": 2.4122729875585343, "mean_action_processing_ms": 0.10657751537592419, "mean_env_wait_ms": 2.05848884962969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055997848510742, "StateBufferConnector_ms": 0.0038759708404541016, "ViewRequirementAgentConnector_ms": 0.10094738006591797}, "num_episodes": 21, "episode_return_max": -204.24975783605936, "episode_return_min": -272.95528953059807, "episode_return_mean": -233.39728075786647, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136200, "num_agent_steps_trained": 135850, "num_env_steps_sampled": 136200, "num_env_steps_trained": 135850, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 207.00678240382334, "num_env_steps_trained_throughput_per_sec": 216.86424823257684, "timesteps_total": 136200, "num_env_steps_sampled_lifetime": 136200, "num_agent_steps_sampled_lifetime": 136200, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 136200, "timers": {"training_iteration_time_ms": 10413.882, "restore_workers_time_ms": 0.014, "training_step_time_ms": 721.615, "sample_time_ms": 704.913, "synch_weights_time_ms": 15.128}, "counters": {"num_env_steps_sampled": 136200, "num_env_steps_trained": 135850, "num_agent_steps_sampled": 136200, "num_agent_steps_trained": 135850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 908, "num_samples_added_to_queue": 135850}, "done": false, "training_iteration": 66, "trial_id": "13390_00000", "date": "2024-10-13_00-49-56", "timestamp": 1728776996, "time_this_iter_s": 10.161768674850464, "time_total_s": 687.0500175952911, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c15ea0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 687.0500175952911, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.085714285714282, "ram_util_percent": 60.64285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -315290.9375, "policy_loss": -316630.71875, "entropy": 28.793237686157227, "entropy_coeff": 0.01, "var_gnorm": 16.213897705078125, "vf_loss": 149814.1875, "vf_explained_var": 0.14975547790527344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 138300, "num_env_steps_trained": 138050, "num_agent_steps_sampled": 138300, "num_agent_steps_trained": 138050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 922, "num_samples_added_to_queue": 138050, "learner_queue": {"size_count": 251, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.964, "learner_load_time_ms": 0.473, "learner_load_wait_time_ms": 2643.845, "learner_dequeue_time_ms": 21678.238}}, "env_runners": {"episode_reward_max": -204.24975783605936, "episode_reward_min": -263.8308751408816, "episode_reward_mean": -231.77769877242682, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -263.8308751408816}, "policy_reward_max": {"default_policy": -204.24975783605936}, "policy_reward_mean": {"default_policy": -231.77769877242682}, "custom_metrics": {"num_consolidated_mean": 0.6806, "num_consolidated_min": 0.52, "num_consolidated_max": 0.91, "num_overloaded_mean": 1.0850000000000002, "num_overloaded_min": 0.89, "num_overloaded_max": 1.26, "num_moves_mean": 9.857, "num_moves_min": 9.48, "num_moves_max": 10.28, "mean_accuracy_mean": 40.96725333333333, "mean_accuracy_min": 40.656666666666666, "mean_accuracy_max": 41.20766666666666, "num_model_switches_mean": 5.755799999999999, "num_model_switches_min": 5.27, "num_model_switches_max": 6.31, "num_slav_mean": 0.11620533333333335, "num_slav_min": 0.09793333333333334, "num_slav_max": 0.1371, "cpu_conserved_cost_mean": 2.7904, "cpu_conserved_cost_min": 2.12, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5769829318376944, "mean_cluster_cpu_util_min": 0.5590563373619999, "mean_cluster_cpu_util_max": 0.6047403670549582, "mean_cluster_mem_util_mean": 0.3672245422461179, "mean_cluster_mem_util_min": 0.35935224676368444, "mean_cluster_mem_util_max": 0.37766405662475955, "reward_consolidation_mean_mean": -0.513423654390935, "reward_consolidation_mean_min": -0.7986624630661916, "reward_consolidation_mean_max": -0.2697640805385483, "reward_illegal_mean_mean": -1.808333333333333, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.827833333333333, "reward_accuracy_mean_min": 0.4416666666666665, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.8238533333333332, "reward_sla_mean_min": -1.4966666666666666, "reward_sla_mean_max": -0.33666666666666667, "reward_consolidation_sum_mean": -51.34236543909349, "reward_consolidation_sum_min": -79.86624630661916, "reward_consolidation_sum_max": -26.976408053854826, "reward_illegal_sum_mean": -180.83333333333331, "reward_illegal_sum_min": -209.99999999999997, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 82.78333333333332, "reward_accuracy_sum_min": 44.16666666666665, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -82.3853333333333, "reward_sla_sum_min": -149.66666666666666, "reward_sla_sum_max": -33.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5475.0, "global_timestep_min": 3700, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-208.10802948612505, -231.71730482195605, -263.8308751408816, -237.10328977428495, -233.74863382984552, -225.81442931554392, -248.988741661336, -248.5598190624142, -256.4602637911601, -227.6788175089096, -247.79776417192102, -239.4201711901062, -235.26739772761894, -210.05284656858248, -226.05468335922507, -230.9137226232903, -212.84107953333927, -224.1473270583934, -221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854449397277157, "mean_inference_ms": 2.4112495365147053, "mean_action_processing_ms": 0.10654724656356712, "mean_env_wait_ms": 2.0579440966177027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070803165435791016, "StateBufferConnector_ms": 0.003877401351928711, "ViewRequirementAgentConnector_ms": 0.09984374046325684}, "num_episodes": 21, "episode_return_max": -204.24975783605936, "episode_return_min": -263.8308751408816, "episode_return_mean": -231.77769877242682, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138300, "num_agent_steps_trained": 138050, "num_env_steps_sampled": 138300, "num_env_steps_trained": 138050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.17420851951186, "num_env_steps_trained_throughput_per_sec": 213.89678987758387, "timesteps_total": 138300, "num_env_steps_sampled_lifetime": 138300, "num_agent_steps_sampled_lifetime": 138300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 138300, "timers": {"training_iteration_time_ms": 10401.714, "restore_workers_time_ms": 0.014, "training_step_time_ms": 753.286, "sample_time_ms": 735.988, "synch_weights_time_ms": 15.546}, "counters": {"num_env_steps_sampled": 138300, "num_env_steps_trained": 138050, "num_agent_steps_sampled": 138300, "num_agent_steps_trained": 138050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 922, "num_samples_added_to_queue": 138050}, "done": false, "training_iteration": 67, "trial_id": "13390_00000", "date": "2024-10-13_00-50-06", "timestamp": 1728777006, "time_this_iter_s": 10.297802448272705, "time_total_s": 697.3478200435638, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f241b70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 697.3478200435638, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.826666666666664, "ram_util_percent": 60.78666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -321577.6875, "policy_loss": -322898.46875, "entropy": 28.747642517089844, "entropy_coeff": 0.01, "var_gnorm": 16.219141006469727, "vf_loss": 147891.125, "vf_explained_var": 0.1738184094429016}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 254.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 140250, "num_env_steps_trained": 139700, "num_agent_steps_sampled": 140250, "num_agent_steps_trained": 139700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 935, "num_samples_added_to_queue": 140250, "learner_queue": {"size_count": 254, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.65, "learner_load_time_ms": 0.473, "learner_load_wait_time_ms": 2668.748, "learner_dequeue_time_ms": 21678.238}}, "env_runners": {"episode_reward_max": -204.24975783605936, "episode_reward_min": -258.50159919583297, "episode_reward_mean": -230.7433155746443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -258.50159919583297}, "policy_reward_max": {"default_policy": -204.24975783605936}, "policy_reward_mean": {"default_policy": -230.7433155746443}, "custom_metrics": {"num_consolidated_mean": 0.6781, "num_consolidated_min": 0.55, "num_consolidated_max": 0.91, "num_overloaded_mean": 1.0903, "num_overloaded_min": 0.89, "num_overloaded_max": 1.26, "num_moves_mean": 9.8508, "num_moves_min": 9.48, "num_moves_max": 10.14, "mean_accuracy_mean": 40.93957666666667, "mean_accuracy_min": 40.656666666666666, "mean_accuracy_max": 41.20766666666666, "num_model_switches_mean": 5.7471, "num_model_switches_min": 5.27, "num_model_switches_max": 6.31, "num_slav_mean": 0.11460066666666666, "num_slav_min": 0.09793333333333334, "num_slav_max": 0.13343333333333335, "cpu_conserved_cost_mean": 2.7826000000000004, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5767404732966286, "mean_cluster_cpu_util_min": 0.5573246107678472, "mean_cluster_cpu_util_max": 0.6047403670549582, "mean_cluster_mem_util_mean": 0.3670731165611814, "mean_cluster_mem_util_min": 0.35892618222394435, "mean_cluster_mem_util_max": 0.37766405662475955, "reward_consolidation_mean_mean": -0.5001531557464437, "reward_consolidation_mean_min": -0.7986624630661916, "reward_consolidation_mean_max": -0.2697640805385483, "reward_illegal_mean_mean": -1.8171666666666666, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8058333333333332, "reward_accuracy_mean_min": 0.4416666666666665, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.7959466666666666, "reward_sla_mean_min": -1.4966666666666666, "reward_sla_mean_max": -0.33666666666666667, "reward_consolidation_sum_mean": -50.01531557464438, "reward_consolidation_sum_min": -79.86624630661916, "reward_consolidation_sum_max": -26.976408053854826, "reward_illegal_sum_mean": -181.71666666666667, "reward_illegal_sum_min": -209.99999999999997, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 80.58333333333333, "reward_accuracy_sum_min": 44.16666666666665, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -79.59466666666665, "reward_sla_sum_min": -149.66666666666666, "reward_sla_sum_max": -33.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6082.0, "global_timestep_min": 4400, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-221.62535867677954, -221.40625970940312, -223.75426604526473, -258.50159919583297, -217.55812848396224, -225.84263913003733, -211.43061317737371, -242.00375582564186, -236.77257607603028, -221.93548082488033, -221.34736665752826, -206.40759389564099, -226.99535167077883, -222.69713363184985, -218.5341892838646, -244.38276219196445, -232.9567394681529, -213.40785281306162, -234.22995217642926, -239.44828657589323, -228.3102378994182, -215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28544288760058045, "mean_inference_ms": 2.4129381497020175, "mean_action_processing_ms": 0.10654826664558663, "mean_env_wait_ms": 2.0581400778041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007216930389404297, "StateBufferConnector_ms": 0.003980875015258789, "ViewRequirementAgentConnector_ms": 0.10317778587341309}, "num_episodes": 18, "episode_return_max": -204.24975783605936, "episode_return_min": -258.50159919583297, "episode_return_mean": -230.7433155746443, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140250, "num_agent_steps_trained": 139700, "num_env_steps_sampled": 140250, "num_env_steps_trained": 139700, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 183.91577765754923, "num_env_steps_trained_throughput_per_sec": 155.62104263331088, "timesteps_total": 140250, "num_env_steps_sampled_lifetime": 140250, "num_agent_steps_sampled_lifetime": 140250, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 140250, "timers": {"training_iteration_time_ms": 10419.664, "restore_workers_time_ms": 0.016, "training_step_time_ms": 842.387, "sample_time_ms": 823.978, "synch_weights_time_ms": 16.483}, "counters": {"num_env_steps_sampled": 140250, "num_env_steps_trained": 139700, "num_agent_steps_sampled": 140250, "num_agent_steps_trained": 139700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 935, "num_samples_added_to_queue": 140250}, "done": false, "training_iteration": 68, "trial_id": "13390_00000", "date": "2024-10-13_00-50-17", "timestamp": 1728777017, "time_this_iter_s": 10.612113237380981, "time_total_s": 707.9599332809448, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069cc70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 707.9599332809448, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 25.199999999999996, "ram_util_percent": 62.486666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -289406.75, "policy_loss": -290481.0, "entropy": 28.608657836914062, "entropy_coeff": 0.01, "var_gnorm": 16.227014541625977, "vf_loss": 123160.203125, "vf_explained_var": 0.1936345100402832}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 258.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 142350, "num_env_steps_trained": 141900, "num_agent_steps_sampled": 142350, "num_agent_steps_trained": 141900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 949, "num_samples_added_to_queue": 141900, "learner_queue": {"size_count": 258, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.75, "learner_load_time_ms": 0.435, "learner_load_wait_time_ms": 2682.34, "learner_dequeue_time_ms": 21878.277}}, "env_runners": {"episode_reward_max": -204.24975783605936, "episode_reward_min": -254.1825977032501, "episode_reward_mean": -230.41162999177553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.1825977032501}, "policy_reward_max": {"default_policy": -204.24975783605936}, "policy_reward_mean": {"default_policy": -230.41162999177553}, "custom_metrics": {"num_consolidated_mean": 0.6774000000000001, "num_consolidated_min": 0.55, "num_consolidated_max": 0.91, "num_overloaded_mean": 1.0986, "num_overloaded_min": 0.89, "num_overloaded_max": 1.26, "num_moves_mean": 9.8457, "num_moves_min": 9.48, "num_moves_max": 10.14, "mean_accuracy_mean": 40.927163333333326, "mean_accuracy_min": 40.656666666666666, "mean_accuracy_max": 41.20766666666666, "num_model_switches_mean": 5.7226, "num_model_switches_min": 5.27, "num_model_switches_max": 6.31, "num_slav_mean": 0.11178766666666666, "num_slav_min": 0.09271666666666668, "num_slav_max": 0.132, "cpu_conserved_cost_mean": 2.795200000000001, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5774144942066485, "mean_cluster_cpu_util_min": 0.5484868430553849, "mean_cluster_cpu_util_max": 0.6047403670549582, "mean_cluster_mem_util_mean": 0.3673472897865897, "mean_cluster_mem_util_min": 0.3549212355406297, "mean_cluster_mem_util_max": 0.37766405662475955, "reward_consolidation_mean_mean": -0.48445963325108904, "reward_consolidation_mean_min": -0.7986624630661916, "reward_consolidation_mean_max": -0.2562747875354108, "reward_illegal_mean_mean": -1.8309999999999997, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.7782499999999999, "reward_accuracy_mean_min": 0.43333333333333307, "reward_accuracy_mean_max": 1.325, "reward_sla_mean_mean": -0.7669066666666666, "reward_sla_mean_min": -1.4966666666666666, "reward_sla_mean_max": -0.33666666666666667, "reward_consolidation_sum_mean": -48.4459633251089, "reward_consolidation_sum_min": -79.86624630661916, "reward_consolidation_sum_max": -25.62747875354108, "reward_illegal_sum_mean": -183.10000000000002, "reward_illegal_sum_min": -209.99999999999997, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 77.82499999999999, "reward_accuracy_sum_min": 43.33333333333331, "reward_accuracy_sum_max": 132.5, "reward_sla_sum_mean": -76.69066666666667, "reward_sla_sum_min": -149.66666666666666, "reward_sla_sum_max": -33.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5378.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-215.12828596667578, -212.00157482713442, -235.42832556581047, -245.36624630661905, -221.47008742270546, -241.20045386700772, -226.62803009534252, -254.1825977032501, -228.27676444606905, -209.79133083554177, -226.75851533704946, -237.4484236498218, -222.34004081756976, -224.0115263943463, -241.79092875201795, -250.02994303816732, -234.6378141277527, -204.24975783605936, -230.99931158426998, -244.35224039720978, -251.0564592281215, -216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28541293602327483, "mean_inference_ms": 2.412200960806225, "mean_action_processing_ms": 0.10653283870376652, "mean_env_wait_ms": 2.057920460975637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007131814956665039, "StateBufferConnector_ms": 0.0039598941802978516, "ViewRequirementAgentConnector_ms": 0.1024773120880127}, "num_episodes": 21, "episode_return_max": -204.24975783605936, "episode_return_min": -254.1825977032501, "episode_return_mean": -230.41162999177553, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142350, "num_agent_steps_trained": 141900, "num_env_steps_sampled": 142350, "num_env_steps_trained": 141900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 205.01525457672216, "num_env_steps_trained_throughput_per_sec": 214.77788574704226, "timesteps_total": 142350, "num_env_steps_sampled_lifetime": 142350, "num_agent_steps_sampled_lifetime": 142350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 142350, "timers": {"training_iteration_time_ms": 10383.443, "restore_workers_time_ms": 0.015, "training_step_time_ms": 735.355, "sample_time_ms": 719.8, "synch_weights_time_ms": 14.081}, "counters": {"num_env_steps_sampled": 142350, "num_env_steps_trained": 141900, "num_agent_steps_sampled": 142350, "num_agent_steps_trained": 141900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 949, "num_samples_added_to_queue": 141900}, "done": false, "training_iteration": 69, "trial_id": "13390_00000", "date": "2024-10-13_00-50-27", "timestamp": 1728777027, "time_this_iter_s": 10.26489782333374, "time_total_s": 718.2248311042786, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f241b70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 718.2248311042786, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.233333333333334, "ram_util_percent": 63.01999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -272935.40625, "policy_loss": -273957.5625, "entropy": 28.497337341308594, "entropy_coeff": 0.01, "var_gnorm": 16.235898971557617, "vf_loss": 117889.96875, "vf_explained_var": 0.17225557565689087}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 262.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 144450, "num_env_steps_trained": 144100, "num_agent_steps_sampled": 144450, "num_agent_steps_trained": 144100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 963, "num_samples_added_to_queue": 144100, "learner_queue": {"size_count": 262, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.451, "learner_load_time_ms": 0.435, "learner_load_wait_time_ms": 2733.309, "learner_dequeue_time_ms": 21878.277}}, "env_runners": {"episode_reward_max": -200.61756069328948, "episode_reward_min": -251.82098449541562, "episode_reward_mean": -227.90041789271675, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -251.82098449541562}, "policy_reward_max": {"default_policy": -200.61756069328948}, "policy_reward_mean": {"default_policy": -227.90041789271675}, "custom_metrics": {"num_consolidated_mean": 0.6756000000000002, "num_consolidated_min": 0.55, "num_consolidated_max": 0.92, "num_overloaded_mean": 1.099, "num_overloaded_min": 0.94, "num_overloaded_max": 1.26, "num_moves_mean": 9.837200000000001, "num_moves_min": 9.48, "num_moves_max": 10.14, "mean_accuracy_mean": 40.908860000000004, "mean_accuracy_min": 40.65033333333333, "mean_accuracy_max": 41.20766666666666, "num_model_switches_mean": 5.699299999999999, "num_model_switches_min": 5.27, "num_model_switches_max": 6.22, "num_slav_mean": 0.10940333333333331, "num_slav_min": 0.08963333333333334, "num_slav_max": 0.132, "cpu_conserved_cost_mean": 2.7873999999999994, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.84, "mean_cluster_cpu_util_mean": 0.577198345777551, "mean_cluster_cpu_util_min": 0.5484868430553849, "mean_cluster_cpu_util_max": 0.6047403670549582, "mean_cluster_mem_util_mean": 0.3671349021175982, "mean_cluster_mem_util_min": 0.3549212355406297, "mean_cluster_mem_util_max": 0.3783707427380235, "reward_consolidation_mean_mean": -0.4791941789271681, "reward_consolidation_mean_min": -0.7482095098845535, "reward_consolidation_mean_max": -0.22048752627250298, "reward_illegal_mean_mean": -1.8316666666666666, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5666666666666667, "reward_accuracy_mean_mean": 0.7642499999999995, "reward_accuracy_mean_min": 0.43333333333333307, "reward_accuracy_mean_max": 1.1333333333333335, "reward_sla_mean_mean": -0.7323933333333335, "reward_sla_mean_min": -1.2106666666666666, "reward_sla_mean_max": -0.32933333333333337, "reward_consolidation_sum_mean": -47.91941789271681, "reward_consolidation_sum_min": -74.82095098845535, "reward_consolidation_sum_max": -22.0487526272503, "reward_illegal_sum_mean": -183.16666666666669, "reward_illegal_sum_min": -209.99999999999997, "reward_illegal_sum_max": -156.66666666666666, "reward_accuracy_sum_mean": 76.425, "reward_accuracy_sum_min": 43.33333333333331, "reward_accuracy_sum_max": 113.33333333333336, "reward_sla_sum_mean": -73.23933333333333, "reward_sla_sum_min": -121.06666666666666, "reward_sla_sum_max": -32.93333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4440.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-216.19279904962076, -243.4020500167535, -244.1714033324193, -237.72340308873243, -243.8501995187181, -204.55346492430468, -243.21164823783846, -249.14883791769466, -231.67922263852066, -239.17450729537896, -237.0690883060708, -249.5421548021566, -247.7940448993268, -241.3744555118949, -240.71813335770193, -222.76792774680928, -241.59356970970777, -247.37741021657666, -244.4853330896462, -247.20567486064152, -232.50735630083147, -226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2853691859790334, "mean_inference_ms": 2.4114439928601343, "mean_action_processing_ms": 0.10651356922889392, "mean_env_wait_ms": 2.057628267877287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007088899612426758, "StateBufferConnector_ms": 0.003961801528930664, "ViewRequirementAgentConnector_ms": 0.10181450843811035}, "num_episodes": 21, "episode_return_max": -200.61756069328948, "episode_return_min": -251.82098449541562, "episode_return_mean": -227.90041789271675, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144450, "num_agent_steps_trained": 144100, "num_env_steps_sampled": 144450, "num_env_steps_trained": 144100, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.58868205776668, "num_env_steps_trained_throughput_per_sec": 218.52147644146987, "timesteps_total": 144450, "num_env_steps_sampled_lifetime": 144450, "num_agent_steps_sampled_lifetime": 144450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 144450, "timers": {"training_iteration_time_ms": 10326.746, "restore_workers_time_ms": 0.013, "training_step_time_ms": 717.183, "sample_time_ms": 700.657, "synch_weights_time_ms": 15.006}, "counters": {"num_env_steps_sampled": 144450, "num_env_steps_trained": 144100, "num_agent_steps_sampled": 144450, "num_agent_steps_trained": 144100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 963, "num_samples_added_to_queue": 144100}, "done": false, "training_iteration": 70, "trial_id": "13390_00000", "date": "2024-10-13_00-50-37", "timestamp": 1728777037, "time_this_iter_s": 10.082516431808472, "time_total_s": 728.307347536087, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 728.307347536087, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.0, "ram_util_percent": 62.74999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -277992.375, "policy_loss": -279033.03125, "entropy": 28.421356201171875, "entropy_coeff": 0.01, "var_gnorm": 16.24360466003418, "vf_loss": 119695.9140625, "vf_explained_var": 0.1951066255569458}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 146550, "num_env_steps_trained": 146300, "num_agent_steps_sampled": 146550, "num_agent_steps_trained": 146300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 977, "num_samples_added_to_queue": 146300, "learner_queue": {"size_count": 266, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.189, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 2647.524, "learner_dequeue_time_ms": 21871.915}}, "env_runners": {"episode_reward_max": -186.05030917786095, "episode_reward_min": -251.82098449541562, "episode_reward_mean": -223.6067563130159, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -251.82098449541562}, "policy_reward_max": {"default_policy": -186.05030917786095}, "policy_reward_mean": {"default_policy": -223.6067563130159}, "custom_metrics": {"num_consolidated_mean": 0.6821, "num_consolidated_min": 0.55, "num_consolidated_max": 0.92, "num_overloaded_mean": 1.0985, "num_overloaded_min": 0.92, "num_overloaded_max": 1.26, "num_moves_mean": 9.8169, "num_moves_min": 9.48, "num_moves_max": 10.14, "mean_accuracy_mean": 40.88878333333333, "mean_accuracy_min": 40.64399999999999, "mean_accuracy_max": 41.138000000000005, "num_model_switches_mean": 5.6682, "num_model_switches_min": 5.27, "num_model_switches_max": 6.2, "num_slav_mean": 0.10513383333333333, "num_slav_min": 0.08588333333333333, "num_slav_max": 0.12623333333333334, "cpu_conserved_cost_mean": 2.8112, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.84, "mean_cluster_cpu_util_mean": 0.577379051894951, "mean_cluster_cpu_util_min": 0.5484868430553849, "mean_cluster_cpu_util_max": 0.6029401880560376, "mean_cluster_mem_util_mean": 0.3669550119729326, "mean_cluster_mem_util_min": 0.3549212355406297, "mean_cluster_mem_util_max": 0.3783707427380235, "reward_consolidation_mean_mean": -0.47073089646349275, "reward_consolidation_mean_min": -0.7482095098845535, "reward_consolidation_mean_max": -0.22048752627250298, "reward_illegal_mean_mean": -1.830833333333333, "reward_illegal_mean_min": -2.0999999999999996, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.7492499999999999, "reward_accuracy_mean_min": 0.3999999999999989, "reward_accuracy_mean_max": 1.1333333333333335, "reward_sla_mean_mean": -0.6837533333333333, "reward_sla_mean_min": -1.0666666666666667, "reward_sla_mean_max": -0.32933333333333337, "reward_consolidation_sum_mean": -47.073089646349274, "reward_consolidation_sum_min": -74.82095098845535, "reward_consolidation_sum_max": -22.0487526272503, "reward_illegal_sum_mean": -183.0833333333333, "reward_illegal_sum_min": -209.99999999999997, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 74.925, "reward_accuracy_sum_min": 39.99999999999989, "reward_accuracy_sum_max": 113.33333333333336, "reward_sla_sum_mean": -68.37533333333334, "reward_sla_sum_min": -106.66666666666666, "reward_sla_sum_max": -32.93333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3502.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-226.4497547899722, -231.47568613116457, -222.07640805385475, -235.41101769776714, -237.3547716957567, -222.96439733162742, -240.74768345060772, -227.3043498126656, -230.8842121295196, -205.84816777848846, -238.71320478844913, -212.84462822504491, -237.14305949008485, -230.49680465442123, -229.26594474397632, -240.10346644734835, -224.0346949343568, -223.25586219501048, -220.6510798379478, -251.82098449541562, -234.21736574370217, -251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2853331330771066, "mean_inference_ms": 2.4109101330898466, "mean_action_processing_ms": 0.10650071986001883, "mean_env_wait_ms": 2.0574728455008664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007152080535888672, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.10375118255615234}, "num_episodes": 21, "episode_return_max": -186.05030917786095, "episode_return_min": -251.82098449541562, "episode_return_mean": -223.6067563130159, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146550, "num_agent_steps_trained": 146300, "num_env_steps_sampled": 146550, "num_env_steps_trained": 146300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.6892241668843, "num_env_steps_trained_throughput_per_sec": 212.341091984355, "timesteps_total": 146550, "num_env_steps_sampled_lifetime": 146550, "num_agent_steps_sampled_lifetime": 146550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 146550, "timers": {"training_iteration_time_ms": 10359.287, "restore_workers_time_ms": 0.018, "training_step_time_ms": 742.054, "sample_time_ms": 724.694, "synch_weights_time_ms": 15.708}, "counters": {"num_env_steps_sampled": 146550, "num_env_steps_trained": 146300, "num_agent_steps_sampled": 146550, "num_agent_steps_trained": 146300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 977, "num_samples_added_to_queue": 146300}, "done": false, "training_iteration": 71, "trial_id": "13390_00000", "date": "2024-10-13_00-50-47", "timestamp": 1728777047, "time_this_iter_s": 10.374372005462646, "time_total_s": 738.6817195415497, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c850>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 738.6817195415497, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.513333333333335, "ram_util_percent": 61.780000000000015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -274310.625, "policy_loss": -275320.34375, "entropy": 28.395307540893555, "entropy_coeff": 0.01, "var_gnorm": 16.252914428710938, "vf_loss": 116590.96875, "vf_explained_var": 0.20187973976135254}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 270.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 148650, "num_env_steps_trained": 148500, "num_agent_steps_sampled": 148650, "num_agent_steps_trained": 148500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 991, "num_samples_added_to_queue": 148500, "learner_queue": {"size_count": 270, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.492, "learner_load_time_ms": 0.403, "learner_load_wait_time_ms": 2531.555, "learner_dequeue_time_ms": 21871.915}}, "env_runners": {"episode_reward_max": -186.05030917786095, "episode_reward_min": -251.3178653020195, "episode_reward_mean": -220.67337838496442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -251.3178653020195}, "policy_reward_max": {"default_policy": -186.05030917786095}, "policy_reward_mean": {"default_policy": -220.67337838496442}, "custom_metrics": {"num_consolidated_mean": 0.6857000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.92, "num_overloaded_mean": 1.0881, "num_overloaded_min": 0.92, "num_overloaded_max": 1.25, "num_moves_mean": 9.813500000000001, "num_moves_min": 9.53, "num_moves_max": 10.07, "mean_accuracy_mean": 40.875483333333335, "mean_accuracy_min": 40.549, "mean_accuracy_max": 41.138000000000005, "num_model_switches_mean": 5.6421, "num_model_switches_min": 5.23, "num_model_switches_max": 6.12, "num_slav_mean": 0.10321850000000002, "num_slav_min": 0.08183333333333334, "num_slav_max": 0.11830000000000002, "cpu_conserved_cost_mean": 2.8322000000000003, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.84, "mean_cluster_cpu_util_mean": 0.5771204927668993, "mean_cluster_cpu_util_min": 0.5484868430553849, "mean_cluster_cpu_util_max": 0.6038882382931468, "mean_cluster_mem_util_mean": 0.366867449986007, "mean_cluster_mem_util_min": 0.3549212355406297, "mean_cluster_mem_util_max": 0.3783707427380235, "reward_consolidation_mean_mean": -0.4716904505163119, "reward_consolidation_mean_min": -0.7493941332358587, "reward_consolidation_mean_max": -0.22048752627250298, "reward_illegal_mean_mean": -1.8134999999999997, "reward_illegal_mean_min": -2.083333333333333, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.7460833333333332, "reward_accuracy_mean_min": 0.3999999999999989, "reward_accuracy_mean_max": 1.1333333333333335, "reward_sla_mean_mean": -0.6676266666666666, "reward_sla_mean_min": -1.1426666666666667, "reward_sla_mean_max": -0.3253333333333333, "reward_consolidation_sum_mean": -47.169045051631194, "reward_consolidation_sum_min": -74.93941332358587, "reward_consolidation_sum_max": -22.0487526272503, "reward_illegal_sum_mean": -181.34999999999997, "reward_illegal_sum_min": -208.3333333333333, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 74.6083333333333, "reward_accuracy_sum_min": 39.99999999999989, "reward_accuracy_sum_max": 113.33333333333336, "reward_sla_sum_mean": -66.76266666666668, "reward_sla_sum_min": -114.26666666666667, "reward_sla_sum_max": -32.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2564.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-251.3178653020195, -223.09891863900813, -217.97165006549082, -218.8756373937676, -230.145834475616, -230.7052392701574, -215.8401992141095, -225.68630174540797, -232.17741021657667, -231.84877699594864, -235.4204392457886, -223.33875536872867, -207.8206402875506, -229.61108775777495, -221.33622711626913, -223.83354351335717, -229.3363641901975, -234.96307532973896, -219.60575405891115, -225.5545005939869, -223.84863992202025, -224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28528323974103337, "mean_inference_ms": 2.4101242280742174, "mean_action_processing_ms": 0.10647587080481533, "mean_env_wait_ms": 2.057145357692509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007012605667114258, "StateBufferConnector_ms": 0.003957033157348633, "ViewRequirementAgentConnector_ms": 0.10250568389892578}, "num_episodes": 21, "episode_return_max": -186.05030917786095, "episode_return_min": -251.3178653020195, "episode_return_mean": -220.67337838496442, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148650, "num_agent_steps_trained": 148500, "num_env_steps_sampled": 148650, "num_env_steps_trained": 148500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.04339425754034, "num_env_steps_trained_throughput_per_sec": 218.9978416031375, "timesteps_total": 148650, "num_env_steps_sampled_lifetime": 148650, "num_agent_steps_sampled_lifetime": 148650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 148650, "timers": {"training_iteration_time_ms": 10275.865, "restore_workers_time_ms": 0.014, "training_step_time_ms": 726.585, "sample_time_ms": 709.235, "synch_weights_time_ms": 15.699}, "counters": {"num_env_steps_sampled": 148650, "num_env_steps_trained": 148500, "num_agent_steps_sampled": 148650, "num_agent_steps_trained": 148500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 991, "num_samples_added_to_queue": 148500}, "done": false, "training_iteration": 72, "trial_id": "13390_00000", "date": "2024-10-13_00-50-57", "timestamp": 1728777057, "time_this_iter_s": 10.065240621566772, "time_total_s": 748.7469601631165, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069d2d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 748.7469601631165, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.053333333333335, "ram_util_percent": 61.319999999999986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -287330.8125, "policy_loss": -288445.25, "entropy": 28.328359603881836, "entropy_coeff": 0.01, "var_gnorm": 16.259889602661133, "vf_loss": 127025.21875, "vf_explained_var": 0.206445574760437}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 273.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 150750, "num_env_steps_trained": 150150, "num_agent_steps_sampled": 150750, "num_agent_steps_trained": 150150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1005, "num_samples_added_to_queue": 150700, "learner_queue": {"size_count": 273, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.147, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 2621.66, "learner_dequeue_time_ms": 21793.472}}, "env_runners": {"episode_reward_max": -186.05030917786095, "episode_reward_min": -254.6774406774497, "episode_reward_mean": -220.21888607633485, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.6774406774497}, "policy_reward_max": {"default_policy": -186.05030917786095}, "policy_reward_mean": {"default_policy": -220.21888607633485}, "custom_metrics": {"num_consolidated_mean": 0.6903000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.92, "num_overloaded_mean": 1.0975000000000001, "num_overloaded_min": 0.92, "num_overloaded_max": 1.27, "num_moves_mean": 9.7834, "num_moves_min": 9.52, "num_moves_max": 10.07, "mean_accuracy_mean": 40.868959999999994, "mean_accuracy_min": 40.542666666666655, "mean_accuracy_max": 41.138000000000005, "num_model_switches_mean": 5.6391, "num_model_switches_min": 5.23, "num_model_switches_max": 6.12, "num_slav_mean": 0.10114916666666667, "num_slav_min": 0.08183333333333334, "num_slav_max": 0.11830000000000002, "cpu_conserved_cost_mean": 2.861, "cpu_conserved_cost_min": 2.18, "cpu_conserved_cost_max": 3.84, "mean_cluster_cpu_util_mean": 0.5780829602237356, "mean_cluster_cpu_util_min": 0.5484868430553849, "mean_cluster_cpu_util_max": 0.6038882382931468, "mean_cluster_mem_util_mean": 0.36742371315730926, "mean_cluster_mem_util_min": 0.3549212355406297, "mean_cluster_mem_util_max": 0.3783707427380235, "reward_consolidation_mean_mean": -0.4666821940966829, "reward_consolidation_mean_min": -0.7493941332358587, "reward_consolidation_mean_max": -0.22048752627250298, "reward_illegal_mean_mean": -1.8291666666666666, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.7369999999999997, "reward_accuracy_mean_min": 0.32499999999999907, "reward_accuracy_mean_max": 1.1750000000000003, "reward_sla_mean_mean": -0.64334, "reward_sla_mean_min": -1.1426666666666667, "reward_sla_mean_max": -0.23, "reward_consolidation_sum_mean": -46.668219409668296, "reward_consolidation_sum_min": -74.93941332358587, "reward_consolidation_sum_max": -22.0487526272503, "reward_illegal_sum_mean": -182.91666666666663, "reward_illegal_sum_min": -211.66666666666666, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 73.69999999999997, "reward_accuracy_sum_min": 32.49999999999991, "reward_accuracy_sum_max": 117.50000000000003, "reward_sla_sum_mean": -64.334, "reward_sla_sum_min": -114.26666666666667, "reward_sla_sum_max": -23.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1931.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-224.94326053184676, -234.91573304090892, -217.60197081848352, -241.14108867160127, -228.07003259313407, -221.09325596271577, -244.20503213622092, -216.29414542020757, -214.06351092022294, -237.32403972097842, -222.3489384385756, -225.2268025221601, -205.41543452435354, -220.66958177221338, -214.10941850193407, -235.6490054524961, -217.0392031435621, -214.37402601358545, -228.8987846111669, -240.52648877516833, -212.58989917451018, -207.31109080386244, -218.8414877090376, -216.80948856194215, -212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28513701673461433, "mean_inference_ms": 2.4063202720362913, "mean_action_processing_ms": 0.10641446759585374, "mean_env_wait_ms": 2.055922490067871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006989479064941406, "StateBufferConnector_ms": 0.0038819313049316406, "ViewRequirementAgentConnector_ms": 0.09936404228210449}, "num_episodes": 21, "episode_return_max": -186.05030917786095, "episode_return_min": -254.6774406774497, "episode_return_mean": -220.21888607633485, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150750, "num_agent_steps_trained": 150150, "num_env_steps_sampled": 150750, "num_env_steps_trained": 150150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 203.68618589104688, "num_env_steps_trained_throughput_per_sec": 160.03914605725112, "timesteps_total": 150750, "num_env_steps_sampled_lifetime": 150750, "num_agent_steps_sampled_lifetime": 150750, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 150750, "timers": {"training_iteration_time_ms": 10241.725, "restore_workers_time_ms": 0.018, "training_step_time_ms": 735.484, "sample_time_ms": 718.78, "synch_weights_time_ms": 15.18}, "counters": {"num_env_steps_sampled": 150750, "num_env_steps_trained": 150150, "num_agent_steps_sampled": 150750, "num_agent_steps_trained": 150150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1005, "num_samples_added_to_queue": 150700}, "done": false, "training_iteration": 73, "trial_id": "13390_00000", "date": "2024-10-13_00-51-08", "timestamp": 1728777068, "time_this_iter_s": 10.320134401321411, "time_total_s": 759.0670945644379, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 759.0670945644379, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.207142857142856, "ram_util_percent": 61.414285714285704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -284007.3125, "policy_loss": -285172.4375, "entropy": 28.216655731201172, "entropy_coeff": 0.01, "var_gnorm": 16.268951416015625, "vf_loss": 132030.265625, "vf_explained_var": 0.18723362684249878}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 277.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 153000, "num_env_steps_trained": 152350, "num_agent_steps_sampled": 153000, "num_agent_steps_trained": 152350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1020, "num_samples_added_to_queue": 152900, "learner_queue": {"size_count": 277, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.062, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 2615.714, "learner_dequeue_time_ms": 21793.472}}, "env_runners": {"episode_reward_max": -186.05030917786095, "episode_reward_min": -254.6774406774497, "episode_reward_mean": -219.85157382192563, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.6774406774497}, "policy_reward_max": {"default_policy": -186.05030917786095}, "policy_reward_mean": {"default_policy": -219.85157382192563}, "custom_metrics": {"num_consolidated_mean": 0.6871, "num_consolidated_min": 0.5, "num_consolidated_max": 0.92, "num_overloaded_mean": 1.1021, "num_overloaded_min": 0.92, "num_overloaded_max": 1.27, "num_moves_mean": 9.765699999999999, "num_moves_min": 9.38, "num_moves_max": 10.07, "mean_accuracy_mean": 40.84039666666667, "mean_accuracy_min": 40.536333333333324, "mean_accuracy_max": 41.12533333333333, "num_model_switches_mean": 5.611799999999999, "num_model_switches_min": 5.23, "num_model_switches_max": 6.12, "num_slav_mean": 0.09795233333333334, "num_slav_min": 0.07768333333333333, "num_slav_max": 0.11573333333333334, "cpu_conserved_cost_mean": 2.858, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.72, "mean_cluster_cpu_util_mean": 0.5780400422888523, "mean_cluster_cpu_util_min": 0.5527523744030591, "mean_cluster_cpu_util_max": 0.6038882382931468, "mean_cluster_mem_util_mean": 0.36759056117784666, "mean_cluster_mem_util_min": 0.357462402767014, "mean_cluster_mem_util_max": 0.37789996089152955, "reward_consolidation_mean_mean": -0.47068573821925747, "reward_consolidation_mean_min": -0.7493941332358587, "reward_consolidation_mean_max": -0.22048752627250298, "reward_illegal_mean_mean": -1.836833333333333, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.730083333333333, "reward_accuracy_mean_min": 0.32499999999999907, "reward_accuracy_mean_max": 1.1750000000000003, "reward_sla_mean_mean": -0.62108, "reward_sla_mean_min": -1.1426666666666667, "reward_sla_mean_max": -0.23, "reward_consolidation_sum_mean": -47.06857382192574, "reward_consolidation_sum_min": -74.93941332358587, "reward_consolidation_sum_max": -22.0487526272503, "reward_illegal_sum_mean": -183.6833333333333, "reward_illegal_sum_min": -211.66666666666666, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 73.0083333333333, "reward_accuracy_sum_min": 32.49999999999991, "reward_accuracy_sum_max": 117.50000000000003, "reward_sla_sum_mean": -62.108000000000004, "reward_sla_sum_min": -114.26666666666667, "reward_sla_sum_max": -23.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2569.0, "global_timestep_min": 700, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-212.72164854244716, -222.75542660452658, -200.61756069328948, -219.36783027201548, -227.35912150842228, -217.95428432178863, -225.9314630357306, -230.62541046026368, -207.78425477474198, -224.3890310396296, -221.76415973681793, -219.21803588290834, -219.1487526272501, -216.8113558134576, -239.1174540802338, -212.06044655639812, -203.9695787261262, -218.45489353924876, -208.74318742575164, -214.2029973499042, -232.99054799110542, -213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.284964613900464, "mean_inference_ms": 2.403226883025593, "mean_action_processing_ms": 0.10635210655556149, "mean_env_wait_ms": 2.0546794839654763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007292747497558594, "StateBufferConnector_ms": 0.003851175308227539, "ViewRequirementAgentConnector_ms": 0.09800004959106445}, "num_episodes": 24, "episode_return_max": -186.05030917786095, "episode_return_min": -254.6774406774497, "episode_return_mean": -219.85157382192563, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153000, "num_agent_steps_trained": 152350, "num_env_steps_sampled": 153000, "num_env_steps_trained": 152350, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.57039617048602, "num_env_steps_trained_throughput_per_sec": 204.91327625558634, "timesteps_total": 153000, "num_env_steps_sampled_lifetime": 153000, "num_agent_steps_sampled_lifetime": 153000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 153000, "timers": {"training_iteration_time_ms": 10300.901, "restore_workers_time_ms": 0.014, "training_step_time_ms": 708.932, "sample_time_ms": 692.162, "synch_weights_time_ms": 15.318}, "counters": {"num_env_steps_sampled": 153000, "num_env_steps_trained": 152350, "num_agent_steps_sampled": 153000, "num_agent_steps_trained": 152350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1020, "num_samples_added_to_queue": 152900}, "done": false, "training_iteration": 74, "trial_id": "13390_00000", "date": "2024-10-13_00-51-19", "timestamp": 1728777079, "time_this_iter_s": 10.749158143997192, "time_total_s": 769.8162527084351, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069cdc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 769.8162527084351, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.293750000000003, "ram_util_percent": 61.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -262271.8125, "policy_loss": -263271.875, "entropy": 28.01761245727539, "entropy_coeff": 0.01, "var_gnorm": 16.28238868713379, "vf_loss": 115414.3515625, "vf_explained_var": 0.20390498638153076}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 282.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 155250, "num_env_steps_trained": 155100, "num_agent_steps_sampled": 155250, "num_agent_steps_trained": 155100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1035, "num_samples_added_to_queue": 155100, "learner_queue": {"size_count": 282, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.735, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 2506.111, "learner_dequeue_time_ms": 21725.783}}, "env_runners": {"episode_reward_max": -182.79893691553193, "episode_reward_min": -254.6774406774497, "episode_reward_mean": -219.2705675774467, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.6774406774497}, "policy_reward_max": {"default_policy": -182.79893691553193}, "policy_reward_mean": {"default_policy": -219.2705675774467}, "custom_metrics": {"num_consolidated_mean": 0.6934, "num_consolidated_min": 0.5, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.107, "num_overloaded_min": 0.92, "num_overloaded_max": 1.27, "num_moves_mean": 9.761899999999999, "num_moves_min": 9.38, "num_moves_max": 10.07, "mean_accuracy_mean": 40.84641333333333, "mean_accuracy_min": 40.536333333333324, "mean_accuracy_max": 41.12533333333333, "num_model_switches_mean": 5.587199999999999, "num_model_switches_min": 5.15, "num_model_switches_max": 6.01, "num_slav_mean": 0.09663799999999999, "num_slav_min": 0.07666666666666667, "num_slav_max": 0.11573333333333334, "cpu_conserved_cost_mean": 2.8938, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.5793366463349816, "mean_cluster_cpu_util_min": 0.5527523744030591, "mean_cluster_cpu_util_max": 0.6038882382931468, "mean_cluster_mem_util_mean": 0.368251174154683, "mean_cluster_mem_util_min": 0.35821019547059324, "mean_cluster_mem_util_max": 0.37789996089152955, "reward_consolidation_mean_mean": -0.46560234244113446, "reward_consolidation_mean_min": -0.7493941332358587, "reward_consolidation_mean_max": -0.23924563647994154, "reward_illegal_mean_mean": -1.845, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.72925, "reward_accuracy_mean_min": 0.32499999999999907, "reward_accuracy_mean_max": 1.1750000000000003, "reward_sla_mean_mean": -0.6113533333333333, "reward_sla_mean_min": -1.1426666666666667, "reward_sla_mean_max": -0.23, "reward_consolidation_sum_mean": -46.56023424411344, "reward_consolidation_sum_min": -74.93941332358587, "reward_consolidation_sum_max": -23.924563647994155, "reward_illegal_sum_mean": -184.49999999999997, "reward_illegal_sum_min": -211.66666666666666, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 72.92499999999997, "reward_accuracy_sum_min": 32.49999999999991, "reward_accuracy_sum_max": 117.50000000000003, "reward_sla_sum_mean": -61.135333333333335, "reward_sla_sum_min": -114.26666666666667, "reward_sla_sum_max": -23.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3269.0, "global_timestep_min": 1400, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.10070669225368, -224.4406134819822, -217.443790551037, -200.7824484449725, -220.84373267537845, -220.36947211307066, -226.46193913917554, -214.0909043833195, -225.07226537512557, -227.2379390173322, -186.05030917786095, -240.83142039050844, -213.1005239270156, -210.99557403515183, -211.58705412897123, -201.84333668402925, -243.097532669286, -231.59907094337316, -210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2848345000354008, "mean_inference_ms": 2.4014882005576474, "mean_action_processing_ms": 0.10630676450031057, "mean_env_wait_ms": 2.0537727814491715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007263660430908203, "StateBufferConnector_ms": 0.0038077831268310547, "ViewRequirementAgentConnector_ms": 0.09728479385375977}, "num_episodes": 21, "episode_return_max": -182.79893691553193, "episode_return_min": -254.6774406774497, "episode_return_mean": -219.2705675774467, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155250, "num_agent_steps_trained": 155100, "num_env_steps_sampled": 155250, "num_env_steps_trained": 155100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 210.32308981572473, "num_env_steps_trained_throughput_per_sec": 257.0615542192191, "timesteps_total": 155250, "num_env_steps_sampled_lifetime": 155250, "num_agent_steps_sampled_lifetime": 155250, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 155250, "timers": {"training_iteration_time_ms": 10349.401, "restore_workers_time_ms": 0.017, "training_step_time_ms": 724.3, "sample_time_ms": 708.685, "synch_weights_time_ms": 14.09}, "counters": {"num_env_steps_sampled": 155250, "num_env_steps_trained": 155100, "num_agent_steps_sampled": 155250, "num_agent_steps_trained": 155100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1035, "num_samples_added_to_queue": 155100}, "done": false, "training_iteration": 75, "trial_id": "13390_00000", "date": "2024-10-13_00-51-29", "timestamp": 1728777089, "time_this_iter_s": 10.712251901626587, "time_total_s": 780.5285046100616, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069db70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 780.5285046100616, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.34, "ram_util_percent": 61.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -232975.953125, "policy_loss": -233723.84375, "entropy": 27.874576568603516, "entropy_coeff": 0.01, "var_gnorm": 16.29121208190918, "vf_loss": 90120.6640625, "vf_explained_var": 0.25230735540390015}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 285.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 156900, "num_env_steps_trained": 156750, "num_agent_steps_sampled": 156900, "num_agent_steps_trained": 156750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1046, "num_samples_added_to_queue": 156750, "learner_queue": {"size_count": 285, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.054, "learner_load_time_ms": 0.34, "learner_load_wait_time_ms": 2751.562, "learner_dequeue_time_ms": 21725.783}}, "env_runners": {"episode_reward_max": -182.79893691553193, "episode_reward_min": -254.6774406774497, "episode_reward_mean": -219.10389643303176, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -254.6774406774497}, "policy_reward_max": {"default_policy": -182.79893691553193}, "policy_reward_mean": {"default_policy": -219.10389643303176}, "custom_metrics": {"num_consolidated_mean": 0.6954999999999998, "num_consolidated_min": 0.5, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.1126, "num_overloaded_min": 0.93, "num_overloaded_max": 1.27, "num_moves_mean": 9.7406, "num_moves_min": 9.38, "num_moves_max": 10.05, "mean_accuracy_mean": 40.83539333333333, "mean_accuracy_min": 40.536333333333324, "mean_accuracy_max": 41.04933333333332, "num_model_switches_mean": 5.5798000000000005, "num_model_switches_min": 5.15, "num_model_switches_max": 5.99, "num_slav_mean": 0.09488166666666664, "num_slav_min": 0.07666666666666667, "num_slav_max": 0.11573333333333334, "cpu_conserved_cost_mean": 2.9133999999999993, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5800560194712827, "mean_cluster_cpu_util_min": 0.5527523744030591, "mean_cluster_cpu_util_max": 0.6009496674165045, "mean_cluster_mem_util_mean": 0.3687374111950688, "mean_cluster_mem_util_min": 0.35821019547059324, "mean_cluster_mem_util_max": 0.3788712195743276, "reward_consolidation_mean_mean": -0.46281563099698436, "reward_consolidation_mean_min": -0.7493941332358587, "reward_consolidation_mean_max": -0.23924563647994154, "reward_illegal_mean_mean": -1.8543333333333334, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.722083333333333, "reward_accuracy_mean_min": 0.32499999999999907, "reward_accuracy_mean_max": 1.1750000000000003, "reward_sla_mean_mean": -0.5959733333333334, "reward_sla_mean_min": -0.996, "reward_sla_mean_max": -0.23, "reward_consolidation_sum_mean": -46.28156309969843, "reward_consolidation_sum_min": -74.93941332358587, "reward_consolidation_sum_max": -23.924563647994155, "reward_illegal_sum_mean": -185.43333333333337, "reward_illegal_sum_min": -211.66666666666666, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 72.2083333333333, "reward_accuracy_sum_min": 32.49999999999991, "reward_accuracy_sum_max": 117.50000000000003, "reward_sla_sum_mean": -59.597333333333324, "reward_sla_sum_min": -99.6, "reward_sla_sum_max": -23.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3875.0, "global_timestep_min": 2100, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-210.19943038167466, -230.53546559444388, -200.50114532882515, -209.4273599561363, -196.59968929909513, -232.89713667793717, -215.88736178378866, -206.87176886289555, -206.50215053763432, -212.48962807274054, -211.58448323128937, -227.41545584696448, -211.09825154588916, -223.2793688507112, -227.2417405342837, -208.07274665691915, -233.18006031252847, -204.5564805507325, -232.4979926284687, -217.2534314173444, -223.2682993694597, -222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2848535496583308, "mean_inference_ms": 2.4027984383240617, "mean_action_processing_ms": 0.10632346659787827, "mean_env_wait_ms": 2.054245682051979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074460506439208984, "StateBufferConnector_ms": 0.003878355026245117, "ViewRequirementAgentConnector_ms": 0.10017585754394531}, "num_episodes": 18, "episode_return_max": -182.79893691553193, "episode_return_min": -254.6774406774497, "episode_return_mean": -219.10389643303176, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156900, "num_agent_steps_trained": 156750, "num_env_steps_sampled": 156900, "num_env_steps_trained": 156750, "num_env_steps_sampled_this_iter": 1650, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 155.42574192496463, "num_env_steps_trained_throughput_per_sec": 155.42574192496463, "timesteps_total": 156900, "num_env_steps_sampled_lifetime": 156900, "num_agent_steps_sampled_lifetime": 156900, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 156900, "timers": {"training_iteration_time_ms": 10396.542, "restore_workers_time_ms": 0.023, "training_step_time_ms": 983.105, "sample_time_ms": 962.302, "synch_weights_time_ms": 18.984}, "counters": {"num_env_steps_sampled": 156900, "num_env_steps_trained": 156750, "num_agent_steps_sampled": 156900, "num_agent_steps_trained": 156750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1046, "num_samples_added_to_queue": 156750}, "done": false, "training_iteration": 76, "trial_id": "13390_00000", "date": "2024-10-13_00-51-40", "timestamp": 1728777100, "time_this_iter_s": 10.628265857696533, "time_total_s": 791.1567704677582, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2423b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 791.1567704677582, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 33.68666666666667, "ram_util_percent": 64.32666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -238884.15625, "policy_loss": -239713.34375, "entropy": 27.7420597076416, "entropy_coeff": 0.01, "var_gnorm": 16.30003547668457, "vf_loss": 98176.8359375, "vf_explained_var": 0.23474526405334473}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 288.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 159000, "num_env_steps_trained": 158400, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 158400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1060, "num_samples_added_to_queue": 158950, "learner_queue": {"size_count": 288, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.16, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 2937.371, "learner_dequeue_time_ms": 22017.265}}, "env_runners": {"episode_reward_max": -182.79893691553193, "episode_reward_min": -272.02299795912137, "episode_reward_mean": -219.3362276036431, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.02299795912137}, "policy_reward_max": {"default_policy": -182.79893691553193}, "policy_reward_mean": {"default_policy": -219.3362276036431}, "custom_metrics": {"num_consolidated_mean": 0.7018999999999999, "num_consolidated_min": 0.5, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.1184000000000003, "num_overloaded_min": 0.94, "num_overloaded_max": 1.27, "num_moves_mean": 9.7119, "num_moves_min": 9.38, "num_moves_max": 10.03, "mean_accuracy_mean": 40.84533666666667, "mean_accuracy_min": 40.536333333333324, "mean_accuracy_max": 41.04933333333332, "num_model_switches_mean": 5.514999999999999, "num_model_switches_min": 4.93, "num_model_switches_max": 5.9, "num_slav_mean": 0.09263700000000002, "num_slav_min": 0.07121666666666666, "num_slav_max": 0.11573333333333334, "cpu_conserved_cost_mean": 2.9364000000000003, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5809895287578342, "mean_cluster_cpu_util_min": 0.5527523744030591, "mean_cluster_cpu_util_max": 0.6009496674165045, "mean_cluster_mem_util_mean": 0.3691568333925342, "mean_cluster_mem_util_min": 0.35821019547059324, "mean_cluster_mem_util_max": 0.3788712195743276, "reward_consolidation_mean_mean": -0.45690560936976454, "reward_consolidation_mean_min": -0.7561483749124249, "reward_consolidation_mean_max": -0.23924563647994154, "reward_illegal_mean_mean": -1.8639999999999994, "reward_illegal_mean_min": -2.1166666666666667, "reward_illegal_mean_max": -1.5666666666666662, "reward_accuracy_mean_mean": 0.7164166666666664, "reward_accuracy_mean_min": 0.32499999999999907, "reward_accuracy_mean_max": 1.191666666666666, "reward_sla_mean_mean": -0.5888733333333334, "reward_sla_mean_min": -1.1533333333333333, "reward_sla_mean_max": -0.23, "reward_consolidation_sum_mean": -45.69056093697645, "reward_consolidation_sum_min": -75.6148374912425, "reward_consolidation_sum_max": -23.924563647994155, "reward_illegal_sum_mean": -186.4, "reward_illegal_sum_min": -211.66666666666666, "reward_illegal_sum_max": -156.66666666666663, "reward_accuracy_sum_mean": 71.64166666666665, "reward_accuracy_sum_min": 32.49999999999991, "reward_accuracy_sum_max": 119.1666666666666, "reward_sla_sum_mean": -58.88733333333332, "reward_sla_sum_min": -115.33333333333334, "reward_sla_sum_max": -23.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4575.0, "global_timestep_min": 2800, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-222.78305157025787, -213.816969752353, -206.17556733375977, -226.09175728776384, -230.62760973529493, -254.6774406774497, -225.01346370586992, -214.03619665539597, -228.82969630509606, -221.4197416917969, -213.84407992933077, -220.83629413018974, -222.91750890980526, -239.7837552164243, -217.86802826769014, -237.41020439245779, -232.738636571324, -214.51507203996462, -228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28494301397187555, "mean_inference_ms": 2.403637681142955, "mean_action_processing_ms": 0.10635052545147872, "mean_env_wait_ms": 2.0548975252350368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007696390151977539, "StateBufferConnector_ms": 0.004004716873168945, "ViewRequirementAgentConnector_ms": 0.10355257987976074}, "num_episodes": 21, "episode_return_max": -182.79893691553193, "episode_return_min": -272.02299795912137, "episode_return_mean": -219.3362276036431, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 158400, "num_env_steps_sampled": 159000, "num_env_steps_trained": 158400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 192.89826496125605, "num_env_steps_trained_throughput_per_sec": 151.56292246955832, "timesteps_total": 159000, "num_env_steps_sampled_lifetime": 159000, "num_agent_steps_sampled_lifetime": 159000, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 159000, "timers": {"training_iteration_time_ms": 10456.665, "restore_workers_time_ms": 0.015, "training_step_time_ms": 803.814, "sample_time_ms": 784.182, "synch_weights_time_ms": 17.991}, "counters": {"num_env_steps_sampled": 159000, "num_env_steps_trained": 158400, "num_agent_steps_sampled": 159000, "num_agent_steps_trained": 158400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1060, "num_samples_added_to_queue": 158950}, "done": false, "training_iteration": 77, "trial_id": "13390_00000", "date": "2024-10-13_00-51-51", "timestamp": 1728777111, "time_this_iter_s": 10.89970350265503, "time_total_s": 802.0564739704132, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c5b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 802.0564739704132, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 20.856250000000003, "ram_util_percent": 63.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -237602.5, "policy_loss": -238502.96875, "entropy": 27.56376075744629, "entropy_coeff": 0.01, "var_gnorm": 16.311962127685547, "vf_loss": 105206.1328125, "vf_explained_var": 0.20936155319213867}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 292.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 160800, "num_env_steps_trained": 160600, "num_agent_steps_sampled": 160800, "num_agent_steps_trained": 160600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1072, "num_samples_added_to_queue": 160600, "learner_queue": {"size_count": 292, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 99.415, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 3075.46, "learner_dequeue_time_ms": 22017.265}}, "env_runners": {"episode_reward_max": -182.79893691553193, "episode_reward_min": -272.02299795912137, "episode_reward_mean": -217.07592716805257, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.02299795912137}, "policy_reward_max": {"default_policy": -182.79893691553193}, "policy_reward_mean": {"default_policy": -217.07592716805257}, "custom_metrics": {"num_consolidated_mean": 0.7, "num_consolidated_min": 0.5, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.1136, "num_overloaded_min": 0.94, "num_overloaded_max": 1.27, "num_moves_mean": 9.686, "num_moves_min": 9.27, "num_moves_max": 10.03, "mean_accuracy_mean": 40.84685666666667, "mean_accuracy_min": 40.536333333333324, "mean_accuracy_max": 41.04933333333332, "num_model_switches_mean": 5.4738, "num_model_switches_min": 4.93, "num_model_switches_max": 5.9, "num_slav_mean": 0.09044966666666664, "num_slav_min": 0.07121666666666666, "num_slav_max": 0.10541666666666667, "cpu_conserved_cost_mean": 2.9182, "cpu_conserved_cost_min": 2.0, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5804044507190917, "mean_cluster_cpu_util_min": 0.5527523744030591, "mean_cluster_cpu_util_max": 0.6009496674165045, "mean_cluster_mem_util_mean": 0.36880830343508714, "mean_cluster_mem_util_min": 0.35821019547059324, "mean_cluster_mem_util_max": 0.3788712195743276, "reward_consolidation_mean_mean": -0.46082260501385974, "reward_consolidation_mean_min": -0.7561483749124249, "reward_consolidation_mean_max": -0.23924563647994154, "reward_illegal_mean_mean": -1.8559999999999999, "reward_illegal_mean_min": -2.1166666666666663, "reward_illegal_mean_max": -1.5666666666666662, "reward_accuracy_mean_mean": 0.7222499999999998, "reward_accuracy_mean_min": 0.39166666666666694, "reward_accuracy_mean_max": 1.191666666666666, "reward_sla_mean_mean": -0.5761866666666665, "reward_sla_mean_min": -1.1533333333333333, "reward_sla_mean_max": -0.22733333333333333, "reward_consolidation_sum_mean": -46.082260501385974, "reward_consolidation_sum_min": -75.6148374912425, "reward_consolidation_sum_max": -23.924563647994155, "reward_illegal_sum_mean": -185.60000000000002, "reward_illegal_sum_min": -211.66666666666663, "reward_illegal_sum_max": -156.66666666666663, "reward_accuracy_sum_mean": 72.22499999999997, "reward_accuracy_sum_min": 39.16666666666669, "reward_accuracy_sum_max": 119.1666666666666, "reward_sla_sum_mean": -57.618666666666655, "reward_sla_sum_min": -115.33333333333334, "reward_sla_sum_max": -22.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5182.0, "global_timestep_min": 3500, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-228.30195254195974, -234.03929452618112, -225.6937433366842, -235.48827865606623, -221.71580919309156, -227.78035882908418, -228.41165433001328, -204.26930762435657, -230.15702580035946, -219.85894178927168, -216.73193213317484, -228.18439489475767, -223.66637728837293, -204.4313198696273, -221.3153644643455, -219.79544914557243, -197.32051539797135, -211.86336470803252, -235.8330987846111, -227.4651223004051, -215.84079624722045, -217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2851114957106066, "mean_inference_ms": 2.407604275578257, "mean_action_processing_ms": 0.10641342082901616, "mean_env_wait_ms": 2.0563563328099197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007626771926879883, "StateBufferConnector_ms": 0.004030942916870117, "ViewRequirementAgentConnector_ms": 0.10428285598754883}, "num_episodes": 18, "episode_return_max": -182.79893691553193, "episode_return_min": -272.02299795912137, "episode_return_mean": -217.07592716805257, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160800, "num_agent_steps_trained": 160600, "num_env_steps_sampled": 160800, "num_env_steps_trained": 160600, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 178.08102099178504, "num_env_steps_trained_throughput_per_sec": 217.65458121218174, "timesteps_total": 160800, "num_env_steps_sampled_lifetime": 160800, "num_agent_steps_sampled_lifetime": 160800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 160800, "timers": {"training_iteration_time_ms": 10407.172, "restore_workers_time_ms": 0.015, "training_step_time_ms": 739.025, "sample_time_ms": 721.721, "synch_weights_time_ms": 15.35}, "counters": {"num_env_steps_sampled": 160800, "num_env_steps_trained": 160600, "num_agent_steps_sampled": 160800, "num_agent_steps_trained": 160600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1072, "num_samples_added_to_queue": 160600}, "done": false, "training_iteration": 78, "trial_id": "13390_00000", "date": "2024-10-13_00-52-01", "timestamp": 1728777121, "time_this_iter_s": 10.134031057357788, "time_total_s": 812.190505027771, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b5abc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 812.190505027771, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 27.364285714285717, "ram_util_percent": 64.18571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -238677.5625, "policy_loss": -239544.796875, "entropy": 27.393884658813477, "entropy_coeff": 0.01, "var_gnorm": 16.32135009765625, "vf_loss": 101790.5234375, "vf_explained_var": 0.24591535329818726}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 295.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 162900, "num_env_steps_trained": 162250, "num_agent_steps_sampled": 162900, "num_agent_steps_trained": 162250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1086, "num_samples_added_to_queue": 162800, "learner_queue": {"size_count": 295, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.651, "learner_load_time_ms": 0.345, "learner_load_wait_time_ms": 2823.303, "learner_dequeue_time_ms": 22017.265}}, "env_runners": {"episode_reward_max": -182.79893691553193, "episode_reward_min": -272.02299795912137, "episode_reward_mean": -215.184884370526, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.02299795912137}, "policy_reward_max": {"default_policy": -182.79893691553193}, "policy_reward_mean": {"default_policy": -215.184884370526}, "custom_metrics": {"num_consolidated_mean": 0.7067999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.1164999999999998, "num_overloaded_min": 0.94, "num_overloaded_max": 1.27, "num_moves_mean": 9.657900000000001, "num_moves_min": 9.27, "num_moves_max": 10.03, "mean_accuracy_mean": 40.85610333333334, "mean_accuracy_min": 40.63133333333333, "mean_accuracy_max": 41.04933333333332, "num_model_switches_mean": 5.4422000000000015, "num_model_switches_min": 4.93, "num_model_switches_max": 5.89, "num_slav_mean": 0.08851233333333335, "num_slav_min": 0.06995000000000001, "num_slav_max": 0.10541666666666667, "cpu_conserved_cost_mean": 2.9502000000000006, "cpu_conserved_cost_min": 2.3, "cpu_conserved_cost_max": 3.52, "mean_cluster_cpu_util_mean": 0.5810256218866905, "mean_cluster_cpu_util_min": 0.5596501573504349, "mean_cluster_cpu_util_max": 0.6009496674165045, "mean_cluster_mem_util_mean": 0.3690311810973334, "mean_cluster_mem_util_min": 0.36019624773960224, "mean_cluster_mem_util_max": 0.3788712195743276, "reward_consolidation_mean_mean": -0.453572177038594, "reward_consolidation_mean_min": -0.7561483749124249, "reward_consolidation_mean_max": -0.23924563647994154, "reward_illegal_mean_mean": -1.8608333333333331, "reward_illegal_mean_min": -2.1166666666666663, "reward_illegal_mean_max": -1.5666666666666662, "reward_accuracy_mean_mean": 0.7199166666666664, "reward_accuracy_mean_min": 0.39166666666666694, "reward_accuracy_mean_max": 1.191666666666666, "reward_sla_mean_mean": -0.55736, "reward_sla_mean_min": -1.1533333333333333, "reward_sla_mean_max": -0.22733333333333333, "reward_consolidation_sum_mean": -45.35721770385939, "reward_consolidation_sum_min": -75.6148374912425, "reward_consolidation_sum_max": -23.924563647994155, "reward_illegal_sum_mean": -186.08333333333331, "reward_illegal_sum_min": -211.66666666666663, "reward_illegal_sum_max": -156.66666666666663, "reward_accuracy_sum_mean": 71.99166666666665, "reward_accuracy_sum_min": 39.16666666666669, "reward_accuracy_sum_max": 119.1666666666666, "reward_sla_sum_mean": -55.736000000000004, "reward_sla_sum_min": -115.33333333333334, "reward_sla_sum_max": -22.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5883.0, "global_timestep_min": 4200, "global_timestep_max": 7500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-217.3126839075209, -215.1153461878215, -230.20387157695944, -216.70493161533992, -182.79893691553193, -224.7941819732553, -205.32194705900264, -224.32005848487634, -216.37754424441798, -196.28325870419448, -205.08550062444772, -226.4611227877791, -196.29745956319104, -221.5578969813273, -253.20195254195988, -243.54529227207655, -224.7151025008376, -207.78822078040744, -214.62353102439903, -192.22986079381033, -226.3515702580035, -214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28531108564991114, "mean_inference_ms": 2.410671973811912, "mean_action_processing_ms": 0.10647657722705088, "mean_env_wait_ms": 2.057707892036525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007296323776245117, "StateBufferConnector_ms": 0.00403594970703125, "ViewRequirementAgentConnector_ms": 0.10430717468261719}, "num_episodes": 21, "episode_return_max": -182.79893691553193, "episode_return_min": -272.02299795912137, "episode_return_mean": -215.184884370526, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162900, "num_agent_steps_trained": 162250, "num_env_steps_sampled": 162900, "num_env_steps_trained": 162250, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 207.17134795115885, "num_env_steps_trained_throughput_per_sec": 162.77748767591052, "timesteps_total": 162900, "num_env_steps_sampled_lifetime": 162900, "num_agent_steps_sampled_lifetime": 162900, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 162900, "timers": {"training_iteration_time_ms": 10396.511, "restore_workers_time_ms": 0.014, "training_step_time_ms": 727.494, "sample_time_ms": 709.539, "synch_weights_time_ms": 16.445}, "counters": {"num_env_steps_sampled": 162900, "num_env_steps_trained": 162250, "num_agent_steps_sampled": 162900, "num_agent_steps_trained": 162250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1086, "num_samples_added_to_queue": 162800}, "done": false, "training_iteration": 79, "trial_id": "13390_00000", "date": "2024-10-13_00-52-11", "timestamp": 1728777131, "time_this_iter_s": 10.151854991912842, "time_total_s": 822.3423600196838, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c14bb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 822.3423600196838, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.293333333333333, "ram_util_percent": 63.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -177517.515625, "policy_loss": -178030.078125, "entropy": 26.982717514038086, "entropy_coeff": 0.01, "var_gnorm": 16.333301544189453, "vf_loss": 66097.390625, "vf_explained_var": 0.25929921865463257}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 165000, "num_env_steps_trained": 164450, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 164450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1100, "num_samples_added_to_queue": 165000, "learner_queue": {"size_count": 299, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.767, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 2538.113, "learner_dequeue_time_ms": 22123.651}}, "env_runners": {"episode_reward_max": -180.1236894209388, "episode_reward_min": -272.02299795912137, "episode_reward_mean": -213.49057540589106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.02299795912137}, "policy_reward_max": {"default_policy": -180.1236894209388}, "policy_reward_mean": {"default_policy": -213.49057540589106}, "custom_metrics": {"num_consolidated_mean": 0.7064, "num_consolidated_min": 0.53, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.1154000000000002, "num_overloaded_min": 0.98, "num_overloaded_max": 1.28, "num_moves_mean": 9.610700000000001, "num_moves_min": 9.16, "num_moves_max": 9.94, "mean_accuracy_mean": 40.85344333333333, "mean_accuracy_min": 40.618666666666655, "mean_accuracy_max": 41.023999999999994, "num_model_switches_mean": 5.3882, "num_model_switches_min": 4.88, "num_model_switches_max": 5.85, "num_slav_mean": 0.085358, "num_slav_min": 0.06693333333333333, "num_slav_max": 0.10541666666666667, "cpu_conserved_cost_mean": 2.931000000000001, "cpu_conserved_cost_min": 2.26, "cpu_conserved_cost_max": 3.78, "mean_cluster_cpu_util_mean": 0.5800811948785255, "mean_cluster_cpu_util_min": 0.5587676820735296, "mean_cluster_cpu_util_max": 0.601480097623001, "mean_cluster_mem_util_mean": 0.36842331278344675, "mean_cluster_mem_util_min": 0.3596262884267631, "mean_cluster_mem_util_max": 0.3788712195743276, "reward_consolidation_mean_mean": -0.4534557540589115, "reward_consolidation_mean_min": -0.7561483749124249, "reward_consolidation_mean_max": -0.24433610527277716, "reward_illegal_mean_mean": -1.858999999999999, "reward_illegal_mean_min": -2.133333333333333, "reward_illegal_mean_max": -1.6333333333333326, "reward_accuracy_mean_mean": 0.7207499999999999, "reward_accuracy_mean_min": 0.4083333333333324, "reward_accuracy_mean_max": 1.191666666666666, "reward_sla_mean_mean": -0.5432, "reward_sla_mean_min": -1.1533333333333333, "reward_sla_mean_max": -0.22733333333333333, "reward_consolidation_sum_mean": -45.34557540589113, "reward_consolidation_sum_min": -75.6148374912425, "reward_consolidation_sum_max": -24.433610527277715, "reward_illegal_sum_mean": -185.9, "reward_illegal_sum_min": -213.3333333333333, "reward_illegal_sum_max": -163.33333333333326, "reward_accuracy_sum_mean": 72.07499999999997, "reward_accuracy_sum_min": 40.833333333333236, "reward_accuracy_sum_max": 119.1666666666666, "reward_sla_sum_mean": -54.32000000000001, "reward_sla_sum_min": -115.33333333333334, "reward_sla_sum_max": -22.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5647.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-214.10922964452146, -209.81189497090972, -240.2211977215266, -214.4409881507203, -239.2693929148009, -221.75601754546275, -191.40735630083157, -215.32314112522445, -199.3617106826282, -231.44478662158465, -221.53944378445877, -215.86192086265189, -200.7782448444971, -213.1665661457857, -195.17893326022715, -233.53139602181008, -217.14090590636314, -232.09431904718386, -219.9533034816776, -217.95138749276546, -207.36332815498483, -211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28552970766022534, "mean_inference_ms": 2.4128082131902744, "mean_action_processing_ms": 0.10653710197890139, "mean_env_wait_ms": 2.059018442558253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007387638092041016, "StateBufferConnector_ms": 0.004122495651245117, "ViewRequirementAgentConnector_ms": 0.10628175735473633}, "num_episodes": 21, "episode_return_max": -180.1236894209388, "episode_return_min": -272.02299795912137, "episode_return_mean": -213.49057540589106, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 164450, "num_env_steps_sampled": 165000, "num_env_steps_trained": 164450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.60315129291763, "num_env_steps_trained_throughput_per_sec": 214.3461584973423, "timesteps_total": 165000, "num_env_steps_sampled_lifetime": 165000, "num_agent_steps_sampled_lifetime": 165000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 165000, "timers": {"training_iteration_time_ms": 10416.122, "restore_workers_time_ms": 0.014, "training_step_time_ms": 725.443, "sample_time_ms": 709.053, "synch_weights_time_ms": 14.774}, "counters": {"num_env_steps_sampled": 165000, "num_env_steps_trained": 164450, "num_agent_steps_sampled": 165000, "num_agent_steps_trained": 164450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1100, "num_samples_added_to_queue": 165000}, "done": false, "training_iteration": 80, "trial_id": "13390_00000", "date": "2024-10-13_00-52-22", "timestamp": 1728777142, "time_this_iter_s": 10.278393268585205, "time_total_s": 832.620753288269, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b5beb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 832.620753288269, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 17.128571428571426, "ram_util_percent": 63.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -154046.25, "policy_loss": -154427.921875, "entropy": 26.73728370666504, "entropy_coeff": 0.01, "var_gnorm": 16.34368133544922, "vf_loss": 52873.296875, "vf_explained_var": 0.29959362745285034}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 303.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 167100, "num_env_steps_trained": 166650, "num_agent_steps_sampled": 167100, "num_agent_steps_trained": 166650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1114, "num_samples_added_to_queue": 166650, "learner_queue": {"size_count": 303, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 97.943, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 2547.522, "learner_dequeue_time_ms": 22123.651}}, "env_runners": {"episode_reward_max": -174.64371439885466, "episode_reward_min": -272.02299795912137, "episode_reward_mean": -209.42439663102743, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -272.02299795912137}, "policy_reward_max": {"default_policy": -174.64371439885466}, "policy_reward_mean": {"default_policy": -209.42439663102743}, "custom_metrics": {"num_consolidated_mean": 0.7117, "num_consolidated_min": 0.53, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.1034, "num_overloaded_min": 0.94, "num_overloaded_max": 1.28, "num_moves_mean": 9.548200000000001, "num_moves_min": 9.16, "num_moves_max": 9.86, "mean_accuracy_mean": 40.840650000000004, "mean_accuracy_min": 40.492, "mean_accuracy_max": 41.023999999999994, "num_model_switches_mean": 5.3136, "num_model_switches_min": 4.8, "num_model_switches_max": 5.85, "num_slav_mean": 0.08135633333333335, "num_slav_min": 0.0562, "num_slav_max": 0.10036666666666666, "cpu_conserved_cost_mean": 2.940199999999999, "cpu_conserved_cost_min": 2.26, "cpu_conserved_cost_max": 3.78, "mean_cluster_cpu_util_mean": 0.5789361698670523, "mean_cluster_cpu_util_min": 0.5571017270383156, "mean_cluster_cpu_util_max": 0.601480097623001, "mean_cluster_mem_util_mean": 0.3679183100602056, "mean_cluster_mem_util_min": 0.35889624504865236, "mean_cluster_mem_util_max": 0.3777191529248831, "reward_consolidation_mean_mean": -0.46479729964360794, "reward_consolidation_mean_min": -0.7561483749124249, "reward_consolidation_mean_max": -0.24433610527277716, "reward_illegal_mean_mean": -1.8389999999999995, "reward_illegal_mean_min": -2.133333333333333, "reward_illegal_mean_max": -1.5666666666666667, "reward_accuracy_mean_mean": 0.7394999999999997, "reward_accuracy_mean_min": 0.4083333333333324, "reward_accuracy_mean_max": 1.2, "reward_sla_mean_mean": -0.5299466666666668, "reward_sla_mean_min": -1.1533333333333333, "reward_sla_mean_max": -0.22666666666666666, "reward_consolidation_sum_mean": -46.47972996436079, "reward_consolidation_sum_min": -75.6148374912425, "reward_consolidation_sum_max": -24.433610527277715, "reward_illegal_sum_mean": -183.89999999999998, "reward_illegal_sum_min": -213.3333333333333, "reward_illegal_sum_max": -156.66666666666666, "reward_accuracy_sum_mean": 73.94999999999996, "reward_accuracy_sum_min": 40.833333333333236, "reward_accuracy_sum_max": 120.0, "reward_sla_sum_mean": -52.99466666666666, "reward_sla_sum_min": -115.33333333333334, "reward_sla_sum_max": -22.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4708.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-211.75953273020806, -216.21393584940145, -236.5330957385238, -208.149358798623, -196.01701239757523, -212.08734046117772, -203.60636936854607, -224.86362971762765, -216.81889792561427, -197.2699869018245, -218.6796399524809, -200.39906789728593, -272.02299795912137, -230.38142495963945, -220.95091839532125, -224.13924883487147, -208.89802004325432, -220.10586676414135, -220.38150415790926, -222.22793262054878, -209.46294739407224, -197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28558996848887414, "mean_inference_ms": 2.4118765555280617, "mean_action_processing_ms": 0.10653153218994546, "mean_env_wait_ms": 2.0589591819916246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007273435592651367, "StateBufferConnector_ms": 0.0040416717529296875, "ViewRequirementAgentConnector_ms": 0.10342717170715332}, "num_episodes": 21, "episode_return_max": -174.64371439885466, "episode_return_min": -272.02299795912137, "episode_return_mean": -209.42439663102743, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167100, "num_agent_steps_trained": 166650, "num_env_steps_sampled": 167100, "num_env_steps_trained": 166650, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.3870438856611, "num_env_steps_trained_throughput_per_sec": 214.11976026116875, "timesteps_total": 167100, "num_env_steps_sampled_lifetime": 167100, "num_agent_steps_sampled_lifetime": 167100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 167100, "timers": {"training_iteration_time_ms": 10407.516, "restore_workers_time_ms": 0.014, "training_step_time_ms": 740.18, "sample_time_ms": 724.876, "synch_weights_time_ms": 13.81}, "counters": {"num_env_steps_sampled": 167100, "num_env_steps_trained": 166650, "num_agent_steps_sampled": 167100, "num_agent_steps_trained": 166650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1114, "num_samples_added_to_queue": 166650}, "done": false, "training_iteration": 81, "trial_id": "13390_00000", "date": "2024-10-13_00-52-32", "timestamp": 1728777152, "time_this_iter_s": 10.286810398101807, "time_total_s": 842.9075636863708, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c164a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 842.9075636863708, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.06, "ram_util_percent": 62.86000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -180039.421875, "policy_loss": -180576.953125, "entropy": 26.52967643737793, "entropy_coeff": 0.01, "var_gnorm": 16.35273551940918, "vf_loss": 68344.3046875, "vf_explained_var": 0.2903265357017517}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 169200, "num_env_steps_trained": 168850, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1128, "num_samples_added_to_queue": 168850, "learner_queue": {"size_count": 307, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.532, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2633.946, "learner_dequeue_time_ms": 22264.63}}, "env_runners": {"episode_reward_max": -170.82051235188385, "episode_reward_min": -243.46918578086442, "episode_reward_mean": -204.99178747448894, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -243.46918578086442}, "policy_reward_max": {"default_policy": -170.82051235188385}, "policy_reward_mean": {"default_policy": -204.99178747448894}, "custom_metrics": {"num_consolidated_mean": 0.7165999999999998, "num_consolidated_min": 0.53, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0904, "num_overloaded_min": 0.91, "num_overloaded_max": 1.28, "num_moves_mean": 9.5053, "num_moves_min": 9.16, "num_moves_max": 9.86, "mean_accuracy_mean": 40.83064333333333, "mean_accuracy_min": 40.492, "mean_accuracy_max": 41.023999999999994, "num_model_switches_mean": 5.2798, "num_model_switches_min": 4.78, "num_model_switches_max": 5.85, "num_slav_mean": 0.078216, "num_slav_min": 0.0562, "num_slav_max": 0.09948333333333334, "cpu_conserved_cost_mean": 2.9393999999999996, "cpu_conserved_cost_min": 2.26, "cpu_conserved_cost_max": 3.78, "mean_cluster_cpu_util_mean": 0.5773856675255508, "mean_cluster_cpu_util_min": 0.5571017270383156, "mean_cluster_cpu_util_max": 0.601480097623001, "mean_cluster_mem_util_mean": 0.36718681759307104, "mean_cluster_mem_util_min": 0.35808804393065247, "mean_cluster_mem_util_max": 0.3777191529248831, "reward_consolidation_mean_mean": -0.4752945414115568, "reward_consolidation_mean_min": -0.7151056992293401, "reward_consolidation_mean_max": -0.24433610527277716, "reward_illegal_mean_mean": -1.817333333333333, "reward_illegal_mean_min": -2.133333333333333, "reward_illegal_mean_max": -1.5166666666666666, "reward_accuracy_mean_mean": 0.7615833333333331, "reward_accuracy_mean_min": 0.4083333333333324, "reward_accuracy_mean_max": 1.2666666666666666, "reward_sla_mean_mean": -0.5188733333333334, "reward_sla_mean_min": -1.0439999999999998, "reward_sla_mean_max": -0.22666666666666666, "reward_consolidation_sum_mean": -47.52945414115568, "reward_consolidation_sum_min": -71.51056992293401, "reward_consolidation_sum_max": -24.433610527277715, "reward_illegal_sum_mean": -181.73333333333332, "reward_illegal_sum_min": -213.3333333333333, "reward_illegal_sum_max": -151.66666666666666, "reward_accuracy_sum_mean": 76.1583333333333, "reward_accuracy_sum_min": 40.833333333333236, "reward_accuracy_sum_max": 126.66666666666667, "reward_sla_sum_mean": -51.88733333333334, "reward_sla_sum_min": -104.39999999999999, "reward_sla_sum_max": -22.666666666666664, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3770.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-197.92757013616, -227.8086722105455, -232.24800024368693, -220.53154223400048, -208.16800694507904, -217.58329221115463, -212.28157421791704, -191.54331840750538, -225.6601175789697, -197.62255627646277, -215.40045691309513, -192.37514392762495, -227.60027719394418, -205.0053215145146, -212.17036461664975, -201.73793597124475, -221.8247098601845, -201.53196564013518, -212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28558336689052893, "mean_inference_ms": 2.41158931411063, "mean_action_processing_ms": 0.10651911591994594, "mean_env_wait_ms": 2.0588119173826085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007008075714111328, "StateBufferConnector_ms": 0.003914594650268555, "ViewRequirementAgentConnector_ms": 0.09947776794433594}, "num_episodes": 21, "episode_return_max": -170.82051235188385, "episode_return_min": -243.46918578086442, "episode_return_mean": -204.99178747448894, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168850, "num_env_steps_sampled": 169200, "num_env_steps_trained": 168850, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.28543420546805, "num_env_steps_trained_throughput_per_sec": 211.91807392953797, "timesteps_total": 169200, "num_env_steps_sampled_lifetime": 169200, "num_agent_steps_sampled_lifetime": 169200, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 169200, "timers": {"training_iteration_time_ms": 10441.077, "restore_workers_time_ms": 0.014, "training_step_time_ms": 734.058, "sample_time_ms": 716.519, "synch_weights_time_ms": 15.703}, "counters": {"num_env_steps_sampled": 169200, "num_env_steps_trained": 168850, "num_agent_steps_sampled": 169200, "num_agent_steps_trained": 168850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1128, "num_samples_added_to_queue": 168850}, "done": false, "training_iteration": 82, "trial_id": "13390_00000", "date": "2024-10-13_00-52-42", "timestamp": 1728777162, "time_this_iter_s": 10.393928050994873, "time_total_s": 853.3014917373657, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16a40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 853.3014917373657, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.653333333333332, "ram_util_percent": 62.65333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -144010.890625, "policy_loss": -144393.4375, "entropy": 26.526750564575195, "entropy_coeff": 0.01, "var_gnorm": 16.360904693603516, "vf_loss": 52843.96875, "vf_explained_var": 0.2735910415649414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 310.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 171150, "num_env_steps_trained": 170500, "num_agent_steps_sampled": 171150, "num_agent_steps_trained": 170500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1141, "num_samples_added_to_queue": 171050, "learner_queue": {"size_count": 310, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 79.049, "learner_load_time_ms": 0.356, "learner_load_wait_time_ms": 2747.103, "learner_dequeue_time_ms": 22264.63}}, "env_runners": {"episode_reward_max": -167.70274757074534, "episode_reward_min": -243.46918578086442, "episode_reward_mean": -202.49309997258518, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -243.46918578086442}, "policy_reward_max": {"default_policy": -167.70274757074534}, "policy_reward_mean": {"default_policy": -202.49309997258518}, "custom_metrics": {"num_consolidated_mean": 0.7203000000000002, "num_consolidated_min": 0.53, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0743, "num_overloaded_min": 0.89, "num_overloaded_max": 1.28, "num_moves_mean": 9.4659, "num_moves_min": 9.15, "num_moves_max": 9.81, "mean_accuracy_mean": 40.83298666666666, "mean_accuracy_min": 40.492, "mean_accuracy_max": 41.023999999999994, "num_model_switches_mean": 5.2177, "num_model_switches_min": 4.77, "num_model_switches_max": 5.85, "num_slav_mean": 0.07531416666666668, "num_slav_min": 0.0562, "num_slav_max": 0.09421666666666667, "cpu_conserved_cost_mean": 2.9370000000000003, "cpu_conserved_cost_min": 2.26, "cpu_conserved_cost_max": 3.78, "mean_cluster_cpu_util_mean": 0.5761019752315364, "mean_cluster_cpu_util_min": 0.5571017270383156, "mean_cluster_cpu_util_max": 0.601480097623001, "mean_cluster_mem_util_mean": 0.36660228362790265, "mean_cluster_mem_util_min": 0.35808804393065247, "mean_cluster_mem_util_max": 0.3777191529248831, "reward_consolidation_mean_mean": -0.49982099972585226, "reward_consolidation_mean_min": -0.7774274269700571, "reward_consolidation_mean_max": -0.26810548600322887, "reward_illegal_mean_mean": -1.7904999999999998, "reward_illegal_mean_min": -2.133333333333333, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8025833333333331, "reward_accuracy_mean_min": 0.4083333333333324, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.5371933333333334, "reward_sla_mean_min": -1.0439999999999998, "reward_sla_mean_max": -0.16333333333333333, "reward_consolidation_sum_mean": -49.98209997258521, "reward_consolidation_sum_min": -77.74274269700571, "reward_consolidation_sum_max": -26.81054860032289, "reward_illegal_sum_mean": -179.04999999999995, "reward_illegal_sum_min": -213.3333333333333, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 80.2583333333333, "reward_accuracy_sum_min": 40.833333333333236, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -53.71933333333333, "reward_sla_sum_min": -104.39999999999999, "reward_sla_sum_max": -16.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2966.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-212.06880806603908, -218.28563160620183, -195.14450333546546, -198.097590544945, -242.60885802187084, -209.5599865972157, -219.63028115385777, -210.57146120807806, -233.27687715129915, -210.32906881111194, -191.38441317128164, -211.6759298181486, -207.20451734746715, -204.45652014986754, -209.9059368241492, -243.46918578086442, -206.31153553260845, -212.57083676018138, -209.15120472752744, -219.89261628438274, -238.53253830454784, -196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855476906782532, "mean_inference_ms": 2.411065638710184, "mean_action_processing_ms": 0.10650601196526363, "mean_env_wait_ms": 2.058606138428337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007114410400390625, "StateBufferConnector_ms": 0.003993988037109375, "ViewRequirementAgentConnector_ms": 0.1011655330657959}, "num_episodes": 18, "episode_return_max": -167.70274757074534, "episode_return_min": -243.46918578086442, "episode_return_mean": -202.49309997258518, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171150, "num_agent_steps_trained": 170500, "num_env_steps_sampled": 171150, "num_env_steps_trained": 170500, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 187.72895302243444, "num_env_steps_trained_throughput_per_sec": 158.84757563436762, "timesteps_total": 171150, "num_env_steps_sampled_lifetime": 171150, "num_agent_steps_sampled_lifetime": 171150, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 171150, "timers": {"training_iteration_time_ms": 10448.811, "restore_workers_time_ms": 0.016, "training_step_time_ms": 828.465, "sample_time_ms": 808.729, "synch_weights_time_ms": 18.196}, "counters": {"num_env_steps_sampled": 171150, "num_env_steps_trained": 170500, "num_agent_steps_sampled": 171150, "num_agent_steps_trained": 170500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1141, "num_samples_added_to_queue": 171050}, "done": false, "training_iteration": 83, "trial_id": "13390_00000", "date": "2024-10-13_00-52-53", "timestamp": 1728777173, "time_this_iter_s": 10.407459497451782, "time_total_s": 863.7089512348175, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b59ae0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 863.7089512348175, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 24.279999999999998, "ram_util_percent": 63.166666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -146902.421875, "policy_loss": -147279.21875, "entropy": 26.406110763549805, "entropy_coeff": 0.01, "var_gnorm": 16.371597290039062, "vf_loss": 52202.8984375, "vf_explained_var": 0.2942829132080078}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 314.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 173250, "num_env_steps_trained": 172700, "num_agent_steps_sampled": 173250, "num_agent_steps_trained": 172700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1155, "num_samples_added_to_queue": 173250, "learner_queue": {"size_count": 314, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.32, "learner_load_time_ms": 0.32, "learner_load_wait_time_ms": 2663.911, "learner_dequeue_time_ms": 22162.808}}, "env_runners": {"episode_reward_max": -167.70274757074534, "episode_reward_min": -232.46046178683486, "episode_reward_mean": -197.7315249322245, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -232.46046178683486}, "policy_reward_max": {"default_policy": -167.70274757074534}, "policy_reward_mean": {"default_policy": -197.7315249322245}, "custom_metrics": {"num_consolidated_mean": 0.7271999999999998, "num_consolidated_min": 0.53, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.057, "num_overloaded_min": 0.89, "num_overloaded_max": 1.19, "num_moves_mean": 9.4175, "num_moves_min": 9.03, "num_moves_max": 9.76, "mean_accuracy_mean": 40.83982666666666, "mean_accuracy_min": 40.492, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 5.1564, "num_model_switches_min": 4.64, "num_model_switches_max": 5.72, "num_slav_mean": 0.07276016666666667, "num_slav_min": 0.0562, "num_slav_max": 0.09126666666666666, "cpu_conserved_cost_mean": 2.940399999999999, "cpu_conserved_cost_min": 2.26, "cpu_conserved_cost_max": 3.78, "mean_cluster_cpu_util_mean": 0.5749700337241552, "mean_cluster_cpu_util_min": 0.5571017270383156, "mean_cluster_cpu_util_max": 0.601480097623001, "mean_cluster_mem_util_mean": 0.36590547771355375, "mean_cluster_mem_util_min": 0.3560611844843422, "mean_cluster_mem_util_max": 0.3777191529248831, "reward_consolidation_mean_mean": -0.5170352493222456, "reward_consolidation_mean_min": -0.7774274269700571, "reward_consolidation_mean_max": -0.26810548600322887, "reward_illegal_mean_mean": -1.7616666666666665, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.840333333333333, "reward_accuracy_mean_min": 0.41666666666666624, "reward_accuracy_mean_max": 1.3250000000000006, "reward_sla_mean_mean": -0.5389466666666667, "reward_sla_mean_min": -1.0439999999999998, "reward_sla_mean_max": -0.16333333333333333, "reward_consolidation_sum_mean": -51.70352493222456, "reward_consolidation_sum_min": -77.74274269700571, "reward_consolidation_sum_max": -26.81054860032289, "reward_illegal_sum_mean": -176.16666666666663, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 84.0333333333333, "reward_accuracy_sum_min": 41.66666666666662, "reward_accuracy_sum_max": 132.50000000000006, "reward_sla_sum_mean": -53.89466666666667, "reward_sla_sum_min": -104.39999999999999, "reward_sla_sum_max": -16.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2028.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-196.41664077492445, -209.02095098845518, -198.43870663133208, -227.34308385878344, -180.1236894209388, -200.15598708458992, -216.89198574431128, -200.3398732827682, -193.04699808096493, -195.799634469524, -212.47118706022113, -206.1526485729081, -218.4105486003226, -188.20654908769677, -232.46046178683486, -209.6129428249412, -205.9900362484387, -213.690048432788, -208.6622467939932, -201.05060464832897, -195.84365956928306, -224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28550978820083095, "mean_inference_ms": 2.410602827934798, "mean_action_processing_ms": 0.10649457757133284, "mean_env_wait_ms": 2.0584923686956738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007178783416748047, "StateBufferConnector_ms": 0.004004001617431641, "ViewRequirementAgentConnector_ms": 0.10219669342041016}, "num_episodes": 21, "episode_return_max": -167.70274757074534, "episode_return_min": -232.46046178683486, "episode_return_mean": -197.7315249322245, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173250, "num_agent_steps_trained": 172700, "num_env_steps_sampled": 173250, "num_env_steps_trained": 172700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.2469153123085, "num_env_steps_trained_throughput_per_sec": 212.92533985098984, "timesteps_total": 173250, "num_env_steps_sampled_lifetime": 173250, "num_agent_steps_sampled_lifetime": 173250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 173250, "timers": {"training_iteration_time_ms": 10408.413, "restore_workers_time_ms": 0.016, "training_step_time_ms": 731.147, "sample_time_ms": 713.611, "synch_weights_time_ms": 15.99}, "counters": {"num_env_steps_sampled": 173250, "num_env_steps_trained": 172700, "num_agent_steps_sampled": 173250, "num_agent_steps_trained": 172700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1155, "num_samples_added_to_queue": 173250}, "done": false, "training_iteration": 84, "trial_id": "13390_00000", "date": "2024-10-13_00-53-03", "timestamp": 1728777183, "time_this_iter_s": 10.342915773391724, "time_total_s": 874.0518670082092, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b5ad70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 874.0518670082092, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.94, "ram_util_percent": 64.92666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -143159.734375, "policy_loss": -143521.5625, "entropy": 26.067880630493164, "entropy_coeff": 0.01, "var_gnorm": 16.38375473022461, "vf_loss": 50520.26171875, "vf_explained_var": 0.31931501626968384}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 318.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 175350, "num_env_steps_trained": 174900, "num_agent_steps_sampled": 175350, "num_agent_steps_trained": 174900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1169, "num_samples_added_to_queue": 174900, "learner_queue": {"size_count": 318, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.175, "learner_load_time_ms": 0.32, "learner_load_wait_time_ms": 2656.862, "learner_dequeue_time_ms": 22162.808}}, "env_runners": {"episode_reward_max": -153.22235523470093, "episode_reward_min": -226.88585701666216, "episode_reward_mean": -193.00030168448626, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -226.88585701666216}, "policy_reward_max": {"default_policy": -153.22235523470093}, "policy_reward_mean": {"default_policy": -193.00030168448626}, "custom_metrics": {"num_consolidated_mean": 0.7236, "num_consolidated_min": 0.59, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0393000000000001, "num_overloaded_min": 0.89, "num_overloaded_max": 1.19, "num_moves_mean": 9.366299999999997, "num_moves_min": 8.91, "num_moves_max": 9.76, "mean_accuracy_mean": 40.836659999999995, "mean_accuracy_min": 40.492, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 5.1262, "num_model_switches_min": 4.64, "num_model_switches_max": 5.72, "num_slav_mean": 0.07097816666666666, "num_slav_min": 0.0558, "num_slav_max": 0.09126666666666666, "cpu_conserved_cost_mean": 2.915, "cpu_conserved_cost_min": 2.3, "cpu_conserved_cost_max": 3.72, "mean_cluster_cpu_util_mean": 0.5725886828573643, "mean_cluster_cpu_util_min": 0.5526368140776126, "mean_cluster_cpu_util_max": 0.5975334742896249, "mean_cluster_mem_util_mean": 0.3648870739508884, "mean_cluster_mem_util_min": 0.35596526109388904, "mean_cluster_mem_util_max": 0.3749534207353827, "reward_consolidation_mean_mean": -0.543393016844863, "reward_consolidation_mean_min": -0.8912117335282831, "reward_consolidation_mean_max": -0.2801919034999544, "reward_illegal_mean_mean": -1.7321666666666666, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8824166666666664, "reward_accuracy_mean_min": 0.41666666666666624, "reward_accuracy_mean_max": 1.4000000000000006, "reward_sla_mean_mean": -0.53686, "reward_sla_mean_min": -1.0439999999999998, "reward_sla_mean_max": -0.16333333333333333, "reward_consolidation_sum_mean": -54.33930168448629, "reward_consolidation_sum_min": -89.12117335282831, "reward_consolidation_sum_max": -28.019190349995437, "reward_illegal_sum_mean": -173.21666666666664, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 88.24166666666665, "reward_accuracy_sum_min": 41.66666666666662, "reward_accuracy_sum_max": 140.00000000000006, "reward_sla_sum_mean": -53.685999999999986, "reward_sla_sum_min": -104.39999999999999, "reward_sla_sum_max": -16.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2182.0, "global_timestep_min": 500, "global_timestep_max": 3800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-224.03575801882468, -190.49623199000877, -211.7409820585459, -186.66930762435646, -194.03781717384012, -187.0734228883, -213.41193457004474, -183.9640561698498, -176.98182399707574, -181.6617228669774, -217.58512900179713, -197.81474915471077, -199.2240275366291, -192.50548295714168, -220.45606019068504, -225.8344817082457, -174.64371439885466, -179.97723658960066, -190.07938408114785, -199.20555301714938, -186.48454415303542, -188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28545949411541666, "mean_inference_ms": 2.410150178475342, "mean_action_processing_ms": 0.10648227332446543, "mean_env_wait_ms": 2.0583853641654692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007063150405883789, "StateBufferConnector_ms": 0.003966093063354492, "ViewRequirementAgentConnector_ms": 0.10080909729003906}, "num_episodes": 21, "episode_return_max": -153.22235523470093, "episode_return_min": -226.88585701666216, "episode_return_mean": -193.00030168448626, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175350, "num_agent_steps_trained": 174900, "num_env_steps_sampled": 175350, "num_env_steps_trained": 174900, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.8593314693262, "num_env_steps_trained_throughput_per_sec": 214.61453772977032, "timesteps_total": 175350, "num_env_steps_sampled_lifetime": 175350, "num_agent_steps_sampled_lifetime": 175350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 175350, "timers": {"training_iteration_time_ms": 10363.724, "restore_workers_time_ms": 0.016, "training_step_time_ms": 734.466, "sample_time_ms": 718.108, "synch_weights_time_ms": 14.868}, "counters": {"num_env_steps_sampled": 175350, "num_env_steps_trained": 174900, "num_agent_steps_sampled": 175350, "num_agent_steps_trained": 174900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1169, "num_samples_added_to_queue": 174900}, "done": false, "training_iteration": 85, "trial_id": "13390_00000", "date": "2024-10-13_00-53-14", "timestamp": 1728777194, "time_this_iter_s": 10.263510465621948, "time_total_s": 884.3153774738312, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2cd720>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 884.3153774738312, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.085714285714285, "ram_util_percent": 64.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -102924.1796875, "policy_loss": -103128.234375, "entropy": 25.63574981689453, "entropy_coeff": 0.01, "var_gnorm": 16.396259307861328, "vf_loss": 34505.734375, "vf_explained_var": 0.3323410153388977}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 322.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 177300, "num_env_steps_trained": 177100, "num_agent_steps_sampled": 177300, "num_agent_steps_trained": 177100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1182, "num_samples_added_to_queue": 177100, "learner_queue": {"size_count": 322, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.885, "learner_load_time_ms": 0.371, "learner_load_wait_time_ms": 2704.09, "learner_dequeue_time_ms": 22174.49}}, "env_runners": {"episode_reward_max": -144.78460202869405, "episode_reward_min": -226.88585701666216, "episode_reward_mean": -188.82164732401228, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -226.88585701666216}, "policy_reward_max": {"default_policy": -144.78460202869405}, "policy_reward_mean": {"default_policy": -188.82164732401228}, "custom_metrics": {"num_consolidated_mean": 0.7269, "num_consolidated_min": 0.54, "num_consolidated_max": 0.88, "num_overloaded_mean": 1.0212, "num_overloaded_min": 0.79, "num_overloaded_max": 1.19, "num_moves_mean": 9.3297, "num_moves_min": 8.91, "num_moves_max": 9.76, "mean_accuracy_mean": 40.84717333333334, "mean_accuracy_min": 40.663, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 5.0731, "num_model_switches_min": 4.59, "num_model_switches_max": 5.58, "num_slav_mean": 0.06873216666666668, "num_slav_min": 0.04548333333333333, "num_slav_max": 0.08336666666666666, "cpu_conserved_cost_mean": 2.891, "cpu_conserved_cost_min": 2.24, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5700274568633678, "mean_cluster_cpu_util_min": 0.5440194134909602, "mean_cluster_cpu_util_max": 0.5905760643689978, "mean_cluster_mem_util_mean": 0.3635105316635092, "mean_cluster_mem_util_min": 0.3530782345216567, "mean_cluster_mem_util_max": 0.3719943979807113, "reward_consolidation_mean_mean": -0.5689664732401232, "reward_consolidation_mean_min": -0.964589692040574, "reward_consolidation_mean_max": -0.2801919034999544, "reward_illegal_mean_mean": -1.7019999999999995, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.3166666666666662, "reward_accuracy_mean_mean": 0.9327499999999997, "reward_accuracy_mean_min": 0.44999999999999996, "reward_accuracy_mean_max": 1.4916666666666671, "reward_sla_mean_mean": -0.55, "reward_sla_mean_min": -0.9353333333333333, "reward_sla_mean_max": -0.16333333333333333, "reward_consolidation_sum_mean": -56.896647324012314, "reward_consolidation_sum_min": -96.4589692040574, "reward_consolidation_sum_max": -28.019190349995437, "reward_illegal_sum_mean": -170.19999999999993, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -131.66666666666663, "reward_accuracy_sum_mean": 93.27499999999998, "reward_accuracy_sum_min": 44.99999999999999, "reward_accuracy_sum_max": 149.1666666666667, "reward_sla_sum_mean": -54.99999999999999, "reward_sla_sum_min": -93.53333333333333, "reward_sla_sum_max": -16.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2882.0, "global_timestep_min": 1200, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-188.25745834475615, -204.04456730329883, -215.29361235493008, -195.40585762587946, -206.8216790033201, -209.18054768649662, -203.83389076730933, -182.32958969204074, -200.92686344390626, -196.93756434859412, -197.99303664443025, -226.88585701666216, -170.82051235188385, -179.36815315726938, -192.47411435011722, -198.9664747631668, -221.9035761064912, -178.27524444850596, -172.2991166346828, -201.02777117792186, -203.5245514636448, -218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2854723187239606, "mean_inference_ms": 2.4102727832281188, "mean_action_processing_ms": 0.10648651400732569, "mean_env_wait_ms": 2.058655284466878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007166624069213867, "StateBufferConnector_ms": 0.004028797149658203, "ViewRequirementAgentConnector_ms": 0.10251450538635254}, "num_episodes": 21, "episode_return_max": -144.78460202869405, "episode_return_min": -226.88585701666216, "episode_return_mean": -188.82164732401228, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177300, "num_agent_steps_trained": 177100, "num_env_steps_sampled": 177300, "num_env_steps_trained": 177100, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 187.98367069554732, "num_env_steps_trained_throughput_per_sec": 212.08414129754055, "timesteps_total": 177300, "num_env_steps_sampled_lifetime": 177300, "num_agent_steps_sampled_lifetime": 177300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 177300, "timers": {"training_iteration_time_ms": 10339.448, "restore_workers_time_ms": 0.014, "training_step_time_ms": 809.131, "sample_time_ms": 789.692, "synch_weights_time_ms": 17.618}, "counters": {"num_env_steps_sampled": 177300, "num_env_steps_trained": 177100, "num_agent_steps_sampled": 177300, "num_agent_steps_trained": 177100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1182, "num_samples_added_to_queue": 177100}, "done": false, "training_iteration": 86, "trial_id": "13390_00000", "date": "2024-10-13_00-53-24", "timestamp": 1728777204, "time_this_iter_s": 10.38281774520874, "time_total_s": 894.6981952190399, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2cda50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 894.6981952190399, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 20.919999999999998, "ram_util_percent": 64.57999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -79131.3203125, "policy_loss": -79243.0625, "entropy": 25.331684112548828, "entropy_coeff": 0.01, "var_gnorm": 16.40440559387207, "vf_loss": 25107.3515625, "vf_explained_var": 0.3542643189430237}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 325.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 179400, "num_env_steps_trained": 178750, "num_agent_steps_sampled": 179400, "num_agent_steps_trained": 178750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1196, "num_samples_added_to_queue": 179300, "learner_queue": {"size_count": 325, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.261, "learner_load_time_ms": 0.371, "learner_load_wait_time_ms": 2734.06, "learner_dequeue_time_ms": 22174.49}}, "env_runners": {"episode_reward_max": -122.25411374089978, "episode_reward_min": -224.88715160376498, "episode_reward_mean": -180.54453327850374, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -224.88715160376498}, "policy_reward_max": {"default_policy": -122.25411374089978}, "policy_reward_mean": {"default_policy": -180.54453327850374}, "custom_metrics": {"num_consolidated_mean": 0.7253000000000002, "num_consolidated_min": 0.54, "num_consolidated_max": 0.9, "num_overloaded_mean": 0.9892999999999997, "num_overloaded_min": 0.78, "num_overloaded_max": 1.17, "num_moves_mean": 9.2452, "num_moves_min": 8.68, "num_moves_max": 9.67, "mean_accuracy_mean": 40.85337999999999, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 4.9987, "num_model_switches_min": 4.28, "num_model_switches_max": 5.58, "num_slav_mean": 0.06569166666666666, "num_slav_min": 0.04088333333333333, "num_slav_max": 0.07953333333333333, "cpu_conserved_cost_mean": 2.8438000000000003, "cpu_conserved_cost_min": 2.24, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5661561197394359, "mean_cluster_cpu_util_min": 0.5434363405795031, "mean_cluster_cpu_util_max": 0.5887823502146272, "mean_cluster_mem_util_mean": 0.36165149901870036, "mean_cluster_mem_util_min": 0.35051601958293865, "mean_cluster_mem_util_max": 0.3715747492034789, "reward_consolidation_mean_mean": -0.612508666118371, "reward_consolidation_mean_min": -1.0180390813000701, "reward_consolidation_mean_max": -0.2955045843613878, "reward_illegal_mean_mean": -1.648833333333333, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.2999999999999998, "reward_accuracy_mean_mean": 1.0147499999999998, "reward_accuracy_mean_min": 0.5166666666666663, "reward_accuracy_mean_max": 1.5750000000000008, "reward_sla_mean_mean": -0.5588533333333333, "reward_sla_mean_min": -0.9353333333333333, "reward_sla_mean_max": -0.16333333333333333, "reward_consolidation_sum_mean": -61.2508666118371, "reward_consolidation_sum_min": -101.80390813000702, "reward_consolidation_sum_max": -29.550458436138783, "reward_illegal_sum_mean": -164.88333333333333, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -129.99999999999997, "reward_accuracy_sum_mean": 101.47499999999998, "reward_accuracy_sum_min": 51.66666666666663, "reward_accuracy_sum_max": 157.50000000000009, "reward_sla_sum_mean": -55.88533333333333, "reward_sla_sum_min": -93.53333333333333, "reward_sla_sum_max": -16.333333333333332, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3582.0, "global_timestep_min": 1900, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-218.49183953212082, -168.9279508970727, -201.66560662828587, -212.77731883395776, -201.81406378506793, -224.88715160376498, -195.21177921959244, -197.07607603033895, -185.60533369886377, -167.70274757074534, -212.0564104907249, -184.90806908526, -186.65941697889056, -168.73876755307813, -203.65159158061476, -224.4256297785494, -184.9571385055895, -194.26439428554028, -182.97902464284616, -180.45337354168564, -184.4037375491182, -189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28549086657446243, "mean_inference_ms": 2.4103079886992385, "mean_action_processing_ms": 0.10649271339702597, "mean_env_wait_ms": 2.0588793772433656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007070779800415039, "StateBufferConnector_ms": 0.003954410552978516, "ViewRequirementAgentConnector_ms": 0.10122346878051758}, "num_episodes": 21, "episode_return_max": -122.25411374089978, "episode_return_min": -224.88715160376498, "episode_return_mean": -180.54453327850374, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179400, "num_agent_steps_trained": 178750, "num_env_steps_sampled": 179400, "num_env_steps_trained": 178750, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 203.4170779254911, "num_env_steps_trained_throughput_per_sec": 159.82770408431443, "timesteps_total": 179400, "num_env_steps_sampled_lifetime": 179400, "num_agent_steps_sampled_lifetime": 179400, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 179400, "timers": {"training_iteration_time_ms": 10283.153, "restore_workers_time_ms": 0.014, "training_step_time_ms": 733.124, "sample_time_ms": 716.367, "synch_weights_time_ms": 15.26}, "counters": {"num_env_steps_sampled": 179400, "num_env_steps_trained": 178750, "num_agent_steps_sampled": 179400, "num_agent_steps_trained": 178750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1196, "num_samples_added_to_queue": 179300}, "done": false, "training_iteration": 87, "trial_id": "13390_00000", "date": "2024-10-13_00-53-34", "timestamp": 1728777214, "time_this_iter_s": 10.335686445236206, "time_total_s": 905.0338816642761, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c15ff0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 905.0338816642761, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.020000000000003, "ram_util_percent": 65.32666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -3327.811279296875, "policy_loss": -3306.31884765625, "entropy": 24.843265533447266, "entropy_coeff": 0.01, "var_gnorm": 16.41611671447754, "vf_loss": 11514.556640625, "vf_explained_var": 0.3347907066345215}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 181500, "num_env_steps_trained": 180950, "num_agent_steps_sampled": 181500, "num_agent_steps_trained": 180950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1210, "num_samples_added_to_queue": 181500, "learner_queue": {"size_count": 329, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.393, "learner_load_time_ms": 0.359, "learner_load_wait_time_ms": 2619.182, "learner_dequeue_time_ms": 22321.501}}, "env_runners": {"episode_reward_max": -92.44823174632191, "episode_reward_min": -214.18379176947204, "episode_reward_mean": -167.2157289286911, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -214.18379176947204}, "policy_reward_max": {"default_policy": -92.44823174632191}, "policy_reward_mean": {"default_policy": -167.2157289286911}, "custom_metrics": {"num_consolidated_mean": 0.7338000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.9, "num_overloaded_mean": 0.938, "num_overloaded_min": 0.66, "num_overloaded_max": 1.17, "num_moves_mean": 9.1447, "num_moves_min": 8.65, "num_moves_max": 9.59, "mean_accuracy_mean": 40.84970666666666, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 4.937499999999999, "num_model_switches_min": 4.28, "num_model_switches_max": 5.58, "num_slav_mean": 0.06237383333333334, "num_slav_min": 0.04088333333333333, "num_slav_max": 0.07953333333333332, "cpu_conserved_cost_mean": 2.7933999999999997, "cpu_conserved_cost_min": 2.2, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5597571528052354, "mean_cluster_cpu_util_min": 0.5278431613261114, "mean_cluster_cpu_util_max": 0.5872454345481016, "mean_cluster_mem_util_mean": 0.3585600395677258, "mean_cluster_mem_util_min": 0.34363278778811107, "mean_cluster_mem_util_max": 0.37046508528516897, "reward_consolidation_mean_mean": -0.6839406226202444, "reward_consolidation_mean_min": -1.243271650065491, "reward_consolidation_mean_max": -0.2955045843613878, "reward_illegal_mean_mean": -1.5633333333333328, "reward_illegal_mean_min": -1.9499999999999997, "reward_illegal_mean_max": -1.0999999999999999, "reward_accuracy_mean_mean": 1.1455833333333332, "reward_accuracy_mean_min": 0.5166666666666663, "reward_accuracy_mean_max": 2.1000000000000014, "reward_sla_mean_mean": -0.5704666666666666, "reward_sla_mean_min": -0.954, "reward_sla_mean_max": -0.23133333333333334, "reward_consolidation_sum_mean": -68.39406226202443, "reward_consolidation_sum_min": -124.3271650065491, "reward_consolidation_sum_max": -29.550458436138783, "reward_illegal_sum_mean": -156.3333333333333, "reward_illegal_sum_min": -194.99999999999997, "reward_illegal_sum_max": -109.99999999999999, "reward_accuracy_sum_mean": 114.55833333333332, "reward_accuracy_sum_min": 51.66666666666663, "reward_accuracy_sum_max": 210.00000000000014, "reward_sla_sum_mean": -57.04666666666667, "reward_sla_sum_min": -95.39999999999999, "reward_sla_sum_max": -23.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4275.0, "global_timestep_min": 2500, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-189.6527338633524, -176.1969356361753, -212.56804045203955, -195.11251941880658, -191.2528191537968, -191.9436473849339, -206.78289012763113, -174.08353589813873, -204.37867129671932, -187.21961984830472, -189.82739041700913, -212.18570775838427, -187.12993694599274, -198.2529988729476, -193.35397057479668, -190.9717109872369, -181.9612263547473, -167.0295165859452, -203.00560784672078, -165.79807182673855, -214.18379176947204, -185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28546379364563323, "mean_inference_ms": 2.407272507574165, "mean_action_processing_ms": 0.10645558124265446, "mean_env_wait_ms": 2.058211210035085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007177591323852539, "StateBufferConnector_ms": 0.003883838653564453, "ViewRequirementAgentConnector_ms": 0.0994415283203125}, "num_episodes": 21, "episode_return_max": -92.44823174632191, "episode_return_min": -214.18379176947204, "episode_return_mean": -167.2157289286911, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181500, "num_agent_steps_trained": 180950, "num_env_steps_sampled": 181500, "num_env_steps_trained": 180950, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.0158826224317, "num_env_steps_trained_throughput_per_sec": 218.96901989016652, "timesteps_total": 181500, "num_env_steps_sampled_lifetime": 181500, "num_agent_steps_sampled_lifetime": 181500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 181500, "timers": {"training_iteration_time_ms": 10277.086, "restore_workers_time_ms": 0.014, "training_step_time_ms": 717.04, "sample_time_ms": 700.075, "synch_weights_time_ms": 15.364}, "counters": {"num_env_steps_sampled": 181500, "num_env_steps_trained": 180950, "num_agent_steps_sampled": 181500, "num_agent_steps_trained": 180950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1210, "num_samples_added_to_queue": 181500}, "done": false, "training_iteration": 88, "trial_id": "13390_00000", "date": "2024-10-13_00-53-44", "timestamp": 1728777224, "time_this_iter_s": 10.060034990310669, "time_total_s": 915.0939166545868, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b5a5f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 915.0939166545868, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.05, "ram_util_percent": 64.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 26209.365234375, "policy_loss": 26167.1953125, "entropy": 24.06540298461914, "entropy_coeff": 0.01, "var_gnorm": 16.430194854736328, "vf_loss": 17452.998046875, "vf_explained_var": 0.2219994068145752}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 333.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 183600, "num_env_steps_trained": 183150, "num_agent_steps_sampled": 183600, "num_agent_steps_trained": 183150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1224, "num_samples_added_to_queue": 183150, "learner_queue": {"size_count": 333, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.751, "learner_load_time_ms": 0.359, "learner_load_wait_time_ms": 2533.095, "learner_dequeue_time_ms": 22321.501}}, "env_runners": {"episode_reward_max": -52.59228426086681, "episode_reward_min": -206.66461969600044, "episode_reward_mean": -149.1572524292546, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -206.66461969600044}, "policy_reward_max": {"default_policy": -52.59228426086681}, "policy_reward_mean": {"default_policy": -149.1572524292546}, "custom_metrics": {"num_consolidated_mean": 0.7562000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 1.0, "num_overloaded_mean": 0.8658, "num_overloaded_min": 0.56, "num_overloaded_max": 1.14, "num_moves_mean": 9.0073, "num_moves_min": 8.36, "num_moves_max": 9.53, "mean_accuracy_mean": 40.851859999999995, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.04933333333334, "num_model_switches_mean": 4.8137, "num_model_switches_min": 4.26, "num_model_switches_max": 5.37, "num_slav_mean": 0.05772666666666666, "num_slav_min": 0.0376, "num_slav_max": 0.07953333333333332, "cpu_conserved_cost_mean": 2.7641999999999998, "cpu_conserved_cost_min": 2.2, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5515570418831515, "mean_cluster_cpu_util_min": 0.5175048852046771, "mean_cluster_cpu_util_max": 0.5843484693014231, "mean_cluster_mem_util_mean": 0.3547393647797727, "mean_cluster_mem_util_min": 0.3373199851459572, "mean_cluster_mem_util_max": 0.3683790819914464, "reward_consolidation_mean_mean": -0.7921225242925461, "reward_consolidation_mean_min": -1.2835895092753362, "reward_consolidation_mean_max": -0.3569386822626337, "reward_illegal_mean_mean": -1.4429999999999996, "reward_illegal_mean_min": -1.8999999999999997, "reward_illegal_mean_max": -0.9333333333333331, "reward_accuracy_mean_mean": 1.36075, "reward_accuracy_mean_min": 0.6416666666666667, "reward_accuracy_mean_max": 2.425000000000001, "reward_sla_mean_mean": -0.6172000000000001, "reward_sla_mean_min": -0.9746666666666666, "reward_sla_mean_max": -0.23133333333333334, "reward_consolidation_sum_mean": -79.21225242925463, "reward_consolidation_sum_min": -128.3589509275336, "reward_consolidation_sum_max": -35.69386822626337, "reward_illegal_sum_mean": -144.29999999999998, "reward_illegal_sum_min": -189.99999999999997, "reward_illegal_sum_max": -93.33333333333331, "reward_accuracy_sum_mean": 136.075, "reward_accuracy_sum_min": 64.16666666666667, "reward_accuracy_sum_max": 242.5000000000001, "reward_sla_sum_mean": -61.71999999999999, "reward_sla_sum_min": -97.46666666666665, "reward_sla_sum_max": -23.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4975.0, "global_timestep_min": 3200, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-185.95532608364564, -169.98956105881987, -185.84955374821047, -179.7984647720004, -176.20692071034753, -180.63796643211793, -187.82117335282828, -206.66461969600044, -153.22235523470093, -206.4902372902006, -159.15624295592315, -167.20332023515795, -195.1125742483779, -190.31139236650515, -170.64770172713153, -189.96053489292999, -184.69652746047709, -177.47599378598193, -186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28546753967383, "mean_inference_ms": 2.4066832766141806, "mean_action_processing_ms": 0.1064356299226066, "mean_env_wait_ms": 2.0579840314434406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007437944412231445, "StateBufferConnector_ms": 0.0038957595825195312, "ViewRequirementAgentConnector_ms": 0.09922528266906738}, "num_episodes": 21, "episode_return_max": -52.59228426086681, "episode_return_min": -206.66461969600044, "episode_return_mean": -149.1572524292546, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183600, "num_agent_steps_trained": 183150, "num_env_steps_sampled": 183600, "num_env_steps_trained": 183150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.795046103685, "num_env_steps_trained_throughput_per_sec": 213.49957210862237, "timesteps_total": 183600, "num_env_steps_sampled_lifetime": 183600, "num_agent_steps_sampled_lifetime": 183600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 183600, "timers": {"training_iteration_time_ms": 10293.879, "restore_workers_time_ms": 0.013, "training_step_time_ms": 749.913, "sample_time_ms": 734.578, "synch_weights_time_ms": 13.618}, "counters": {"num_env_steps_sampled": 183600, "num_env_steps_trained": 183150, "num_agent_steps_sampled": 183600, "num_agent_steps_trained": 183150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1224, "num_samples_added_to_queue": 183150}, "done": false, "training_iteration": 89, "trial_id": "13390_00000", "date": "2024-10-13_00-53-55", "timestamp": 1728777235, "time_this_iter_s": 10.315686702728271, "time_total_s": 925.4096033573151, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b59090>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 925.4096033573151, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.78666666666667, "ram_util_percent": 64.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 72390.3125, "policy_loss": 72250.5859375, "entropy": 23.18708610534668, "entropy_coeff": 0.01, "var_gnorm": 16.442249298095703, "vf_loss": 26725.615234375, "vf_explained_var": 0.11688375473022461}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 336.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 185400, "num_env_steps_trained": 184800, "num_agent_steps_sampled": 185400, "num_agent_steps_trained": 184800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1236, "num_samples_added_to_queue": 185350, "learner_queue": {"size_count": 336, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.504, "learner_load_time_ms": 0.438, "learner_load_wait_time_ms": 2736.481, "learner_dequeue_time_ms": 22247.778}}, "env_runners": {"episode_reward_max": -33.0159188522341, "episode_reward_min": -203.81907764476531, "episode_reward_mean": -129.2664869475159, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -203.81907764476531}, "policy_reward_max": {"default_policy": -33.0159188522341}, "policy_reward_mean": {"default_policy": -129.2664869475159}, "custom_metrics": {"num_consolidated_mean": 0.7861999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 1.08, "num_overloaded_mean": 0.7929999999999999, "num_overloaded_min": 0.43, "num_overloaded_max": 1.11, "num_moves_mean": 8.8352, "num_moves_min": 8.06, "num_moves_max": 9.37, "mean_accuracy_mean": 40.88244999999999, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.080999999999996, "num_model_switches_mean": 4.6697999999999995, "num_model_switches_min": 3.92, "num_model_switches_max": 5.19, "num_slav_mean": 0.053402000000000005, "num_slav_min": 0.034416666666666665, "num_slav_max": 0.074, "cpu_conserved_cost_mean": 2.7556, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.54, "mean_cluster_cpu_util_mean": 0.5440801668827644, "mean_cluster_cpu_util_min": 0.5065137654182945, "mean_cluster_cpu_util_max": 0.5843484693014231, "mean_cluster_mem_util_mean": 0.35107641683529955, "mean_cluster_mem_util_min": 0.3342994567869341, "mean_cluster_mem_util_max": 0.3683790819914464, "reward_consolidation_mean_mean": -0.9017148694751593, "reward_consolidation_mean_min": -1.657635627037071, "reward_consolidation_mean_max": -0.3673966614883183, "reward_illegal_mean_mean": -1.3216666666666665, "reward_illegal_mean_min": -1.85, "reward_illegal_mean_max": -0.7166666666666667, "reward_accuracy_mean_mean": 1.6039166666666669, "reward_accuracy_mean_min": 0.6416666666666667, "reward_accuracy_mean_max": 2.975000000000002, "reward_sla_mean_mean": -0.6731999999999999, "reward_sla_mean_min": -1.0199999999999998, "reward_sla_mean_max": -0.23133333333333334, "reward_consolidation_sum_mean": -90.17148694751592, "reward_consolidation_sum_min": -165.7635627037071, "reward_consolidation_sum_max": -36.73966614883183, "reward_illegal_sum_mean": -132.16666666666666, "reward_illegal_sum_min": -185.0, "reward_illegal_sum_max": -71.66666666666667, "reward_accuracy_sum_mean": 160.3916666666667, "reward_accuracy_sum_min": 64.16666666666667, "reward_accuracy_sum_max": 297.50000000000017, "reward_sla_sum_mean": -67.32, "reward_sla_sum_min": -101.99999999999999, "reward_sla_sum_max": -23.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5582.0, "global_timestep_min": 3900, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-186.19931158427, -173.1132626641079, -172.37299948216517, -181.7809040787108, -154.5256358707241, -175.9633494775959, -185.42547138200985, -144.78460202869405, -173.1179201315909, -173.1635383350085, -163.00575710499857, -157.32358585397066, -203.81907764476531, -181.38921380486772, -179.63356788205547, -178.94036674891092, -189.74568217125108, -193.09754180754803, -186.44367479971962, -158.94549940601308, -167.1464497852507, -170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855225291998567, "mean_inference_ms": 2.409074653140981, "mean_action_processing_ms": 0.10645469692238858, "mean_env_wait_ms": 2.0586113798396637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00764012336730957, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.10253620147705078}, "num_episodes": 18, "episode_return_max": -33.0159188522341, "episode_return_min": -203.81907764476531, "episode_return_mean": -129.2664869475159, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185400, "num_agent_steps_trained": 184800, "num_env_steps_sampled": 185400, "num_env_steps_trained": 184800, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 179.81575151555813, "num_env_steps_trained_throughput_per_sec": 164.8311055559283, "timesteps_total": 185400, "num_env_steps_sampled_lifetime": 185400, "num_agent_steps_sampled_lifetime": 185400, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 185400, "timers": {"training_iteration_time_ms": 10268.527, "restore_workers_time_ms": 0.018, "training_step_time_ms": 770.916, "sample_time_ms": 752.132, "synch_weights_time_ms": 16.881}, "counters": {"num_env_steps_sampled": 185400, "num_env_steps_trained": 184800, "num_agent_steps_sampled": 185400, "num_agent_steps_trained": 184800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1236, "num_samples_added_to_queue": 185350}, "done": false, "training_iteration": 90, "trial_id": "13390_00000", "date": "2024-10-13_00-54-05", "timestamp": 1728777245, "time_this_iter_s": 10.0232515335083, "time_total_s": 935.4328548908234, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c15330>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 935.4328548908234, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 25.173333333333336, "ram_util_percent": 66.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 166825.546875, "policy_loss": 166242.46875, "entropy": 21.789281845092773, "entropy_coeff": 0.01, "var_gnorm": 16.457792282104492, "vf_loss": 70292.515625, "vf_explained_var": -0.3331187963485718}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 340.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 187500, "num_env_steps_trained": 187000, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1250, "num_samples_added_to_queue": 187000, "learner_queue": {"size_count": 340, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 93.399, "learner_load_time_ms": 0.438, "learner_load_wait_time_ms": 2781.3, "learner_dequeue_time_ms": 22247.778}}, "env_runners": {"episode_reward_max": 39.65303542599543, "episode_reward_min": -187.86494258125433, "episode_reward_mean": -95.41200825489658, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -187.86494258125433}, "policy_reward_max": {"default_policy": 39.65303542599543}, "policy_reward_mean": {"default_policy": -95.41200825489658}, "custom_metrics": {"num_consolidated_mean": 0.8312999999999999, "num_consolidated_min": 0.6, "num_consolidated_max": 1.14, "num_overloaded_mean": 0.6833999999999999, "num_overloaded_min": 0.36, "num_overloaded_max": 1.04, "num_moves_mean": 8.5666, "num_moves_min": 7.29, "num_moves_max": 9.32, "mean_accuracy_mean": 40.914433333333335, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 4.479900000000001, "num_model_switches_min": 3.73, "num_model_switches_max": 5.19, "num_slav_mean": 0.04807350000000001, "num_slav_min": 0.027249999999999996, "num_slav_max": 0.07285, "cpu_conserved_cost_mean": 2.7308, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.44, "mean_cluster_cpu_util_mean": 0.532940985820093, "mean_cluster_cpu_util_min": 0.5019833251734735, "mean_cluster_cpu_util_max": 0.5727653291939238, "mean_cluster_mem_util_mean": 0.3455063483129539, "mean_cluster_mem_util_min": 0.32824660168919884, "mean_cluster_mem_util_max": 0.3670416828123655, "reward_consolidation_mean_mean": -1.0657434158822991, "reward_consolidation_mean_min": -1.7103975143927626, "reward_consolidation_mean_max": -0.44071461208078233, "reward_illegal_mean_mean": -1.1389999999999996, "reward_illegal_mean_min": -1.7333333333333332, "reward_illegal_mean_max": -0.5999999999999999, "reward_accuracy_mean_mean": 1.9800833333333343, "reward_accuracy_mean_min": 0.8416666666666669, "reward_accuracy_mean_max": 3.225000000000001, "reward_sla_mean_mean": -0.72946, "reward_sla_mean_min": -1.1166666666666665, "reward_sla_mean_max": -0.26866666666666666, "reward_consolidation_sum_mean": -106.57434158822993, "reward_consolidation_sum_min": -171.03975143927624, "reward_consolidation_sum_max": -44.07146120807823, "reward_illegal_sum_mean": -113.89999999999996, "reward_illegal_sum_min": -173.33333333333331, "reward_illegal_sum_max": -59.999999999999986, "reward_accuracy_sum_mean": 198.00833333333335, "reward_accuracy_sum_min": 84.16666666666669, "reward_accuracy_sum_max": 322.5000000000001, "reward_sla_sum_mean": -72.946, "reward_sla_sum_min": -111.66666666666664, "reward_sla_sum_max": -26.866666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6048.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-170.8372414633405, -176.23812787474478, -168.84077492460935, -141.46049224770766, -144.44182887081544, -173.01547412348836, -187.86494258125433, -172.00576928934785, -154.69219897042254, -178.21290017971907, -166.59119376161314, -122.25411374089978, -174.55758323433543, -149.50226019677726, -163.47706296262453, -139.55881385360505, -142.74144506381552, -126.34914252642481, -140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2855604314464888, "mean_inference_ms": 2.408844715289999, "mean_action_processing_ms": 0.10645864053968018, "mean_env_wait_ms": 2.0587776485059575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007684946060180664, "StateBufferConnector_ms": 0.003974437713623047, "ViewRequirementAgentConnector_ms": 0.10200023651123047}, "num_episodes": 21, "episode_return_max": 39.65303542599543, "episode_return_min": -187.86494258125433, "episode_return_mean": -95.41200825489658, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187000, "num_env_steps_sampled": 187500, "num_env_steps_trained": 187000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 196.33463032209303, "num_env_steps_trained_throughput_per_sec": 205.6838984326689, "timesteps_total": 187500, "num_env_steps_sampled_lifetime": 187500, "num_agent_steps_sampled_lifetime": 187500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 187500, "timers": {"training_iteration_time_ms": 10310.667, "restore_workers_time_ms": 0.018, "training_step_time_ms": 770.482, "sample_time_ms": 753.632, "synch_weights_time_ms": 15.154}, "counters": {"num_env_steps_sampled": 187500, "num_env_steps_trained": 187000, "num_agent_steps_sampled": 187500, "num_agent_steps_trained": 187000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1250, "num_samples_added_to_queue": 187000}, "done": false, "training_iteration": 91, "trial_id": "13390_00000", "date": "2024-10-13_00-54-16", "timestamp": 1728777256, "time_this_iter_s": 10.70655870437622, "time_total_s": 946.1394135951996, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c8400>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 946.1394135951996, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 18.506666666666668, "ram_util_percent": 65.81333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 215878.234375, "policy_loss": 214497.625, "entropy": 19.824613571166992, "entropy_coeff": 0.01, "var_gnorm": 16.4698429107666, "vf_loss": 148964.65625, "vf_explained_var": -0.28892767429351807}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 344.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 189450, "num_env_steps_trained": 189200, "num_agent_steps_sampled": 189450, "num_agent_steps_trained": 189200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1263, "num_samples_added_to_queue": 189200, "learner_queue": {"size_count": 344, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.821, "learner_load_time_ms": 0.438, "learner_load_wait_time_ms": 2828.808, "learner_dequeue_time_ms": 22247.778}}, "env_runners": {"episode_reward_max": 89.08434006518665, "episode_reward_min": -156.26511925431797, "episode_reward_mean": -57.348119406622125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -156.26511925431797}, "policy_reward_max": {"default_policy": 89.08434006518665}, "policy_reward_mean": {"default_policy": -57.348119406622125}, "custom_metrics": {"num_consolidated_mean": 0.8964000000000002, "num_consolidated_min": 0.65, "num_consolidated_max": 1.22, "num_overloaded_mean": 0.5813999999999999, "num_overloaded_min": 0.25, "num_overloaded_max": 0.89, "num_moves_mean": 8.262799999999999, "num_moves_min": 6.98, "num_moves_max": 9.28, "mean_accuracy_mean": 40.953509999999994, "mean_accuracy_min": 40.66299999999999, "mean_accuracy_max": 41.20133333333333, "num_model_switches_mean": 4.268800000000001, "num_model_switches_min": 3.13, "num_model_switches_max": 5.14, "num_slav_mean": 0.042792, "num_slav_min": 0.0219, "num_slav_max": 0.0654, "cpu_conserved_cost_mean": 2.7762000000000002, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.46, "mean_cluster_cpu_util_mean": 0.5234584537030521, "mean_cluster_cpu_util_min": 0.49274755062804415, "mean_cluster_cpu_util_max": 0.5612006150140704, "mean_cluster_mem_util_mean": 0.34026255368983027, "mean_cluster_mem_util_min": 0.3225131479807113, "mean_cluster_mem_util_max": 0.3584348765033439, "reward_consolidation_mean_mean": -1.217717860732889, "reward_consolidation_mean_min": -1.7217973438118739, "reward_consolidation_mean_max": -0.6259584513692162, "reward_illegal_mean_mean": -0.9689999999999999, "reward_illegal_mean_min": -1.4833333333333332, "reward_illegal_mean_max": -0.4166666666666666, "reward_accuracy_mean_mean": 2.366416666666668, "reward_accuracy_mean_min": 1.0916666666666657, "reward_accuracy_mean_max": 3.7083333333333366, "reward_sla_mean_mean": -0.7531800000000001, "reward_sla_mean_min": -1.1166666666666665, "reward_sla_mean_max": -0.26866666666666666, "reward_consolidation_sum_mean": -121.7717860732889, "reward_consolidation_sum_min": -172.1797343811874, "reward_consolidation_sum_max": -62.595845136921625, "reward_illegal_sum_mean": -96.9, "reward_illegal_sum_min": -148.33333333333331, "reward_illegal_sum_max": -41.66666666666666, "reward_accuracy_sum_mean": 236.6416666666668, "reward_accuracy_sum_min": 109.16666666666657, "reward_accuracy_sum_max": 370.83333333333366, "reward_sla_sum_mean": -75.31799999999998, "reward_sla_sum_min": -111.66666666666664, "reward_sla_sum_max": -26.866666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5245.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-140.12531907764478, -144.4844832312896, -156.26511925431797, -127.7963446952391, -120.49039568674041, -136.5625118035885, -138.05074781443253, -105.79287824789063, -147.09689299095317, -131.39383167321583, -120.45850619878777, -134.9718846142132, -106.00427670657032, -117.98317036766278, -140.44685491486206, -139.03498126656322, -132.00050565049202, -151.73234640104795, -147.3627280757867, -92.44823174632191, -126.51581833135359, -131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28561488889021297, "mean_inference_ms": 2.4100794267261936, "mean_action_processing_ms": 0.10647748242350186, "mean_env_wait_ms": 2.0592506051012247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077915191650390625, "StateBufferConnector_ms": 0.004023313522338867, "ViewRequirementAgentConnector_ms": 0.10352158546447754}, "num_episodes": 18, "episode_return_max": 89.08434006518665, "episode_return_min": -156.26511925431797, "episode_return_mean": -57.348119406622125, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189450, "num_agent_steps_trained": 189200, "num_env_steps_sampled": 189450, "num_env_steps_trained": 189200, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 191.1974119867317, "num_env_steps_trained_throughput_per_sec": 215.70990070297938, "timesteps_total": 189450, "num_env_steps_sampled_lifetime": 189450, "num_agent_steps_sampled_lifetime": 189450, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 189450, "timers": {"training_iteration_time_ms": 10292.418, "restore_workers_time_ms": 0.017, "training_step_time_ms": 783.57, "sample_time_ms": 765.486, "synch_weights_time_ms": 16.319}, "counters": {"num_env_steps_sampled": 189450, "num_env_steps_trained": 189200, "num_agent_steps_sampled": 189450, "num_agent_steps_trained": 189200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1263, "num_samples_added_to_queue": 189200}, "done": false, "training_iteration": 92, "trial_id": "13390_00000", "date": "2024-10-13_00-54-26", "timestamp": 1728777266, "time_this_iter_s": 10.218097686767578, "time_total_s": 956.3575112819672, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2ca680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 956.3575112819672, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 65.65000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 272047.6875, "policy_loss": 269682.3125, "entropy": 18.540786743164062, "entropy_coeff": 0.01, "var_gnorm": 16.476829528808594, "vf_loss": 246734.96875, "vf_explained_var": -0.5106266736984253}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 348.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 191550, "num_env_steps_trained": 191400, "num_agent_steps_sampled": 191550, "num_agent_steps_trained": 191400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1277, "num_samples_added_to_queue": 191400, "learner_queue": {"size_count": 348, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.428, "learner_load_time_ms": 0.473, "learner_load_wait_time_ms": 2707.235, "learner_dequeue_time_ms": 22378.988}}, "env_runners": {"episode_reward_max": 140.37104694020567, "episode_reward_min": -153.26618843096045, "episode_reward_mean": -9.087131499588617, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -153.26618843096045}, "policy_reward_max": {"default_policy": 140.37104694020567}, "policy_reward_mean": {"default_policy": -9.087131499588617}, "custom_metrics": {"num_consolidated_mean": 0.9825000000000002, "num_consolidated_min": 0.69, "num_consolidated_max": 1.34, "num_overloaded_mean": 0.47179999999999994, "num_overloaded_min": 0.17, "num_overloaded_max": 0.87, "num_moves_mean": 7.8435000000000015, "num_moves_min": 6.52, "num_moves_max": 9.09, "mean_accuracy_mean": 41.015006666666665, "mean_accuracy_min": 40.71366666666666, "mean_accuracy_max": 41.271, "num_model_switches_mean": 3.9639000000000006, "num_model_switches_min": 3.03, "num_model_switches_max": 4.88, "num_slav_mean": 0.036519166666666665, "num_slav_min": 0.01813333333333333, "num_slav_max": 0.06126666666666667, "cpu_conserved_cost_mean": 2.867800000000001, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.5, "mean_cluster_cpu_util_mean": 0.513306084160602, "mean_cluster_cpu_util_min": 0.48526863594058267, "mean_cluster_cpu_util_max": 0.548044399579605, "mean_cluster_mem_util_mean": 0.3344005852618474, "mean_cluster_mem_util_min": 0.31936602747639137, "mean_cluster_mem_util_max": 0.3528307277763426, "reward_consolidation_mean_mean": -1.3713546483292214, "reward_consolidation_mean_min": -1.8457424837795853, "reward_consolidation_mean_max": -0.6788447713911482, "reward_illegal_mean_mean": -0.7863333333333332, "reward_illegal_mean_min": -1.4499999999999995, "reward_illegal_mean_max": -0.2833333333333333, "reward_accuracy_mean_mean": 2.8324166666666684, "reward_accuracy_mean_min": 1.266666666666667, "reward_accuracy_mean_max": 4.191666666666672, "reward_sla_mean_mean": -0.7656000000000001, "reward_sla_mean_min": -1.1166666666666665, "reward_sla_mean_max": -0.4046666666666667, "reward_consolidation_sum_mean": -137.13546483292214, "reward_consolidation_sum_min": -184.57424837795853, "reward_consolidation_sum_max": -67.88447713911482, "reward_illegal_sum_mean": -78.63333333333333, "reward_illegal_sum_min": -144.99999999999994, "reward_illegal_sum_max": -28.333333333333332, "reward_accuracy_sum_mean": 283.24166666666684, "reward_accuracy_sum_min": 126.66666666666671, "reward_accuracy_sum_max": 419.16666666666714, "reward_sla_sum_mean": -76.56, "reward_sla_sum_min": -111.66666666666664, "reward_sla_sum_max": -40.46666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4307.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-131.88447713911484, -122.03203874623053, -115.11564470437729, -127.40131590971401, -109.39982637302396, -119.97737366352919, -99.63534984312653, -92.25399798958233, -132.1219409668281, -103.8654086326115, -94.2650918395321, -79.76396478723086, -52.59228426086681, -117.39609796216767, -83.68341100855926, -112.73480459349985, -127.93204483840512, -98.67441895884728, -153.26618843096045, -94.35740351518474, -111.11643059490088, -79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28572431039987767, "mean_inference_ms": 2.4105236732419324, "mean_action_processing_ms": 0.10650955614842082, "mean_env_wait_ms": 2.0599550660868253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077207088470458984, "StateBufferConnector_ms": 0.004090070724487305, "ViewRequirementAgentConnector_ms": 0.10620903968811035}, "num_episodes": 21, "episode_return_max": 140.37104694020567, "episode_return_min": -153.26618843096045, "episode_return_mean": -9.087131499588617, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191550, "num_agent_steps_trained": 191400, "num_env_steps_sampled": 191550, "num_env_steps_trained": 191400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 196.42420306713004, "num_env_steps_trained_throughput_per_sec": 205.7777365465172, "timesteps_total": 191550, "num_env_steps_sampled_lifetime": 191550, "num_agent_steps_sampled_lifetime": 191550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 191550, "timers": {"training_iteration_time_ms": 10322.801, "restore_workers_time_ms": 0.018, "training_step_time_ms": 767.017, "sample_time_ms": 749.122, "synch_weights_time_ms": 16.314}, "counters": {"num_env_steps_sampled": 191550, "num_env_steps_trained": 191400, "num_agent_steps_sampled": 191550, "num_agent_steps_trained": 191400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1277, "num_samples_added_to_queue": 191400}, "done": false, "training_iteration": 93, "trial_id": "13390_00000", "date": "2024-10-13_00-54-37", "timestamp": 1728777277, "time_this_iter_s": 10.702783107757568, "time_total_s": 967.0602943897247, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c143a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 967.0602943897247, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.75, "ram_util_percent": 64.24375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 265580.625, "policy_loss": 263165.1875, "entropy": 18.321796417236328, "entropy_coeff": 0.01, "var_gnorm": 16.47779083251953, "vf_loss": 251621.609375, "vf_explained_var": -0.4282461404800415}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 351.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 193500, "num_env_steps_trained": 193050, "num_agent_steps_sampled": 193500, "num_agent_steps_trained": 193050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1290, "num_samples_added_to_queue": 193050, "learner_queue": {"size_count": 351, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.763, "learner_load_time_ms": 0.473, "learner_load_wait_time_ms": 2729.858, "learner_dequeue_time_ms": 22378.988}}, "env_runners": {"episode_reward_max": 176.7932194096689, "episode_reward_min": -119.18970117883579, "episode_reward_mean": 40.77208973773214, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -119.18970117883579}, "policy_reward_max": {"default_policy": 176.7932194096689}, "policy_reward_mean": {"default_policy": 40.77208973773214}, "custom_metrics": {"num_consolidated_mean": 1.0735000000000001, "num_consolidated_min": 0.73, "num_consolidated_max": 1.36, "num_overloaded_mean": 0.37139999999999995, "num_overloaded_min": 0.15, "num_overloaded_max": 0.7, "num_moves_mean": 7.4077, "num_moves_min": 6.36, "num_moves_max": 8.67, "mean_accuracy_mean": 41.08530666666667, "mean_accuracy_min": 40.777, "mean_accuracy_max": 41.33433333333334, "num_model_switches_mean": 3.6575, "num_model_switches_min": 2.82, "num_model_switches_max": 4.52, "num_slav_mean": 0.030973, "num_slav_min": 0.016366666666666665, "num_slav_max": 0.050649999999999994, "cpu_conserved_cost_mean": 2.9618, "cpu_conserved_cost_min": 2.16, "cpu_conserved_cost_max": 3.56, "mean_cluster_cpu_util_mean": 0.5041624268045406, "mean_cluster_cpu_util_min": 0.4810171078617344, "mean_cluster_cpu_util_max": 0.541375893768094, "mean_cluster_mem_util_mean": 0.32868667767265136, "mean_cluster_mem_util_min": 0.31324879212233414, "mean_cluster_mem_util_max": 0.34650567467493326, "reward_consolidation_mean_mean": -1.5076891026226817, "reward_consolidation_mean_min": -1.91597063571842, "reward_consolidation_mean_max": -0.9737134850284811, "reward_illegal_mean_mean": -0.619, "reward_illegal_mean_min": -1.1666666666666665, "reward_illegal_mean_max": -0.24999999999999997, "reward_accuracy_mean_mean": 3.28041666666667, "reward_accuracy_mean_min": 1.766666666666666, "reward_accuracy_mean_max": 4.4416666666666735, "reward_sla_mean_mean": -0.7460066666666667, "reward_sla_mean_min": -1.1166666666666665, "reward_sla_mean_max": -0.4046666666666667, "reward_consolidation_sum_mean": -150.76891026226815, "reward_consolidation_sum_min": -191.597063571842, "reward_consolidation_sum_max": -97.37134850284811, "reward_illegal_sum_mean": -61.9, "reward_illegal_sum_min": -116.66666666666666, "reward_illegal_sum_max": -24.999999999999996, "reward_accuracy_sum_mean": 328.0416666666669, "reward_accuracy_sum_min": 176.6666666666666, "reward_accuracy_sum_max": 444.1666666666673, "reward_sla_sum_mean": -74.60066666666665, "reward_sla_sum_min": -111.66666666666664, "reward_sla_sum_max": -40.46666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3369.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-79.4586554570654, -68.46061104511239, -97.51456029729808, -102.8359651527614, -95.8196259404794, -54.704642237046336, -33.0159188522341, -119.18970117883579, -80.1534832008285, -86.11749672545602, -57.19054189893069, -77.61033232812447, -41.93022937037367, -65.32866672758824, -74.0763684547199, -43.51033842029892, -63.83801516951464, -81.26824149380124, -35.55917938408109, -54.868616162539034, -37.787450120320436, -36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28583485362410194, "mean_inference_ms": 2.411368832001307, "mean_action_processing_ms": 0.10654966905563738, "mean_env_wait_ms": 2.060854280629787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007459402084350586, "StateBufferConnector_ms": 0.0041043758392333984, "ViewRequirementAgentConnector_ms": 0.10607409477233887}, "num_episodes": 21, "episode_return_max": 176.7932194096689, "episode_return_min": -119.18970117883579, "episode_return_mean": 40.77208973773214, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193500, "num_agent_steps_trained": 193050, "num_env_steps_sampled": 193500, "num_env_steps_trained": 193050, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 192.81612717402797, "num_env_steps_trained_throughput_per_sec": 163.1521076087929, "timesteps_total": 193500, "num_env_steps_sampled_lifetime": 193500, "num_agent_steps_sampled_lifetime": 193500, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 193500, "timers": {"training_iteration_time_ms": 10300.901, "restore_workers_time_ms": 0.015, "training_step_time_ms": 764.238, "sample_time_ms": 747.07, "synch_weights_time_ms": 15.737}, "counters": {"num_env_steps_sampled": 193500, "num_env_steps_trained": 193050, "num_agent_steps_sampled": 193500, "num_agent_steps_trained": 193050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1290, "num_samples_added_to_queue": 193050}, "done": false, "training_iteration": 94, "trial_id": "13390_00000", "date": "2024-10-13_00-54-47", "timestamp": 1728777287, "time_this_iter_s": 10.124387264251709, "time_total_s": 977.1846816539764, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c15390>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 977.1846816539764, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.828571428571433, "ram_util_percent": 64.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 297475.96875, "policy_loss": 294293.0625, "entropy": 18.298091888427734, "entropy_coeff": 0.01, "var_gnorm": 16.477245330810547, "vf_loss": 328353.25, "vf_explained_var": -0.39146149158477783}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 355.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 195600, "num_env_steps_trained": 195250, "num_agent_steps_sampled": 195600, "num_agent_steps_trained": 195250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1304, "num_samples_added_to_queue": 195250, "learner_queue": {"size_count": 355, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.535, "learner_load_time_ms": 0.515, "learner_load_wait_time_ms": 2776.488, "learner_dequeue_time_ms": 22576.269}}, "env_runners": {"episode_reward_max": 176.7932194096689, "episode_reward_min": -45.17281671692695, "episode_reward_mean": 85.31447135154926, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -45.17281671692695}, "policy_reward_max": {"default_policy": 176.7932194096689}, "policy_reward_mean": {"default_policy": 85.31447135154926}, "custom_metrics": {"num_consolidated_mean": 1.1601, "num_consolidated_min": 0.86, "num_consolidated_max": 1.39, "num_overloaded_mean": 0.2938, "num_overloaded_min": 0.15, "num_overloaded_max": 0.57, "num_moves_mean": 7.0311, "num_moves_min": 6.08, "num_moves_max": 8.54, "mean_accuracy_mean": 41.138949999999994, "mean_accuracy_min": 40.86566666666667, "mean_accuracy_max": 41.38500000000001, "num_model_switches_mean": 3.4082999999999997, "num_model_switches_min": 2.62, "num_model_switches_max": 4.49, "num_slav_mean": 0.026344, "num_slav_min": 0.01315, "num_slav_max": 0.04188333333333333, "cpu_conserved_cost_mean": 3.0693999999999995, "cpu_conserved_cost_min": 2.38, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.4970815250551454, "mean_cluster_cpu_util_min": 0.47620065540552453, "mean_cluster_cpu_util_max": 0.524189730058982, "mean_cluster_mem_util_mean": 0.32405217852299145, "mean_cluster_mem_util_min": 0.3109799305376159, "mean_cluster_mem_util_max": 0.3407564998995379, "reward_consolidation_mean_mean": -1.6054719531511774, "reward_consolidation_mean_min": -1.91597063571842, "reward_consolidation_mean_max": -1.166554570653995, "reward_illegal_mean_mean": -0.48966666666666653, "reward_illegal_mean_min": -0.95, "reward_illegal_mean_max": -0.24999999999999997, "reward_accuracy_mean_mean": 3.656416666666671, "reward_accuracy_mean_min": 2.2666666666666675, "reward_accuracy_mean_max": 4.475000000000007, "reward_sla_mean_mean": -0.7081333333333333, "reward_sla_mean_min": -1.1166666666666665, "reward_sla_mean_max": -0.39866666666666667, "reward_consolidation_sum_mean": -160.54719531511776, "reward_consolidation_sum_min": -191.597063571842, "reward_consolidation_sum_max": -116.6554570653995, "reward_illegal_sum_mean": -48.96666666666666, "reward_illegal_sum_min": -95.0, "reward_illegal_sum_max": -24.999999999999996, "reward_accuracy_sum_mean": 365.641666666667, "reward_accuracy_sum_min": 226.66666666666677, "reward_accuracy_sum_max": 447.5000000000007, "reward_sla_sum_mean": -70.81333333333333, "reward_sla_sum_min": -111.66666666666664, "reward_sla_sum_max": -39.86666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2430.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-36.76627067531747, 0.9935818940571606, 7.853373541685775, 13.201367693198351, -1.684958420907991, -32.37546072070416, -11.673444210910917, 0.7265314203905993, -14.68223826494858, 2.4863778975906263, -10.075034268481922, 39.65303542599543, -44.18879039873271, -19.759200706692127, -8.089762100581734, -21.824100642724073, -18.022358280788197, -45.17281671692695, -2.433308964634636, 52.378787048037026, 61.54248987175994, 64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28590578078732815, "mean_inference_ms": 2.4105259935764924, "mean_action_processing_ms": 0.106563199238976, "mean_env_wait_ms": 2.0612105689811115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007311105728149414, "StateBufferConnector_ms": 0.004012107849121094, "ViewRequirementAgentConnector_ms": 0.10396862030029297}, "num_episodes": 21, "episode_return_max": 176.7932194096689, "episode_return_min": -45.17281671692695, "episode_return_mean": 85.31447135154926, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195600, "num_agent_steps_trained": 195250, "num_env_steps_sampled": 195600, "num_env_steps_trained": 195250, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 197.37450477041207, "num_env_steps_trained_throughput_per_sec": 206.77329071186028, "timesteps_total": 195600, "num_env_steps_sampled_lifetime": 195600, "num_agent_steps_sampled_lifetime": 195600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 195600, "timers": {"training_iteration_time_ms": 10339.775, "restore_workers_time_ms": 0.015, "training_step_time_ms": 757.023, "sample_time_ms": 738.997, "synch_weights_time_ms": 16.409}, "counters": {"num_env_steps_sampled": 195600, "num_env_steps_trained": 195250, "num_agent_steps_sampled": 195600, "num_agent_steps_trained": 195250, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1304, "num_samples_added_to_queue": 195250}, "done": false, "training_iteration": 95, "trial_id": "13390_00000", "date": "2024-10-13_00-54-58", "timestamp": 1728777298, "time_this_iter_s": 10.656529188156128, "time_total_s": 987.8412108421326, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c166b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 987.8412108421326, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 18.11875, "ram_util_percent": 64.2625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 293392.3125, "policy_loss": 290316.5625, "entropy": 17.718294143676758, "entropy_coeff": 0.01, "var_gnorm": 16.47736167907715, "vf_loss": 317320.21875, "vf_explained_var": -0.4214361906051636}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 359.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 197700, "num_env_steps_trained": 197450, "num_agent_steps_sampled": 197700, "num_agent_steps_trained": 197450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1318, "num_samples_added_to_queue": 197450, "learner_queue": {"size_count": 359, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.226, "learner_load_time_ms": 0.515, "learner_load_wait_time_ms": 2735.001, "learner_dequeue_time_ms": 22576.269}}, "env_runners": {"episode_reward_max": 225.27690456608562, "episode_reward_min": 16.19085259983559, "episode_reward_mean": 120.15194367784619, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 16.19085259983559}, "policy_reward_max": {"default_policy": 225.27690456608562}, "policy_reward_mean": {"default_policy": 120.15194367784619}, "custom_metrics": {"num_consolidated_mean": 1.229, "num_consolidated_min": 1.0, "num_consolidated_max": 1.44, "num_overloaded_mean": 0.2407, "num_overloaded_min": 0.11, "num_overloaded_max": 0.45, "num_moves_mean": 6.740500000000001, "num_moves_min": 6.08, "num_moves_max": 7.7, "mean_accuracy_mean": 41.198483333333336, "mean_accuracy_min": 40.922666666666665, "mean_accuracy_max": 41.40400000000002, "num_model_switches_mean": 3.2074000000000007, "num_model_switches_min": 2.44, "num_model_switches_max": 3.83, "num_slav_mean": 0.02339516666666667, "num_slav_min": 0.01315, "num_slav_max": 0.03928333333333334, "cpu_conserved_cost_mean": 3.1590000000000003, "cpu_conserved_cost_min": 2.64, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.4921606450809055, "mean_cluster_cpu_util_min": 0.47620065540552453, "mean_cluster_cpu_util_max": 0.5133276564853291, "mean_cluster_mem_util_mean": 0.32071938427301305, "mean_cluster_mem_util_min": 0.3109799305376159, "mean_cluster_mem_util_max": 0.3325070899351302, "reward_consolidation_mean_mean": -1.6693405632215421, "reward_consolidation_mean_min": -1.9170258003594387, "reward_consolidation_mean_max": -1.2786711444149992, "reward_illegal_mean_mean": -0.4011666666666665, "reward_illegal_mean_min": -0.7499999999999999, "reward_illegal_mean_max": -0.1833333333333333, "reward_accuracy_mean_mean": 3.948333333333339, "reward_accuracy_mean_min": 2.958333333333335, "reward_accuracy_mean_max": 4.766666666666674, "reward_sla_mean_mean": -0.6763066666666667, "reward_sla_mean_min": -0.9913333333333335, "reward_sla_mean_max": -0.36933333333333335, "reward_consolidation_sum_mean": -166.93405632215422, "reward_consolidation_sum_min": -191.70258003594387, "reward_consolidation_sum_max": -127.86711444149992, "reward_illegal_sum_mean": -40.11666666666667, "reward_illegal_sum_min": -74.99999999999999, "reward_illegal_sum_max": -18.33333333333333, "reward_accuracy_sum_mean": 394.83333333333377, "reward_accuracy_sum_min": 295.8333333333335, "reward_accuracy_sum_max": 476.66666666666737, "reward_sla_sum_mean": -67.63066666666667, "reward_sla_sum_min": -99.13333333333335, "reward_sla_sum_max": -36.93333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1882.0, "global_timestep_min": 200, "global_timestep_max": 3500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [64.05359895214619, 22.79956136342905, 58.3301654025408, 55.5128758110212, 16.19085259983559, 52.42174297115371, 52.81087148557712, 66.3484571567824, 89.08434006518665, 43.62522160285144, 56.78883913612987, 37.863538335009, 70.1908069085263, 57.51079228730714, 43.43288555850027, 52.86169240610465, 113.08760242468591, 67.98094063175898, 76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2859668149795393, "mean_inference_ms": 2.4107306087876874, "mean_action_processing_ms": 0.10657572638517804, "mean_env_wait_ms": 2.061617832121044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007154226303100586, "StateBufferConnector_ms": 0.0039637088775634766, "ViewRequirementAgentConnector_ms": 0.1021111011505127}, "num_episodes": 21, "episode_return_max": 225.27690456608562, "episode_return_min": 16.19085259983559, "episode_return_mean": 120.15194367784619, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197700, "num_agent_steps_trained": 197450, "num_env_steps_sampled": 197700, "num_env_steps_trained": 197450, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 198.60010534688544, "num_env_steps_trained_throughput_per_sec": 208.05725322054664, "timesteps_total": 197700, "num_env_steps_sampled_lifetime": 197700, "num_agent_steps_sampled_lifetime": 197700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 197700, "timers": {"training_iteration_time_ms": 10359.852, "restore_workers_time_ms": 0.019, "training_step_time_ms": 756.216, "sample_time_ms": 738.729, "synch_weights_time_ms": 15.811}, "counters": {"num_env_steps_sampled": 197700, "num_env_steps_trained": 197450, "num_agent_steps_sampled": 197700, "num_agent_steps_trained": 197450, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1318, "num_samples_added_to_queue": 197450}, "done": false, "training_iteration": 96, "trial_id": "13390_00000", "date": "2024-10-13_00-55-08", "timestamp": 1728777308, "time_this_iter_s": 10.59194540977478, "time_total_s": 998.4331562519073, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c310>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 998.4331562519073, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.253333333333334, "ram_util_percent": 64.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 312735.28125, "policy_loss": 309041.15625, "entropy": 17.449005126953125, "entropy_coeff": 0.01, "var_gnorm": 16.474384307861328, "vf_loss": 379008.96875, "vf_explained_var": -0.34971141815185547}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 362.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 199500, "num_env_steps_trained": 199100, "num_agent_steps_sampled": 199500, "num_agent_steps_trained": 199100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1330, "num_samples_added_to_queue": 199100, "learner_queue": {"size_count": 362, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.735, "learner_load_time_ms": 0.507, "learner_load_wait_time_ms": 2757.871, "learner_dequeue_time_ms": 22626.725}}, "env_runners": {"episode_reward_max": 225.27690456608562, "episode_reward_min": 65.49502269335069, "episode_reward_mean": 142.28191873039125, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 65.49502269335069}, "policy_reward_max": {"default_policy": 225.27690456608562}, "policy_reward_mean": {"default_policy": 142.28191873039125}, "custom_metrics": {"num_consolidated_mean": 1.2717999999999998, "num_consolidated_min": 1.08, "num_consolidated_max": 1.44, "num_overloaded_mean": 0.2134, "num_overloaded_min": 0.11, "num_overloaded_max": 0.35, "num_moves_mean": 6.550699999999999, "num_moves_min": 5.94, "num_moves_max": 7.22, "mean_accuracy_mean": 41.24313333333333, "mean_accuracy_min": 40.97333333333333, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 3.0699, "num_model_switches_min": 2.44, "num_model_switches_max": 3.71, "num_slav_mean": 0.021741666666666663, "num_slav_min": 0.012083333333333335, "num_slav_max": 0.031966666666666664, "cpu_conserved_cost_mean": 3.201, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.4891170700040046, "mean_cluster_cpu_util_min": 0.47620065540552453, "mean_cluster_cpu_util_max": 0.5030459836224084, "mean_cluster_mem_util_mean": 0.31851631634985217, "mean_cluster_mem_util_min": 0.3095237727474956, "mean_cluster_mem_util_max": 0.32884883697149747, "reward_consolidation_mean_mean": -1.6936308126960922, "reward_consolidation_mean_min": -1.9170258003594387, "reward_consolidation_mean_max": -1.4237928356026688, "reward_illegal_mean_mean": -0.3556666666666667, "reward_illegal_mean_min": -0.5833333333333333, "reward_illegal_mean_max": -0.1833333333333333, "reward_accuracy_mean_mean": 4.1270833333333385, "reward_accuracy_mean_min": 3.3416666666666703, "reward_accuracy_mean_max": 4.825000000000008, "reward_sla_mean_mean": -0.6549666666666667, "reward_sla_mean_min": -0.9546666666666667, "reward_sla_mean_max": -0.3373333333333333, "reward_consolidation_sum_mean": -169.3630812696092, "reward_consolidation_sum_min": -191.70258003594387, "reward_consolidation_sum_max": -142.37928356026688, "reward_illegal_sum_mean": -35.56666666666666, "reward_illegal_sum_min": -58.33333333333332, "reward_illegal_sum_max": -18.33333333333333, "reward_accuracy_sum_mean": 412.70833333333377, "reward_accuracy_sum_min": 334.166666666667, "reward_accuracy_sum_max": 482.50000000000085, "reward_sla_sum_mean": -65.49666666666666, "reward_sla_sum_min": -95.46666666666667, "reward_sla_sum_max": -33.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2482.0, "global_timestep_min": 800, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [76.67476621279977, 105.31345761369552, 68.83647384934083, 116.06808918943659, 128.11938529958294, 110.65967589631158, 65.49502269335069, 85.82996740686639, 127.3257516220418, 112.31672606536941, 104.74819214718732, 107.73394255079388, 76.12359194614555, 80.18494014438484, 88.99970148344468, 91.34191720734736, 140.37104694020567, 91.31656462274245, 110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860636370380752, "mean_inference_ms": 2.411278125221911, "mean_action_processing_ms": 0.10659955158445147, "mean_env_wait_ms": 2.0622905869739285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007422208786010742, "StateBufferConnector_ms": 0.0041043758392333984, "ViewRequirementAgentConnector_ms": 0.10548758506774902}, "num_episodes": 18, "episode_return_max": 225.27690456608562, "episode_return_min": 65.49502269335069, "episode_return_mean": 142.28191873039125, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199500, "num_agent_steps_trained": 199100, "num_env_steps_sampled": 199500, "num_env_steps_trained": 199100, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 175.81458731942217, "num_env_steps_trained_throughput_per_sec": 161.16337170947034, "timesteps_total": 199500, "num_env_steps_sampled_lifetime": 199500, "num_agent_steps_sampled_lifetime": 199500, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 199500, "timers": {"training_iteration_time_ms": 10351.295, "restore_workers_time_ms": 0.015, "training_step_time_ms": 876.456, "sample_time_ms": 857.383, "synch_weights_time_ms": 16.84}, "counters": {"num_env_steps_sampled": 199500, "num_env_steps_trained": 199100, "num_agent_steps_sampled": 199500, "num_agent_steps_trained": 199100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1330, "num_samples_added_to_queue": 199100}, "done": false, "training_iteration": 97, "trial_id": "13390_00000", "date": "2024-10-13_00-55-18", "timestamp": 1728777318, "time_this_iter_s": 10.268274545669556, "time_total_s": 1008.7014307975769, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c9cc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1008.7014307975769, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 22.207142857142856, "ram_util_percent": 65.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 319812.125, "policy_loss": 315752.4375, "entropy": 17.189550399780273, "entropy_coeff": 0.01, "var_gnorm": 16.471317291259766, "vf_loss": 415421.4375, "vf_explained_var": -0.38062751293182373}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 201300, "num_env_steps_trained": 200750, "num_agent_steps_sampled": 201300, "num_agent_steps_trained": 200750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1342, "num_samples_added_to_queue": 201300, "learner_queue": {"size_count": 365, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.446, "learner_load_time_ms": 0.507, "learner_load_wait_time_ms": 2914.196, "learner_dequeue_time_ms": 22626.725}}, "env_runners": {"episode_reward_max": 241.2508331048774, "episode_reward_min": 81.09512930640624, "episode_reward_mean": 161.31331697584508, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 81.09512930640624}, "policy_reward_max": {"default_policy": 241.2508331048774}, "policy_reward_mean": {"default_policy": 161.31331697584508}, "custom_metrics": {"num_consolidated_mean": 1.3011000000000001, "num_consolidated_min": 1.14, "num_consolidated_max": 1.45, "num_overloaded_mean": 0.19069999999999993, "num_overloaded_min": 0.06, "num_overloaded_max": 0.31, "num_moves_mean": 6.4045999999999985, "num_moves_min": 5.73, "num_moves_max": 7.03, "mean_accuracy_mean": 41.28715000000001, "mean_accuracy_min": 41.09366666666666, "mean_accuracy_max": 41.49266666666667, "num_model_switches_mean": 2.9549999999999996, "num_model_switches_min": 2.32, "num_model_switches_max": 3.38, "num_slav_mean": 0.020460333333333334, "num_slav_min": 0.011899999999999999, "num_slav_max": 0.031966666666666664, "cpu_conserved_cost_mean": 3.1979999999999995, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.4860056965593197, "mean_cluster_cpu_util_min": 0.4686262212341875, "mean_cluster_cpu_util_max": 0.4990203899829432, "mean_cluster_mem_util_mean": 0.3164108220797813, "mean_cluster_mem_util_min": 0.30769546844054074, "mean_cluster_mem_util_max": 0.3248372041749189, "reward_consolidation_mean_mean": -1.7205368302415551, "reward_consolidation_mean_min": -1.9170258003594387, "reward_consolidation_mean_max": -1.4237928356026688, "reward_illegal_mean_mean": -0.3178333333333333, "reward_illegal_mean_min": -0.5166666666666666, "reward_illegal_mean_max": -0.1, "reward_accuracy_mean_mean": 4.281250000000006, "reward_accuracy_mean_min": 3.66666666666667, "reward_accuracy_mean_max": 4.991666666666674, "reward_sla_mean_mean": -0.6297466666666666, "reward_sla_mean_min": -0.9546666666666667, "reward_sla_mean_max": -0.2773333333333333, "reward_consolidation_sum_mean": -172.0536830241555, "reward_consolidation_sum_min": -191.70258003594387, "reward_consolidation_sum_max": -142.37928356026688, "reward_illegal_sum_mean": -31.78333333333333, "reward_illegal_sum_min": -51.66666666666666, "reward_illegal_sum_max": -10.0, "reward_accuracy_sum_mean": 428.12500000000057, "reward_accuracy_sum_min": 366.666666666667, "reward_accuracy_sum_max": 499.1666666666674, "reward_sla_sum_mean": -62.97466666666667, "reward_sla_sum_min": -95.46666666666667, "reward_sla_sum_max": -27.73333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3083.0, "global_timestep_min": 1400, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [110.55320600688444, 105.78305766243288, 138.7316275244452, 161.47904596545783, 131.34975478997274, 129.79969843735762, 156.6303664443029, 158.75207895458325, 136.2489932681475, 103.92001888574177, 112.11896493953559, 101.92566633159738, 98.15404977306696, 149.70797770264141, 117.80293642815843, 121.09552225166811, 116.00367358128524, 143.2237320661614, 81.09512930640624, 130.5464406469894, 135.29065460416143, 176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2861845659834539, "mean_inference_ms": 2.4136661630852285, "mean_action_processing_ms": 0.10664473217584348, "mean_env_wait_ms": 2.0635436843691126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007421016693115234, "StateBufferConnector_ms": 0.004086971282958984, "ViewRequirementAgentConnector_ms": 0.10491943359375}, "num_episodes": 18, "episode_return_max": 241.2508331048774, "episode_return_min": 81.09512930640624, "episode_return_mean": 161.31331697584508, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201300, "num_agent_steps_trained": 200750, "num_env_steps_sampled": 201300, "num_env_steps_trained": 200750, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 171.37413586238273, "num_env_steps_trained_throughput_per_sec": 157.09295787385085, "timesteps_total": 201300, "num_env_steps_sampled_lifetime": 201300, "num_agent_steps_sampled_lifetime": 201300, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 201300, "timers": {"training_iteration_time_ms": 10396.921, "restore_workers_time_ms": 0.015, "training_step_time_ms": 834.583, "sample_time_ms": 818.149, "synch_weights_time_ms": 14.99}, "counters": {"num_env_steps_sampled": 201300, "num_env_steps_trained": 200750, "num_agent_steps_sampled": 201300, "num_agent_steps_trained": 200750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1342, "num_samples_added_to_queue": 201300}, "done": false, "training_iteration": 98, "trial_id": "13390_00000", "date": "2024-10-13_00-55-29", "timestamp": 1728777329, "time_this_iter_s": 10.526105403900146, "time_total_s": 1019.227536201477, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c17eb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1019.227536201477, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 33.29333333333334, "ram_util_percent": 67.44666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 313510.59375, "policy_loss": 309195.125, "entropy": 16.732175827026367, "entropy_coeff": 0.01, "var_gnorm": 16.469369888305664, "vf_loss": 440750.8125, "vf_explained_var": -0.26346826553344727}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 369.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 203400, "num_env_steps_trained": 202950, "num_agent_steps_sampled": 203400, "num_agent_steps_trained": 202950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1356, "num_samples_added_to_queue": 202950, "learner_queue": {"size_count": 369, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.705, "learner_load_time_ms": 0.474, "learner_load_wait_time_ms": 2878.478, "learner_dequeue_time_ms": 22604.183}}, "env_runners": {"episode_reward_max": 246.78602150537722, "episode_reward_min": 112.12006153096402, "episode_reward_mean": 178.88523467056632, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 112.12006153096402}, "policy_reward_max": {"default_policy": 246.78602150537722}, "policy_reward_mean": {"default_policy": 178.88523467056632}, "custom_metrics": {"num_consolidated_mean": 1.3249000000000002, "num_consolidated_min": 1.14, "num_consolidated_max": 1.49, "num_overloaded_mean": 0.17180000000000004, "num_overloaded_min": 0.06, "num_overloaded_max": 0.31, "num_moves_mean": 6.258000000000001, "num_moves_min": 5.58, "num_moves_max": 6.85, "mean_accuracy_mean": 41.33598, "mean_accuracy_min": 41.09366666666666, "mean_accuracy_max": 41.58133333333334, "num_model_switches_mean": 2.8649, "num_model_switches_min": 2.32, "num_model_switches_max": 3.34, "num_slav_mean": 0.019667833333333332, "num_slav_min": 0.011666666666666665, "num_slav_max": 0.02868333333333333, "cpu_conserved_cost_mean": 3.207, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.74, "mean_cluster_cpu_util_mean": 0.4841349990476393, "mean_cluster_cpu_util_min": 0.4686262212341875, "mean_cluster_cpu_util_max": 0.4976485946018584, "mean_cluster_mem_util_mean": 0.3149777662156635, "mean_cluster_mem_util_min": 0.3057510704598295, "mean_cluster_mem_util_max": 0.3248372041749189, "reward_consolidation_mean_mean": -1.7378409866276772, "reward_consolidation_mean_min": -1.9654456425721163, "reward_consolidation_mean_max": -1.4875893265100981, "reward_illegal_mean_mean": -0.28633333333333333, "reward_illegal_mean_min": -0.5166666666666666, "reward_illegal_mean_max": -0.1, "reward_accuracy_mean_mean": 4.435666666666674, "reward_accuracy_mean_min": 3.6666666666666714, "reward_accuracy_mean_max": 5.0916666666666766, "reward_sla_mean_mean": -0.6226400000000001, "reward_sla_mean_min": -0.9546666666666667, "reward_sla_mean_max": -0.2773333333333333, "reward_consolidation_sum_mean": -173.78409866276772, "reward_consolidation_sum_min": -196.54456425721162, "reward_consolidation_sum_max": -148.75893265100981, "reward_illegal_sum_mean": -28.633333333333326, "reward_illegal_sum_min": -51.66666666666666, "reward_illegal_sum_max": -10.0, "reward_accuracy_sum_mean": 443.56666666666734, "reward_accuracy_sum_min": 366.66666666666714, "reward_accuracy_sum_max": 509.16666666666765, "reward_sla_sum_mean": -62.263999999999996, "reward_sla_sum_min": -95.46666666666667, "reward_sla_sum_max": -27.73333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3783.0, "global_timestep_min": 2100, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [176.7932194096689, 112.12006153096402, 136.39459014895402, 144.179371896799, 161.66899083127782, 133.02519114197867, 166.7296688903109, 146.94878918029832, 121.29125468335957, 136.7784276097359, 142.60790764263356, 124.76223765573154, 133.21919339608323, 123.66312102104884, 140.69763014408045, 130.56419019769154, 164.88316427548847, 151.6126473544737, 136.72587346553394, 167.32530993938332, 158.32638520820055, 170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2862784227781241, "mean_inference_ms": 2.414549515692226, "mean_action_processing_ms": 0.10667469334712551, "mean_env_wait_ms": 2.064531546968589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072939395904541016, "StateBufferConnector_ms": 0.003994941711425781, "ViewRequirementAgentConnector_ms": 0.1033785343170166}, "num_episodes": 21, "episode_return_max": 246.78602150537722, "episode_return_min": 112.12006153096402, "episode_return_mean": 178.88523467056632, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203400, "num_agent_steps_trained": 202950, "num_env_steps_sampled": 203400, "num_env_steps_trained": 202950, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.97695627380065, "num_env_steps_trained_throughput_per_sec": 219.97585895350545, "timesteps_total": 203400, "num_env_steps_sampled_lifetime": 203400, "num_agent_steps_sampled_lifetime": 203400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 203400, "timers": {"training_iteration_time_ms": 10366.584, "restore_workers_time_ms": 0.014, "training_step_time_ms": 707.408, "sample_time_ms": 691.744, "synch_weights_time_ms": 14.233}, "counters": {"num_env_steps_sampled": 203400, "num_env_steps_trained": 202950, "num_agent_steps_sampled": 203400, "num_agent_steps_trained": 202950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1356, "num_samples_added_to_queue": 202950}, "done": false, "training_iteration": 99, "trial_id": "13390_00000", "date": "2024-10-13_00-55-39", "timestamp": 1728777339, "time_this_iter_s": 10.011107206344604, "time_total_s": 1029.2386434078217, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069f0d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1029.2386434078217, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.226666666666667, "ram_util_percent": 65.98666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 337443.75, "policy_loss": 332211.78125, "entropy": 16.515134811401367, "entropy_coeff": 0.01, "var_gnorm": 16.464439392089844, "vf_loss": 532280.5, "vf_explained_var": -0.24399316310882568}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 373.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 205500, "num_env_steps_trained": 205150, "num_agent_steps_sampled": 205500, "num_agent_steps_trained": 205150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1370, "num_samples_added_to_queue": 205150, "learner_queue": {"size_count": 373, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.034, "learner_load_time_ms": 0.474, "learner_load_wait_time_ms": 2730.504, "learner_dequeue_time_ms": 22604.183}}, "env_runners": {"episode_reward_max": 270.0532029607978, "episode_reward_min": 128.27413262664166, "episode_reward_mean": 197.72763724146404, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 128.27413262664166}, "policy_reward_max": {"default_policy": 270.0532029607978}, "policy_reward_mean": {"default_policy": 197.72763724146404}, "custom_metrics": {"num_consolidated_mean": 1.347, "num_consolidated_min": 1.22, "num_consolidated_max": 1.49, "num_overloaded_mean": 0.15130000000000002, "num_overloaded_min": 0.06, "num_overloaded_max": 0.26, "num_moves_mean": 6.105500000000001, "num_moves_min": 5.45, "num_moves_max": 6.84, "mean_accuracy_mean": 41.392853333333335, "mean_accuracy_min": 41.144333333333336, "mean_accuracy_max": 41.695333333333345, "num_model_switches_mean": 2.7579000000000002, "num_model_switches_min": 2.19, "num_model_switches_max": 3.34, "num_slav_mean": 0.018917499999999997, "num_slav_min": 0.008716666666666668, "num_slav_max": 0.02955, "cpu_conserved_cost_mean": 3.2072000000000003, "cpu_conserved_cost_min": 2.72, "cpu_conserved_cost_max": 3.6, "mean_cluster_cpu_util_mean": 0.48209110003469946, "mean_cluster_cpu_util_min": 0.4686262212341875, "mean_cluster_cpu_util_max": 0.49634247148603877, "mean_cluster_mem_util_mean": 0.31329196596845493, "mean_cluster_mem_util_min": 0.3057510704598295, "mean_cluster_mem_util_max": 0.3215277720370849, "reward_consolidation_mean_mean": -1.7589102942520334, "reward_consolidation_mean_min": -1.992058545797923, "reward_consolidation_mean_max": -1.4875893265100981, "reward_illegal_mean_mean": -0.25216666666666665, "reward_illegal_mean_min": -0.4333333333333333, "reward_illegal_mean_max": -0.09999999999999998, "reward_accuracy_mean_mean": 4.601666666666675, "reward_accuracy_mean_min": 3.9416666666666726, "reward_accuracy_mean_max": 5.325000000000013, "reward_sla_mean_mean": -0.6133133333333333, "reward_sla_mean_min": -1.0833333333333335, "reward_sla_mean_max": -0.24599999999999997, "reward_consolidation_sum_mean": -175.89102942520339, "reward_consolidation_sum_min": -199.2058545797923, "reward_consolidation_sum_max": -148.75893265100981, "reward_illegal_sum_mean": -25.21666666666666, "reward_illegal_sum_min": -43.33333333333333, "reward_illegal_sum_max": -9.999999999999998, "reward_accuracy_sum_mean": 460.16666666666737, "reward_accuracy_sum_min": 394.16666666666725, "reward_accuracy_sum_max": 532.5000000000013, "reward_sla_sum_mean": -61.33133333333333, "reward_sla_sum_min": -108.33333333333334, "reward_sla_sum_max": -24.599999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4483.0, "global_timestep_min": 2800, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [170.47551555027607, 133.18052027171143, 167.70208961588887, 170.93587681623023, 165.6165097931711, 145.01406378506866, 197.92528252459772, 165.14106734899082, 160.35617898809033, 174.7640866307234, 225.27690456608562, 187.60585153370562, 147.5519479728293, 128.27413262664166, 153.35005026044095, 165.98883304395548, 142.583471930306, 160.03776539035658, 143.69778854062005, 173.3778458070614, 138.33364708032582, 149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2863409646286776, "mean_inference_ms": 2.415206199805402, "mean_action_processing_ms": 0.10669659378486188, "mean_env_wait_ms": 2.0653952444468806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072002410888671875, "StateBufferConnector_ms": 0.003953456878662109, "ViewRequirementAgentConnector_ms": 0.10064387321472168}, "num_episodes": 21, "episode_return_max": 270.0532029607978, "episode_return_min": 128.27413262664166, "episode_return_mean": 197.72763724146404, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205500, "num_agent_steps_trained": 205150, "num_env_steps_sampled": 205500, "num_env_steps_trained": 205150, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 204.01907014081587, "num_env_steps_trained_throughput_per_sec": 213.7342639570452, "timesteps_total": 205500, "num_env_steps_sampled_lifetime": 205500, "num_agent_steps_sampled_lifetime": 205500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 205500, "timers": {"training_iteration_time_ms": 10394.875, "restore_workers_time_ms": 0.014, "training_step_time_ms": 726.218, "sample_time_ms": 709.896, "synch_weights_time_ms": 14.563}, "counters": {"num_env_steps_sampled": 205500, "num_env_steps_trained": 205150, "num_agent_steps_sampled": 205500, "num_agent_steps_trained": 205150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1370, "num_samples_added_to_queue": 205150}, "done": false, "training_iteration": 100, "trial_id": "13390_00000", "date": "2024-10-13_00-55-49", "timestamp": 1728777349, "time_this_iter_s": 10.307409286499023, "time_total_s": 1039.5460526943207, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16530>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1039.5460526943207, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.34, "ram_util_percent": 65.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 343993.0625, "policy_loss": 338518.71875, "entropy": 16.233230590820312, "entropy_coeff": 0.01, "var_gnorm": 16.461524963378906, "vf_loss": 556361.375, "vf_explained_var": -0.31028759479522705}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 377.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 207600, "num_env_steps_trained": 207350, "num_agent_steps_sampled": 207600, "num_agent_steps_trained": 207350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1384, "num_samples_added_to_queue": 207350, "learner_queue": {"size_count": 377, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.756, "learner_load_time_ms": 0.478, "learner_load_wait_time_ms": 2607.126, "learner_dequeue_time_ms": 22511.124}}, "env_runners": {"episode_reward_max": 285.04869170550506, "episode_reward_min": 145.53747601206308, "episode_reward_mean": 212.25374540802414, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 145.53747601206308}, "policy_reward_max": {"default_policy": 285.04869170550506}, "policy_reward_mean": {"default_policy": 212.25374540802414}, "custom_metrics": {"num_consolidated_mean": 1.365, "num_consolidated_min": 1.22, "num_consolidated_max": 1.65, "num_overloaded_mean": 0.13870000000000002, "num_overloaded_min": 0.05, "num_overloaded_max": 0.24, "num_moves_mean": 5.977700000000001, "num_moves_min": 5.32, "num_moves_max": 6.84, "mean_accuracy_mean": 41.44440666666667, "mean_accuracy_min": 41.176, "mean_accuracy_max": 41.695333333333345, "num_model_switches_mean": 2.668599999999999, "num_model_switches_min": 2.05, "num_model_switches_max": 3.14, "num_slav_mean": 0.01823983333333333, "num_slav_min": 0.008716666666666668, "num_slav_max": 0.02955, "cpu_conserved_cost_mean": 3.196, "cpu_conserved_cost_min": 2.72, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.4803384130684096, "mean_cluster_cpu_util_min": 0.4686262212341875, "mean_cluster_cpu_util_max": 0.4932584643941949, "mean_cluster_mem_util_mean": 0.31173286714780846, "mean_cluster_mem_util_min": 0.3052932232914263, "mean_cluster_mem_util_max": 0.31850602162806047, "reward_consolidation_mean_mean": -1.7696325459197664, "reward_consolidation_mean_min": -1.992058545797923, "reward_consolidation_mean_max": -1.5549233909043831, "reward_illegal_mean_mean": -0.23116666666666663, "reward_illegal_mean_min": -0.4, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 4.724750000000008, "reward_accuracy_mean_min": 4.05833333333334, "reward_accuracy_mean_max": 5.325000000000013, "reward_sla_mean_mean": -0.6014133333333332, "reward_sla_mean_min": -1.0833333333333335, "reward_sla_mean_max": -0.24599999999999997, "reward_consolidation_sum_mean": -176.96325459197658, "reward_consolidation_sum_min": -199.2058545797923, "reward_consolidation_sum_max": -155.49233909043832, "reward_illegal_sum_mean": -23.116666666666664, "reward_illegal_sum_min": -40.0, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 472.4750000000008, "reward_accuracy_sum_min": 405.83333333333394, "reward_accuracy_sum_max": 532.5000000000013, "reward_sla_sum_mean": -60.141333333333336, "reward_sla_sum_min": -108.33333333333334, "reward_sla_sum_max": -24.599999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5183.0, "global_timestep_min": 3500, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [149.12111852325734, 179.92861189801766, 177.66232599226348, 215.78534832008356, 188.7926376069946, 185.31313472844195, 189.87926528374356, 195.98036187517204, 213.17380060312607, 180.9157756861316, 157.34099424289548, 159.910198300284, 169.84542629991836, 148.23233726278661, 163.13022023211255, 145.53747601206308, 208.06605440311998, 164.88358768162354, 189.51473392427488, 190.56584726918337, 187.9971458161997, 212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28636631124730855, "mean_inference_ms": 2.4156259907440325, "mean_action_processing_ms": 0.1067087417790378, "mean_env_wait_ms": 2.066090478476105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007152080535888672, "StateBufferConnector_ms": 0.003921031951904297, "ViewRequirementAgentConnector_ms": 0.10056543350219727}, "num_episodes": 21, "episode_return_max": 285.04869170550506, "episode_return_min": 145.53747601206308, "episode_return_mean": 212.25374540802414, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207600, "num_agent_steps_trained": 207350, "num_env_steps_sampled": 207600, "num_env_steps_trained": 207350, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.24760967872413, "num_env_steps_trained_throughput_per_sec": 218.16416252056814, "timesteps_total": 207600, "num_env_steps_sampled_lifetime": 207600, "num_agent_steps_sampled_lifetime": 207600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 207600, "timers": {"training_iteration_time_ms": 10333.687, "restore_workers_time_ms": 0.016, "training_step_time_ms": 726.682, "sample_time_ms": 710.7, "synch_weights_time_ms": 14.462}, "counters": {"num_env_steps_sampled": 207600, "num_env_steps_trained": 207350, "num_agent_steps_sampled": 207600, "num_agent_steps_trained": 207350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1384, "num_samples_added_to_queue": 207350}, "done": false, "training_iteration": 101, "trial_id": "13390_00000", "date": "2024-10-13_00-56-00", "timestamp": 1728777360, "time_this_iter_s": 10.097149133682251, "time_total_s": 1049.643201828003, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069cf40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1049.643201828003, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 17.007142857142856, "ram_util_percent": 64.71428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 342699.3125, "policy_loss": 337254.8125, "entropy": 16.217403411865234, "entropy_coeff": 0.01, "var_gnorm": 16.456405639648438, "vf_loss": 553367.25, "vf_explained_var": -0.3122274875640869}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 381.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 209700, "num_env_steps_trained": 209550, "num_agent_steps_sampled": 209700, "num_agent_steps_trained": 209550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1398, "num_samples_added_to_queue": 209550, "learner_queue": {"size_count": 381, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.121, "learner_load_time_ms": 0.478, "learner_load_wait_time_ms": 2549.818, "learner_dequeue_time_ms": 22511.124}}, "env_runners": {"episode_reward_max": 297.55605714459904, "episode_reward_min": 160.94415303542678, "episode_reward_mean": 228.09417310914213, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 160.94415303542678}, "policy_reward_max": {"default_policy": 297.55605714459904}, "policy_reward_mean": {"default_policy": 228.09417310914213}, "custom_metrics": {"num_consolidated_mean": 1.3809, "num_consolidated_min": 1.22, "num_consolidated_max": 1.65, "num_overloaded_mean": 0.1237, "num_overloaded_min": 0.03, "num_overloaded_max": 0.22, "num_moves_mean": 5.864400000000001, "num_moves_min": 5.29, "num_moves_max": 6.46, "mean_accuracy_mean": 41.49057666666667, "mean_accuracy_min": 41.271, "mean_accuracy_max": 41.746, "num_model_switches_mean": 2.5841, "num_model_switches_min": 2.05, "num_model_switches_max": 2.95, "num_slav_mean": 0.01733216666666667, "num_slav_min": 0.008716666666666668, "num_slav_max": 0.02955, "cpu_conserved_cost_mean": 3.1975999999999996, "cpu_conserved_cost_min": 2.72, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.47880596924840335, "mean_cluster_cpu_util_min": 0.4669267061221632, "mean_cluster_cpu_util_max": 0.4932584643941949, "mean_cluster_mem_util_mean": 0.31047105523622953, "mean_cluster_mem_util_min": 0.3038288776586584, "mean_cluster_mem_util_max": 0.31810167072103107, "reward_consolidation_mean_mean": -1.7872516022419207, "reward_consolidation_mean_min": -2.0174744890188556, "reward_consolidation_mean_max": -1.5880623838679222, "reward_illegal_mean_mean": -0.20616666666666666, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.857500000000009, "reward_accuracy_mean_min": 4.125000000000006, "reward_accuracy_mean_max": 5.6666666666666785, "reward_sla_mean_mean": -0.5831399999999999, "reward_sla_mean_min": -1.0833333333333335, "reward_sla_mean_max": -0.24599999999999997, "reward_consolidation_sum_mean": -178.72516022419208, "reward_consolidation_sum_min": -201.74744890188555, "reward_consolidation_sum_max": -158.80623838679222, "reward_illegal_sum_mean": -20.616666666666664, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 485.750000000001, "reward_accuracy_sum_min": 412.5000000000006, "reward_accuracy_sum_max": 566.6666666666679, "reward_sla_sum_mean": -58.313999999999986, "reward_sla_sum_min": -108.33333333333334, "reward_sla_sum_max": -24.599999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5882.0, "global_timestep_min": 4200, "global_timestep_max": 7500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [212.6472113070768, 216.15006244479022, 186.12709494654175, 241.2508331048774, 184.1181059429168, 214.56511620823133, 190.0529958268611, 211.39641170916036, 225.38044411952927, 215.8249718236933, 184.47788236010908, 225.34569130951385, 199.2858661549246, 173.96381248286656, 223.40605866764218, 198.04348594230783, 173.50523013189616, 215.91159950044266, 214.25543574278925, 225.3456273416804, 244.68392884340145, 194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2862981982142556, "mean_inference_ms": 2.4140722723048706, "mean_action_processing_ms": 0.10668316333636785, "mean_env_wait_ms": 2.0660373384283877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006870269775390625, "StateBufferConnector_ms": 0.0037550926208496094, "ViewRequirementAgentConnector_ms": 0.09611201286315918}, "num_episodes": 21, "episode_return_max": 297.55605714459904, "episode_return_min": 160.94415303542678, "episode_return_mean": 228.09417310914213, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209700, "num_agent_steps_trained": 209550, "num_env_steps_sampled": 209700, "num_env_steps_trained": 209550, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.7807267860685, "num_env_steps_trained_throughput_per_sec": 213.48457091873843, "timesteps_total": 209700, "num_env_steps_sampled_lifetime": 209700, "num_agent_steps_sampled_lifetime": 209700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 209700, "timers": {"training_iteration_time_ms": 10344.318, "restore_workers_time_ms": 0.013, "training_step_time_ms": 737.449, "sample_time_ms": 720.92, "synch_weights_time_ms": 14.978}, "counters": {"num_env_steps_sampled": 209700, "num_env_steps_trained": 209550, "num_agent_steps_sampled": 209700, "num_agent_steps_trained": 209550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1398, "num_samples_added_to_queue": 209550}, "done": false, "training_iteration": 102, "trial_id": "13390_00000", "date": "2024-10-13_00-56-10", "timestamp": 1728777370, "time_this_iter_s": 10.316186666488647, "time_total_s": 1059.9593884944916, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c89a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1059.9593884944916, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.02, "ram_util_percent": 64.5133333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 318965.59375, "policy_loss": 314148.4375, "entropy": 15.54998779296875, "entropy_coeff": 0.01, "var_gnorm": 16.4521484375, "vf_loss": 490269.25, "vf_explained_var": -0.3052777051925659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 384.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 211800, "num_env_steps_trained": 211200, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1412, "num_samples_added_to_queue": 211750, "learner_queue": {"size_count": 384, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 81.269, "learner_load_time_ms": 0.448, "learner_load_wait_time_ms": 2662.712, "learner_dequeue_time_ms": 22474.178}}, "env_runners": {"episode_reward_max": 302.2112217856175, "episode_reward_min": 160.94415303542678, "episode_reward_mean": 238.11661564470532, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 160.94415303542678}, "policy_reward_max": {"default_policy": 302.2112217856175}, "policy_reward_mean": {"default_policy": 238.11661564470532}, "custom_metrics": {"num_consolidated_mean": 1.3941, "num_consolidated_min": 1.23, "num_consolidated_max": 1.65, "num_overloaded_mean": 0.1189, "num_overloaded_min": 0.03, "num_overloaded_max": 0.22, "num_moves_mean": 5.766599999999999, "num_moves_min": 5.13, "num_moves_max": 6.2, "mean_accuracy_mean": 41.54485333333333, "mean_accuracy_min": 41.328, "mean_accuracy_max": 41.76500000000001, "num_model_switches_mean": 2.5213, "num_model_switches_min": 2.04, "num_model_switches_max": 2.95, "num_slav_mean": 0.017258999999999997, "num_slav_min": 0.008716666666666668, "num_slav_max": 0.02955, "cpu_conserved_cost_mean": 3.2062, "cpu_conserved_cost_min": 2.76, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.478635016291974, "mean_cluster_cpu_util_min": 0.4669267061221632, "mean_cluster_cpu_util_max": 0.4932584643941949, "mean_cluster_mem_util_mean": 0.3097670571234823, "mean_cluster_mem_util_min": 0.3038288776586584, "mean_cluster_mem_util_max": 0.31810167072103107, "reward_consolidation_mean_mean": -1.7826005102196232, "reward_consolidation_mean_min": -2.0174744890188556, "reward_consolidation_mean_max": -1.59971610466356, "reward_illegal_mean_mean": -0.19816666666666666, "reward_illegal_mean_min": -0.36666666666666664, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 4.94400000000001, "reward_accuracy_mean_min": 4.125000000000006, "reward_accuracy_mean_max": 5.6666666666666785, "reward_sla_mean_mean": -0.5820666666666666, "reward_sla_mean_min": -1.0833333333333335, "reward_sla_mean_max": -0.24599999999999997, "reward_consolidation_sum_mean": -178.2600510219623, "reward_consolidation_sum_min": -201.74744890188555, "reward_consolidation_sum_max": -159.971610466356, "reward_illegal_sum_mean": -19.816666666666666, "reward_illegal_sum_min": -36.666666666666664, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 494.4000000000009, "reward_accuracy_sum_min": 412.5000000000006, "reward_accuracy_sum_max": 566.6666666666679, "reward_sla_sum_mean": -58.20666666666667, "reward_sla_sum_min": -108.33333333333334, "reward_sla_sum_max": -24.599999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5639.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [194.42965975204928, 246.78602150537722, 236.70177586889736, 240.4124615431487, 201.04730573578306, 160.94415303542678, 186.85312680861495, 237.16507660909633, 222.3141795363864, 168.32652532821655, 162.79574156995403, 189.2369886380952, 198.4359316458019, 204.82793871272432, 244.32655274300234, 229.09910445033427, 238.79414542020865, 216.3149958877831, 201.42343659569394, 206.6307076060808, 225.69337476012132, 224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28616387306797475, "mean_inference_ms": 2.4106150529683172, "mean_action_processing_ms": 0.1066290905308312, "mean_env_wait_ms": 2.065196053606068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007137298583984375, "StateBufferConnector_ms": 0.003747224807739258, "ViewRequirementAgentConnector_ms": 0.09492874145507812}, "num_episodes": 21, "episode_return_max": 302.2112217856175, "episode_return_min": 160.94415303542678, "episode_return_mean": 238.11661564470532, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211200, "num_env_steps_sampled": 211800, "num_env_steps_trained": 211200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 200.76814908346822, "num_env_steps_trained_throughput_per_sec": 157.74640285129647, "timesteps_total": 211800, "num_env_steps_sampled_lifetime": 211800, "num_agent_steps_sampled_lifetime": 211800, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 211800, "timers": {"training_iteration_time_ms": 10321.186, "restore_workers_time_ms": 0.014, "training_step_time_ms": 753.488, "sample_time_ms": 735.868, "synch_weights_time_ms": 16.05}, "counters": {"num_env_steps_sampled": 211800, "num_env_steps_trained": 211200, "num_agent_steps_sampled": 211800, "num_agent_steps_trained": 211200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1412, "num_samples_added_to_queue": 211750}, "done": false, "training_iteration": 103, "trial_id": "13390_00000", "date": "2024-10-13_00-56-20", "timestamp": 1728777380, "time_this_iter_s": 10.469670295715332, "time_total_s": 1070.429058790207, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c176a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1070.429058790207, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 17.799999999999997, "ram_util_percent": 64.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 347593.46875, "policy_loss": 341385.78125, "entropy": 15.474563598632812, "entropy_coeff": 0.01, "var_gnorm": 16.443588256835938, "vf_loss": 629282.75, "vf_explained_var": -0.2786731719970703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 388.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 214050, "num_env_steps_trained": 213400, "num_agent_steps_sampled": 214050, "num_agent_steps_trained": 213400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1427, "num_samples_added_to_queue": 213950, "learner_queue": {"size_count": 388, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.721, "learner_load_time_ms": 0.448, "learner_load_wait_time_ms": 2637.762, "learner_dequeue_time_ms": 22474.178}}, "env_runners": {"episode_reward_max": 318.18571994273475, "episode_reward_min": 185.808839745348, "episode_reward_mean": 251.7259303664453, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 185.808839745348}, "policy_reward_max": {"default_policy": 318.18571994273475}, "policy_reward_mean": {"default_policy": 251.7259303664453}, "custom_metrics": {"num_consolidated_mean": 1.4106999999999996, "num_consolidated_min": 1.25, "num_consolidated_max": 1.65, "num_overloaded_mean": 0.1096, "num_overloaded_min": 0.02, "num_overloaded_max": 0.19, "num_moves_mean": 5.679500000000002, "num_moves_min": 5.05, "num_moves_max": 6.2, "mean_accuracy_mean": 41.58836333333335, "mean_accuracy_min": 41.372333333333344, "mean_accuracy_max": 41.78400000000001, "num_model_switches_mean": 2.4414, "num_model_switches_min": 2.04, "num_model_switches_max": 2.91, "num_slav_mean": 0.016394999999999996, "num_slav_min": 0.007983333333333334, "num_slav_max": 0.023983333333333336, "cpu_conserved_cost_mean": 3.2159999999999993, "cpu_conserved_cost_min": 2.76, "cpu_conserved_cost_max": 3.86, "mean_cluster_cpu_util_mean": 0.4778517349833277, "mean_cluster_cpu_util_min": 0.46594291121644, "mean_cluster_cpu_util_max": 0.48599490539564094, "mean_cluster_mem_util_mean": 0.30876392924954793, "mean_cluster_mem_util_min": 0.30112502009242514, "mean_cluster_mem_util_max": 0.31416624042021873, "reward_consolidation_mean_mean": -1.7871273630022235, "reward_consolidation_mean_min": -2.0174744890188556, "reward_consolidation_mean_max": -1.5496257881750894, "reward_illegal_mean_mean": -0.1826666666666667, "reward_illegal_mean_min": -0.31666666666666665, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.042666666666678, "reward_accuracy_mean_min": 4.5583333333333425, "reward_accuracy_mean_max": 5.66666666666668, "reward_sla_mean_mean": -0.5556133333333334, "reward_sla_mean_min": -0.8619999999999999, "reward_sla_mean_max": -0.24599999999999997, "reward_consolidation_sum_mean": -178.7127363002224, "reward_consolidation_sum_min": -201.74744890188555, "reward_consolidation_sum_max": -154.96257881750896, "reward_illegal_sum_mean": -18.266666666666662, "reward_illegal_sum_min": -31.666666666666664, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 504.26666666666773, "reward_accuracy_sum_min": 455.8333333333342, "reward_accuracy_sum_max": 566.666666666668, "reward_sla_sum_mean": -55.56133333333333, "reward_sla_sum_min": -86.19999999999999, "reward_sla_sum_max": -24.599999999999998, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4701.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [224.53801212342847, 242.20714002863403, 217.71598282006838, 252.06535075695368, 222.77828748972047, 253.07742240092713, 252.07826312102188, 231.6425142404591, 263.0350482804845, 216.3713759176345, 244.33793597124563, 225.60723445734035, 218.73284900545335, 226.6705900271109, 270.0532029607978, 244.78961284230493, 185.808839745348, 220.16801608334168, 228.6172408541237, 238.80684455816595, 228.7680526363894, 271.1655822595887, 244.42738127874838, 240.1927259435263, 232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2860515413447049, "mean_inference_ms": 2.4094602323544394, "mean_action_processing_ms": 0.10658789257146903, "mean_env_wait_ms": 2.064734933301502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073130130767822266, "StateBufferConnector_ms": 0.0037565231323242188, "ViewRequirementAgentConnector_ms": 0.09530234336853027}, "num_episodes": 21, "episode_return_max": 318.18571994273475, "episode_return_min": 185.808839745348, "episode_return_mean": 251.7259303664453, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214050, "num_agent_steps_trained": 213400, "num_env_steps_sampled": 214050, "num_env_steps_trained": 213400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.19195049857294, "num_env_steps_trained_throughput_per_sec": 204.54324048749353, "timesteps_total": 214050, "num_env_steps_sampled_lifetime": 214050, "num_agent_steps_sampled_lifetime": 214050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 214050, "timers": {"training_iteration_time_ms": 10385.427, "restore_workers_time_ms": 0.015, "training_step_time_ms": 715.444, "sample_time_ms": 698.286, "synch_weights_time_ms": 15.521}, "counters": {"num_env_steps_sampled": 214050, "num_env_steps_trained": 213400, "num_agent_steps_sampled": 214050, "num_agent_steps_trained": 213400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1427, "num_samples_added_to_queue": 213950}, "done": false, "training_iteration": 104, "trial_id": "13390_00000", "date": "2024-10-13_00-56-31", "timestamp": 1728777391, "time_this_iter_s": 10.765463590621948, "time_total_s": 1081.1945223808289, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c15a80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1081.1945223808289, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 16.873333333333335, "ram_util_percent": 64.56666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 345765.8125, "policy_loss": 340280.75, "entropy": 16.1624755859375, "entropy_coeff": 0.01, "var_gnorm": 16.43205451965332, "vf_loss": 557395.5, "vf_explained_var": -0.25012874603271484}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 216300, "num_env_steps_trained": 216150, "num_agent_steps_sampled": 216300, "num_agent_steps_trained": 216150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1442, "num_samples_added_to_queue": 216150, "learner_queue": {"size_count": 393, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.297, "learner_load_time_ms": 0.445, "learner_load_wait_time_ms": 2529.671, "learner_dequeue_time_ms": 22307.72}}, "env_runners": {"episode_reward_max": 318.18571994273475, "episode_reward_min": 194.28262816412405, "episode_reward_mean": 261.03681132535354, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 194.28262816412405}, "policy_reward_max": {"default_policy": 318.18571994273475}, "policy_reward_mean": {"default_policy": 261.03681132535354}, "custom_metrics": {"num_consolidated_mean": 1.4206, "num_consolidated_min": 1.26, "num_consolidated_max": 1.63, "num_overloaded_mean": 0.10379999999999999, "num_overloaded_min": 0.02, "num_overloaded_max": 0.19, "num_moves_mean": 5.6149000000000004, "num_moves_min": 5.05, "num_moves_max": 6.2, "mean_accuracy_mean": 41.63003666666668, "mean_accuracy_min": 41.403999999999996, "mean_accuracy_max": 41.79033333333334, "num_model_switches_mean": 2.3853999999999997, "num_model_switches_min": 1.99, "num_model_switches_max": 2.91, "num_slav_mean": 0.016053500000000002, "num_slav_min": 0.007983333333333334, "num_slav_max": 0.023983333333333336, "cpu_conserved_cost_mean": 3.2076, "cpu_conserved_cost_min": 2.76, "cpu_conserved_cost_max": 3.76, "mean_cluster_cpu_util_mean": 0.47723333629782433, "mean_cluster_cpu_util_min": 0.46594291121644, "mean_cluster_cpu_util_max": 0.48984913482564996, "mean_cluster_mem_util_mean": 0.3080307762206148, "mean_cluster_mem_util_min": 0.30112502009242514, "mean_cluster_mem_util_max": 0.31319120077355833, "reward_consolidation_mean_mean": -1.7857918867464744, "reward_consolidation_mean_min": -2.0174744890188556, "reward_consolidation_mean_max": -1.5496257881750894, "reward_illegal_mean_mean": -0.17299999999999996, "reward_illegal_mean_min": -0.31666666666666665, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.123000000000011, "reward_accuracy_mean_min": 4.5583333333333425, "reward_accuracy_mean_max": 5.66666666666668, "reward_sla_mean_mean": -0.5538400000000001, "reward_sla_mean_min": -0.8619999999999999, "reward_sla_mean_max": -0.2793333333333333, "reward_consolidation_sum_mean": -178.57918867464744, "reward_consolidation_sum_min": -201.74744890188555, "reward_consolidation_sum_max": -154.96257881750896, "reward_illegal_sum_mean": -17.3, "reward_illegal_sum_min": -31.666666666666664, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 512.300000000001, "reward_accuracy_sum_min": 455.8333333333342, "reward_accuracy_sum_max": 566.666666666668, "reward_sla_sum_mean": -55.38400000000001, "reward_sla_sum_min": -86.19999999999999, "reward_sla_sum_max": -27.933333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3623.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [232.0080660391737, 251.62841694843053, 223.96914313564324, 285.04869170550506, 224.9416765664513, 244.87041335404757, 221.70628407810273, 231.234030887326, 194.28262816412405, 239.00177282281007, 225.7066282859675, 240.70938499497495, 196.73842639130123, 267.6536842425912, 266.9002680556834, 248.49837643546965, 262.91921776478216, 252.44124097596728, 228.15481738706717, 269.8218343537736, 230.49811751804896, 254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28588882708725866, "mean_inference_ms": 2.4067387088371106, "mean_action_processing_ms": 0.10652601552830307, "mean_env_wait_ms": 2.0637842531981603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007219552993774414, "StateBufferConnector_ms": 0.003669261932373047, "ViewRequirementAgentConnector_ms": 0.0940861701965332}, "num_episodes": 24, "episode_return_max": 318.18571994273475, "episode_return_min": 194.28262816412405, "episode_return_mean": 261.03681132535354, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216300, "num_agent_steps_trained": 216150, "num_env_steps_sampled": 216300, "num_env_steps_trained": 216150, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 211.79443301433125, "num_env_steps_trained_throughput_per_sec": 258.85986257307155, "timesteps_total": 216300, "num_env_steps_sampled_lifetime": 216300, "num_agent_steps_sampled_lifetime": 216300, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 216300, "timers": {"training_iteration_time_ms": 10383.811, "restore_workers_time_ms": 0.015, "training_step_time_ms": 709.181, "sample_time_ms": 692.66, "synch_weights_time_ms": 14.975}, "counters": {"num_env_steps_sampled": 216300, "num_env_steps_trained": 216150, "num_agent_steps_sampled": 216300, "num_agent_steps_trained": 216150, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1442, "num_samples_added_to_queue": 216150}, "done": false, "training_iteration": 105, "trial_id": "13390_00000", "date": "2024-10-13_00-56-42", "timestamp": 1728777402, "time_this_iter_s": 10.637996673583984, "time_total_s": 1091.8325190544128, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16200>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1091.8325190544128, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 17.19333333333333, "ram_util_percent": 64.70666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 314552.34375, "policy_loss": 310376.40625, "entropy": 16.7375431060791, "entropy_coeff": 0.01, "var_gnorm": 16.42594337463379, "vf_loss": 426799.75, "vf_explained_var": -0.2616734504699707}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 396.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 218400, "num_env_steps_trained": 217800, "num_agent_steps_sampled": 218400, "num_agent_steps_trained": 217800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1456, "num_samples_added_to_queue": 218350, "learner_queue": {"size_count": 396, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.512, "learner_load_time_ms": 0.445, "learner_load_wait_time_ms": 2596.791, "learner_dequeue_time_ms": 22307.72}}, "env_runners": {"episode_reward_max": 318.18571994273475, "episode_reward_min": 210.06031862073243, "episode_reward_mean": 262.0244161564481, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 210.06031862073243}, "policy_reward_max": {"default_policy": 318.18571994273475}, "policy_reward_mean": {"default_policy": 262.0244161564481}, "custom_metrics": {"num_consolidated_mean": 1.4207999999999998, "num_consolidated_min": 1.24, "num_consolidated_max": 1.63, "num_overloaded_mean": 0.10480000000000002, "num_overloaded_min": 0.02, "num_overloaded_max": 0.18, "num_moves_mean": 5.6202, "num_moves_min": 5.05, "num_moves_max": 6.21, "mean_accuracy_mean": 41.66094333333334, "mean_accuracy_min": 41.403999999999996, "mean_accuracy_max": 41.83466666666668, "num_model_switches_mean": 2.3838999999999997, "num_model_switches_min": 1.99, "num_model_switches_max": 2.91, "num_slav_mean": 0.0167745, "num_slav_min": 0.007983333333333334, "num_slav_max": 0.028099999999999997, "cpu_conserved_cost_mean": 3.2063999999999995, "cpu_conserved_cost_min": 2.72, "cpu_conserved_cost_max": 3.76, "mean_cluster_cpu_util_mean": 0.47781588581825923, "mean_cluster_cpu_util_min": 0.46594291121644, "mean_cluster_cpu_util_max": 0.48984913482564996, "mean_cluster_mem_util_mean": 0.3082066819584373, "mean_cluster_mem_util_min": 0.30112502009242514, "mean_cluster_mem_util_max": 0.3161061289072591, "reward_consolidation_mean_mean": -1.7814925051021964, "reward_consolidation_mean_min": -1.9203655304761036, "reward_consolidation_mean_max": -1.5496257881750894, "reward_illegal_mean_mean": -0.1746666666666666, "reward_illegal_mean_min": -0.3, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.151416666666678, "reward_accuracy_mean_min": 4.650000000000009, "reward_accuracy_mean_max": 5.66666666666668, "reward_sla_mean_mean": -0.5750133333333333, "reward_sla_mean_min": -0.9406666666666665, "reward_sla_mean_max": -0.2793333333333333, "reward_consolidation_sum_mean": -178.14925051021964, "reward_consolidation_sum_min": -192.03655304761037, "reward_consolidation_sum_max": -154.96257881750896, "reward_illegal_sum_mean": -17.46666666666666, "reward_illegal_sum_min": -30.0, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 515.1416666666678, "reward_accuracy_sum_min": 465.00000000000097, "reward_accuracy_sum_max": 566.666666666668, "reward_sla_sum_mean": -57.50133333333332, "reward_sla_sum_min": -94.06666666666665, "reward_sla_sum_max": -27.933333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2685.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [254.6313746992, 283.27858905236315, 261.8943525541453, 237.349773066497, 259.4288007554308, 260.21011605592724, 246.8905875902413, 233.7022266898178, 228.27895762892643, 223.1696183252621, 238.49505620031175, 297.55605714459904, 293.84610557738694, 242.50562003107106, 246.05708672210645, 259.63305309330286, 259.38284139023534, 244.14927960035428, 301.3448901885538, 284.7821742971165, 225.68607328886145, 212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2857723779081448, "mean_inference_ms": 2.405639997902907, "mean_action_processing_ms": 0.10648600054172014, "mean_env_wait_ms": 2.0632631483794523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007282733917236328, "StateBufferConnector_ms": 0.0037136077880859375, "ViewRequirementAgentConnector_ms": 0.09600687026977539}, "num_episodes": 21, "episode_return_max": 318.18571994273475, "episode_return_min": 210.06031862073243, "episode_return_mean": 262.0244161564481, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218400, "num_agent_steps_trained": 217800, "num_env_steps_sampled": 218400, "num_env_steps_trained": 217800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 201.5070962995195, "num_env_steps_trained_throughput_per_sec": 158.32700423533674, "timesteps_total": 218400, "num_env_steps_sampled_lifetime": 218400, "num_agent_steps_sampled_lifetime": 218400, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 218400, "timers": {"training_iteration_time_ms": 10368.557, "restore_workers_time_ms": 0.015, "training_step_time_ms": 764.656, "sample_time_ms": 743.857, "synch_weights_time_ms": 19.111}, "counters": {"num_env_steps_sampled": 218400, "num_env_steps_trained": 217800, "num_agent_steps_sampled": 218400, "num_agent_steps_trained": 217800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1456, "num_samples_added_to_queue": 218350}, "done": false, "training_iteration": 106, "trial_id": "13390_00000", "date": "2024-10-13_00-56-52", "timestamp": 1728777412, "time_this_iter_s": 10.459809303283691, "time_total_s": 1102.2923283576965, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16830>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1102.2923283576965, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.826666666666668, "ram_util_percent": 64.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 328846.40625, "policy_loss": 324392.0625, "entropy": 17.096599578857422, "entropy_coeff": 0.01, "var_gnorm": 16.417638778686523, "vf_loss": 454836.53125, "vf_explained_var": -0.2522566318511963}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 400.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 220500, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220500, "num_agent_steps_trained": 220000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1470, "num_samples_added_to_queue": 220000, "learner_queue": {"size_count": 400, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 102.913, "learner_load_time_ms": 0.445, "learner_load_wait_time_ms": 2662.388, "learner_dequeue_time_ms": 22307.72}}, "env_runners": {"episode_reward_max": 318.18571994273475, "episode_reward_min": 205.40323799080187, "episode_reward_mean": 259.54177873221954, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 205.40323799080187}, "policy_reward_max": {"default_policy": 318.18571994273475}, "policy_reward_mean": {"default_policy": 259.54177873221954}, "custom_metrics": {"num_consolidated_mean": 1.409, "num_consolidated_min": 1.24, "num_consolidated_max": 1.63, "num_overloaded_mean": 0.10869999999999999, "num_overloaded_min": 0.02, "num_overloaded_max": 0.21, "num_moves_mean": 5.7105999999999995, "num_moves_min": 5.05, "num_moves_max": 6.62, "mean_accuracy_mean": 41.67766333333334, "mean_accuracy_min": 41.403999999999996, "mean_accuracy_max": 41.86000000000001, "num_model_switches_mean": 2.4067999999999996, "num_model_switches_min": 1.99, "num_model_switches_max": 2.87, "num_slav_mean": 0.017458166666666667, "num_slav_min": 0.007983333333333334, "num_slav_max": 0.028099999999999997, "cpu_conserved_cost_mean": 3.189000000000001, "cpu_conserved_cost_min": 2.72, "cpu_conserved_cost_max": 3.76, "mean_cluster_cpu_util_mean": 0.4787635400300209, "mean_cluster_cpu_util_min": 0.46594291121644, "mean_cluster_cpu_util_max": 0.49005093520743964, "mean_cluster_mem_util_mean": 0.30897623249268064, "mean_cluster_mem_util_min": 0.30112502009242514, "mean_cluster_mem_util_max": 0.31693509949338383, "reward_consolidation_mean_mean": -1.780925546011149, "reward_consolidation_mean_min": -1.9203655304761036, "reward_consolidation_mean_max": -1.5496257881750894, "reward_illegal_mean_mean": -0.18116666666666664, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.149083333333346, "reward_accuracy_mean_min": 4.62500000000001, "reward_accuracy_mean_max": 5.69166666666668, "reward_sla_mean_mean": -0.5915733333333332, "reward_sla_mean_min": -0.9406666666666665, "reward_sla_mean_max": -0.2793333333333333, "reward_consolidation_sum_mean": -178.0925546011148, "reward_consolidation_sum_min": -192.03655304761037, "reward_consolidation_sum_max": -154.96257881750896, "reward_illegal_sum_mean": -18.116666666666667, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 514.9083333333346, "reward_accuracy_sum_min": 462.50000000000097, "reward_accuracy_sum_max": 569.166666666668, "reward_sla_sum_mean": -59.15733333333332, "reward_sla_sum_min": -94.06666666666665, "reward_sla_sum_max": -27.933333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2059.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [212.0061713728725, 261.56991074964293, 233.1492948307908, 273.72423467056683, 262.1973955953588, 267.7579609491619, 210.06031862073243, 248.15075390660814, 246.0280757866532, 265.74999238478284, 302.2112217856175, 241.70000913826297, 290.1357610649132, 249.11276005970436, 265.56482682993806, 278.74916689512423, 314.0087575009911, 272.6707545158257, 254.89831246763632, 294.2170733193226, 254.59896737640605, 293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2856730690398032, "mean_inference_ms": 2.404746886974358, "mean_action_processing_ms": 0.10645375537882858, "mean_env_wait_ms": 2.0629041843431772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007119178771972656, "StateBufferConnector_ms": 0.003709554672241211, "ViewRequirementAgentConnector_ms": 0.09644174575805664}, "num_episodes": 21, "episode_return_max": 318.18571994273475, "episode_return_min": 205.40323799080187, "episode_return_mean": 259.54177873221954, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220500, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220500, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 195.79677201708208, "num_env_steps_trained_throughput_per_sec": 205.12042782741932, "timesteps_total": 220500, "num_env_steps_sampled_lifetime": 220500, "num_agent_steps_sampled_lifetime": 220500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 220500, "timers": {"training_iteration_time_ms": 10417.292, "restore_workers_time_ms": 0.016, "training_step_time_ms": 693.068, "sample_time_ms": 677.296, "synch_weights_time_ms": 14.38}, "counters": {"num_env_steps_sampled": 220500, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220500, "num_agent_steps_trained": 220000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1470, "num_samples_added_to_queue": 220000}, "done": false, "training_iteration": 107, "trial_id": "13390_00000", "date": "2024-10-13_00-57-03", "timestamp": 1728777423, "time_this_iter_s": 10.73589563369751, "time_total_s": 1113.028223991394, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c17070>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1113.028223991394, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 24.737499999999997, "ram_util_percent": 67.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 336265.59375, "policy_loss": 331492.4375, "entropy": 16.978168487548828, "entropy_coeff": 0.01, "var_gnorm": 16.41453742980957, "vf_loss": 486653.875, "vf_explained_var": -0.2587498426437378}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 404.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 222600, "num_env_steps_trained": 222200, "num_agent_steps_sampled": 222600, "num_agent_steps_trained": 222200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1484, "num_samples_added_to_queue": 222200, "learner_queue": {"size_count": 404, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 103.835, "learner_load_time_ms": 0.43, "learner_load_wait_time_ms": 2686.34, "learner_dequeue_time_ms": 22436.567}}, "env_runners": {"episode_reward_max": 318.18571994273475, "episode_reward_min": 205.40323799080187, "episode_reward_mean": 257.2317391635455, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 205.40323799080187}, "policy_reward_max": {"default_policy": 318.18571994273475}, "policy_reward_mean": {"default_policy": 257.2317391635455}, "custom_metrics": {"num_consolidated_mean": 1.3979, "num_consolidated_min": 1.24, "num_consolidated_max": 1.59, "num_overloaded_mean": 0.1114, "num_overloaded_min": 0.02, "num_overloaded_max": 0.21, "num_moves_mean": 5.7912, "num_moves_min": 5.07, "num_moves_max": 6.62, "mean_accuracy_mean": 41.68944333333334, "mean_accuracy_min": 41.530666666666676, "mean_accuracy_max": 41.89166666666668, "num_model_switches_mean": 2.4223, "num_model_switches_min": 1.99, "num_model_switches_max": 2.86, "num_slav_mean": 0.018042833333333334, "num_slav_min": 0.011199999999999998, "num_slav_max": 0.028099999999999997, "cpu_conserved_cost_mean": 3.17, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.76, "mean_cluster_cpu_util_mean": 0.47941693509404715, "mean_cluster_cpu_util_min": 0.4707211129715154, "mean_cluster_cpu_util_max": 0.49005093520743964, "mean_cluster_mem_util_mean": 0.30975854658751684, "mean_cluster_mem_util_min": 0.30163173006544397, "mean_cluster_mem_util_max": 0.31693509949338383, "reward_consolidation_mean_mean": -1.7824659416978894, "reward_consolidation_mean_min": -2.0205048889701183, "reward_consolidation_mean_max": -1.5694411952846574, "reward_illegal_mean_mean": -0.18566666666666667, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.144583333333345, "reward_accuracy_mean_min": 4.62500000000001, "reward_accuracy_mean_max": 5.69166666666668, "reward_sla_mean_mean": -0.6041333333333333, "reward_sla_mean_min": -0.9406666666666665, "reward_sla_mean_max": -0.37133333333333335, "reward_consolidation_sum_mean": -178.24659416978895, "reward_consolidation_sum_min": -202.05048889701183, "reward_consolidation_sum_max": -156.94411952846573, "reward_illegal_sum_mean": -18.566666666666666, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 514.4583333333345, "reward_accuracy_sum_min": 462.50000000000097, "reward_accuracy_sum_max": 569.166666666668, "reward_sla_sum_mean": -60.41333333333332, "reward_sla_sum_min": -94.06666666666665, "reward_sla_sum_max": -37.13333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2369.0, "global_timestep_min": 500, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [293.5682750007628, 274.84397636236366, 309.71216302659343, 253.5648725212477, 243.53649212586538, 277.5756495781179, 286.71796582290153, 296.80765177130104, 301.4634469523909, 318.18571994273475, 273.937500380762, 218.21647324012397, 241.53987023668202, 274.46414450638275, 292.7105425081495, 267.58921380486896, 267.4239818453208, 255.68277742240193, 290.3727009656107, 282.48526912181416, 293.96177769655, 278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28556592915265055, "mean_inference_ms": 2.403854895478955, "mean_action_processing_ms": 0.106420100616064, "mean_env_wait_ms": 2.062519342790686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006795406341552734, "StateBufferConnector_ms": 0.0037224292755126953, "ViewRequirementAgentConnector_ms": 0.09685659408569336}, "num_episodes": 21, "episode_return_max": 318.18571994273475, "episode_return_min": 205.40323799080187, "episode_return_mean": 257.2317391635455, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222600, "num_agent_steps_trained": 222200, "num_env_steps_sampled": 222600, "num_env_steps_trained": 222200, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 206.6158975837047, "num_env_steps_trained_throughput_per_sec": 216.4547498495954, "timesteps_total": 222600, "num_env_steps_sampled_lifetime": 222600, "num_agent_steps_sampled_lifetime": 222600, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 222600, "timers": {"training_iteration_time_ms": 10383.337, "restore_workers_time_ms": 0.014, "training_step_time_ms": 732.0, "sample_time_ms": 716.476, "synch_weights_time_ms": 14.008}, "counters": {"num_env_steps_sampled": 222600, "num_env_steps_trained": 222200, "num_agent_steps_sampled": 222600, "num_agent_steps_trained": 222200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1484, "num_samples_added_to_queue": 222200}, "done": false, "training_iteration": 108, "trial_id": "13390_00000", "date": "2024-10-13_00-57-14", "timestamp": 1728777434, "time_this_iter_s": 10.175483703613281, "time_total_s": 1123.2037076950073, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c15630>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1123.2037076950073, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 16.87857142857143, "ram_util_percent": 67.24285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 340216.75, "policy_loss": 334796.6875, "entropy": 16.43181037902832, "entropy_coeff": 0.01, "var_gnorm": 16.416736602783203, "vf_loss": 551042.375, "vf_explained_var": -0.2119741439819336}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 408.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 224700, "num_env_steps_trained": 224400, "num_agent_steps_sampled": 224700, "num_agent_steps_trained": 224400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1498, "num_samples_added_to_queue": 224400, "learner_queue": {"size_count": 408, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.595, "learner_load_time_ms": 0.43, "learner_load_wait_time_ms": 2490.74, "learner_dequeue_time_ms": 22436.567}}, "env_runners": {"episode_reward_max": 321.29665539614496, "episode_reward_min": 199.82300405129712, "episode_reward_mean": 253.73081756983268, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 199.82300405129712}, "policy_reward_max": {"default_policy": 321.29665539614496}, "policy_reward_mean": {"default_policy": 253.73081756983268}, "custom_metrics": {"num_consolidated_mean": 1.3846999999999996, "num_consolidated_min": 1.23, "num_consolidated_max": 1.59, "num_overloaded_mean": 0.11560000000000001, "num_overloaded_min": 0.03, "num_overloaded_max": 0.21, "num_moves_mean": 5.884199999999998, "num_moves_min": 5.24, "num_moves_max": 6.62, "mean_accuracy_mean": 41.705720000000014, "mean_accuracy_min": 41.530666666666676, "mean_accuracy_max": 41.910666666666685, "num_model_switches_mean": 2.4489, "num_model_switches_min": 1.91, "num_model_switches_max": 2.86, "num_slav_mean": 0.018844333333333334, "num_slav_min": 0.011199999999999998, "num_slav_max": 0.028099999999999997, "cpu_conserved_cost_mean": 3.1378000000000004, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.76, "mean_cluster_cpu_util_mean": 0.4798343477310947, "mean_cluster_cpu_util_min": 0.47183419021088346, "mean_cluster_cpu_util_max": 0.49005093520743964, "mean_cluster_mem_util_mean": 0.31038364977288385, "mean_cluster_mem_util_min": 0.30366035369844135, "mean_cluster_mem_util_max": 0.31693509949338383, "reward_consolidation_mean_mean": -1.782125157635018, "reward_consolidation_mean_min": -2.0205048889701183, "reward_consolidation_mean_max": -1.5845790307350214, "reward_illegal_mean_mean": -0.19266666666666662, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 5.141000000000012, "reward_accuracy_mean_min": 4.62500000000001, "reward_accuracy_mean_max": 5.69166666666668, "reward_sla_mean_mean": -0.6289, "reward_sla_mean_min": -0.9406666666666665, "reward_sla_mean_max": -0.37800000000000006, "reward_consolidation_sum_mean": -178.21251576350178, "reward_consolidation_sum_min": -202.05048889701183, "reward_consolidation_sum_max": -158.45790307350214, "reward_illegal_sum_mean": -19.26666666666667, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 514.1000000000013, "reward_accuracy_sum_min": 462.50000000000097, "reward_accuracy_sum_max": 569.166666666668, "reward_sla_sum_mean": -62.89, "reward_sla_sum_min": -94.06666666666665, "reward_sla_sum_max": -37.800000000000004, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3062.0, "global_timestep_min": 1200, "global_timestep_max": 4700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [278.62924548417675, 245.36699259800886, 308.75687958817014, 253.02328733741618, 244.57021231228578, 305.15283743032194, 265.2833622711638, 266.3966767187559, 288.7635474732717, 260.6061683267852, 287.7412683907532, 282.42559322550295, 255.68927777270213, 291.05686131164623, 268.04824697675946, 268.5427366048322, 211.04248682567356, 255.32073471625807, 250.8967254561528, 255.56380943677954, 229.33348259161195, 257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28546847724164887, "mean_inference_ms": 2.40194559709705, "mean_action_processing_ms": 0.106379944121945, "mean_env_wait_ms": 2.0620215045898846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006768226623535156, "StateBufferConnector_ms": 0.0037887096405029297, "ViewRequirementAgentConnector_ms": 0.0984346866607666}, "num_episodes": 21, "episode_return_max": 321.29665539614496, "episode_return_min": 199.82300405129712, "episode_return_mean": 253.73081756983268, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224700, "num_agent_steps_trained": 224400, "num_env_steps_sampled": 224700, "num_env_steps_trained": 224400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.7388033104285, "num_env_steps_trained_throughput_per_sec": 212.39303203949652, "timesteps_total": 224700, "num_env_steps_sampled_lifetime": 224700, "num_agent_steps_sampled_lifetime": 224700, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 224700, "timers": {"training_iteration_time_ms": 10419.042, "restore_workers_time_ms": 0.015, "training_step_time_ms": 761.561, "sample_time_ms": 731.341, "synch_weights_time_ms": 28.547}, "counters": {"num_env_steps_sampled": 224700, "num_env_steps_trained": 224400, "num_agent_steps_sampled": 224700, "num_agent_steps_trained": 224400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1498, "num_samples_added_to_queue": 224400}, "done": false, "training_iteration": 109, "trial_id": "13390_00000", "date": "2024-10-13_00-57-24", "timestamp": 1728777444, "time_this_iter_s": 10.37782883644104, "time_total_s": 1133.5815365314484, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371f95e70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1133.5815365314484, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 17.860000000000003, "ram_util_percent": 67.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 348407.25, "policy_loss": 342404.5, "entropy": 15.87350845336914, "entropy_coeff": 0.01, "var_gnorm": 16.4186954498291, "vf_loss": 609006.8125, "vf_explained_var": -0.22474002838134766}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 412.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 226800, "num_env_steps_trained": 226600, "num_agent_steps_sampled": 226800, "num_agent_steps_trained": 226600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1512, "num_samples_added_to_queue": 226600, "learner_queue": {"size_count": 412, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.156, "learner_load_time_ms": 0.435, "learner_load_wait_time_ms": 2643.399, "learner_dequeue_time_ms": 22335.439}}, "env_runners": {"episode_reward_max": 321.29665539614496, "episode_reward_min": 199.82300405129712, "episode_reward_mean": 256.00433701910015, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 199.82300405129712}, "policy_reward_max": {"default_policy": 321.29665539614496}, "policy_reward_mean": {"default_policy": 256.00433701910015}, "custom_metrics": {"num_consolidated_mean": 1.3851999999999998, "num_consolidated_min": 1.23, "num_consolidated_max": 1.57, "num_overloaded_mean": 0.11549999999999999, "num_overloaded_min": 0.03, "num_overloaded_max": 0.21, "num_moves_mean": 5.900600000000001, "num_moves_min": 5.2, "num_moves_max": 6.62, "mean_accuracy_mean": 41.73612000000002, "mean_accuracy_min": 41.57500000000001, "mean_accuracy_max": 41.936000000000014, "num_model_switches_mean": 2.4152, "num_model_switches_min": 1.88, "num_model_switches_max": 2.83, "num_slav_mean": 0.01935083333333333, "num_slav_min": 0.009416666666666667, "num_slav_max": 0.027449999999999995, "cpu_conserved_cost_mean": 3.1438, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.6, "mean_cluster_cpu_util_mean": 0.48028058637263543, "mean_cluster_cpu_util_min": 0.46890911656078194, "mean_cluster_cpu_util_max": 0.49005093520743964, "mean_cluster_mem_util_mean": 0.3109464662088464, "mean_cluster_mem_util_min": 0.3054808637590057, "mean_cluster_mem_util_max": 0.31693509949338383, "reward_consolidation_mean_mean": -1.7792732964756772, "reward_consolidation_mean_min": -2.0205048889701183, "reward_consolidation_mean_max": -1.5845790307350214, "reward_illegal_mean_mean": -0.19249999999999998, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 5.179750000000012, "reward_accuracy_mean_min": 4.62500000000001, "reward_accuracy_mean_max": 5.69166666666668, "reward_sla_mean_mean": -0.6479333333333333, "reward_sla_mean_min": -0.9986666666666666, "reward_sla_mean_max": -0.2806666666666667, "reward_consolidation_sum_mean": -177.92732964756772, "reward_consolidation_sum_min": -202.05048889701183, "reward_consolidation_sum_max": -158.45790307350214, "reward_illegal_sum_mean": -19.25, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 517.9750000000012, "reward_accuracy_sum_min": 462.50000000000097, "reward_accuracy_sum_max": 569.166666666668, "reward_sla_sum_mean": -64.79333333333334, "reward_sla_sum_min": -99.86666666666666, "reward_sla_sum_max": -28.066666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3775.0, "global_timestep_min": 2000, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [257.77903987328403, 239.39020682932875, 278.5748850102056, 235.22651314386766, 237.7462822504503, 225.3088488836099, 265.5570684455828, 236.79269548265367, 268.61137104389513, 266.2031374699211, 237.94240762740384, 219.8366474763178, 213.1529257668534, 270.10258003594504, 261.6842212677826, 221.42753358311361, 206.37065704103173, 213.28370343294148, 264.9443083858794, 241.22525206372504, 224.52099972585324, 220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28539370951644794, "mean_inference_ms": 2.40363644953651, "mean_action_processing_ms": 0.1063645123359819, "mean_env_wait_ms": 2.0622218432634356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006878376007080078, "StateBufferConnector_ms": 0.003853321075439453, "ViewRequirementAgentConnector_ms": 0.09975123405456543}, "num_episodes": 21, "episode_return_max": 321.29665539614496, "episode_return_min": 199.82300405129712, "episode_return_mean": 256.00433701910015, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226800, "num_agent_steps_trained": 226600, "num_env_steps_sampled": 226800, "num_env_steps_trained": 226600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.87490246082046, "num_env_steps_trained_throughput_per_sec": 213.58323114943096, "timesteps_total": 226800, "num_env_steps_sampled_lifetime": 226800, "num_agent_steps_sampled_lifetime": 226800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 226800, "timers": {"training_iteration_time_ms": 10419.771, "restore_workers_time_ms": 0.015, "training_step_time_ms": 721.492, "sample_time_ms": 704.514, "synch_weights_time_ms": 15.372}, "counters": {"num_env_steps_sampled": 226800, "num_env_steps_trained": 226600, "num_agent_steps_sampled": 226800, "num_agent_steps_trained": 226600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1512, "num_samples_added_to_queue": 226600}, "done": false, "training_iteration": 110, "trial_id": "13390_00000", "date": "2024-10-13_00-57-34", "timestamp": 1728777454, "time_this_iter_s": 10.309699058532715, "time_total_s": 1143.891235589981, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b53f40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1143.891235589981, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 18.726666666666667, "ram_util_percent": 67.03999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 327192.84375, "policy_loss": 321363.125, "entropy": 15.454676628112793, "entropy_coeff": 0.01, "var_gnorm": 16.419755935668945, "vf_loss": 591473.375, "vf_explained_var": -0.16426730155944824}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 416.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 229050, "num_env_steps_trained": 228800, "num_agent_steps_sampled": 229050, "num_agent_steps_trained": 228800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1527, "num_samples_added_to_queue": 228800, "learner_queue": {"size_count": 416, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.676, "learner_load_time_ms": 0.435, "learner_load_wait_time_ms": 2626.546, "learner_dequeue_time_ms": 22335.439}}, "env_runners": {"episode_reward_max": 330.9018885741277, "episode_reward_min": 199.82300405129712, "episode_reward_mean": 266.90817901855183, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 199.82300405129712}, "policy_reward_max": {"default_policy": 330.9018885741277}, "policy_reward_mean": {"default_policy": 266.90817901855183}, "custom_metrics": {"num_consolidated_mean": 1.4051, "num_consolidated_min": 1.23, "num_consolidated_max": 1.58, "num_overloaded_mean": 0.10750000000000001, "num_overloaded_min": 0.03, "num_overloaded_max": 0.21, "num_moves_mean": 5.809600000000001, "num_moves_min": 5.03, "num_moves_max": 6.62, "mean_accuracy_mean": 41.76911666666669, "mean_accuracy_min": 41.593999999999994, "mean_accuracy_max": 41.96133333333335, "num_model_switches_mean": 2.3395, "num_model_switches_min": 1.83, "num_model_switches_max": 2.83, "num_slav_mean": 0.01883483333333333, "num_slav_min": 0.009416666666666667, "num_slav_max": 0.027449999999999995, "cpu_conserved_cost_mean": 3.1689999999999996, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.64, "mean_cluster_cpu_util_mean": 0.4792383475320547, "mean_cluster_cpu_util_min": 0.46890911656078194, "mean_cluster_cpu_util_max": 0.48967808967236237, "mean_cluster_mem_util_mean": 0.3103106643650076, "mean_cluster_mem_util_min": 0.3026157596371882, "mean_cluster_mem_util_max": 0.3168539203550619, "reward_consolidation_mean_mean": -1.778861543147827, "reward_consolidation_mean_min": -2.0205048889701183, "reward_consolidation_mean_max": -1.5845790307350214, "reward_illegal_mean_mean": -0.1791666666666666, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 5.26741666666668, "reward_accuracy_mean_min": 4.62500000000001, "reward_accuracy_mean_max": 5.741666666666682, "reward_sla_mean_mean": -0.6403066666666666, "reward_sla_mean_min": -0.9986666666666666, "reward_sla_mean_max": -0.2806666666666667, "reward_consolidation_sum_mean": -177.88615431478266, "reward_consolidation_sum_min": -202.05048889701183, "reward_consolidation_sum_max": -158.45790307350214, "reward_illegal_sum_mean": -17.916666666666664, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 526.741666666668, "reward_accuracy_sum_min": 462.50000000000097, "reward_accuracy_sum_max": 574.1666666666682, "reward_sla_sum_mean": -64.03066666666666, "reward_sla_sum_min": -99.86666666666666, "reward_sla_sum_max": -28.066666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4475.0, "global_timestep_min": 2700, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [220.56199396874808, 297.63606871973076, 234.68529044442522, 265.8786286514982, 225.50876359316555, 247.88294800329095, 259.295330348169, 257.0600048737407, 228.8032349447145, 259.54620305218054, 241.04200554388, 205.40323799080187, 290.0966736726687, 232.95862804228076, 259.79027384324957, 257.51468518687864, 224.71253464924413, 269.38284443632284, 219.02544092113777, 250.64039416369783, 259.08439794084615, 243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2852676863329116, "mean_inference_ms": 2.402567117127124, "mean_action_processing_ms": 0.10631988391220253, "mean_env_wait_ms": 2.0617377476747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006748676300048828, "StateBufferConnector_ms": 0.0037975311279296875, "ViewRequirementAgentConnector_ms": 0.09748268127441406}, "num_episodes": 21, "episode_return_max": 330.9018885741277, "episode_return_min": 199.82300405129712, "episode_return_mean": 266.90817901855183, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229050, "num_agent_steps_trained": 228800, "num_env_steps_sampled": 229050, "num_env_steps_trained": 228800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 214.89723674229793, "num_env_steps_trained_throughput_per_sec": 210.12174259246908, "timesteps_total": 229050, "num_env_steps_sampled_lifetime": 229050, "num_agent_steps_sampled_lifetime": 229050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 229050, "timers": {"training_iteration_time_ms": 10458.368, "restore_workers_time_ms": 0.013, "training_step_time_ms": 686.412, "sample_time_ms": 669.868, "synch_weights_time_ms": 15.091}, "counters": {"num_env_steps_sampled": 229050, "num_env_steps_trained": 228800, "num_agent_steps_sampled": 229050, "num_agent_steps_trained": 228800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1527, "num_samples_added_to_queue": 228800}, "done": false, "training_iteration": 111, "trial_id": "13390_00000", "date": "2024-10-13_00-57-45", "timestamp": 1728777465, "time_this_iter_s": 10.48455548286438, "time_total_s": 1154.3757910728455, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c8700>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1154.3757910728455, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 16.793333333333333, "ram_util_percent": 67.05333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 342297.28125, "policy_loss": 335925.96875, "entropy": 15.053542137145996, "entropy_coeff": 0.01, "var_gnorm": 16.42013931274414, "vf_loss": 645409.8125, "vf_explained_var": -0.1967540979385376}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 420.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 231150, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231150, "num_agent_steps_trained": 231000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1541, "num_samples_added_to_queue": 231000, "learner_queue": {"size_count": 420, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.38, "learner_load_time_ms": 0.386, "learner_load_wait_time_ms": 2471.953, "learner_dequeue_time_ms": 22141.665}}, "env_runners": {"episode_reward_max": 335.86343172195456, "episode_reward_min": 199.82300405129712, "episode_reward_mean": 278.0227614913656, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 199.82300405129712}, "policy_reward_max": {"default_policy": 335.86343172195456}, "policy_reward_mean": {"default_policy": 278.0227614913656}, "custom_metrics": {"num_consolidated_mean": 1.4315, "num_consolidated_min": 1.23, "num_consolidated_max": 1.63, "num_overloaded_mean": 0.10120000000000003, "num_overloaded_min": 0.04, "num_overloaded_max": 0.2, "num_moves_mean": 5.6728, "num_moves_min": 4.85, "num_moves_max": 6.39, "mean_accuracy_mean": 41.81085333333334, "mean_accuracy_min": 41.613000000000014, "mean_accuracy_max": 41.98033333333335, "num_model_switches_mean": 2.2561, "num_model_switches_min": 1.74, "num_model_switches_max": 2.83, "num_slav_mean": 0.01855983333333333, "num_slav_min": 0.009416666666666667, "num_slav_max": 0.027449999999999995, "cpu_conserved_cost_mean": 3.2148000000000003, "cpu_conserved_cost_min": 2.7, "cpu_conserved_cost_max": 3.72, "mean_cluster_cpu_util_mean": 0.47859522072899663, "mean_cluster_cpu_util_min": 0.46839208874664556, "mean_cluster_cpu_util_max": 0.48967808967236237, "mean_cluster_mem_util_mean": 0.3097645935445909, "mean_cluster_mem_util_min": 0.3026157596371882, "mean_cluster_mem_util_max": 0.3168539203550619, "reward_consolidation_mean_mean": -1.7696690517530234, "reward_consolidation_mean_min": -1.9854614822260808, "reward_consolidation_mean_max": -1.5875252063724148, "reward_illegal_mean_mean": -0.16866666666666663, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.06666666666666667, "reward_accuracy_mean_mean": 5.35291666666668, "reward_accuracy_mean_min": 4.641666666666676, "reward_accuracy_mean_max": 5.79166666666668, "reward_sla_mean_mean": -0.6343533333333333, "reward_sla_mean_min": -0.9986666666666666, "reward_sla_mean_max": -0.2806666666666667, "reward_consolidation_sum_mean": -176.96690517530232, "reward_consolidation_sum_min": -198.54614822260808, "reward_consolidation_sum_max": -158.75252063724147, "reward_illegal_sum_mean": -16.866666666666664, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -6.666666666666666, "reward_accuracy_sum_mean": 535.291666666668, "reward_accuracy_sum_min": 464.16666666666765, "reward_accuracy_sum_max": 579.166666666668, "reward_sla_sum_mean": -63.435333333333325, "reward_sla_sum_min": -99.86666666666666, "reward_sla_sum_max": -28.066666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5175.0, "global_timestep_min": 3400, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [243.24884400987068, 239.3142861494421, 257.3822839562593, 260.2760364312051, 250.53591032319082, 248.1000609217472, 240.6215693441785, 254.94195985257048, 233.60680800511847, 258.040598251547, 249.5173901124018, 272.95580127326554, 255.57031587925417, 254.82367723659067, 277.57236894209507, 247.90424015352397, 263.27660604953076, 253.69181820951098, 287.47377014225344, 270.38364251119566, 225.81401809375959, 290.6247068140984, 280.956005361115, 266.0941758810818, 248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28511145359957624, "mean_inference_ms": 2.401329949570486, "mean_action_processing_ms": 0.10626657590610158, "mean_env_wait_ms": 2.061076720328365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006765604019165039, "StateBufferConnector_ms": 0.003818988800048828, "ViewRequirementAgentConnector_ms": 0.09788346290588379}, "num_episodes": 21, "episode_return_max": 335.86343172195456, "episode_return_min": 199.82300405129712, "episode_return_mean": 278.0227614913656, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231150, "num_agent_steps_trained": 231000, "num_env_steps_sampled": 231150, "num_env_steps_trained": 231000, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.57258086889536, "num_env_steps_trained_throughput_per_sec": 219.552227576938, "timesteps_total": 231150, "num_env_steps_sampled_lifetime": 231150, "num_agent_steps_sampled_lifetime": 231150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 231150, "timers": {"training_iteration_time_ms": 10429.888, "restore_workers_time_ms": 0.014, "training_step_time_ms": 711.627, "sample_time_ms": 696.937, "synch_weights_time_ms": 13.178}, "counters": {"num_env_steps_sampled": 231150, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231150, "num_agent_steps_trained": 231000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1541, "num_samples_added_to_queue": 231000}, "done": false, "training_iteration": 112, "trial_id": "13390_00000", "date": "2024-10-13_00-57-55", "timestamp": 1728777475, "time_this_iter_s": 10.034728288650513, "time_total_s": 1164.410519361496, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b52110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1164.410519361496, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 16.892857142857142, "ram_util_percent": 67.07142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 362499.71875, "policy_loss": 355764.0, "entropy": 14.972702026367188, "entropy_coeff": 0.01, "var_gnorm": 16.417373657226562, "vf_loss": 681806.25, "vf_explained_var": -0.1961667537689209}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 424.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233200, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1556, "num_samples_added_to_queue": 233200, "learner_queue": {"size_count": 424, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.391, "learner_load_time_ms": 0.386, "learner_load_wait_time_ms": 2529.056, "learner_dequeue_time_ms": 22141.665}}, "env_runners": {"episode_reward_max": 350.0787383106413, "episode_reward_min": 199.82300405129712, "episode_reward_mean": 290.34985552408057, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 199.82300405129712}, "policy_reward_max": {"default_policy": 350.0787383106413}, "policy_reward_mean": {"default_policy": 290.34985552408057}, "custom_metrics": {"num_consolidated_mean": 1.4608, "num_consolidated_min": 1.26, "num_consolidated_max": 1.63, "num_overloaded_mean": 0.0928, "num_overloaded_min": 0.03, "num_overloaded_max": 0.2, "num_moves_mean": 5.509200000000001, "num_moves_min": 4.85, "num_moves_max": 6.39, "mean_accuracy_mean": 41.85601000000001, "mean_accuracy_min": 41.64466666666667, "mean_accuracy_max": 42.05000000000001, "num_model_switches_mean": 2.1465000000000005, "num_model_switches_min": 1.71, "num_model_switches_max": 2.83, "num_slav_mean": 0.018171, "num_slav_min": 0.009416666666666667, "num_slav_max": 0.027449999999999995, "cpu_conserved_cost_mean": 3.2611999999999997, "cpu_conserved_cost_min": 2.74, "cpu_conserved_cost_max": 3.72, "mean_cluster_cpu_util_mean": 0.47743794875691487, "mean_cluster_cpu_util_min": 0.46674820323224514, "mean_cluster_cpu_util_max": 0.48967808967236237, "mean_cluster_mem_util_mean": 0.3088956289287867, "mean_cluster_mem_util_min": 0.3026157596371882, "mean_cluster_mem_util_max": 0.3164993417936795, "reward_consolidation_mean_mean": -1.761848111425874, "reward_consolidation_mean_min": -1.9854614822260808, "reward_consolidation_mean_max": -1.5875252063724148, "reward_illegal_mean_mean": -0.15466666666666665, "reward_illegal_mean_min": -0.33333333333333326, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 5.456166666666679, "reward_accuracy_mean_min": 4.641666666666676, "reward_accuracy_mean_max": 5.850000000000015, "reward_sla_mean_mean": -0.6361533333333333, "reward_sla_mean_min": -0.9986666666666666, "reward_sla_mean_max": -0.2806666666666667, "reward_consolidation_sum_mean": -176.1848111425874, "reward_consolidation_sum_min": -198.54614822260808, "reward_consolidation_sum_max": -158.75252063724147, "reward_illegal_sum_mean": -15.466666666666667, "reward_illegal_sum_min": -33.33333333333333, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 545.6166666666682, "reward_accuracy_sum_min": 464.16666666666765, "reward_accuracy_sum_max": 585.0000000000015, "reward_sla_sum_mean": -63.61533333333334, "reward_sla_sum_min": -99.86666666666666, "reward_sla_sum_max": -28.066666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5969.0, "global_timestep_min": 4100, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [248.91966858570277, 255.89189436169372, 256.0986779981129, 254.97494288586435, 259.6458192451808, 276.71230314660943, 219.76888421822267, 199.82300405129712, 245.00676231380905, 263.08929604922605, 321.29665539614496, 268.57472052149143, 256.15093362575897, 259.1656096743744, 277.1020926619768, 287.5197295074489, 269.65385177739284, 319.6753236467771, 289.9203113101236, 274.70111791404076, 273.1738158335633, 247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2849118779088743, "mean_inference_ms": 2.398705620099432, "mean_action_processing_ms": 0.10619434053176477, "mean_env_wait_ms": 2.060017333874102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006661891937255859, "StateBufferConnector_ms": 0.003778696060180664, "ViewRequirementAgentConnector_ms": 0.09666800498962402}, "num_episodes": 24, "episode_return_max": 350.0787383106413, "episode_return_min": 199.82300405129712, "episode_return_mean": 290.34985552408057, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233200, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.28897527460109, "num_env_steps_trained_throughput_per_sec": 208.54922026849886, "timesteps_total": 233400, "num_env_steps_sampled_lifetime": 233400, "num_agent_steps_sampled_lifetime": 233400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 10438.813, "restore_workers_time_ms": 0.015, "training_step_time_ms": 713.274, "sample_time_ms": 696.721, "synch_weights_time_ms": 15.15}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233200, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1556, "num_samples_added_to_queue": 233200}, "done": false, "training_iteration": 113, "trial_id": "13390_00000", "date": "2024-10-13_00-58-05", "timestamp": 1728777485, "time_this_iter_s": 10.560572147369385, "time_total_s": 1174.9710915088654, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b53a90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1174.9710915088654, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 16.64, "ram_util_percent": 66.22666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 346514.75, "policy_loss": 339422.5, "entropy": 14.502939224243164, "entropy_coeff": 0.01, "var_gnorm": 16.41185188293457, "vf_loss": 717203.5, "vf_explained_var": -0.16297268867492676}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 235650, "num_env_steps_trained": 235400, "num_agent_steps_sampled": 235650, "num_agent_steps_trained": 235400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1571, "num_samples_added_to_queue": 235400, "learner_queue": {"size_count": 428, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.306, "learner_load_time_ms": 0.383, "learner_load_wait_time_ms": 2529.922, "learner_dequeue_time_ms": 22020.222}}, "env_runners": {"episode_reward_max": 367.7325504888987, "episode_reward_min": 240.44449419720507, "episode_reward_mean": 303.1150030156278, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 240.44449419720507}, "policy_reward_max": {"default_policy": 367.7325504888987}, "policy_reward_mean": {"default_policy": 303.1150030156278}, "custom_metrics": {"num_consolidated_mean": 1.4949000000000001, "num_consolidated_min": 1.27, "num_consolidated_max": 1.63, "num_overloaded_mean": 0.0842, "num_overloaded_min": 0.02, "num_overloaded_max": 0.17, "num_moves_mean": 5.367299999999999, "num_moves_min": 4.68, "num_moves_max": 6.1, "mean_accuracy_mean": 41.88812000000001, "mean_accuracy_min": 41.71433333333334, "mean_accuracy_max": 42.107000000000006, "num_model_switches_mean": 2.0477000000000003, "num_model_switches_min": 1.62, "num_model_switches_max": 2.54, "num_slav_mean": 0.0175255, "num_slav_min": 0.007883333333333332, "num_slav_max": 0.02643333333333333, "cpu_conserved_cost_mean": 3.3268, "cpu_conserved_cost_min": 2.8, "cpu_conserved_cost_max": 3.72, "mean_cluster_cpu_util_mean": 0.4765031832030197, "mean_cluster_cpu_util_min": 0.46674820323224514, "mean_cluster_cpu_util_max": 0.48967808967236237, "mean_cluster_mem_util_mean": 0.30811614560549955, "mean_cluster_mem_util_min": 0.30250165870145523, "mean_cluster_mem_util_max": 0.3164993417936795, "reward_consolidation_mean_mean": -1.7528766365104032, "reward_consolidation_mean_min": -1.9539334125316035, "reward_consolidation_mean_max": -1.5875252063724148, "reward_illegal_mean_mean": -0.1403333333333333, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 5.543500000000015, "reward_accuracy_mean_min": 4.9166666666666785, "reward_accuracy_mean_max": 6.083333333333352, "reward_sla_mean_mean": -0.61914, "reward_sla_mean_min": -0.9933333333333332, "reward_sla_mean_max": -0.2806666666666667, "reward_consolidation_sum_mean": -175.28766365104028, "reward_consolidation_sum_min": -195.39334125316034, "reward_consolidation_sum_max": -158.75252063724147, "reward_illegal_sum_mean": -14.033333333333333, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 554.3500000000015, "reward_accuracy_sum_min": 491.6666666666678, "reward_accuracy_sum_max": 608.3333333333352, "reward_sla_sum_mean": -61.91400000000001, "reward_sla_sum_min": -99.33333333333331, "reward_sla_sum_max": -28.066666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5499.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [247.86614273965208, 303.8468762374741, 240.44449419720507, 305.1536233208457, 275.2996862530092, 260.75209418502084, 280.4624143287957, 251.24208778823726, 250.64747936275975, 289.60386243869885, 293.963276371502, 273.78183618142623, 275.586652045449, 286.5908190928763, 277.4405525602377, 312.67993846903784, 289.34715343141846, 283.0590331718921, 265.50958299064985, 323.0664778092555, 297.04246550306254, 260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2847032350790322, "mean_inference_ms": 2.396999471234759, "mean_action_processing_ms": 0.10612340096872941, "mean_env_wait_ms": 2.0590058515204843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064122676849365234, "StateBufferConnector_ms": 0.003653287887573242, "ViewRequirementAgentConnector_ms": 0.09285712242126465}, "num_episodes": 21, "episode_return_max": 367.7325504888987, "episode_return_min": 240.44449419720507, "episode_return_mean": 303.1150030156278, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235650, "num_agent_steps_trained": 235400, "num_env_steps_sampled": 235650, "num_env_steps_trained": 235400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.99879485448716, "num_env_steps_trained_throughput_per_sec": 209.243266079943, "timesteps_total": 235650, "num_env_steps_sampled_lifetime": 235650, "num_agent_steps_sampled_lifetime": 235650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 235650, "timers": {"training_iteration_time_ms": 10414.653, "restore_workers_time_ms": 0.016, "training_step_time_ms": 697.704, "sample_time_ms": 680.994, "synch_weights_time_ms": 15.061}, "counters": {"num_env_steps_sampled": 235650, "num_env_steps_trained": 235400, "num_agent_steps_sampled": 235650, "num_agent_steps_trained": 235400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1571, "num_samples_added_to_queue": 235400}, "done": false, "training_iteration": 114, "trial_id": "13390_00000", "date": "2024-10-13_00-58-16", "timestamp": 1728777496, "time_this_iter_s": 10.52888536453247, "time_total_s": 1185.4999768733978, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b51780>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1185.4999768733978, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 16.513333333333332, "ram_util_percent": 66.33333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 345684.1875, "policy_loss": 338918.0, "entropy": 14.620282173156738, "entropy_coeff": 0.01, "var_gnorm": 16.4066162109375, "vf_loss": 684658.25, "vf_explained_var": -0.1870518922805786}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 432.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 237750, "num_env_steps_trained": 237600, "num_agent_steps_sampled": 237750, "num_agent_steps_trained": 237600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1585, "num_samples_added_to_queue": 237600, "learner_queue": {"size_count": 432, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.72, "learner_load_time_ms": 0.383, "learner_load_wait_time_ms": 2520.747, "learner_dequeue_time_ms": 22020.222}}, "env_runners": {"episode_reward_max": 369.6464071400301, "episode_reward_min": 256.95877120838406, "episode_reward_mean": 314.3801311645205, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 256.95877120838406}, "policy_reward_max": {"default_policy": 369.6464071400301}, "policy_reward_mean": {"default_policy": 314.3801311645205}, "custom_metrics": {"num_consolidated_mean": 1.5226, "num_consolidated_min": 1.37, "num_consolidated_max": 1.73, "num_overloaded_mean": 0.07490000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 5.2546, "num_moves_min": 4.63, "num_moves_max": 5.73, "mean_accuracy_mean": 41.91535333333334, "mean_accuracy_min": 41.76500000000001, "mean_accuracy_max": 42.107000000000006, "num_model_switches_mean": 1.9744, "num_model_switches_min": 1.57, "num_model_switches_max": 2.4, "num_slav_mean": 0.017175666666666665, "num_slav_min": 0.007883333333333332, "num_slav_max": 0.028600000000000004, "cpu_conserved_cost_mean": 3.3728, "cpu_conserved_cost_min": 2.88, "cpu_conserved_cost_max": 4.0, "mean_cluster_cpu_util_mean": 0.47547849689407334, "mean_cluster_cpu_util_min": 0.46674820323224514, "mean_cluster_cpu_util_max": 0.48967808967236237, "mean_cluster_mem_util_mean": 0.3073218753695571, "mean_cluster_mem_util_min": 0.30250165870145523, "mean_cluster_mem_util_max": 0.3164993417936795, "reward_consolidation_mean_mean": -1.748705355021475, "reward_consolidation_mean_min": -1.9539334125316035, "reward_consolidation_mean_max": -1.5888548234792415, "reward_illegal_mean_mean": -0.12483333333333332, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.629833333333347, "reward_accuracy_mean_min": 5.175000000000012, "reward_accuracy_mean_max": 6.083333333333352, "reward_sla_mean_mean": -0.6124933333333333, "reward_sla_mean_min": -1.0153333333333334, "reward_sla_mean_max": -0.3153333333333333, "reward_consolidation_sum_mean": -174.87053550214753, "reward_consolidation_sum_min": -195.39334125316034, "reward_consolidation_sum_max": -158.88548234792415, "reward_illegal_sum_mean": -12.48333333333333, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 562.9833333333349, "reward_accuracy_sum_min": 517.5000000000013, "reward_accuracy_sum_max": 608.3333333333352, "reward_sla_sum_mean": -61.24933333333333, "reward_sla_sum_min": -101.53333333333333, "reward_sla_sum_max": -31.53333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4561.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [260.06081208687567, 306.7396631027459, 284.882107283196, 288.79986292607265, 304.36372719242263, 326.07530841634053, 272.9443875841496, 300.35809802309063, 330.9018885741277, 319.4713881019844, 299.437476012064, 259.5526912181315, 287.74205123518965, 299.7455329129745, 306.84651375308556, 289.39273508178877, 286.5911998537889, 278.4146516799183, 313.8451064607527, 309.6027749855323, 287.2511438057828, 307.15783605958285, 280.5204849370996, 305.5862682384491, 297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28453301154638777, "mean_inference_ms": 2.3956884704664962, "mean_action_processing_ms": 0.10606265756007882, "mean_env_wait_ms": 2.058243628858359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00637364387512207, "StateBufferConnector_ms": 0.003674030303955078, "ViewRequirementAgentConnector_ms": 0.09274029731750488}, "num_episodes": 21, "episode_return_max": 369.6464071400301, "episode_return_min": 256.95877120838406, "episode_return_mean": 314.3801311645205, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237750, "num_agent_steps_trained": 237600, "num_env_steps_sampled": 237750, "num_env_steps_trained": 237600, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 197.67806933644758, "num_env_steps_trained_throughput_per_sec": 207.09131073342127, "timesteps_total": 237750, "num_env_steps_sampled_lifetime": 237750, "num_agent_steps_sampled_lifetime": 237750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 237750, "timers": {"training_iteration_time_ms": 10414.636, "restore_workers_time_ms": 0.015, "training_step_time_ms": 765.99, "sample_time_ms": 748.014, "synch_weights_time_ms": 16.466}, "counters": {"num_env_steps_sampled": 237750, "num_env_steps_trained": 237600, "num_agent_steps_sampled": 237750, "num_agent_steps_trained": 237600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1585, "num_samples_added_to_queue": 237600}, "done": false, "training_iteration": 115, "trial_id": "13390_00000", "date": "2024-10-13_00-58-27", "timestamp": 1728777507, "time_this_iter_s": 10.6365647315979, "time_total_s": 1196.1365416049957, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b53c10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1196.1365416049957, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 19.737499999999997, "ram_util_percent": 66.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 351145.21875, "policy_loss": 344446.84375, "entropy": 14.783343315124512, "entropy_coeff": 0.01, "var_gnorm": 16.403303146362305, "vf_loss": 677970.0, "vf_explained_var": -0.17832553386688232}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 436.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 239800, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 239800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1600, "num_samples_added_to_queue": 239800, "learner_queue": {"size_count": 436, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.527, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 2620.513, "learner_dequeue_time_ms": 21828.97}}, "env_runners": {"episode_reward_max": 369.6464071400301, "episode_reward_min": 256.95877120838406, "episode_reward_mean": 321.7433145389761, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 256.95877120838406}, "policy_reward_max": {"default_policy": 369.6464071400301}, "policy_reward_mean": {"default_policy": 321.7433145389761}, "custom_metrics": {"num_consolidated_mean": 1.5521999999999998, "num_consolidated_min": 1.37, "num_consolidated_max": 1.73, "num_overloaded_mean": 0.0711, "num_overloaded_min": 0.01, "num_overloaded_max": 0.13, "num_moves_mean": 5.1857, "num_moves_min": 4.63, "num_moves_max": 5.63, "mean_accuracy_mean": 41.934923333333344, "mean_accuracy_min": 41.77133333333334, "mean_accuracy_max": 42.107000000000006, "num_model_switches_mean": 1.8997, "num_model_switches_min": 1.46, "num_model_switches_max": 2.31, "num_slav_mean": 0.0167225, "num_slav_min": 0.007316666666666667, "num_slav_max": 0.028600000000000004, "cpu_conserved_cost_mean": 3.4337999999999993, "cpu_conserved_cost_min": 2.88, "cpu_conserved_cost_max": 4.0, "mean_cluster_cpu_util_mean": 0.47486765136661724, "mean_cluster_cpu_util_min": 0.46674820323224514, "mean_cluster_cpu_util_max": 0.484069334187603, "mean_cluster_mem_util_mean": 0.3070224054579638, "mean_cluster_mem_util_min": 0.30250165870145523, "mean_cluster_mem_util_max": 0.3135580150836706, "reward_consolidation_mean_mean": -1.7326868546102534, "reward_consolidation_mean_min": -1.9539334125316035, "reward_consolidation_mean_max": -1.5888548234792415, "reward_illegal_mean_mean": -0.1185, "reward_illegal_mean_min": -0.21666666666666665, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.675333333333348, "reward_accuracy_mean_min": 5.191666666666679, "reward_accuracy_mean_max": 6.083333333333352, "reward_sla_mean_mean": -0.6067133333333333, "reward_sla_mean_min": -1.0153333333333334, "reward_sla_mean_max": -0.29266666666666663, "reward_consolidation_sum_mean": -173.26868546102534, "reward_consolidation_sum_min": -195.39334125316034, "reward_consolidation_sum_max": -158.88548234792415, "reward_illegal_sum_mean": -11.85, "reward_illegal_sum_min": -21.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 567.5333333333349, "reward_accuracy_sum_min": 519.1666666666679, "reward_accuracy_sum_max": 608.3333333333352, "reward_sla_sum_mean": -60.67133333333335, "reward_sla_sum_min": -101.53333333333333, "reward_sla_sum_max": -29.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3491.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [297.5394316001111, 335.22169727984556, 294.1522586737349, 307.8764110999434, 292.14785098541034, 307.47767218008613, 311.8310091687243, 270.2610770964708, 300.642742697007, 335.86343172195456, 306.0733254135078, 302.43163970879533, 324.5706570410322, 290.08197020926764, 324.25175911541766, 299.5390203783255, 326.8290048432801, 280.2255018428841, 301.89534862469293, 326.647336196657, 324.0639130037479, 305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28434577804025, "mean_inference_ms": 2.3953936019233937, "mean_action_processing_ms": 0.10600450550527592, "mean_env_wait_ms": 2.057523978136193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063283443450927734, "StateBufferConnector_ms": 0.0036563873291015625, "ViewRequirementAgentConnector_ms": 0.09145474433898926}, "num_episodes": 24, "episode_return_max": 369.6464071400301, "episode_return_min": 256.95877120838406, "episode_return_mean": 321.7433145389761, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 239800, "num_env_steps_sampled": 240000, "num_env_steps_trained": 239800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 212.27778916712026, "num_env_steps_trained_throughput_per_sec": 207.56050496340646, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 10432.42, "restore_workers_time_ms": 0.014, "training_step_time_ms": 707.868, "sample_time_ms": 691.866, "synch_weights_time_ms": 14.56}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 239800, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 239800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1600, "num_samples_added_to_queue": 239800}, "done": false, "training_iteration": 116, "trial_id": "13390_00000", "date": "2024-10-13_00-58-37", "timestamp": 1728777517, "time_this_iter_s": 10.616077423095703, "time_total_s": 1206.7526190280914, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b53760>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1206.7526190280914, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.1, "ram_util_percent": 67.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 342200.125, "policy_loss": 336071.09375, "entropy": 15.369437217712402, "entropy_coeff": 0.01, "var_gnorm": 16.400043487548828, "vf_loss": 621357.4375, "vf_explained_var": -0.15600860118865967}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 440.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 242250, "num_env_steps_trained": 242000, "num_agent_steps_sampled": 242250, "num_agent_steps_trained": 242000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1615, "num_samples_added_to_queue": 242000, "learner_queue": {"size_count": 440, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.605, "learner_load_time_ms": 0.355, "learner_load_wait_time_ms": 2619.572, "learner_dequeue_time_ms": 21828.97}}, "env_runners": {"episode_reward_max": 369.6464071400301, "episode_reward_min": 256.95877120838406, "episode_reward_mean": 324.6223947119938, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 256.95877120838406}, "policy_reward_max": {"default_policy": 369.6464071400301}, "policy_reward_mean": {"default_policy": 324.6223947119938}, "custom_metrics": {"num_consolidated_mean": 1.5651, "num_consolidated_min": 1.37, "num_consolidated_max": 1.73, "num_overloaded_mean": 0.0698, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 5.2104, "num_moves_min": 4.63, "num_moves_max": 5.81, "mean_accuracy_mean": 41.93321333333334, "mean_accuracy_min": 41.77133333333334, "mean_accuracy_max": 42.107000000000006, "num_model_switches_mean": 1.8813000000000002, "num_model_switches_min": 1.46, "num_model_switches_max": 2.32, "num_slav_mean": 0.016259166666666665, "num_slav_min": 0.007316666666666667, "num_slav_max": 0.028600000000000004, "cpu_conserved_cost_mean": 3.4856, "cpu_conserved_cost_min": 2.88, "cpu_conserved_cost_max": 4.0, "mean_cluster_cpu_util_mean": 0.47541928433017583, "mean_cluster_cpu_util_min": 0.46685416247510064, "mean_cluster_cpu_util_max": 0.4848940512360594, "mean_cluster_mem_util_mean": 0.30766000206664945, "mean_cluster_mem_util_min": 0.30250165870145523, "mean_cluster_mem_util_max": 0.31549194760182553, "reward_consolidation_mean_mean": -1.7271493862134095, "reward_consolidation_mean_min": -1.8612025952663809, "reward_consolidation_mean_max": -1.5192658929604923, "reward_illegal_mean_mean": -0.11633333333333333, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.678500000000015, "reward_accuracy_mean_min": 5.133333333333346, "reward_accuracy_mean_max": 6.083333333333352, "reward_sla_mean_mean": -0.5887933333333334, "reward_sla_mean_min": -1.0153333333333334, "reward_sla_mean_max": -0.29266666666666663, "reward_consolidation_sum_mean": -172.71493862134096, "reward_consolidation_sum_min": -186.12025952663808, "reward_consolidation_sum_max": -151.92658929604923, "reward_illegal_sum_mean": -11.633333333333333, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 567.8500000000015, "reward_accuracy_sum_min": 513.3333333333346, "reward_accuracy_sum_max": 608.3333333333352, "reward_sla_sum_mean": -58.879333333333335, "reward_sla_sum_min": -101.53333333333333, "reward_sla_sum_max": -29.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2549.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [305.48966767187704, 309.08103810655354, 295.67540589113406, 310.8246184775669, 314.6110390203797, 256.95877120838406, 313.1948460202884, 308.41401504767254, 305.37154345243664, 311.62603186207434, 306.40939717932434, 350.0787383106413, 321.09170855036854, 348.57370617442047, 334.745919766062, 327.6255475341938, 328.87436717536457, 334.1468701452999, 351.01919644217173, 317.3094581010707, 324.5549788296947, 278.5372079563814, 337.57462304669787, 346.34994060129924, 345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2842006987743808, "mean_inference_ms": 2.3929323151989417, "mean_action_processing_ms": 0.10593710643015886, "mean_env_wait_ms": 2.056600697876705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006782054901123047, "StateBufferConnector_ms": 0.0036606788635253906, "ViewRequirementAgentConnector_ms": 0.09151983261108398}, "num_episodes": 21, "episode_return_max": 369.6464071400301, "episode_return_min": 256.95877120838406, "episode_return_mean": 324.6223947119938, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242250, "num_agent_steps_trained": 242000, "num_env_steps_sampled": 242250, "num_env_steps_trained": 242000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.1310609869291, "num_env_steps_trained_throughput_per_sec": 208.39481518721956, "timesteps_total": 242250, "num_env_steps_sampled_lifetime": 242250, "num_agent_steps_sampled_lifetime": 242250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 242250, "timers": {"training_iteration_time_ms": 10415.567, "restore_workers_time_ms": 0.015, "training_step_time_ms": 706.855, "sample_time_ms": 690.159, "synch_weights_time_ms": 15.12}, "counters": {"num_env_steps_sampled": 242250, "num_env_steps_trained": 242000, "num_agent_steps_sampled": 242250, "num_agent_steps_trained": 242000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1615, "num_samples_added_to_queue": 242000}, "done": false, "training_iteration": 117, "trial_id": "13390_00000", "date": "2024-10-13_00-58-48", "timestamp": 1728777528, "time_this_iter_s": 10.568393230438232, "time_total_s": 1217.3210122585297, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c8070>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1217.3210122585297, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 16.573333333333334, "ram_util_percent": 67.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 345258.34375, "policy_loss": 338714.40625, "entropy": 15.157155990600586, "entropy_coeff": 0.01, "var_gnorm": 16.40018653869629, "vf_loss": 662730.75, "vf_explained_var": -0.15234315395355225}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 444.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 244500, "num_env_steps_trained": 244200, "num_agent_steps_sampled": 244500, "num_agent_steps_trained": 244200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1630, "num_samples_added_to_queue": 244200, "learner_queue": {"size_count": 444, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.742, "learner_load_time_ms": 0.366, "learner_load_wait_time_ms": 2450.911, "learner_dequeue_time_ms": 21674.824}}, "env_runners": {"episode_reward_max": 369.6464071400301, "episode_reward_min": 277.4050656431827, "episode_reward_mean": 325.20475360199964, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 277.4050656431827}, "policy_reward_max": {"default_policy": 369.6464071400301}, "policy_reward_mean": {"default_policy": 325.20475360199964}, "custom_metrics": {"num_consolidated_mean": 1.5831000000000004, "num_consolidated_min": 1.39, "num_consolidated_max": 1.73, "num_overloaded_mean": 0.0707, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 5.242000000000001, "num_moves_min": 4.63, "num_moves_max": 5.81, "mean_accuracy_mean": 41.93220000000002, "mean_accuracy_min": 41.80933333333334, "mean_accuracy_max": 42.08166666666668, "num_model_switches_mean": 1.8797, "num_model_switches_min": 1.46, "num_model_switches_max": 2.34, "num_slav_mean": 0.016312, "num_slav_min": 0.007316666666666667, "num_slav_max": 0.028600000000000004, "cpu_conserved_cost_mean": 3.556800000000001, "cpu_conserved_cost_min": 3.16, "cpu_conserved_cost_max": 4.0, "mean_cluster_cpu_util_mean": 0.47638235350979946, "mean_cluster_cpu_util_min": 0.46685416247510064, "mean_cluster_cpu_util_max": 0.4848940512360594, "mean_cluster_mem_util_mean": 0.3085725883636155, "mean_cluster_mem_util_min": 0.30257449750997445, "mean_cluster_mem_util_max": 0.3158167265851488, "reward_consolidation_mean_mean": -1.7137757973133512, "reward_consolidation_mean_min": -1.8612025952663809, "reward_consolidation_mean_max": -1.5192658929604923, "reward_illegal_mean_mean": -0.11783333333333332, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.670416666666681, "reward_accuracy_mean_min": 5.133333333333346, "reward_accuracy_mean_max": 6.075000000000016, "reward_sla_mean_mean": -0.58676, "reward_sla_mean_min": -1.0153333333333334, "reward_sla_mean_max": -0.29266666666666663, "reward_consolidation_sum_mean": -171.3775797313351, "reward_consolidation_sum_min": -186.12025952663808, "reward_consolidation_sum_max": -151.92658929604923, "reward_illegal_sum_mean": -11.78333333333333, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 567.0416666666682, "reward_accuracy_sum_min": 513.3333333333346, "reward_accuracy_sum_max": 607.5000000000016, "reward_sla_sum_mean": -58.676, "reward_sla_sum_min": -101.53333333333333, "reward_sla_sum_max": -29.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2027.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [345.077589935729, 325.54254774742003, 311.20248560723894, 294.96776630418356, 307.52853269974855, 282.8067988668568, 348.9718450150795, 330.96078771817736, 309.2774437235384, 367.7325504888987, 281.11806329769564, 347.32568156203496, 355.82704620914564, 315.7485576776645, 338.55448231746453, 368.88380395382273, 325.34146638642795, 336.35291662859186, 313.5977641719226, 368.7602546528999, 302.04298638399126, 343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28404155940597425, "mean_inference_ms": 2.3925650284500186, "mean_action_processing_ms": 0.1058788529832863, "mean_env_wait_ms": 2.055901782574008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070133209228515625, "StateBufferConnector_ms": 0.0037021636962890625, "ViewRequirementAgentConnector_ms": 0.09240579605102539}, "num_episodes": 24, "episode_return_max": 369.6464071400301, "episode_return_min": 277.4050656431827, "episode_return_mean": 325.20475360199964, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244500, "num_agent_steps_trained": 244200, "num_env_steps_sampled": 244500, "num_env_steps_trained": 244200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 215.4829654983495, "num_env_steps_trained_throughput_per_sec": 210.69445515394173, "timesteps_total": 244500, "num_env_steps_sampled_lifetime": 244500, "num_agent_steps_sampled_lifetime": 244500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 244500, "timers": {"training_iteration_time_ms": 10443.355, "restore_workers_time_ms": 0.014, "training_step_time_ms": 694.008, "sample_time_ms": 676.402, "synch_weights_time_ms": 15.802}, "counters": {"num_env_steps_sampled": 244500, "num_env_steps_trained": 244200, "num_agent_steps_sampled": 244500, "num_agent_steps_trained": 244200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1630, "num_samples_added_to_queue": 244200}, "done": false, "training_iteration": 118, "trial_id": "13390_00000", "date": "2024-10-13_00-58-58", "timestamp": 1728777538, "time_this_iter_s": 10.456977367401123, "time_total_s": 1227.7779896259308, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069c1c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1227.7779896259308, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 16.98, "ram_util_percent": 67.40666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 361480.5625, "policy_loss": 354216.78125, "entropy": 14.910555839538574, "entropy_coeff": 0.01, "var_gnorm": 16.40016746520996, "vf_loss": 734579.375, "vf_explained_var": -0.15469825267791748}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 448.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 246750, "num_env_steps_trained": 246400, "num_agent_steps_sampled": 246750, "num_agent_steps_trained": 246400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1645, "num_samples_added_to_queue": 246400, "learner_queue": {"size_count": 448, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.578, "learner_load_time_ms": 0.366, "learner_load_wait_time_ms": 2536.924, "learner_dequeue_time_ms": 21674.824}}, "env_runners": {"episode_reward_max": 371.33770446861155, "episode_reward_min": 277.4050656431827, "episode_reward_mean": 326.584895762894, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 277.4050656431827}, "policy_reward_max": {"default_policy": 371.33770446861155}, "policy_reward_mean": {"default_policy": 326.584895762894}, "custom_metrics": {"num_consolidated_mean": 1.5897999999999999, "num_consolidated_min": 1.44, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.06960000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 5.277699999999999, "num_moves_min": 4.78, "num_moves_max": 5.81, "mean_accuracy_mean": 41.927513333333344, "mean_accuracy_min": 41.80933333333334, "mean_accuracy_max": 42.08800000000001, "num_model_switches_mean": 1.8833999999999997, "num_model_switches_min": 1.42, "num_model_switches_max": 2.34, "num_slav_mean": 0.0160215, "num_slav_min": 0.007316666666666667, "num_slav_max": 0.026633333333333332, "cpu_conserved_cost_mean": 3.5862, "cpu_conserved_cost_min": 3.18, "cpu_conserved_cost_max": 3.94, "mean_cluster_cpu_util_mean": 0.4766355569229844, "mean_cluster_cpu_util_min": 0.46685416247510064, "mean_cluster_cpu_util_max": 0.4848940512360594, "mean_cluster_mem_util_mean": 0.30908596375111225, "mean_cluster_mem_util_min": 0.30257449750997445, "mean_cluster_mem_util_max": 0.3158167265851488, "reward_consolidation_mean_mean": -1.7114210423710747, "reward_consolidation_mean_min": -1.8612025952663809, "reward_consolidation_mean_max": -1.5192658929604923, "reward_illegal_mean_mean": -0.11599999999999998, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.669416666666681, "reward_accuracy_mean_min": 5.133333333333346, "reward_accuracy_mean_max": 6.075000000000018, "reward_sla_mean_mean": -0.5761466666666667, "reward_sla_mean_min": -0.9646666666666666, "reward_sla_mean_max": -0.272, "reward_consolidation_sum_mean": -171.14210423710745, "reward_consolidation_sum_min": -186.12025952663808, "reward_consolidation_sum_max": -151.92658929604923, "reward_illegal_sum_mean": -11.600000000000001, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 566.941666666668, "reward_accuracy_sum_min": 513.3333333333346, "reward_accuracy_sum_max": 607.5000000000018, "reward_sla_sum_mean": -57.614666666666665, "reward_sla_sum_min": -96.46666666666665, "reward_sla_sum_max": -27.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2571.0, "global_timestep_min": 600, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [343.6395717201268, 329.4544975479012, 338.2201986048933, 369.6464071400301, 356.35131743275906, 336.0858478784015, 359.45305979469504, 314.91226050138744, 300.55241707027477, 308.03076243565266, 309.01399677114904, 327.98658198544126, 363.02923025374054, 305.1229796825992, 349.9601449937566, 287.8606079990265, 302.73153309574, 327.00689329556326, 326.11336927716496, 343.8139998172363, 351.18883304395627, 312.33950470620647, 329.8025891742071, 351.14958725517255, 319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2838735449964599, "mean_inference_ms": 2.391083082383084, "mean_action_processing_ms": 0.10581774269078988, "mean_env_wait_ms": 2.0550431561359517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006968259811401367, "StateBufferConnector_ms": 0.003679513931274414, "ViewRequirementAgentConnector_ms": 0.0922849178314209}, "num_episodes": 21, "episode_return_max": 371.33770446861155, "episode_return_min": 277.4050656431827, "episode_return_mean": 326.584895762894, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246750, "num_agent_steps_trained": 246400, "num_env_steps_sampled": 246750, "num_env_steps_trained": 246400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 211.01826592787341, "num_env_steps_trained_throughput_per_sec": 206.32897112947623, "timesteps_total": 246750, "num_env_steps_sampled_lifetime": 246750, "num_agent_steps_sampled_lifetime": 246750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 246750, "timers": {"training_iteration_time_ms": 10473.798, "restore_workers_time_ms": 0.015, "training_step_time_ms": 704.71, "sample_time_ms": 688.076, "synch_weights_time_ms": 15.118}, "counters": {"num_env_steps_sampled": 246750, "num_env_steps_trained": 246400, "num_agent_steps_sampled": 246750, "num_agent_steps_trained": 246400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1645, "num_samples_added_to_queue": 246400}, "done": false, "training_iteration": 119, "trial_id": "13390_00000", "date": "2024-10-13_00-59-09", "timestamp": 1728777549, "time_this_iter_s": 10.672825813293457, "time_total_s": 1238.4508154392242, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c91e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1238.4508154392242, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.386666666666667, "ram_util_percent": 66.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 352242.375, "policy_loss": 345238.84375, "entropy": 14.795707702636719, "entropy_coeff": 0.01, "var_gnorm": 16.397844314575195, "vf_loss": 708489.625, "vf_explained_var": -0.14411985874176025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 452.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 249000, "num_env_steps_trained": 248600, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 248600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1660, "num_samples_added_to_queue": 248600, "learner_queue": {"size_count": 452, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.156, "learner_load_time_ms": 0.374, "learner_load_wait_time_ms": 2534.934, "learner_dequeue_time_ms": 21368.655}}, "env_runners": {"episode_reward_max": 385.0282098144949, "episode_reward_min": 277.4050656431827, "episode_reward_mean": 327.8555330652791, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 277.4050656431827}, "policy_reward_max": {"default_policy": 385.0282098144949}, "policy_reward_mean": {"default_policy": 327.8555330652791}, "custom_metrics": {"num_consolidated_mean": 1.5996000000000004, "num_consolidated_min": 1.44, "num_consolidated_max": 1.74, "num_overloaded_mean": 0.0713, "num_overloaded_min": 0.01, "num_overloaded_max": 0.16, "num_moves_mean": 5.307399999999999, "num_moves_min": 4.79, "num_moves_max": 5.81, "mean_accuracy_mean": 41.93125000000002, "mean_accuracy_min": 41.79666666666668, "mean_accuracy_max": 42.08800000000001, "num_model_switches_mean": 1.8809999999999996, "num_model_switches_min": 1.42, "num_model_switches_max": 2.34, "num_slav_mean": 0.015952, "num_slav_min": 0.0075, "num_slav_max": 0.025916666666666668, "cpu_conserved_cost_mean": 3.635, "cpu_conserved_cost_min": 3.18, "cpu_conserved_cost_max": 4.06, "mean_cluster_cpu_util_mean": 0.47776412811837027, "mean_cluster_cpu_util_min": 0.4692449669562896, "mean_cluster_cpu_util_max": 0.4863541042992606, "mean_cluster_mem_util_mean": 0.30989889983029073, "mean_cluster_mem_util_min": 0.30257449750997445, "mean_cluster_mem_util_max": 0.3158167265851488, "reward_consolidation_mean_mean": -1.6985446693472233, "reward_consolidation_mean_min": -1.8539221420085896, "reward_consolidation_mean_max": -1.4848373389381342, "reward_illegal_mean_mean": -0.11883333333333333, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.6596666666666815, "reward_accuracy_mean_min": 5.133333333333346, "reward_accuracy_mean_max": 6.075000000000018, "reward_sla_mean_mean": -0.5637333333333333, "reward_sla_mean_min": -0.9373333333333334, "reward_sla_mean_max": -0.23266666666666666, "reward_consolidation_sum_mean": -169.85446693472232, "reward_consolidation_sum_min": -185.39221420085897, "reward_consolidation_sum_max": -148.48373389381342, "reward_illegal_sum_mean": -11.883333333333333, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 565.9666666666682, "reward_accuracy_sum_min": 513.3333333333346, "reward_accuracy_sum_max": 607.5000000000018, "reward_sla_sum_mean": -56.37333333333333, "reward_sla_sum_min": -93.73333333333333, "reward_sla_sum_max": -23.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3366.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [319.61192238569697, 311.87655426604687, 319.7260653690351, 352.64171921167406, 306.1579274422018, 319.6744524658092, 317.4826677632595, 302.58142800572824, 350.1173322367432, 355.6121264735463, 363.6893661092341, 343.7641079533354, 338.6686192086281, 333.04601114868103, 313.59481860550255, 286.8067440372855, 337.8437174449435, 358.4681897103185, 338.8032532212387, 303.5886563708929, 329.7769106582608, 294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2836524092196299, "mean_inference_ms": 2.38918023041196, "mean_action_processing_ms": 0.10574392936671653, "mean_env_wait_ms": 2.0538765497231353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006955862045288086, "StateBufferConnector_ms": 0.0036563873291015625, "ViewRequirementAgentConnector_ms": 0.09311914443969727}, "num_episodes": 24, "episode_return_max": 385.0282098144949, "episode_return_min": 277.4050656431827, "episode_return_mean": 327.8555330652791, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 248600, "num_env_steps_sampled": 249000, "num_env_steps_trained": 248600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 215.0938070601724, "num_env_steps_trained_throughput_per_sec": 210.31394468105745, "timesteps_total": 249000, "num_env_steps_sampled_lifetime": 249000, "num_agent_steps_sampled_lifetime": 249000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 249000, "timers": {"training_iteration_time_ms": 10489.809, "restore_workers_time_ms": 0.014, "training_step_time_ms": 692.051, "sample_time_ms": 677.508, "synch_weights_time_ms": 13.19}, "counters": {"num_env_steps_sampled": 249000, "num_env_steps_trained": 248600, "num_agent_steps_sampled": 249000, "num_agent_steps_trained": 248600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1660, "num_samples_added_to_queue": 248600}, "done": false, "training_iteration": 120, "trial_id": "13390_00000", "date": "2024-10-13_00-59-20", "timestamp": 1728777560, "time_this_iter_s": 10.472151041030884, "time_total_s": 1248.9229664802551, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2cb010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1248.9229664802551, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 16.593333333333334, "ram_util_percent": 67.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 330208.15625, "policy_loss": 324049.96875, "entropy": 14.623472213745117, "entropy_coeff": 0.01, "var_gnorm": 16.39676284790039, "vf_loss": 623863.875, "vf_explained_var": -0.14524078369140625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 456.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 251250, "num_env_steps_trained": 250800, "num_agent_steps_sampled": 251250, "num_agent_steps_trained": 250800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1675, "num_samples_added_to_queue": 250800, "learner_queue": {"size_count": 456, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.821, "learner_load_time_ms": 0.374, "learner_load_wait_time_ms": 2463.675, "learner_dequeue_time_ms": 21368.655}}, "env_runners": {"episode_reward_max": 385.0282098144949, "episode_reward_min": 277.4050656431827, "episode_reward_mean": 329.23383100307797, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 277.4050656431827}, "policy_reward_max": {"default_policy": 385.0282098144949}, "policy_reward_mean": {"default_policy": 329.23383100307797}, "custom_metrics": {"num_consolidated_mean": 1.6119000000000006, "num_consolidated_min": 1.44, "num_consolidated_max": 1.79, "num_overloaded_mean": 0.0708, "num_overloaded_min": 0.01, "num_overloaded_max": 0.16, "num_moves_mean": 5.2936999999999985, "num_moves_min": 4.79, "num_moves_max": 5.81, "mean_accuracy_mean": 41.93207333333335, "mean_accuracy_min": 41.79666666666668, "mean_accuracy_max": 42.08800000000001, "num_model_switches_mean": 1.8756, "num_model_switches_min": 1.42, "num_model_switches_max": 2.34, "num_slav_mean": 0.015887166666666664, "num_slav_min": 0.0075, "num_slav_max": 0.025916666666666668, "cpu_conserved_cost_mean": 3.6642, "cpu_conserved_cost_min": 3.2, "cpu_conserved_cost_max": 4.12, "mean_cluster_cpu_util_mean": 0.4779812337170759, "mean_cluster_cpu_util_min": 0.4691145365503364, "mean_cluster_cpu_util_max": 0.4868607500747813, "mean_cluster_mem_util_mean": 0.3099085567736588, "mean_cluster_mem_util_min": 0.3038769028603003, "mean_cluster_mem_util_max": 0.3158167265851488, "reward_consolidation_mean_mean": -1.690081689969235, "reward_consolidation_mean_min": -1.8506710530323804, "reward_consolidation_mean_max": -1.4848373389381342, "reward_illegal_mean_mean": -0.118, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.666500000000014, "reward_accuracy_mean_min": 5.241666666666682, "reward_accuracy_mean_max": 6.075000000000018, "reward_sla_mean_mean": -0.56608, "reward_sla_mean_min": -0.9373333333333334, "reward_sla_mean_max": -0.23266666666666666, "reward_consolidation_sum_mean": -169.00816899692344, "reward_consolidation_sum_min": -185.06710530323804, "reward_consolidation_sum_max": -148.48373389381342, "reward_illegal_sum_mean": -11.8, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 566.6500000000015, "reward_accuracy_sum_min": 524.1666666666682, "reward_accuracy_sum_max": 607.5000000000018, "reward_sla_sum_mean": -56.60799999999999, "reward_sla_sum_min": -93.73333333333333, "reward_sla_sum_max": -23.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4071.0, "global_timestep_min": 2100, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [294.38531176703657, 309.98686527155985, 349.1662280300967, 312.2331962594062, 347.7929939992095, 288.110009442872, 329.3096073593483, 290.81542234000545, 277.4050656431827, 300.2759816016341, 311.3271741448123, 311.5326327332556, 303.4374029059686, 330.25371774955204, 313.2457613695223, 310.4733010448092, 361.82627859514605, 311.24554205123684, 308.83409485515995, 309.8084193853009, 354.9214566389489, 304.24207255780084, 309.7929787687729, 346.6442413719591, 297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2834780370666926, "mean_inference_ms": 2.3875776193704947, "mean_action_processing_ms": 0.10567572766300065, "mean_env_wait_ms": 2.0529806703142333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006764650344848633, "StateBufferConnector_ms": 0.003692150115966797, "ViewRequirementAgentConnector_ms": 0.09333062171936035}, "num_episodes": 21, "episode_return_max": 385.0282098144949, "episode_return_min": 277.4050656431827, "episode_return_mean": 329.23383100307797, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251250, "num_agent_steps_trained": 250800, "num_env_steps_sampled": 251250, "num_env_steps_trained": 250800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.05931749696282, "num_env_steps_trained_throughput_per_sec": 208.3246659970303, "timesteps_total": 251250, "num_env_steps_sampled_lifetime": 251250, "num_agent_steps_sampled_lifetime": 251250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 251250, "timers": {"training_iteration_time_ms": 10498.841, "restore_workers_time_ms": 0.014, "training_step_time_ms": 702.118, "sample_time_ms": 687.174, "synch_weights_time_ms": 13.524}, "counters": {"num_env_steps_sampled": 251250, "num_env_steps_trained": 250800, "num_agent_steps_sampled": 251250, "num_agent_steps_trained": 250800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1675, "num_samples_added_to_queue": 250800}, "done": false, "training_iteration": 121, "trial_id": "13390_00000", "date": "2024-10-13_00-59-30", "timestamp": 1728777570, "time_this_iter_s": 10.571074485778809, "time_total_s": 1259.494040966034, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c9210>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1259.494040966034, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 16.546666666666667, "ram_util_percent": 67.12666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 365188.9375, "policy_loss": 357413.3125, "entropy": 14.509246826171875, "entropy_coeff": 0.01, "var_gnorm": 16.395658493041992, "vf_loss": 785544.125, "vf_explained_var": -0.13789701461791992}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 460.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 253500, "num_env_steps_trained": 253000, "num_agent_steps_sampled": 253500, "num_agent_steps_trained": 253000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1690, "num_samples_added_to_queue": 253000, "learner_queue": {"size_count": 460, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.619, "learner_load_time_ms": 0.388, "learner_load_wait_time_ms": 2505.653, "learner_dequeue_time_ms": 21219.602}}, "env_runners": {"episode_reward_max": 387.055173779282, "episode_reward_min": 291.1495994395213, "episode_reward_mean": 337.32658862591137, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 291.1495994395213}, "policy_reward_max": {"default_policy": 387.055173779282}, "policy_reward_mean": {"default_policy": 337.32658862591137}, "custom_metrics": {"num_consolidated_mean": 1.6382000000000003, "num_consolidated_min": 1.44, "num_consolidated_max": 1.8, "num_overloaded_mean": 0.0674, "num_overloaded_min": 0.01, "num_overloaded_max": 0.16, "num_moves_mean": 5.2231, "num_moves_min": 4.74, "num_moves_max": 5.76, "mean_accuracy_mean": 41.937456666666684, "mean_accuracy_min": 41.79666666666668, "mean_accuracy_max": 42.08800000000001, "num_model_switches_mean": 1.8255999999999997, "num_model_switches_min": 1.37, "num_model_switches_max": 2.23, "num_slav_mean": 0.014905999999999999, "num_slav_min": 0.0066166666666666665, "num_slav_max": 0.02326666666666666, "cpu_conserved_cost_mean": 3.7282000000000006, "cpu_conserved_cost_min": 3.2, "cpu_conserved_cost_max": 4.26, "mean_cluster_cpu_util_mean": 0.478195348610728, "mean_cluster_cpu_util_min": 0.4691145365503364, "mean_cluster_cpu_util_max": 0.4882933099242707, "mean_cluster_mem_util_mean": 0.30972827523213925, "mean_cluster_mem_util_min": 0.30379394267200555, "mean_cluster_mem_util_max": 0.3158167265851488, "reward_consolidation_mean_mean": -1.6754374470742335, "reward_consolidation_mean_min": -1.8446899083127726, "reward_consolidation_mean_max": -1.4848373389381342, "reward_illegal_mean_mean": -0.11233333333333333, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.694916666666682, "reward_accuracy_mean_min": 5.241666666666682, "reward_accuracy_mean_max": 6.075000000000018, "reward_sla_mean_mean": -0.5338799999999999, "reward_sla_mean_min": -0.866, "reward_sla_mean_max": -0.23133333333333334, "reward_consolidation_sum_mean": -167.54374470742334, "reward_consolidation_sum_min": -184.46899083127727, "reward_consolidation_sum_max": -148.48373389381342, "reward_illegal_sum_mean": -11.23333333333333, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 569.4916666666683, "reward_accuracy_sum_min": 524.1666666666682, "reward_accuracy_sum_max": 607.5000000000018, "reward_sla_sum_mean": -53.388000000000005, "reward_sla_sum_min": -86.6, "reward_sla_sum_max": -23.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4866.0, "global_timestep_min": 2800, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [297.61124920040345, 325.8502421639416, 347.34177099515836, 344.4440068232369, 323.4133449084666, 317.25138140059255, 298.821258643274, 308.39578421517695, 350.0454537147049, 295.6149593347358, 364.3492460933945, 345.1692527947866, 293.0755917024596, 335.03945292272203, 336.85219775198897, 344.98698406896494, 350.79135215815427, 336.119778244846, 304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28325359958823637, "mean_inference_ms": 2.3857397482649616, "mean_action_processing_ms": 0.10560217176608809, "mean_env_wait_ms": 2.051864049156476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006501436233520508, "StateBufferConnector_ms": 0.0036923885345458984, "ViewRequirementAgentConnector_ms": 0.09337544441223145}, "num_episodes": 24, "episode_return_max": 387.055173779282, "episode_return_min": 291.1495994395213, "episode_return_mean": 337.32658862591137, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253500, "num_agent_steps_trained": 253000, "num_env_steps_sampled": 253500, "num_env_steps_trained": 253000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 216.79143627809097, "num_env_steps_trained_throughput_per_sec": 211.9738488052445, "timesteps_total": 253500, "num_env_steps_sampled_lifetime": 253500, "num_agent_steps_sampled_lifetime": 253500, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 253500, "timers": {"training_iteration_time_ms": 10534.665, "restore_workers_time_ms": 0.013, "training_step_time_ms": 683.559, "sample_time_ms": 667.937, "synch_weights_time_ms": 14.052}, "counters": {"num_env_steps_sampled": 253500, "num_env_steps_trained": 253000, "num_agent_steps_sampled": 253500, "num_agent_steps_trained": 253000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1690, "num_samples_added_to_queue": 253000}, "done": false, "training_iteration": 122, "trial_id": "13390_00000", "date": "2024-10-13_00-59-41", "timestamp": 1728777581, "time_this_iter_s": 10.39038348197937, "time_total_s": 1269.8844244480133, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2c9570>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1269.8844244480133, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 16.779999999999998, "ram_util_percent": 67.31333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 359779.5, "policy_loss": 351800.71875, "entropy": 14.387215614318848, "entropy_coeff": 0.01, "var_gnorm": 16.395709991455078, "vf_loss": 805789.125, "vf_explained_var": -0.10876965522766113}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 463.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 255300, "num_env_steps_trained": 254650, "num_agent_steps_sampled": 255300, "num_agent_steps_trained": 254650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1702, "num_samples_added_to_queue": 255200, "learner_queue": {"size_count": 463, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.245, "learner_load_time_ms": 0.388, "learner_load_wait_time_ms": 2720.656, "learner_dequeue_time_ms": 21219.602}}, "env_runners": {"episode_reward_max": 387.055173779282, "episode_reward_min": 291.1495994395213, "episode_reward_mean": 341.45937037375637, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 291.1495994395213}, "policy_reward_max": {"default_policy": 387.055173779282}, "policy_reward_mean": {"default_policy": 341.45937037375637}, "custom_metrics": {"num_consolidated_mean": 1.652, "num_consolidated_min": 1.44, "num_consolidated_max": 1.81, "num_overloaded_mean": 0.0667, "num_overloaded_min": 0.01, "num_overloaded_max": 0.16, "num_moves_mean": 5.1869000000000005, "num_moves_min": 4.74, "num_moves_max": 5.7, "mean_accuracy_mean": 41.945310000000006, "mean_accuracy_min": 41.79666666666668, "mean_accuracy_max": 42.08800000000001, "num_model_switches_mean": 1.7896999999999996, "num_model_switches_min": 1.37, "num_model_switches_max": 2.2, "num_slav_mean": 0.014508833333333334, "num_slav_min": 0.006383333333333333, "num_slav_max": 0.022016666666666667, "cpu_conserved_cost_mean": 3.7598, "cpu_conserved_cost_min": 3.2, "cpu_conserved_cost_max": 4.26, "mean_cluster_cpu_util_mean": 0.47859118251933, "mean_cluster_cpu_util_min": 0.4691145365503364, "mean_cluster_cpu_util_max": 0.4882933099242707, "mean_cluster_mem_util_mean": 0.30967353949776116, "mean_cluster_mem_util_min": 0.30379394267200555, "mean_cluster_mem_util_max": 0.31556823674617523, "reward_consolidation_mean_mean": -1.6638062962624514, "reward_consolidation_mean_min": -1.8446899083127726, "reward_consolidation_mean_max": -1.4848373389381342, "reward_illegal_mean_mean": -0.11116666666666665, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.708666666666682, "reward_accuracy_mean_min": 5.241666666666682, "reward_accuracy_mean_max": 6.075000000000018, "reward_sla_mean_mean": -0.5191, "reward_sla_mean_min": -0.7466666666666666, "reward_sla_mean_max": -0.23133333333333334, "reward_consolidation_sum_mean": -166.38062962624514, "reward_consolidation_sum_min": -184.46899083127727, "reward_consolidation_sum_max": -148.48373389381342, "reward_illegal_sum_mean": -11.116666666666667, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 570.8666666666683, "reward_accuracy_sum_min": 524.1666666666682, "reward_accuracy_sum_max": 607.5000000000018, "reward_sla_sum_mean": -51.90999999999999, "reward_sla_sum_min": -74.66666666666666, "reward_sla_sum_max": -23.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5469.0, "global_timestep_min": 3600, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [304.8793993115856, 338.66359316458136, 335.2330835541759, 320.82250753906726, 297.7776021200781, 349.43953516707955, 299.6749520241264, 318.2243138688367, 360.2188126351718, 331.42924243808955, 353.8866429071872, 371.33770446861155, 327.66434250205776, 315.48557982271893, 343.1810076456806, 331.4143470711885, 321.2942185263042, 364.9993603216683, 367.3568460812104, 342.91124615431636, 329.7012275731837, 310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28317230195384097, "mean_inference_ms": 2.384179916053525, "mean_action_processing_ms": 0.1055574438737342, "mean_env_wait_ms": 2.0515051188132447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006468534469604492, "StateBufferConnector_ms": 0.003708362579345703, "ViewRequirementAgentConnector_ms": 0.09387755393981934}, "num_episodes": 18, "episode_return_max": 387.055173779282, "episode_return_min": 291.1495994395213, "episode_return_mean": 341.45937037375637, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255300, "num_agent_steps_trained": 254650, "num_env_steps_sampled": 255300, "num_env_steps_trained": 254650, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 170.8660814990151, "num_env_steps_trained_throughput_per_sec": 156.62724137409717, "timesteps_total": 255300, "num_env_steps_sampled_lifetime": 255300, "num_agent_steps_sampled_lifetime": 255300, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 255300, "timers": {"training_iteration_time_ms": 10533.215, "restore_workers_time_ms": 0.016, "training_step_time_ms": 917.183, "sample_time_ms": 899.742, "synch_weights_time_ms": 15.627}, "counters": {"num_env_steps_sampled": 255300, "num_env_steps_trained": 254650, "num_agent_steps_sampled": 255300, "num_agent_steps_trained": 254650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1702, "num_samples_added_to_queue": 255200}, "done": false, "training_iteration": 123, "trial_id": "13390_00000", "date": "2024-10-13_00-59-51", "timestamp": 1728777591, "time_this_iter_s": 10.544885635375977, "time_total_s": 1280.4293100833893, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b6a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1280.4293100833893, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 30.240000000000002, "ram_util_percent": 69.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 330730.5625, "policy_loss": 324040.15625, "entropy": 14.25439453125, "entropy_coeff": 0.01, "var_gnorm": 16.39434051513672, "vf_loss": 676881.625, "vf_explained_var": -0.12562692165374756}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 468.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 257550, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257550, "num_agent_steps_trained": 257400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1717, "num_samples_added_to_queue": 257400, "learner_queue": {"size_count": 468, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.82, "learner_load_time_ms": 0.402, "learner_load_wait_time_ms": 2655.405, "learner_dequeue_time_ms": 21301.167}}, "env_runners": {"episode_reward_max": 396.5607999025265, "episode_reward_min": 291.1495994395213, "episode_reward_mean": 346.0456974626107, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 291.1495994395213}, "policy_reward_max": {"default_policy": 396.5607999025265}, "policy_reward_mean": {"default_policy": 346.0456974626107}, "custom_metrics": {"num_consolidated_mean": 1.6731000000000003, "num_consolidated_min": 1.5, "num_consolidated_max": 1.87, "num_overloaded_mean": 0.06740000000000002, "num_overloaded_min": 0.01, "num_overloaded_max": 0.16, "num_moves_mean": 5.1468, "num_moves_min": 4.74, "num_moves_max": 5.67, "mean_accuracy_mean": 41.95538000000001, "mean_accuracy_min": 41.80933333333335, "mean_accuracy_max": 42.08800000000001, "num_model_switches_mean": 1.7366, "num_model_switches_min": 1.18, "num_model_switches_max": 2.1, "num_slav_mean": 0.014051166666666663, "num_slav_min": 0.006383333333333333, "num_slav_max": 0.022016666666666667, "cpu_conserved_cost_mean": 3.8131999999999993, "cpu_conserved_cost_min": 3.4, "cpu_conserved_cost_max": 4.34, "mean_cluster_cpu_util_mean": 0.47919582532014865, "mean_cluster_cpu_util_min": 0.4691145365503364, "mean_cluster_cpu_util_max": 0.4882933099242707, "mean_cluster_mem_util_mean": 0.30965397973356007, "mean_cluster_mem_util_min": 0.30379394267200555, "mean_cluster_mem_util_max": 0.31556823674617523, "reward_consolidation_mean_mean": -1.6425896920405745, "reward_consolidation_mean_min": -1.8283185598099245, "reward_consolidation_mean_max": -1.4848373389381342, "reward_illegal_mean_mean": -0.11233333333333333, "reward_illegal_mean_min": -0.26666666666666666, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.720166666666682, "reward_accuracy_mean_min": 5.241666666666682, "reward_accuracy_mean_max": 6.091666666666684, "reward_sla_mean_mean": -0.5047866666666666, "reward_sla_mean_min": -0.7466666666666666, "reward_sla_mean_max": -0.20933333333333334, "reward_consolidation_sum_mean": -164.25896920405742, "reward_consolidation_sum_min": -182.83185598099246, "reward_consolidation_sum_max": -148.48373389381342, "reward_illegal_sum_mean": -11.23333333333333, "reward_illegal_sum_min": -26.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 572.0166666666682, "reward_accuracy_sum_min": 524.1666666666682, "reward_accuracy_sum_max": 609.1666666666683, "reward_sla_sum_mean": -50.47866666666667, "reward_sla_sum_min": -74.66666666666666, "reward_sla_sum_max": -20.933333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6162.0, "global_timestep_min": 4300, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [310.95394316001244, 329.6488805629183, 338.95118949709246, 362.72449968016235, 291.1495994395213, 339.5583995857335, 311.23495994395336, 351.83152700356544, 355.9634713210895, 335.9806999908631, 357.28214079015635, 322.5884096378214, 318.7534314173458, 321.60871180968195, 320.92801486490754, 385.0282098144949, 342.0931249809631, 345.53042127387516, 358.07433976057905, 334.9690091078021, 350.34311127357057, 322.27036766273864, 356.0194523135048, 322.4075146973727, 328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2830660599698896, "mean_inference_ms": 2.382527364776139, "mean_action_processing_ms": 0.10551047591980107, "mean_env_wait_ms": 2.050979014757563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006486415863037109, "StateBufferConnector_ms": 0.003720521926879883, "ViewRequirementAgentConnector_ms": 0.0938105583190918}, "num_episodes": 21, "episode_return_max": 396.5607999025265, "episode_return_min": 291.1495994395213, "episode_return_mean": 346.0456974626107, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257550, "num_agent_steps_trained": 257400, "num_env_steps_sampled": 257550, "num_env_steps_trained": 257400, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2750, "num_env_steps_sampled_throughput_per_sec": 212.07760311361696, "num_env_steps_trained_throughput_per_sec": 259.20595936108737, "timesteps_total": 257550, "num_env_steps_sampled_lifetime": 257550, "num_agent_steps_sampled_lifetime": 257550, "num_steps_trained_this_iter": 2750, "agent_timesteps_total": 257550, "timers": {"training_iteration_time_ms": 10542.739, "restore_workers_time_ms": 0.016, "training_step_time_ms": 713.979, "sample_time_ms": 697.037, "synch_weights_time_ms": 15.334}, "counters": {"num_env_steps_sampled": 257550, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257550, "num_agent_steps_trained": 257400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1717, "num_samples_added_to_queue": 257400}, "done": false, "training_iteration": 124, "trial_id": "13390_00000", "date": "2024-10-13_01-00-02", "timestamp": 1728777602, "time_this_iter_s": 10.620020389556885, "time_total_s": 1291.0493304729462, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16830>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1291.0493304729462, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 16.540000000000003, "ram_util_percent": 69.37333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 344546.53125, "policy_loss": 335895.125, "entropy": 13.306102752685547, "entropy_coeff": 0.01, "var_gnorm": 16.39523696899414, "vf_loss": 872459.6875, "vf_explained_var": -0.11737322807312012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 472.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 259800, "num_env_steps_trained": 259600, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1732, "num_samples_added_to_queue": 259600, "learner_queue": {"size_count": 472, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.883, "learner_load_time_ms": 0.402, "learner_load_wait_time_ms": 2740.392, "learner_dequeue_time_ms": 21301.167}}, "env_runners": {"episode_reward_max": 407.751670778886, "episode_reward_min": 298.1077614304438, "episode_reward_mean": 355.59562770721163, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 298.1077614304438}, "policy_reward_max": {"default_policy": 407.751670778886}, "policy_reward_mean": {"default_policy": 355.59562770721163}, "custom_metrics": {"num_consolidated_mean": 1.7025, "num_consolidated_min": 1.5, "num_consolidated_max": 1.9, "num_overloaded_mean": 0.063, "num_overloaded_min": 0.01, "num_overloaded_max": 0.12, "num_moves_mean": 5.0332, "num_moves_min": 4.38, "num_moves_max": 5.67, "mean_accuracy_mean": 41.966336666666685, "mean_accuracy_min": 41.847333333333346, "mean_accuracy_max": 42.10066666666668, "num_model_switches_mean": 1.6670000000000003, "num_model_switches_min": 1.18, "num_model_switches_max": 2.1, "num_slav_mean": 0.013007500000000003, "num_slav_min": 0.005416666666666666, "num_slav_max": 0.021199999999999997, "cpu_conserved_cost_mean": 3.8832, "cpu_conserved_cost_min": 3.44, "cpu_conserved_cost_max": 4.46, "mean_cluster_cpu_util_mean": 0.4792162678379117, "mean_cluster_cpu_util_min": 0.4691145365503364, "mean_cluster_cpu_util_max": 0.4882933099242707, "mean_cluster_mem_util_mean": 0.3094540015051379, "mean_cluster_mem_util_min": 0.30379394267200555, "mean_cluster_mem_util_max": 0.31556823674617523, "reward_consolidation_mean_mean": -1.628123722927899, "reward_consolidation_mean_min": -1.8283185598099245, "reward_consolidation_mean_max": -1.4639883944073842, "reward_illegal_mean_mean": -0.105, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.761500000000015, "reward_accuracy_mean_min": 5.383333333333347, "reward_accuracy_mean_max": 6.091666666666684, "reward_sla_mean_mean": -0.47241999999999995, "reward_sla_mean_min": -0.7426666666666667, "reward_sla_mean_max": -0.20933333333333334, "reward_consolidation_sum_mean": -162.81237229278995, "reward_consolidation_sum_min": -182.83185598099246, "reward_consolidation_sum_max": -146.3988394407384, "reward_illegal_sum_mean": -10.499999999999998, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 576.1500000000016, "reward_accuracy_sum_min": 538.3333333333347, "reward_accuracy_sum_max": 609.1666666666683, "reward_sla_sum_mean": -47.242, "reward_sla_sum_min": -74.26666666666667, "reward_sla_sum_max": -20.933333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5097.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [328.2034207560403, 321.63202960797, 298.1077614304438, 328.70422796917507, 327.13504523439764, 359.0870906820202, 343.70792287307114, 341.779950653387, 328.623128940877, 338.2370556520165, 331.615921898323, 309.64817082457745, 353.1733162752459, 356.3851746931081, 338.1228121477975, 362.9179536385529, 387.055173779282, 382.2039264065323, 328.8558957019721, 333.1435590484038, 366.3367388589371, 358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2829589673480975, "mean_inference_ms": 2.3830761937757132, "mean_action_processing_ms": 0.10547897887198361, "mean_env_wait_ms": 2.0507867722856843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006514072418212891, "StateBufferConnector_ms": 0.0037162303924560547, "ViewRequirementAgentConnector_ms": 0.09323525428771973}, "num_episodes": 24, "episode_return_max": 407.751670778886, "episode_return_min": 298.1077614304438, "episode_return_mean": 355.59562770721163, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259600, "num_env_steps_sampled": 259800, "num_env_steps_trained": 259600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 212.6927520064162, "num_env_steps_trained_throughput_per_sec": 207.96624640627363, "timesteps_total": 259800, "num_env_steps_sampled_lifetime": 259800, "num_agent_steps_sampled_lifetime": 259800, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 259800, "timers": {"training_iteration_time_ms": 10538.27, "restore_workers_time_ms": 0.013, "training_step_time_ms": 718.593, "sample_time_ms": 702.638, "synch_weights_time_ms": 14.469}, "counters": {"num_env_steps_sampled": 259800, "num_env_steps_trained": 259600, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1732, "num_samples_added_to_queue": 259600}, "done": false, "training_iteration": 125, "trial_id": "13390_00000", "date": "2024-10-13_01-00-13", "timestamp": 1728777613, "time_this_iter_s": 10.589492082595825, "time_total_s": 1301.638822555542, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b52290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1301.638822555542, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 16.925, "ram_util_percent": 69.49375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 328189.96875, "policy_loss": 319876.9375, "entropy": 13.005537986755371, "entropy_coeff": 0.01, "var_gnorm": 16.395599365234375, "vf_loss": 838457.75, "vf_explained_var": -0.11201810836791992}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 476.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 262050, "num_env_steps_trained": 261800, "num_agent_steps_sampled": 262050, "num_agent_steps_trained": 261800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1747, "num_samples_added_to_queue": 261800, "learner_queue": {"size_count": 476, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.223, "learner_load_time_ms": 0.414, "learner_load_wait_time_ms": 2523.077, "learner_dequeue_time_ms": 21347.516}}, "env_runners": {"episode_reward_max": 436.067638368517, "episode_reward_min": 315.3656705961207, "episode_reward_mean": 363.99011057297054, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 315.3656705961207}, "policy_reward_max": {"default_policy": 436.067638368517}, "policy_reward_mean": {"default_policy": 363.99011057297054}, "custom_metrics": {"num_consolidated_mean": 1.7294999999999998, "num_consolidated_min": 1.56, "num_consolidated_max": 1.9, "num_overloaded_mean": 0.059100000000000014, "num_overloaded_min": 0.01, "num_overloaded_max": 0.12, "num_moves_mean": 4.9159, "num_moves_min": 4.23, "num_moves_max": 5.67, "mean_accuracy_mean": 41.97628, "mean_accuracy_min": 41.87266666666668, "mean_accuracy_max": 42.10066666666668, "num_model_switches_mean": 1.6035000000000001, "num_model_switches_min": 1.08, "num_model_switches_max": 2.1, "num_slav_mean": 0.012156166666666666, "num_slav_min": 0.002916666666666667, "num_slav_max": 0.019266666666666668, "cpu_conserved_cost_mean": 3.9447999999999994, "cpu_conserved_cost_min": 3.44, "cpu_conserved_cost_max": 4.46, "mean_cluster_cpu_util_mean": 0.47915182879792795, "mean_cluster_cpu_util_min": 0.4704792344134476, "mean_cluster_cpu_util_max": 0.48617512689311126, "mean_cluster_mem_util_mean": 0.3091651791114125, "mean_cluster_mem_util_min": 0.30390175683142456, "mean_cluster_mem_util_max": 0.31556823674617523, "reward_consolidation_mean_mean": -1.6134488942703098, "reward_consolidation_mean_min": -1.8283185598099245, "reward_consolidation_mean_max": -1.4639883944073842, "reward_illegal_mean_mean": -0.09849999999999998, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.796250000000017, "reward_accuracy_mean_min": 5.458333333333348, "reward_accuracy_mean_max": 6.166666666666686, "reward_sla_mean_mean": -0.44439999999999996, "reward_sla_mean_min": -0.7406666666666666, "reward_sla_mean_max": -0.11666666666666668, "reward_consolidation_sum_mean": -161.344889427031, "reward_consolidation_sum_min": -182.83185598099246, "reward_consolidation_sum_max": -146.3988394407384, "reward_illegal_sum_mean": -9.85, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 579.6250000000017, "reward_accuracy_sum_min": 545.8333333333348, "reward_accuracy_sum_max": 616.6666666666686, "reward_sla_sum_mean": -44.44, "reward_sla_sum_min": -74.06666666666666, "reward_sla_sum_max": -11.666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4152.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [358.04994973956116, 343.2450942764031, 330.16687989277915, 315.3656705961207, 332.34759511407736, 341.470635718421, 350.76872277559625, 362.63421365256477, 317.82636693167757, 353.82453014103544, 345.3526089737746, 338.1014773523426, 373.54743062536323, 384.7658990526682, 347.8576258795591, 345.995583173415, 343.8706083036354, 367.1935209723127, 368.4673063450011, 347.7357062353423, 356.68402327210833, 339.1131530049665, 374.9690761217233, 354.23625757714353, 341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2828755611495039, "mean_inference_ms": 2.381413152776393, "mean_action_processing_ms": 0.10543860496909843, "mean_env_wait_ms": 2.0503073485537104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00652623176574707, "StateBufferConnector_ms": 0.0036950111389160156, "ViewRequirementAgentConnector_ms": 0.09309554100036621}, "num_episodes": 21, "episode_return_max": 436.067638368517, "episode_return_min": 315.3656705961207, "episode_return_mean": 363.99011057297054, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262050, "num_agent_steps_trained": 261800, "num_env_steps_sampled": 262050, "num_env_steps_trained": 261800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 215.58634435967718, "num_env_steps_trained_throughput_per_sec": 210.7955367072399, "timesteps_total": 262050, "num_env_steps_sampled_lifetime": 262050, "num_agent_steps_sampled_lifetime": 262050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 262050, "timers": {"training_iteration_time_ms": 10522.004, "restore_workers_time_ms": 0.013, "training_step_time_ms": 690.194, "sample_time_ms": 674.924, "synch_weights_time_ms": 13.739}, "counters": {"num_env_steps_sampled": 262050, "num_env_steps_trained": 261800, "num_agent_steps_sampled": 262050, "num_agent_steps_trained": 261800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1747, "num_samples_added_to_queue": 261800}, "done": false, "training_iteration": 126, "trial_id": "13390_00000", "date": "2024-10-13_01-00-23", "timestamp": 1728777623, "time_this_iter_s": 10.44883108139038, "time_total_s": 1312.0876536369324, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16020>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1312.0876536369324, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.006666666666668, "ram_util_percent": 68.17333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 331668.90625, "policy_loss": 323366.4375, "entropy": 13.145569801330566, "entropy_coeff": 0.01, "var_gnorm": 16.396526336669922, "vf_loss": 837477.875, "vf_explained_var": -0.10988569259643555}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 480.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 264300, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264300, "num_agent_steps_trained": 264000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1762, "num_samples_added_to_queue": 264000, "learner_queue": {"size_count": 480, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 73.69, "learner_load_time_ms": 0.414, "learner_load_wait_time_ms": 2481.663, "learner_dequeue_time_ms": 21347.516}}, "env_runners": {"episode_reward_max": 436.067638368517, "episode_reward_min": 321.6163513966324, "episode_reward_mean": 374.1239391087163, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 321.6163513966324}, "policy_reward_max": {"default_policy": 436.067638368517}, "policy_reward_mean": {"default_policy": 374.1239391087163}, "custom_metrics": {"num_consolidated_mean": 1.7658000000000007, "num_consolidated_min": 1.58, "num_consolidated_max": 1.92, "num_overloaded_mean": 0.056100000000000004, "num_overloaded_min": 0.01, "num_overloaded_max": 0.12, "num_moves_mean": 4.7813, "num_moves_min": 4.23, "num_moves_max": 5.67, "mean_accuracy_mean": 41.99268333333335, "mean_accuracy_min": 41.87266666666668, "mean_accuracy_max": 42.11966666666668, "num_model_switches_mean": 1.5220999999999998, "num_model_switches_min": 1.08, "num_model_switches_max": 1.98, "num_slav_mean": 0.0111195, "num_slav_min": 0.002916666666666667, "num_slav_max": 0.018483333333333334, "cpu_conserved_cost_mean": 4.0388, "cpu_conserved_cost_min": 3.44, "cpu_conserved_cost_max": 4.46, "mean_cluster_cpu_util_mean": 0.47945158599402515, "mean_cluster_cpu_util_min": 0.4704792344134476, "mean_cluster_cpu_util_max": 0.4898613013699039, "mean_cluster_mem_util_mean": 0.3091696364401246, "mean_cluster_mem_util_min": 0.30366593185797525, "mean_cluster_mem_util_max": 0.31522224877292687, "reward_consolidation_mean_mean": -1.5895739422461852, "reward_consolidation_mean_min": -1.7995216119894, "reward_consolidation_mean_max": -1.441016174723568, "reward_illegal_mean_mean": -0.0935, "reward_illegal_mean_min": -0.2, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.83533333333335, "reward_accuracy_mean_min": 5.500000000000015, "reward_accuracy_mean_max": 6.200000000000018, "reward_sla_mean_mean": -0.41101999999999994, "reward_sla_mean_min": -0.7393333333333334, "reward_sla_mean_max": -0.11666666666666668, "reward_consolidation_sum_mean": -158.9573942246185, "reward_consolidation_sum_min": -179.95216119894, "reward_consolidation_sum_max": -144.1016174723568, "reward_illegal_sum_mean": -9.35, "reward_illegal_sum_min": -20.0, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 583.533333333335, "reward_accuracy_sum_min": 550.0000000000015, "reward_accuracy_sum_max": 620.0000000000018, "reward_sla_sum_mean": -41.102000000000004, "reward_sla_sum_min": -73.93333333333334, "reward_sla_sum_max": -11.666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3092.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [341.30840415486443, 364.2548021566312, 345.3699625331279, 321.6163513966324, 336.1145054677282, 382.26979804441333, 339.0074842364998, 363.76049833988395, 346.80779189131687, 335.6722318681666, 332.5692619330485, 367.2947942368045, 378.2336988638109, 342.5543574278853, 365.05131438667195, 366.14457644156226, 361.75646532029776, 337.659767278932, 396.5607999025265, 378.3893782935833, 325.92193182856766, 340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28276554199366666, "mean_inference_ms": 2.3828528236776387, "mean_action_processing_ms": 0.1054121517820845, "mean_env_wait_ms": 2.0501348640376715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006475925445556641, "StateBufferConnector_ms": 0.003685474395751953, "ViewRequirementAgentConnector_ms": 0.09245657920837402}, "num_episodes": 24, "episode_return_max": 436.067638368517, "episode_return_min": 321.6163513966324, "episode_return_mean": 374.1239391087163, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264300, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264300, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 211.41127277499294, "num_env_steps_trained_throughput_per_sec": 206.7132444911042, "timesteps_total": 264300, "num_env_steps_sampled_lifetime": 264300, "num_agent_steps_sampled_lifetime": 264300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 264300, "timers": {"training_iteration_time_ms": 10530.592, "restore_workers_time_ms": 0.014, "training_step_time_ms": 708.796, "sample_time_ms": 693.128, "synch_weights_time_ms": 14.186}, "counters": {"num_env_steps_sampled": 264300, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264300, "num_agent_steps_trained": 264000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1762, "num_samples_added_to_queue": 264000}, "done": false, "training_iteration": 127, "trial_id": "13390_00000", "date": "2024-10-13_01-00-34", "timestamp": 1728777634, "time_this_iter_s": 10.65537405014038, "time_total_s": 1322.7430276870728, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c08d60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1322.7430276870728, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 16.66, "ram_util_percent": 67.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 335932.9375, "policy_loss": 327214.4375, "entropy": 13.055169105529785, "entropy_coeff": 0.01, "var_gnorm": 16.401845932006836, "vf_loss": 879030.75, "vf_explained_var": -0.09422969818115234}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 484.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 266550, "num_env_steps_trained": 266200, "num_agent_steps_sampled": 266550, "num_agent_steps_trained": 266200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1777, "num_samples_added_to_queue": 266200, "learner_queue": {"size_count": 484, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.166, "learner_load_time_ms": 0.396, "learner_load_wait_time_ms": 2512.227, "learner_dequeue_time_ms": 21116.528}}, "env_runners": {"episode_reward_max": 436.067638368517, "episode_reward_min": 323.5445916719989, "episode_reward_mean": 382.30666246306777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 323.5445916719989}, "policy_reward_max": {"default_policy": 436.067638368517}, "policy_reward_mean": {"default_policy": 382.30666246306777}, "custom_metrics": {"num_consolidated_mean": 1.7945999999999998, "num_consolidated_min": 1.58, "num_consolidated_max": 1.92, "num_overloaded_mean": 0.050499999999999996, "num_overloaded_min": 0.01, "num_overloaded_max": 0.1, "num_moves_mean": 4.6748, "num_moves_min": 4.17, "num_moves_max": 5.36, "mean_accuracy_mean": 41.99863666666668, "mean_accuracy_min": 41.87266666666668, "mean_accuracy_max": 42.11966666666668, "num_model_switches_mean": 1.4857, "num_model_switches_min": 1.08, "num_model_switches_max": 1.98, "num_slav_mean": 0.010528166666666665, "num_slav_min": 0.002916666666666667, "num_slav_max": 0.018483333333333334, "cpu_conserved_cost_mean": 4.1184, "cpu_conserved_cost_min": 3.52, "cpu_conserved_cost_max": 4.52, "mean_cluster_cpu_util_mean": 0.47953215772687213, "mean_cluster_cpu_util_min": 0.4704792344134476, "mean_cluster_cpu_util_max": 0.4898613013699039, "mean_cluster_mem_util_mean": 0.3093077955362525, "mean_cluster_mem_util_min": 0.30366593185797525, "mean_cluster_mem_util_max": 0.31522224877292687, "reward_consolidation_mean_mean": -1.5770967087026717, "reward_consolidation_mean_min": -1.7065093362575774, "reward_consolidation_mean_max": -1.441016174723568, "reward_illegal_mean_mean": -0.08416666666666668, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.874416666666682, "reward_accuracy_mean_min": 5.500000000000015, "reward_accuracy_mean_max": 6.200000000000018, "reward_sla_mean_mean": -0.3900866666666667, "reward_sla_mean_min": -0.7073333333333334, "reward_sla_mean_max": -0.11666666666666668, "reward_consolidation_sum_mean": -157.7096708702672, "reward_consolidation_sum_min": -170.65093362575774, "reward_consolidation_sum_max": -144.1016174723568, "reward_illegal_sum_mean": -8.416666666666666, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 587.4416666666684, "reward_accuracy_sum_min": 550.0000000000015, "reward_accuracy_sum_max": 620.0000000000018, "reward_sla_sum_mean": -39.00866666666667, "reward_sla_sum_min": -70.73333333333333, "reward_sla_sum_max": -11.666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2151.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [340.2479636906409, 350.4908221389641, 334.8992963538349, 377.842943738769, 383.023320844377, 350.7836303268464, 363.4815955405295, 338.71279052057776, 351.49037741021806, 341.11918730390977, 372.34576441560966, 388.751670778886, 348.6071187060236, 396.9410307959442, 402.8369338085245, 371.4778336227132, 386.66782722592984, 407.751670778886, 353.74906637424397, 387.5621371348521, 373.00525145450825, 370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28261351506384413, "mean_inference_ms": 2.3812195599008006, "mean_action_processing_ms": 0.1053546307870653, "mean_env_wait_ms": 2.0491605362391088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063936710357666016, "StateBufferConnector_ms": 0.003625631332397461, "ViewRequirementAgentConnector_ms": 0.0915076732635498}, "num_episodes": 21, "episode_return_max": 436.067638368517, "episode_return_min": 323.5445916719989, "episode_return_mean": 382.30666246306777, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266550, "num_agent_steps_trained": 266200, "num_env_steps_sampled": 266550, "num_env_steps_trained": 266200, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 219.66383871378983, "num_env_steps_trained_throughput_per_sec": 214.78242007570563, "timesteps_total": 266550, "num_env_steps_sampled_lifetime": 266550, "num_agent_steps_sampled_lifetime": 266550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 266550, "timers": {"training_iteration_time_ms": 10510.718, "restore_workers_time_ms": 0.014, "training_step_time_ms": 681.793, "sample_time_ms": 665.415, "synch_weights_time_ms": 14.874}, "counters": {"num_env_steps_sampled": 266550, "num_env_steps_trained": 266200, "num_agent_steps_sampled": 266550, "num_agent_steps_trained": 266200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1777, "num_samples_added_to_queue": 266200}, "done": false, "training_iteration": 128, "trial_id": "13390_00000", "date": "2024-10-13_01-00-44", "timestamp": 1728777644, "time_this_iter_s": 10.253774166107178, "time_total_s": 1332.99680185318, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b511b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1332.99680185318, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 16.585714285714285, "ram_util_percent": 68.0857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 324515.40625, "policy_loss": 316111.8125, "entropy": 12.70596981048584, "entropy_coeff": 0.01, "var_gnorm": 16.404491424560547, "vf_loss": 847345.4375, "vf_explained_var": -0.0957421064376831}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 488.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 268650, "num_env_steps_trained": 268400, "num_agent_steps_sampled": 268650, "num_agent_steps_trained": 268400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1791, "num_samples_added_to_queue": 268400, "learner_queue": {"size_count": 488, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 77.611, "learner_load_time_ms": 0.396, "learner_load_wait_time_ms": 2581.081, "learner_dequeue_time_ms": 21116.528}}, "env_runners": {"episode_reward_max": 436.067638368517, "episode_reward_min": 323.5445916719989, "episode_reward_mean": 387.6678151634241, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 323.5445916719989}, "policy_reward_max": {"default_policy": 436.067638368517}, "policy_reward_mean": {"default_policy": 387.6678151634241}, "custom_metrics": {"num_consolidated_mean": 1.8160999999999998, "num_consolidated_min": 1.66, "num_consolidated_max": 1.96, "num_overloaded_mean": 0.04750000000000001, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 4.590300000000001, "num_moves_min": 4.05, "num_moves_max": 5.05, "mean_accuracy_mean": 42.008263333333346, "mean_accuracy_min": 41.885333333333335, "mean_accuracy_max": 42.15133333333334, "num_model_switches_mean": 1.4494, "num_model_switches_min": 1.08, "num_model_switches_max": 1.98, "num_slav_mean": 0.010329166666666667, "num_slav_min": 0.002916666666666667, "num_slav_max": 0.01755, "cpu_conserved_cost_mean": 4.1942, "cpu_conserved_cost_min": 3.68, "cpu_conserved_cost_max": 4.7, "mean_cluster_cpu_util_mean": 0.48037053743074387, "mean_cluster_cpu_util_min": 0.4704792344134476, "mean_cluster_cpu_util_max": 0.4898613013699039, "mean_cluster_mem_util_mean": 0.3099706411528746, "mean_cluster_mem_util_min": 0.30366593185797525, "mean_cluster_mem_util_max": 0.31583594624558686, "reward_consolidation_mean_mean": -1.5653485150324413, "reward_consolidation_mean_min": -1.6933281549849222, "reward_consolidation_mean_max": -1.4042562977854949, "reward_illegal_mean_mean": -0.07916666666666665, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.905666666666682, "reward_accuracy_mean_min": 5.583333333333348, "reward_accuracy_mean_max": 6.2583333333333515, "reward_sla_mean_mean": -0.3844733333333334, "reward_sla_mean_min": -0.6693333333333333, "reward_sla_mean_max": -0.11666666666666668, "reward_consolidation_sum_mean": -156.53485150324414, "reward_consolidation_sum_min": -169.3328154984922, "reward_consolidation_sum_max": -140.42562977854948, "reward_illegal_sum_mean": -7.916666666666666, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 590.5666666666682, "reward_accuracy_sum_min": 558.3333333333348, "reward_accuracy_sum_max": 625.8333333333352, "reward_sla_sum_mean": -38.44733333333334, "reward_sla_sum_min": -66.93333333333334, "reward_sla_sum_max": -11.666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2067.0, "global_timestep_min": 100, "global_timestep_max": 3700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [370.7819884857915, 386.1305339791054, 388.281699107498, 390.63459745956465, 391.0219866581392, 323.5445916719989, 393.27578055987254, 370.3059520545876, 347.74585275214133, 364.83277589935875, 383.9420420969279, 368.26365713241495, 372.4286910962883, 364.669015199977, 368.7865545706554, 386.14450942764176, 368.83485333089783, 353.6451216911892, 410.090517530234, 344.46736422066004, 386.8868591793855, 360.108742270555, 381.85290749033027, 385.5952115507647, 362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2824959165928698, "mean_inference_ms": 2.378903634832257, "mean_action_processing_ms": 0.10530036004012054, "mean_env_wait_ms": 2.048380371730064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006438255310058594, "StateBufferConnector_ms": 0.003660440444946289, "ViewRequirementAgentConnector_ms": 0.09240841865539551}, "num_episodes": 21, "episode_return_max": 436.067638368517, "episode_return_min": 323.5445916719989, "episode_return_mean": 387.6678151634241, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268650, "num_agent_steps_trained": 268400, "num_env_steps_sampled": 268650, "num_env_steps_trained": 268400, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 197.18572777357375, "num_env_steps_trained_throughput_per_sec": 206.57552433422012, "timesteps_total": 268650, "num_env_steps_sampled_lifetime": 268650, "num_agent_steps_sampled_lifetime": 268650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 268650, "timers": {"training_iteration_time_ms": 10509.446, "restore_workers_time_ms": 0.017, "training_step_time_ms": 710.655, "sample_time_ms": 694.778, "synch_weights_time_ms": 14.197}, "counters": {"num_env_steps_sampled": 268650, "num_env_steps_trained": 268400, "num_agent_steps_sampled": 268650, "num_agent_steps_trained": 268400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1791, "num_samples_added_to_queue": 268400}, "done": false, "training_iteration": 129, "trial_id": "13390_00000", "date": "2024-10-13_01-00-55", "timestamp": 1728777655, "time_this_iter_s": 10.664147138595581, "time_total_s": 1343.6609489917755, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b52500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1343.6609489917755, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 21.325, "ram_util_percent": 70.11250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 331526.0625, "policy_loss": 322698.0, "entropy": 12.573202133178711, "entropy_coeff": 0.01, "var_gnorm": 16.404176712036133, "vf_loss": 889720.6875, "vf_explained_var": -0.09894609451293945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 492.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 270900, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270900, "num_agent_steps_trained": 270600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1806, "num_samples_added_to_queue": 270600, "learner_queue": {"size_count": 492, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.64, "learner_load_time_ms": 0.391, "learner_load_wait_time_ms": 2515.077, "learner_dequeue_time_ms": 21065.955}}, "env_runners": {"episode_reward_max": 436.067638368517, "episode_reward_min": 350.9658868683192, "episode_reward_mean": 395.1302304365059, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 350.9658868683192}, "policy_reward_max": {"default_policy": 436.067638368517}, "policy_reward_mean": {"default_policy": 395.1302304365059}, "custom_metrics": {"num_consolidated_mean": 1.845, "num_consolidated_min": 1.69, "num_consolidated_max": 2.01, "num_overloaded_mean": 0.0435, "num_overloaded_min": 0.01, "num_overloaded_max": 0.11, "num_moves_mean": 4.5111, "num_moves_min": 4.05, "num_moves_max": 4.9, "mean_accuracy_mean": 42.02061333333335, "mean_accuracy_min": 41.885333333333335, "mean_accuracy_max": 42.15133333333335, "num_model_switches_mean": 1.4062999999999999, "num_model_switches_min": 1.08, "num_model_switches_max": 1.98, "num_slav_mean": 0.010010000000000002, "num_slav_min": 0.002916666666666667, "num_slav_max": 0.015166666666666667, "cpu_conserved_cost_mean": 4.271999999999999, "cpu_conserved_cost_min": 3.76, "cpu_conserved_cost_max": 4.76, "mean_cluster_cpu_util_mean": 0.48046777579435535, "mean_cluster_cpu_util_min": 0.4704792344134476, "mean_cluster_cpu_util_max": 0.4898613013699039, "mean_cluster_mem_util_mean": 0.31005538631634094, "mean_cluster_mem_util_min": 0.30366593185797525, "mean_cluster_mem_util_max": 0.31583594624558686, "reward_consolidation_mean_mean": -1.5477810289682907, "reward_consolidation_mean_min": -1.7047349904048252, "reward_consolidation_mean_max": -1.3884955374821046, "reward_illegal_mean_mean": -0.0725, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 5.9454166666666834, "reward_accuracy_mean_min": 5.625000000000016, "reward_accuracy_mean_max": 6.2583333333333515, "reward_sla_mean_mean": -0.37383333333333324, "reward_sla_mean_min": -0.5546666666666666, "reward_sla_mean_max": -0.11666666666666668, "reward_consolidation_sum_mean": -154.77810289682904, "reward_consolidation_sum_min": -170.47349904048252, "reward_consolidation_sum_max": -138.84955374821047, "reward_illegal_sum_mean": -7.25, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 594.5416666666683, "reward_accuracy_sum_min": 562.5000000000016, "reward_accuracy_sum_max": 625.8333333333352, "reward_sla_sum_mean": -37.38333333333333, "reward_sla_sum_min": -55.46666666666667, "reward_sla_sum_max": -11.666666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2871.0, "global_timestep_min": 900, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [362.6795881689984, 401.53187121143054, 361.1814401900771, 401.20051783484274, 393.4693655000168, 384.56936550001666, 399.1750068536979, 371.0334003472555, 436.067638368517, 382.1347132108819, 377.76932894696927, 407.4794693715938, 407.0605135703203, 411.61950105090176, 399.069137043469, 398.3078375826268, 422.12926985287555, 377.30184592890606, 409.83674190502455, 384.3920222973605, 402.5793383898396, 416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28236316253938737, "mean_inference_ms": 2.37864940993299, "mean_action_processing_ms": 0.10525273682506192, "mean_env_wait_ms": 2.047795654544459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006491899490356445, "StateBufferConnector_ms": 0.003619670867919922, "ViewRequirementAgentConnector_ms": 0.09159469604492188}, "num_episodes": 24, "episode_return_max": 436.067638368517, "episode_return_min": 350.9658868683192, "episode_return_mean": 395.1302304365059, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270900, "num_agent_steps_trained": 270600, "num_env_steps_sampled": 270900, "num_env_steps_trained": 270600, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.49492844620687, "num_env_steps_trained_throughput_per_sec": 208.75059670295784, "timesteps_total": 270900, "num_env_steps_sampled_lifetime": 270900, "num_agent_steps_sampled_lifetime": 270900, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 270900, "timers": {"training_iteration_time_ms": 10517.279, "restore_workers_time_ms": 0.014, "training_step_time_ms": 704.789, "sample_time_ms": 688.324, "synch_weights_time_ms": 14.949}, "counters": {"num_env_steps_sampled": 270900, "num_env_steps_trained": 270600, "num_agent_steps_sampled": 270900, "num_agent_steps_trained": 270600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1806, "num_samples_added_to_queue": 270600}, "done": false, "training_iteration": 130, "trial_id": "13390_00000", "date": "2024-10-13_01-01-05", "timestamp": 1728777665, "time_this_iter_s": 10.549926996231079, "time_total_s": 1354.2108759880066, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1354.2108759880066, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 16.653333333333332, "ram_util_percent": 70.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 334210.9375, "policy_loss": 324532.6875, "entropy": 12.422816276550293, "entropy_coeff": 0.01, "var_gnorm": 16.404762268066406, "vf_loss": 974656.0625, "vf_explained_var": -0.08688628673553467}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 496.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 273150, "num_env_steps_trained": 272800, "num_agent_steps_sampled": 273150, "num_agent_steps_trained": 272800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1821, "num_samples_added_to_queue": 272800, "learner_queue": {"size_count": 496, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.083, "learner_load_time_ms": 0.391, "learner_load_wait_time_ms": 2532.185, "learner_dequeue_time_ms": 21065.955}}, "env_runners": {"episode_reward_max": 446.77246032471464, "episode_reward_min": 350.9658868683192, "episode_reward_mean": 398.4435616984998, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 350.9658868683192}, "policy_reward_max": {"default_policy": 446.77246032471464}, "policy_reward_mean": {"default_policy": 398.4435616984998}, "custom_metrics": {"num_consolidated_mean": 1.8587999999999996, "num_consolidated_min": 1.67, "num_consolidated_max": 2.04, "num_overloaded_mean": 0.0411, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.460400000000001, "num_moves_min": 3.99, "num_moves_max": 4.9, "mean_accuracy_mean": 42.028973333333354, "mean_accuracy_min": 41.88533333333335, "mean_accuracy_max": 42.18300000000002, "num_model_switches_mean": 1.3966999999999998, "num_model_switches_min": 1.12, "num_model_switches_max": 1.98, "num_slav_mean": 0.0101515, "num_slav_min": 0.005233333333333333, "num_slav_max": 0.016849999999999997, "cpu_conserved_cost_mean": 4.324, "cpu_conserved_cost_min": 3.84, "cpu_conserved_cost_max": 4.88, "mean_cluster_cpu_util_mean": 0.4809691944453773, "mean_cluster_cpu_util_min": 0.47156165511961684, "mean_cluster_cpu_util_max": 0.4892783365103498, "mean_cluster_mem_util_mean": 0.3105958316846781, "mean_cluster_mem_util_min": 0.304694783504119, "mean_cluster_mem_util_max": 0.31583594624558686, "reward_consolidation_mean_mean": -1.5396110496816846, "reward_consolidation_mean_min": -1.72960857778184, "reward_consolidation_mean_max": -1.3884955374821046, "reward_illegal_mean_mean": -0.06849999999999999, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 5.971166666666684, "reward_accuracy_mean_min": 5.625000000000016, "reward_accuracy_mean_max": 6.350000000000018, "reward_sla_mean_mean": -0.37862, "reward_sla_mean_min": -0.5766666666666667, "reward_sla_mean_max": -0.17133333333333334, "reward_consolidation_sum_mean": -153.96110496816843, "reward_consolidation_sum_min": -172.960857778184, "reward_consolidation_sum_max": -138.84955374821047, "reward_illegal_sum_mean": -6.85, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 597.1166666666683, "reward_accuracy_sum_min": 562.5000000000016, "reward_accuracy_sum_max": 635.0000000000018, "reward_sla_sum_mean": -37.861999999999995, "reward_sla_sum_min": -57.66666666666667, "reward_sla_sum_max": -17.133333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3567.0, "global_timestep_min": 1600, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [416.75172560845743, 379.1543848426711, 409.10063054007276, 360.09838252764473, 387.31759724633866, 351.80080112096147, 371.49135825032903, 381.2838740138308, 386.08927472661514, 392.56085473209816, 401.17240244905594, 383.0152030217202, 389.59129428249565, 397.8150872704026, 402.4199853787826, 392.37288373084925, 377.93017454080365, 394.91975996832235, 386.7066435164046, 373.51333577020483, 404.7155715982837, 381.5548661244646, 381.16881111212797, 414.9229705443372, 412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28222410570284506, "mean_inference_ms": 2.3763560521791116, "mean_action_processing_ms": 0.10519587084844534, "mean_env_wait_ms": 2.046978051793302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006898641586303711, "StateBufferConnector_ms": 0.0036246776580810547, "ViewRequirementAgentConnector_ms": 0.09159111976623535}, "num_episodes": 21, "episode_return_max": 446.77246032471464, "episode_return_min": 350.9658868683192, "episode_return_mean": 398.4435616984998, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273150, "num_agent_steps_trained": 272800, "num_env_steps_sampled": 273150, "num_env_steps_trained": 272800, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 213.65326166689445, "num_env_steps_trained_throughput_per_sec": 208.90541140763014, "timesteps_total": 273150, "num_env_steps_sampled_lifetime": 273150, "num_agent_steps_sampled_lifetime": 273150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 273150, "timers": {"training_iteration_time_ms": 10514.344, "restore_workers_time_ms": 0.017, "training_step_time_ms": 706.047, "sample_time_ms": 689.137, "synch_weights_time_ms": 15.202}, "counters": {"num_env_steps_sampled": 273150, "num_env_steps_trained": 272800, "num_agent_steps_sampled": 273150, "num_agent_steps_trained": 272800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1821, "num_samples_added_to_queue": 272800}, "done": false, "training_iteration": 131, "trial_id": "13390_00000", "date": "2024-10-13_01-01-16", "timestamp": 1728777676, "time_this_iter_s": 10.545612335205078, "time_total_s": 1364.7564883232117, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c157b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1364.7564883232117, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 16.919999999999998, "ram_util_percent": 70.20666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 302008.1875, "policy_loss": 294118.5625, "entropy": 12.019686698913574, "entropy_coeff": 0.01, "var_gnorm": 16.407943725585938, "vf_loss": 795572.3125, "vf_explained_var": -0.09301793575286865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 275400, "num_env_steps_trained": 275000, "num_agent_steps_sampled": 275400, "num_agent_steps_trained": 275000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1836, "num_samples_added_to_queue": 275000, "learner_queue": {"size_count": 500, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.319, "learner_load_time_ms": 0.389, "learner_load_wait_time_ms": 2533.714, "learner_dequeue_time_ms": 21115.176}}, "env_runners": {"episode_reward_max": 449.96742818849356, "episode_reward_min": 350.9658868683192, "episode_reward_mean": 404.5880904383336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 350.9658868683192}, "policy_reward_max": {"default_policy": 449.96742818849356}, "policy_reward_mean": {"default_policy": 404.5880904383336}, "custom_metrics": {"num_consolidated_mean": 1.8835, "num_consolidated_min": 1.67, "num_consolidated_max": 2.07, "num_overloaded_mean": 0.0379, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.351, "num_moves_min": 3.81, "num_moves_max": 4.73, "mean_accuracy_mean": 42.04081666666668, "mean_accuracy_min": 41.88533333333335, "mean_accuracy_max": 42.18300000000002, "num_model_switches_mean": 1.3540999999999999, "num_model_switches_min": 1.04, "num_model_switches_max": 1.69, "num_slav_mean": 0.009971, "num_slav_min": 0.0038833333333333333, "num_slav_max": 0.016849999999999997, "cpu_conserved_cost_mean": 4.389399999999999, "cpu_conserved_cost_min": 3.84, "cpu_conserved_cost_max": 4.88, "mean_cluster_cpu_util_mean": 0.481039080670885, "mean_cluster_cpu_util_min": 0.47156165511961684, "mean_cluster_cpu_util_max": 0.4893591184809241, "mean_cluster_mem_util_mean": 0.31053459195334254, "mean_cluster_mem_util_min": 0.30389453593673754, "mean_cluster_mem_util_max": 0.31583594624558686, "reward_consolidation_mean_mean": -1.5245257622833475, "reward_consolidation_mean_min": -1.72960857778184, "reward_consolidation_mean_max": -1.356575131743276, "reward_illegal_mean_mean": -0.06316666666666666, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.006500000000018, "reward_accuracy_mean_min": 5.625000000000016, "reward_accuracy_mean_max": 6.350000000000018, "reward_sla_mean_mean": -0.3729266666666667, "reward_sla_mean_min": -0.5793333333333333, "reward_sla_mean_max": -0.15533333333333332, "reward_consolidation_sum_mean": -152.45257622833478, "reward_consolidation_sum_min": -172.960857778184, "reward_consolidation_sum_max": -135.6575131743276, "reward_illegal_sum_mean": -6.316666666666666, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 600.6500000000018, "reward_accuracy_sum_min": 562.5000000000016, "reward_accuracy_sum_max": 635.0000000000018, "reward_sla_sum_mean": -37.29266666666666, "reward_sla_sum_min": -57.93333333333333, "reward_sla_sum_max": -15.533333333333331, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4371.0, "global_timestep_min": 2400, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [412.09840689634353, 417.54414998934027, 395.69573243169305, 384.3116817448003, 368.36627981358095, 383.90819397484074, 389.2091930914755, 389.7174540802354, 389.5947637759313, 408.10456608486555, 381.21769776721953, 371.54103688811847, 424.0981297023988, 416.7982606841531, 366.3084346157376, 389.73433854214414, 409.8208047762666, 395.6104572177055, 390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820852481765092, "mean_inference_ms": 2.3762125236694307, "mean_action_processing_ms": 0.10514933351847962, "mean_env_wait_ms": 2.0464468216247567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069217681884765625, "StateBufferConnector_ms": 0.003612041473388672, "ViewRequirementAgentConnector_ms": 0.0913846492767334}, "num_episodes": 24, "episode_return_max": 449.96742818849356, "episode_return_min": 350.9658868683192, "episode_return_mean": 404.5880904383336, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275400, "num_agent_steps_trained": 275000, "num_env_steps_sampled": 275400, "num_env_steps_trained": 275000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 212.13555352677866, "num_env_steps_trained_throughput_per_sec": 207.42143011507247, "timesteps_total": 275400, "num_env_steps_sampled_lifetime": 275400, "num_agent_steps_sampled_lifetime": 275400, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 275400, "timers": {"training_iteration_time_ms": 10537.122, "restore_workers_time_ms": 0.015, "training_step_time_ms": 703.948, "sample_time_ms": 688.259, "synch_weights_time_ms": 14.232}, "counters": {"num_env_steps_sampled": 275400, "num_env_steps_trained": 275000, "num_agent_steps_sampled": 275400, "num_agent_steps_trained": 275000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1836, "num_samples_added_to_queue": 275000}, "done": false, "training_iteration": 132, "trial_id": "13390_00000", "date": "2024-10-13_01-01-27", "timestamp": 1728777687, "time_this_iter_s": 10.61730170249939, "time_total_s": 1375.373790025711, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c16020>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1375.373790025711, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 16.893333333333334, "ram_util_percent": 69.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 300561.0625, "policy_loss": 290967.5625, "entropy": 11.586397171020508, "entropy_coeff": 0.01, "var_gnorm": 16.411447525024414, "vf_loss": 965721.5, "vf_explained_var": -0.07933592796325684}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 504.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 277350, "num_env_steps_trained": 277200, "num_agent_steps_sampled": 277350, "num_agent_steps_trained": 277200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1849, "num_samples_added_to_queue": 277200, "learner_queue": {"size_count": 504, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 74.066, "learner_load_time_ms": 0.389, "learner_load_wait_time_ms": 2619.549, "learner_dequeue_time_ms": 21115.176}}, "env_runners": {"episode_reward_max": 463.39077340156734, "episode_reward_min": 350.9658868683192, "episode_reward_mean": 410.8296997776373, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 350.9658868683192}, "policy_reward_max": {"default_policy": 463.39077340156734}, "policy_reward_mean": {"default_policy": 410.8296997776373}, "custom_metrics": {"num_consolidated_mean": 1.8986999999999998, "num_consolidated_min": 1.67, "num_consolidated_max": 2.09, "num_overloaded_mean": 0.035, "num_overloaded_min": 0.0, "num_overloaded_max": 0.11, "num_moves_mean": 4.2578, "num_moves_min": 3.54, "num_moves_max": 4.73, "mean_accuracy_mean": 42.052153333333344, "mean_accuracy_min": 41.88533333333335, "mean_accuracy_max": 42.18300000000002, "num_model_switches_mean": 1.3060000000000003, "num_model_switches_min": 0.8, "num_model_switches_max": 1.69, "num_slav_mean": 0.009490666666666668, "num_slav_min": 0.00145, "num_slav_max": 0.016849999999999997, "cpu_conserved_cost_mean": 4.425999999999999, "cpu_conserved_cost_min": 3.84, "cpu_conserved_cost_max": 5.04, "mean_cluster_cpu_util_mean": 0.4807833742185767, "mean_cluster_cpu_util_min": 0.47156165511961684, "mean_cluster_cpu_util_max": 0.4893591184809241, "mean_cluster_mem_util_mean": 0.3103712670875312, "mean_cluster_mem_util_min": 0.30389453593673754, "mean_cluster_mem_util_max": 0.31583594624558686, "reward_consolidation_mean_mean": -1.5156296688903106, "reward_consolidation_mean_min": -1.72960857778184, "reward_consolidation_mean_max": -1.3277466569191878, "reward_illegal_mean_mean": -0.05833333333333332, "reward_illegal_mean_min": -0.18333333333333332, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.039500000000017, "reward_accuracy_mean_min": 5.625000000000016, "reward_accuracy_mean_max": 6.416666666666686, "reward_sla_mean_mean": -0.35723999999999995, "reward_sla_mean_min": -0.5793333333333333, "reward_sla_mean_max": -0.05533333333333333, "reward_consolidation_sum_mean": -151.56296688903106, "reward_consolidation_sum_min": -172.960857778184, "reward_consolidation_sum_max": -132.77466569191878, "reward_illegal_sum_mean": -5.833333333333332, "reward_illegal_sum_min": -18.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 603.9500000000016, "reward_accuracy_sum_min": 562.5000000000016, "reward_accuracy_sum_max": 641.6666666666686, "reward_sla_sum_mean": -35.724000000000004, "reward_sla_sum_min": -57.93333333333333, "reward_sla_sum_max": -5.533333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4969.0, "global_timestep_min": 3100, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [390.953026287735, 416.5815407109584, 385.97179932377, 382.4393097566191, 368.2402388132457, 389.3266106186617, 384.63258094977147, 396.30286332206447, 408.2605288007569, 406.2357519266519, 419.94096073593636, 402.92324469219454, 350.9658868683192, 380.03985196015896, 417.6661214170413, 434.8614243504238, 392.9250845289241, 429.80439245788943, 397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820356790686638, "mean_inference_ms": 2.374777970589557, "mean_action_processing_ms": 0.10511855616756328, "mean_env_wait_ms": 2.046219141806831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007169008255004883, "StateBufferConnector_ms": 0.0037491321563720703, "ViewRequirementAgentConnector_ms": 0.09499955177307129}, "num_episodes": 18, "episode_return_max": 463.39077340156734, "episode_return_min": 350.9658868683192, "episode_return_mean": 410.8296997776373, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277350, "num_agent_steps_trained": 277200, "num_env_steps_sampled": 277350, "num_env_steps_trained": 277200, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 181.58711796685657, "num_env_steps_trained_throughput_per_sec": 204.86751770619716, "timesteps_total": 277350, "num_env_steps_sampled_lifetime": 277350, "num_agent_steps_sampled_lifetime": 277350, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 277350, "timers": {"training_iteration_time_ms": 10557.53, "restore_workers_time_ms": 0.022, "training_step_time_ms": 857.974, "sample_time_ms": 839.521, "synch_weights_time_ms": 16.902}, "counters": {"num_env_steps_sampled": 277350, "num_env_steps_trained": 277200, "num_agent_steps_sampled": 277350, "num_agent_steps_trained": 277200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1849, "num_samples_added_to_queue": 277200}, "done": false, "training_iteration": 133, "trial_id": "13390_00000", "date": "2024-10-13_01-01-37", "timestamp": 1728777697, "time_this_iter_s": 10.75283432006836, "time_total_s": 1386.1266243457794, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b52020>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1386.1266243457794, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.493333333333336, "ram_util_percent": 70.90666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 300002.25, "policy_loss": 290883.625, "entropy": 11.152003288269043, "entropy_coeff": 0.01, "var_gnorm": 16.416105270385742, "vf_loss": 917996.875, "vf_explained_var": -0.08167409896850586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 507.0, "diff_num_grad_updates_vs_sampler_policy": 0.45454545454543904}}, "num_env_steps_sampled": 279150, "num_env_steps_trained": 278850, "num_agent_steps_sampled": 279150, "num_agent_steps_trained": 278850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1861, "num_samples_added_to_queue": 278850, "learner_queue": {"size_count": 507, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.547, "learner_load_time_ms": 0.401, "learner_load_wait_time_ms": 2814.817, "learner_dequeue_time_ms": 21349.14}}, "env_runners": {"episode_reward_max": 466.6253129854721, "episode_reward_min": 380.2084072009519, "episode_reward_mean": 416.8780636936871, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 380.2084072009519}, "policy_reward_max": {"default_policy": 466.6253129854721}, "policy_reward_mean": {"default_policy": 416.8780636936871}, "custom_metrics": {"num_consolidated_mean": 1.9218000000000002, "num_consolidated_min": 1.67, "num_consolidated_max": 2.13, "num_overloaded_mean": 0.0332, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 4.156000000000001, "num_moves_min": 3.53, "num_moves_max": 4.72, "mean_accuracy_mean": 42.06532666666667, "mean_accuracy_min": 41.88533333333335, "mean_accuracy_max": 42.20833333333335, "num_model_switches_mean": 1.2565, "num_model_switches_min": 0.8, "num_model_switches_max": 1.69, "num_slav_mean": 0.009113666666666667, "num_slav_min": 0.00145, "num_slav_max": 0.016849999999999997, "cpu_conserved_cost_mean": 4.4807999999999995, "cpu_conserved_cost_min": 3.84, "cpu_conserved_cost_max": 5.14, "mean_cluster_cpu_util_mean": 0.48067417088553144, "mean_cluster_cpu_util_min": 0.4730665510651818, "mean_cluster_cpu_util_max": 0.4926412299162069, "mean_cluster_mem_util_mean": 0.31017764476412923, "mean_cluster_mem_util_min": 0.30389453593673754, "mean_cluster_mem_util_max": 0.3156570992637561, "reward_consolidation_mean_mean": -1.499272696396479, "reward_consolidation_mean_min": -1.72960857778184, "reward_consolidation_mean_max": -1.218430655822596, "reward_illegal_mean_mean": -0.055333333333333325, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.067333333333352, "reward_accuracy_mean_min": 5.666666666666683, "reward_accuracy_mean_max": 6.416666666666686, "reward_sla_mean_mean": -0.3439466666666667, "reward_sla_mean_min": -0.5793333333333333, "reward_sla_mean_max": -0.05533333333333333, "reward_consolidation_sum_mean": -149.92726963964793, "reward_consolidation_sum_min": -172.960857778184, "reward_consolidation_sum_max": -121.8430655822596, "reward_illegal_sum_mean": -5.533333333333332, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 606.733333333335, "reward_accuracy_sum_min": 566.6666666666683, "reward_accuracy_sum_max": 641.6666666666686, "reward_sla_sum_mean": -34.394666666666666, "reward_sla_sum_min": -57.93333333333333, "reward_sla_sum_max": -5.533333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5575.0, "global_timestep_min": 3800, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [397.4045995918259, 395.82901093545496, 424.430479149534, 400.99316762618577, 387.80954948368975, 388.9487709037758, 395.08207073014876, 392.0202564805524, 413.3708458984451, 395.86853391818397, 426.5171129184578, 423.55147582929874, 380.2084072009519, 409.8484145115616, 390.09891863901, 408.6915349233925, 418.26576197874016, 410.310228761158, 393.9673185293507, 413.91444454598195, 395.47845502452265, 385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820486315381076, "mean_inference_ms": 2.3760384135349906, "mean_action_processing_ms": 0.10511826073697604, "mean_env_wait_ms": 2.046607920270507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007469654083251953, "StateBufferConnector_ms": 0.0038895606994628906, "ViewRequirementAgentConnector_ms": 0.0994267463684082}, "num_episodes": 18, "episode_return_max": 466.6253129854721, "episode_return_min": 380.2084072009519, "episode_return_mean": 416.8780636936871, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279150, "num_agent_steps_trained": 278850, "num_env_steps_sampled": 279150, "num_env_steps_trained": 278850, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 175.54258367389542, "num_env_steps_trained_throughput_per_sec": 160.91403503440412, "timesteps_total": 279150, "num_env_steps_sampled_lifetime": 279150, "num_agent_steps_sampled_lifetime": 279150, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 279150, "timers": {"training_iteration_time_ms": 10521.991, "restore_workers_time_ms": 0.015, "training_step_time_ms": 746.829, "sample_time_ms": 729.248, "synch_weights_time_ms": 15.802}, "counters": {"num_env_steps_sampled": 279150, "num_env_steps_trained": 278850, "num_agent_steps_sampled": 279150, "num_agent_steps_trained": 278850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1861, "num_samples_added_to_queue": 278850}, "done": false, "training_iteration": 134, "trial_id": "13390_00000", "date": "2024-10-13_01-01-48", "timestamp": 1728777708, "time_this_iter_s": 10.271232604980469, "time_total_s": 1396.39785695076, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069da20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1396.39785695076, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 28.386666666666667, "ram_util_percent": 71.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 296297.84375, "policy_loss": 286009.46875, "entropy": 10.668692588806152, "entropy_coeff": 0.01, "var_gnorm": 16.419172286987305, "vf_loss": 1034706.1875, "vf_explained_var": -0.07501208782196045}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 511.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 281250, "num_env_steps_trained": 281050, "num_agent_steps_sampled": 281250, "num_agent_steps_trained": 281050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1875, "num_samples_added_to_queue": 281050, "learner_queue": {"size_count": 511, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.571, "learner_load_time_ms": 0.401, "learner_load_wait_time_ms": 2900.212, "learner_dequeue_time_ms": 21349.14}}, "env_runners": {"episode_reward_max": 472.8236559139805, "episode_reward_min": 380.49409668281237, "episode_reward_mean": 424.8457249078575, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 380.49409668281237}, "policy_reward_max": {"default_policy": 472.8236559139805}, "policy_reward_mean": {"default_policy": 424.8457249078575}, "custom_metrics": {"num_consolidated_mean": 1.9506000000000001, "num_consolidated_min": 1.67, "num_consolidated_max": 2.21, "num_overloaded_mean": 0.031099999999999996, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 4.010999999999999, "num_moves_min": 3.48, "num_moves_max": 4.72, "mean_accuracy_mean": 42.08116000000002, "mean_accuracy_min": 41.92966666666667, "mean_accuracy_max": 42.20833333333335, "num_model_switches_mean": 1.1875000000000002, "num_model_switches_min": 0.78, "num_model_switches_max": 1.69, "num_slav_mean": 0.008509, "num_slav_min": 0.00145, "num_slav_max": 0.016849999999999997, "cpu_conserved_cost_mean": 4.5534, "cpu_conserved_cost_min": 3.84, "cpu_conserved_cost_max": 5.28, "mean_cluster_cpu_util_mean": 0.48070714592314834, "mean_cluster_cpu_util_min": 0.4730665510651818, "mean_cluster_cpu_util_max": 0.4926412299162069, "mean_cluster_mem_util_mean": 0.3100273551802578, "mean_cluster_mem_util_min": 0.30389453593673754, "mean_cluster_mem_util_max": 0.3156570992637561, "reward_consolidation_mean_mean": -1.4770960842547751, "reward_consolidation_mean_min": -1.72960857778184, "reward_consolidation_mean_max": -1.218430655822596, "reward_illegal_mean_mean": -0.05183333333333333, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.101000000000017, "reward_accuracy_mean_min": 5.666666666666683, "reward_accuracy_mean_max": 6.433333333333353, "reward_sla_mean_mean": -0.32361333333333336, "reward_sla_mean_min": -0.5793333333333333, "reward_sla_mean_max": -0.05533333333333333, "reward_consolidation_sum_mean": -147.70960842547748, "reward_consolidation_sum_min": -172.960857778184, "reward_consolidation_sum_max": -121.8430655822596, "reward_illegal_sum_mean": -5.183333333333333, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 610.1000000000017, "reward_accuracy_sum_min": 566.6666666666683, "reward_accuracy_sum_max": 643.3333333333353, "reward_sla_sum_mean": -32.361333333333334, "reward_sla_sum_min": -57.93333333333333, "reward_sla_sum_max": -5.533333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6048.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [385.360388680741, 396.9506716622517, 410.62214200859177, 424.4879710012507, 416.7783453653797, 405.03588290840565, 401.20659782509523, 402.0866429071871, 391.8416887508012, 384.1806025160697, 416.5418897925627, 413.9694751591597, 414.97546376679315, 434.75070516921187, 446.77246032471464, 401.73914222181776, 413.3047945414133, 426.2767004782375, 425.6465746748318, 390.4816381857519, 402.5849584209097, 407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28206444361283717, "mean_inference_ms": 2.3784570482295297, "mean_action_processing_ms": 0.10512896731168637, "mean_env_wait_ms": 2.047227748765104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007394552230834961, "StateBufferConnector_ms": 0.003928184509277344, "ViewRequirementAgentConnector_ms": 0.10144162178039551}, "num_episodes": 21, "episode_return_max": 472.8236559139805, "episode_return_min": 380.49409668281237, "episode_return_mean": 424.8457249078575, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281250, "num_agent_steps_trained": 281050, "num_env_steps_sampled": 281250, "num_env_steps_trained": 281050, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 207.5371274951, "num_env_steps_trained_throughput_per_sec": 217.41984785200953, "timesteps_total": 281250, "num_env_steps_sampled_lifetime": 281250, "num_agent_steps_sampled_lifetime": 281250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 281250, "timers": {"training_iteration_time_ms": 10475.994, "restore_workers_time_ms": 0.015, "training_step_time_ms": 728.711, "sample_time_ms": 711.135, "synch_weights_time_ms": 16.019}, "counters": {"num_env_steps_sampled": 281250, "num_env_steps_trained": 281050, "num_agent_steps_sampled": 281250, "num_agent_steps_trained": 281050, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1875, "num_samples_added_to_queue": 281050}, "done": false, "training_iteration": 135, "trial_id": "13390_00000", "date": "2024-10-13_01-01-58", "timestamp": 1728777718, "time_this_iter_s": 10.133169651031494, "time_total_s": 1406.5310266017914, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b50880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1406.5310266017914, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 18.12, "ram_util_percent": 71.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 283363.96875, "policy_loss": 272459.625, "entropy": 10.150720596313477, "entropy_coeff": 0.01, "var_gnorm": 16.418743133544922, "vf_loss": 1096018.5, "vf_explained_var": -0.06755661964416504}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 514.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 283350, "num_env_steps_trained": 282700, "num_agent_steps_sampled": 283350, "num_agent_steps_trained": 282700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1889, "num_samples_added_to_queue": 283250, "learner_queue": {"size_count": 514, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.684, "learner_load_time_ms": 0.38, "learner_load_wait_time_ms": 2643.22, "learner_dequeue_time_ms": 21364.721}}, "env_runners": {"episode_reward_max": 486.30243077766784, "episode_reward_min": 380.49409668281237, "episode_reward_mean": 435.8548854366583, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 380.49409668281237}, "policy_reward_max": {"default_policy": 486.30243077766784}, "policy_reward_mean": {"default_policy": 435.8548854366583}, "custom_metrics": {"num_consolidated_mean": 1.9891999999999999, "num_consolidated_min": 1.78, "num_consolidated_max": 2.21, "num_overloaded_mean": 0.028299999999999995, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 3.8005, "num_moves_min": 2.97, "num_moves_max": 4.54, "mean_accuracy_mean": 42.10959666666668, "mean_accuracy_min": 41.99933333333334, "mean_accuracy_max": 42.265333333333345, "num_model_switches_mean": 1.0817999999999999, "num_model_switches_min": 0.59, "num_model_switches_max": 1.53, "num_slav_mean": 0.007804, "num_slav_min": 0.00145, "num_slav_max": 0.01455, "cpu_conserved_cost_mean": 4.6457999999999995, "cpu_conserved_cost_min": 4.12, "cpu_conserved_cost_max": 5.28, "mean_cluster_cpu_util_mean": 0.4807587247756441, "mean_cluster_cpu_util_min": 0.4730665510651818, "mean_cluster_cpu_util_max": 0.4926412299162069, "mean_cluster_mem_util_mean": 0.3097584254212233, "mean_cluster_mem_util_min": 0.30389453593673754, "mean_cluster_mem_util_max": 0.3156570992637561, "reward_consolidation_mean_mean": -1.4487944789667677, "reward_consolidation_mean_min": -1.6379355143318413, "reward_consolidation_mean_max": -1.218430655822596, "reward_illegal_mean_mean": -0.04716666666666666, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.154083333333351, "reward_accuracy_mean_min": 5.666666666666683, "reward_accuracy_mean_max": 6.466666666666686, "reward_sla_mean_mean": -0.29957333333333336, "reward_sla_mean_min": -0.5793333333333333, "reward_sla_mean_max": -0.05533333333333333, "reward_consolidation_sum_mean": -144.87944789667674, "reward_consolidation_sum_min": -163.79355143318412, "reward_consolidation_sum_max": -121.8430655822596, "reward_illegal_sum_mean": -4.716666666666667, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 615.4083333333351, "reward_accuracy_sum_min": 566.6666666666683, "reward_accuracy_sum_max": 646.6666666666687, "reward_sla_sum_mean": -29.957333333333334, "reward_sla_sum_min": -57.93333333333333, "reward_sla_sum_max": -5.533333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5110.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [407.1031435620963, 434.7180511133464, 439.62422248621846, 383.05631606201996, 403.4124828657605, 439.3568826342578, 383.1082548965871, 426.2448840963799, 403.8683420146839, 407.23980017667475, 437.1184836577432, 415.0548478479408, 380.49409668281237, 438.4980992415258, 417.7915806147022, 427.88644491151274, 449.96742818849356, 410.90372536477076, 403.5392214200876, 397.442486825674, 387.51119132474497, 444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28210691718991454, "mean_inference_ms": 2.378920709039034, "mean_action_processing_ms": 0.1051353419297276, "mean_env_wait_ms": 2.0476377213322943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108211517333984, "StateBufferConnector_ms": 0.003981590270996094, "ViewRequirementAgentConnector_ms": 0.10293102264404297}, "num_episodes": 21, "episode_return_max": 486.30243077766784, "episode_return_min": 380.49409668281237, "episode_return_mean": 435.8548854366583, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283350, "num_agent_steps_trained": 282700, "num_env_steps_sampled": 283350, "num_env_steps_trained": 282700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 200.80736153659822, "num_env_steps_trained_throughput_per_sec": 157.7772126358986, "timesteps_total": 283350, "num_env_steps_sampled_lifetime": 283350, "num_agent_steps_sampled_lifetime": 283350, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 283350, "timers": {"training_iteration_time_ms": 10478.107, "restore_workers_time_ms": 0.018, "training_step_time_ms": 730.045, "sample_time_ms": 712.074, "synch_weights_time_ms": 16.39}, "counters": {"num_env_steps_sampled": 283350, "num_env_steps_trained": 282700, "num_agent_steps_sampled": 283350, "num_agent_steps_trained": 282700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1889, "num_samples_added_to_queue": 283250}, "done": false, "training_iteration": 136, "trial_id": "13390_00000", "date": "2024-10-13_01-02-08", "timestamp": 1728777728, "time_this_iter_s": 10.469074249267578, "time_total_s": 1417.000100851059, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b52290>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1417.000100851059, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 18.386666666666667, "ram_util_percent": 71.02666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 278239.375, "policy_loss": 267022.34375, "entropy": 9.911168098449707, "entropy_coeff": 0.01, "var_gnorm": 16.418256759643555, "vf_loss": 1127152.75, "vf_explained_var": -0.064583420753479}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 285300, "num_env_steps_trained": 284900, "num_agent_steps_sampled": 285300, "num_agent_steps_trained": 284900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1902, "num_samples_added_to_queue": 284900, "learner_queue": {"size_count": 518, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 90.037, "learner_load_time_ms": 0.38, "learner_load_wait_time_ms": 2736.151, "learner_dequeue_time_ms": 21364.721}}, "env_runners": {"episode_reward_max": 486.30243077766784, "episode_reward_min": 394.4902677510754, "episode_reward_mean": 445.8079130342093, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 394.4902677510754}, "policy_reward_max": {"default_policy": 486.30243077766784}, "policy_reward_mean": {"default_policy": 445.8079130342093}, "custom_metrics": {"num_consolidated_mean": 2.0267, "num_consolidated_min": 1.8, "num_consolidated_max": 2.22, "num_overloaded_mean": 0.024699999999999993, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 3.6214000000000004, "num_moves_min": 2.75, "num_moves_max": 4.29, "mean_accuracy_mean": 42.12929333333335, "mean_accuracy_min": 42.012000000000015, "mean_accuracy_max": 42.265333333333345, "num_model_switches_mean": 1.0017000000000003, "num_model_switches_min": 0.55, "num_model_switches_max": 1.43, "num_slav_mean": 0.007167333333333334, "num_slav_min": 0.00145, "num_slav_max": 0.013616666666666666, "cpu_conserved_cost_mean": 4.7436, "cpu_conserved_cost_min": 4.14, "cpu_conserved_cost_max": 5.32, "mean_cluster_cpu_util_mean": 0.4810200897761394, "mean_cluster_cpu_util_min": 0.47354101430062295, "mean_cluster_cpu_util_max": 0.4932228100704993, "mean_cluster_mem_util_mean": 0.30973795224999284, "mean_cluster_mem_util_min": 0.30395154944889347, "mean_cluster_mem_util_max": 0.31658280841872605, "reward_consolidation_mean_mean": -1.4234675363245912, "reward_consolidation_mean_min": -1.6379355143318413, "reward_consolidation_mean_max": -1.218430655822596, "reward_illegal_mean_mean": -0.04116666666666666, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.201500000000019, "reward_accuracy_mean_min": 5.700000000000017, "reward_accuracy_mean_max": 6.483333333333353, "reward_sla_mean_mean": -0.2787866666666666, "reward_sla_mean_min": -0.5446666666666666, "reward_sla_mean_max": -0.05533333333333333, "reward_consolidation_sum_mean": -142.34675363245913, "reward_consolidation_sum_min": -163.79355143318412, "reward_consolidation_sum_max": -121.8430655822596, "reward_illegal_sum_mean": -4.116666666666667, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 620.1500000000019, "reward_accuracy_sum_min": 570.0000000000017, "reward_accuracy_sum_max": 648.3333333333353, "reward_sla_sum_mean": -27.878666666666668, "reward_sla_sum_min": -54.46666666666667, "reward_sla_sum_max": -5.533333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4173.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [444.9141643059507, 425.1727923482304, 421.94323616315, 420.3763897773327, 428.3530232416476, 463.39077340156734, 438.54918517164873, 419.537637454691, 422.4103231898643, 431.4258795577098, 463.03957476621446, 423.4064485668176, 425.5344451551999, 418.18812939779036, 424.3766852478007, 422.15866764141623, 415.32085351366317, 430.7965975204867, 423.85987389198743, 433.68116908830785, 433.3526912181319, 434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28220635742952477, "mean_inference_ms": 2.3810320353258834, "mean_action_processing_ms": 0.10516806864031483, "mean_env_wait_ms": 2.048549126725772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007257938385009766, "StateBufferConnector_ms": 0.004063129425048828, "ViewRequirementAgentConnector_ms": 0.1048581600189209}, "num_episodes": 21, "episode_return_max": 486.30243077766784, "episode_return_min": 394.4902677510754, "episode_return_mean": 445.8079130342093, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285300, "num_agent_steps_trained": 284900, "num_env_steps_sampled": 285300, "num_env_steps_trained": 284900, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 185.47246924555617, "num_env_steps_trained_throughput_per_sec": 209.2509909437044, "timesteps_total": 285300, "num_env_steps_sampled_lifetime": 285300, "num_agent_steps_sampled_lifetime": 285300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 285300, "timers": {"training_iteration_time_ms": 10465.199, "restore_workers_time_ms": 0.022, "training_step_time_ms": 813.937, "sample_time_ms": 798.743, "synch_weights_time_ms": 13.582}, "counters": {"num_env_steps_sampled": 285300, "num_env_steps_trained": 284900, "num_agent_steps_sampled": 285300, "num_agent_steps_trained": 284900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1902, "num_samples_added_to_queue": 284900}, "done": false, "training_iteration": 137, "trial_id": "13390_00000", "date": "2024-10-13_01-02-19", "timestamp": 1728777739, "time_this_iter_s": 10.52396273612976, "time_total_s": 1427.5240635871887, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069e500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1427.5240635871887, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 22.07333333333333, "ram_util_percent": 71.68666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 264839.625, "policy_loss": 254770.75, "entropy": 10.077699661254883, "entropy_coeff": 0.01, "var_gnorm": 16.415571212768555, "vf_loss": 1012429.0, "vf_explained_var": -0.0664377212524414}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 522.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 287550, "num_env_steps_trained": 287100, "num_agent_steps_sampled": 287550, "num_agent_steps_trained": 287100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1917, "num_samples_added_to_queue": 287100, "learner_queue": {"size_count": 522, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 95.526, "learner_load_time_ms": 0.37, "learner_load_wait_time_ms": 2624.125, "learner_dequeue_time_ms": 21603.512}}, "env_runners": {"episode_reward_max": 486.30243077766784, "episode_reward_min": 394.4902677510754, "episode_reward_mean": 451.9712161503566, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 394.4902677510754}, "policy_reward_max": {"default_policy": 486.30243077766784}, "policy_reward_mean": {"default_policy": 451.9712161503566}, "custom_metrics": {"num_consolidated_mean": 2.0573, "num_consolidated_min": 1.8, "num_consolidated_max": 2.23, "num_overloaded_mean": 0.024099999999999993, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 3.4922999999999997, "num_moves_min": 2.75, "num_moves_max": 4.13, "mean_accuracy_mean": 42.149243333333345, "mean_accuracy_min": 42.05000000000002, "mean_accuracy_max": 42.27800000000001, "num_model_switches_mean": 0.9365000000000001, "num_model_switches_min": 0.55, "num_model_switches_max": 1.29, "num_slav_mean": 0.006960999999999999, "num_slav_min": 0.00245, "num_slav_max": 0.0129, "cpu_conserved_cost_mean": 4.831, "cpu_conserved_cost_min": 4.14, "cpu_conserved_cost_max": 5.4, "mean_cluster_cpu_util_mean": 0.48155552416670006, "mean_cluster_cpu_util_min": 0.47354101430062295, "mean_cluster_cpu_util_max": 0.4932228100704993, "mean_cluster_mem_util_mean": 0.3100305345464135, "mean_cluster_mem_util_min": 0.30395154944889347, "mean_cluster_mem_util_max": 0.31658280841872605, "reward_consolidation_mean_mean": -1.3991211718297847, "reward_consolidation_mean_min": -1.6298525693746382, "reward_consolidation_mean_max": -1.218430655822596, "reward_illegal_mean_mean": -0.040166666666666656, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.230000000000019, "reward_accuracy_mean_min": 5.700000000000017, "reward_accuracy_mean_max": 6.525000000000021, "reward_sla_mean_mean": -0.27099999999999996, "reward_sla_mean_min": -0.4733333333333333, "reward_sla_mean_max": -0.09799999999999999, "reward_consolidation_sum_mean": -139.9121171829785, "reward_consolidation_sum_min": -162.98525693746382, "reward_consolidation_sum_max": -121.8430655822596, "reward_illegal_sum_mean": -4.016666666666667, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 623.0000000000019, "reward_accuracy_sum_min": 570.0000000000017, "reward_accuracy_sum_max": 652.500000000002, "reward_sla_sum_mean": -27.100000000000005, "reward_sla_sum_min": -47.33333333333333, "reward_sla_sum_max": -9.799999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3234.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [434.466005665724, 440.15674860641656, 435.99634469524057, 466.6253129854721, 417.0671357641127, 442.63420451430306, 417.38140972920456, 394.4902677510754, 437.17342593438894, 428.4128392579747, 441.0210941545602, 404.9285540223599, 429.05215206067965, 438.3493344299265, 446.0290292119789, 422.0898900362501, 406.37556124158675, 436.6300922964469, 472.8236559139805, 450.944430229372, 444.1696640165725, 453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822388683375843, "mean_inference_ms": 2.3802098329272625, "mean_action_processing_ms": 0.1051603346369848, "mean_env_wait_ms": 2.0486312801440327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006960391998291016, "StateBufferConnector_ms": 0.003910064697265625, "ViewRequirementAgentConnector_ms": 0.10044217109680176}, "num_episodes": 21, "episode_return_max": 486.30243077766784, "episode_return_min": 394.4902677510754, "episode_return_mean": 451.9712161503566, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287550, "num_agent_steps_trained": 287100, "num_env_steps_sampled": 287550, "num_env_steps_trained": 287100, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 212.1058402115614, "num_env_steps_trained_throughput_per_sec": 207.3923770957489, "timesteps_total": 287550, "num_env_steps_sampled_lifetime": 287550, "num_agent_steps_sampled_lifetime": 287550, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 287550, "timers": {"training_iteration_time_ms": 10501.698, "restore_workers_time_ms": 0.014, "training_step_time_ms": 696.43, "sample_time_ms": 683.673, "synch_weights_time_ms": 11.413}, "counters": {"num_env_steps_sampled": 287550, "num_env_steps_trained": 287100, "num_agent_steps_sampled": 287550, "num_agent_steps_trained": 287100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1917, "num_samples_added_to_queue": 287100}, "done": false, "training_iteration": 138, "trial_id": "13390_00000", "date": "2024-10-13_01-02-30", "timestamp": 1728777750, "time_this_iter_s": 10.621111631393433, "time_total_s": 1438.1451752185822, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b53eb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1438.1451752185822, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 16.82, "ram_util_percent": 71.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 299006.5625, "policy_loss": 288744.75, "entropy": 10.56513500213623, "entropy_coeff": 0.01, "var_gnorm": 16.414907455444336, "vf_loss": 1031991.5, "vf_explained_var": -0.058002352714538574}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 526.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 289650, "num_env_steps_trained": 289300, "num_agent_steps_sampled": 289650, "num_agent_steps_trained": 289300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1931, "num_samples_added_to_queue": 289300, "learner_queue": {"size_count": 526, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.906, "learner_load_time_ms": 0.37, "learner_load_wait_time_ms": 2698.112, "learner_dequeue_time_ms": 21603.512}}, "env_runners": {"episode_reward_max": 486.3649060282085, "episode_reward_min": 398.249617716045, "episode_reward_mean": 456.8002648877535, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 398.249617716045}, "policy_reward_max": {"default_policy": 486.3649060282085}, "policy_reward_mean": {"default_policy": 456.8002648877535}, "custom_metrics": {"num_consolidated_mean": 2.0812, "num_consolidated_min": 1.89, "num_consolidated_max": 2.24, "num_overloaded_mean": 0.022199999999999994, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.4361999999999995, "num_moves_min": 2.75, "num_moves_max": 4.37, "mean_accuracy_mean": 42.15792000000001, "mean_accuracy_min": 42.05000000000002, "mean_accuracy_max": 42.27800000000001, "num_model_switches_mean": 0.9087000000000001, "num_model_switches_min": 0.55, "num_model_switches_max": 1.22, "num_slav_mean": 0.006843666666666667, "num_slav_min": 0.00245, "num_slav_max": 0.0129, "cpu_conserved_cost_mean": 4.912800000000001, "cpu_conserved_cost_min": 4.28, "cpu_conserved_cost_max": 5.46, "mean_cluster_cpu_util_mean": 0.4825190080999036, "mean_cluster_cpu_util_min": 0.47354101430062295, "mean_cluster_cpu_util_max": 0.4954268758150929, "mean_cluster_mem_util_mean": 0.31069910096802433, "mean_cluster_mem_util_min": 0.3042536672263842, "mean_cluster_mem_util_max": 0.32073764764344553, "reward_consolidation_mean_mean": -1.3814873511224834, "reward_consolidation_mean_min": -1.5586149441042985, "reward_consolidation_mean_max": -1.2220224496634078, "reward_illegal_mean_mean": -0.037, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.252750000000019, "reward_accuracy_mean_min": 5.816666666666684, "reward_accuracy_mean_max": 6.525000000000021, "reward_sla_mean_mean": -0.26626, "reward_sla_mean_min": -0.4733333333333333, "reward_sla_mean_max": -0.09799999999999999, "reward_consolidation_sum_mean": -138.14873511224835, "reward_consolidation_sum_min": -155.86149441042986, "reward_consolidation_sum_max": -122.20224496634077, "reward_illegal_sum_mean": -3.7, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 625.2750000000019, "reward_accuracy_sum_min": 581.6666666666684, "reward_accuracy_sum_max": 652.500000000002, "reward_sla_sum_mean": -26.625999999999998, "reward_sla_sum_min": -47.33333333333333, "reward_sla_sum_max": -9.799999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2289.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [453.6974382405819, 451.63060708520084, 398.249617716045, 429.573952907492, 431.64944408906916, 460.0896920405755, 444.4457826921337, 436.897066617931, 454.66393432635954, 445.18561637576727, 423.7231076182659, 443.4103536507377, 444.45761674129767, 439.78421212952156, 438.5481525480538, 452.42548052027354, 450.75867982576546, 478.04710469402244, 463.129687166836, 476.58830607085366, 466.0113649517214, 464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28220793780717324, "mean_inference_ms": 2.3777065528414085, "mean_action_processing_ms": 0.10513021432805948, "mean_env_wait_ms": 2.048129609218681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006787538528442383, "StateBufferConnector_ms": 0.003809213638305664, "ViewRequirementAgentConnector_ms": 0.09772419929504395}, "num_episodes": 21, "episode_return_max": 486.3649060282085, "episode_return_min": 398.249617716045, "episode_return_mean": 456.8002648877535, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289650, "num_agent_steps_trained": 289300, "num_env_steps_sampled": 289650, "num_env_steps_trained": 289300, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 203.21973127630088, "num_env_steps_trained_throughput_per_sec": 212.8968613370771, "timesteps_total": 289650, "num_env_steps_sampled_lifetime": 289650, "num_agent_steps_sampled_lifetime": 289650, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 289650, "timers": {"training_iteration_time_ms": 10470.077, "restore_workers_time_ms": 0.015, "training_step_time_ms": 729.165, "sample_time_ms": 712.677, "synch_weights_time_ms": 14.85}, "counters": {"num_env_steps_sampled": 289650, "num_env_steps_trained": 289300, "num_agent_steps_sampled": 289650, "num_agent_steps_trained": 289300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1931, "num_samples_added_to_queue": 289300}, "done": false, "training_iteration": 139, "trial_id": "13390_00000", "date": "2024-10-13_01-02-40", "timestamp": 1728777760, "time_this_iter_s": 10.345231533050537, "time_total_s": 1448.4904067516327, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b50700>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1448.4904067516327, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 18.353333333333335, "ram_util_percent": 71.43333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 299707.5, "policy_loss": 289031.5, "entropy": 10.569242477416992, "entropy_coeff": 0.01, "var_gnorm": 16.414020538330078, "vf_loss": 1073413.125, "vf_explained_var": -0.05268454551696777}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 530.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 291750, "num_env_steps_trained": 291500, "num_agent_steps_sampled": 291750, "num_agent_steps_trained": 291500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1945, "num_samples_added_to_queue": 291500, "learner_queue": {"size_count": 530, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 82.807, "learner_load_time_ms": 0.357, "learner_load_wait_time_ms": 2628.785, "learner_dequeue_time_ms": 21626.341}}, "env_runners": {"episode_reward_max": 486.3649060282085, "episode_reward_min": 416.6845928904341, "episode_reward_mean": 459.16007956380207, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 416.6845928904341}, "policy_reward_max": {"default_policy": 486.3649060282085}, "policy_reward_mean": {"default_policy": 459.16007956380207}, "custom_metrics": {"num_consolidated_mean": 2.1065000000000005, "num_consolidated_min": 1.9, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.022299999999999997, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.4306, "num_moves_min": 2.75, "num_moves_max": 4.37, "mean_accuracy_mean": 42.16229000000001, "mean_accuracy_min": 42.05633333333334, "mean_accuracy_max": 42.27800000000001, "num_model_switches_mean": 0.8961999999999999, "num_model_switches_min": 0.55, "num_model_switches_max": 1.27, "num_slav_mean": 0.006886833333333333, "num_slav_min": 0.00245, "num_slav_max": 0.0129, "cpu_conserved_cost_mean": 5.013199999999999, "cpu_conserved_cost_min": 4.28, "cpu_conserved_cost_max": 5.74, "mean_cluster_cpu_util_mean": 0.48419420743851743, "mean_cluster_cpu_util_min": 0.47354101430062295, "mean_cluster_cpu_util_max": 0.49597648459730487, "mean_cluster_mem_util_mean": 0.31192376539402683, "mean_cluster_mem_util_min": 0.3042536672263842, "mean_cluster_mem_util_max": 0.32073764764344553, "reward_consolidation_mean_mean": -1.360745871028664, "reward_consolidation_mean_min": -1.5586149441042985, "reward_consolidation_mean_max": -1.2026478113862746, "reward_illegal_mean_mean": -0.03716666666666667, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.256833333333353, "reward_accuracy_mean_min": 5.950000000000018, "reward_accuracy_mean_max": 6.525000000000021, "reward_sla_mean_mean": -0.26731999999999995, "reward_sla_mean_min": -0.4746666666666666, "reward_sla_mean_max": -0.09799999999999999, "reward_consolidation_sum_mean": -136.0745871028664, "reward_consolidation_sum_min": -155.86149441042986, "reward_consolidation_sum_max": -120.26478113862746, "reward_illegal_sum_mean": -3.716666666666666, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 625.6833333333352, "reward_accuracy_sum_min": 595.0000000000018, "reward_accuracy_sum_max": 652.500000000002, "reward_sla_sum_mean": -26.732000000000003, "reward_sla_sum_min": -47.46666666666666, "reward_sla_sum_max": -9.799999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1975.0, "global_timestep_min": 200, "global_timestep_max": 3600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [464.6388772122231, 455.155423558441, 456.50517225623884, 476.00559566237337, 436.0534710164811, 475.006402875508, 457.8482774376331, 456.69201315909885, 486.30243077766784, 446.4236894209407, 457.7250236071781, 463.88727344725896, 456.96963355569943, 434.4420177282299, 466.75847269182907, 481.5618721252571, 433.10099911663633, 441.6859483992827, 478.23476194827924, 452.6333516098589, 478.1516616406244, 473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2822062961347083, "mean_inference_ms": 2.377625951251854, "mean_action_processing_ms": 0.10511888367098296, "mean_env_wait_ms": 2.048107607766711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006757974624633789, "StateBufferConnector_ms": 0.0038101673126220703, "ViewRequirementAgentConnector_ms": 0.09686660766601562}, "num_episodes": 21, "episode_return_max": 486.3649060282085, "episode_return_min": 416.6845928904341, "episode_return_mean": 459.16007956380207, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291750, "num_agent_steps_trained": 291500, "num_env_steps_sampled": 291750, "num_env_steps_trained": 291500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.397350315886, "num_env_steps_trained_throughput_per_sec": 212.03531937854726, "timesteps_total": 291750, "num_env_steps_sampled_lifetime": 291750, "num_agent_steps_sampled_lifetime": 291750, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 291750, "timers": {"training_iteration_time_ms": 10453.751, "restore_workers_time_ms": 0.016, "training_step_time_ms": 719.713, "sample_time_ms": 701.541, "synch_weights_time_ms": 16.558}, "counters": {"num_env_steps_sampled": 291750, "num_env_steps_trained": 291500, "num_agent_steps_sampled": 291750, "num_agent_steps_trained": 291500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1945, "num_samples_added_to_queue": 291500}, "done": false, "training_iteration": 140, "trial_id": "13390_00000", "date": "2024-10-13_01-02-50", "timestamp": 1728777770, "time_this_iter_s": 10.385424137115479, "time_total_s": 1458.8758308887482, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e37069f6d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1458.8758308887482, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 70.44666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 286939.65625, "policy_loss": 276810.9375, "entropy": 10.696457862854004, "entropy_coeff": 0.01, "var_gnorm": 16.411216735839844, "vf_loss": 1018755.25, "vf_explained_var": -0.050431013107299805}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 534.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 293850, "num_env_steps_trained": 293700, "num_agent_steps_sampled": 293850, "num_agent_steps_trained": 293700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1959, "num_samples_added_to_queue": 293700, "learner_queue": {"size_count": 534, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.764, "learner_load_time_ms": 0.357, "learner_load_wait_time_ms": 2548.628, "learner_dequeue_time_ms": 21626.341}}, "env_runners": {"episode_reward_max": 486.3649060282085, "episode_reward_min": 416.6845928904341, "episode_reward_mean": 458.8346983764373, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 416.6845928904341}, "policy_reward_max": {"default_policy": 486.3649060282085}, "policy_reward_mean": {"default_policy": 458.8346983764373}, "custom_metrics": {"num_consolidated_mean": 2.127, "num_consolidated_min": 1.96, "num_consolidated_max": 2.3, "num_overloaded_mean": 0.023700000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.491699999999999, "num_moves_min": 2.75, "num_moves_max": 4.37, "mean_accuracy_mean": 42.16241666666668, "mean_accuracy_min": 42.05633333333334, "mean_accuracy_max": 42.27800000000001, "num_model_switches_mean": 0.9158, "num_model_switches_min": 0.55, "num_model_switches_max": 1.27, "num_slav_mean": 0.007238833333333332, "num_slav_min": 0.00245, "num_slav_max": 0.0129, "cpu_conserved_cost_mean": 5.1088, "cpu_conserved_cost_min": 4.6, "cpu_conserved_cost_max": 5.74, "mean_cluster_cpu_util_mean": 0.48591840527587776, "mean_cluster_cpu_util_min": 0.47444020274438015, "mean_cluster_cpu_util_max": 0.49779415271184796, "mean_cluster_mem_util_mean": 0.31340120545939887, "mean_cluster_mem_util_min": 0.3042536672263842, "mean_cluster_mem_util_max": 0.32177593914147934, "reward_consolidation_mean_mean": -1.3422230162356459, "reward_consolidation_mean_min": -1.506656157665479, "reward_consolidation_mean_max": -1.2026478113862746, "reward_illegal_mean_mean": -0.0395, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.248916666666686, "reward_accuracy_mean_min": 5.941666666666683, "reward_accuracy_mean_max": 6.525000000000021, "reward_sla_mean_mean": -0.2788466666666667, "reward_sla_mean_min": -0.4746666666666666, "reward_sla_mean_max": -0.09799999999999999, "reward_consolidation_sum_mean": -134.22230162356453, "reward_consolidation_sum_min": -150.6656157665479, "reward_consolidation_sum_max": -120.26478113862746, "reward_illegal_sum_mean": -3.9500000000000006, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 624.8916666666686, "reward_accuracy_sum_min": 594.1666666666683, "reward_accuracy_sum_max": 652.500000000002, "reward_sla_sum_mean": -27.88466666666666, "reward_sla_sum_min": -47.46666666666666, "reward_sla_sum_max": -9.799999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2675.0, "global_timestep_min": 900, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [473.7758841268408, 481.28643881933823, 472.85147278321165, 467.53133205397864, 471.72162721983796, 446.35843918486864, 449.25635870724244, 471.1319443175259, 447.1648572908116, 416.6845928904341, 472.41814554205314, 461.01938225349727, 471.3610039903761, 454.9140729233318, 479.746309665237, 468.2141612598636, 468.4721739925086, 466.7902860275993, 474.99627768132024, 463.3457126321258, 460.41181577264155, 443.52258978342485, 461.0213287032826, 464.96431508727204, 451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821790419165161, "mean_inference_ms": 2.377232461354127, "mean_action_processing_ms": 0.10509895264873864, "mean_env_wait_ms": 2.0478939375678005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006695985794067383, "StateBufferConnector_ms": 0.0037491321563720703, "ViewRequirementAgentConnector_ms": 0.09539413452148438}, "num_episodes": 21, "episode_return_max": 486.3649060282085, "episode_return_min": 416.6845928904341, "episode_return_mean": 458.8346983764373, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293850, "num_agent_steps_trained": 293700, "num_env_steps_sampled": 293850, "num_env_steps_trained": 293700, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 208.92078864976824, "num_env_steps_trained_throughput_per_sec": 218.86939763309053, "timesteps_total": 293850, "num_env_steps_sampled_lifetime": 293850, "num_agent_steps_sampled_lifetime": 293850, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 293850, "timers": {"training_iteration_time_ms": 10405.809, "restore_workers_time_ms": 0.016, "training_step_time_ms": 713.656, "sample_time_ms": 694.79, "synch_weights_time_ms": 16.928}, "counters": {"num_env_steps_sampled": 293850, "num_env_steps_trained": 293700, "num_agent_steps_sampled": 293850, "num_agent_steps_trained": 293700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1959, "num_samples_added_to_queue": 293700}, "done": false, "training_iteration": 141, "trial_id": "13390_00000", "date": "2024-10-13_01-03-01", "timestamp": 1728777781, "time_this_iter_s": 10.062640190124512, "time_total_s": 1468.9384710788727, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1468.9384710788727, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 17.27142857142857, "ram_util_percent": 70.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 294526.28125, "policy_loss": 284751.09375, "entropy": 11.085354804992676, "entropy_coeff": 0.01, "var_gnorm": 16.403932571411133, "vf_loss": 983614.6875, "vf_explained_var": -0.04423701763153076}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 296100, "num_env_steps_trained": 295900, "num_agent_steps_sampled": 296100, "num_agent_steps_trained": 295900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1974, "num_samples_added_to_queue": 295900, "learner_queue": {"size_count": 538, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 86.309, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 2569.062, "learner_dequeue_time_ms": 21671.618}}, "env_runners": {"episode_reward_max": 486.3649060282085, "episode_reward_min": 422.16507965518474, "episode_reward_mean": 454.12032794176065, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 422.16507965518474}, "policy_reward_max": {"default_policy": 486.3649060282085}, "policy_reward_mean": {"default_policy": 454.12032794176065}, "custom_metrics": {"num_consolidated_mean": 2.1360999999999994, "num_consolidated_min": 1.96, "num_consolidated_max": 2.31, "num_overloaded_mean": 0.0271, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 3.5990999999999995, "num_moves_min": 2.85, "num_moves_max": 4.37, "mean_accuracy_mean": 42.15988333333335, "mean_accuracy_min": 42.05633333333334, "mean_accuracy_max": 42.27800000000001, "num_model_switches_mean": 0.9614, "num_model_switches_min": 0.62, "num_model_switches_max": 1.27, "num_slav_mean": 0.008053666666666666, "num_slav_min": 0.00245, "num_slav_max": 0.01608333333333333, "cpu_conserved_cost_mean": 5.176799999999999, "cpu_conserved_cost_min": 4.6, "cpu_conserved_cost_max": 5.82, "mean_cluster_cpu_util_mean": 0.48800393645716933, "mean_cluster_cpu_util_min": 0.4760931294160291, "mean_cluster_cpu_util_max": 0.4990076682467203, "mean_cluster_mem_util_mean": 0.31496992358599557, "mean_cluster_mem_util_min": 0.3070813242702144, "mean_cluster_mem_util_max": 0.32177593914147934, "reward_consolidation_mean_mean": -1.329636720582412, "reward_consolidation_mean_min": -1.506656157665479, "reward_consolidation_mean_max": -1.142543025983125, "reward_illegal_mean_mean": -0.04516666666666666, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.224500000000019, "reward_accuracy_mean_min": 5.858333333333351, "reward_accuracy_mean_max": 6.525000000000021, "reward_sla_mean_mean": -0.3084933333333334, "reward_sla_mean_min": -0.6106666666666666, "reward_sla_mean_max": -0.09799999999999999, "reward_consolidation_sum_mean": -132.96367205824126, "reward_consolidation_sum_min": -150.6656157665479, "reward_consolidation_sum_max": -114.2543025983125, "reward_illegal_sum_mean": -4.516666666666666, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 622.4500000000019, "reward_accuracy_sum_min": 585.8333333333351, "reward_accuracy_sum_max": 652.500000000002, "reward_sla_sum_mean": -30.84933333333333, "reward_sla_sum_min": -61.06666666666666, "reward_sla_sum_max": -9.799999999999999, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3469.0, "global_timestep_min": 1600, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [451.11790794724385, 433.36321240366914, 467.56221328703464, 469.4752627250315, 429.1977550336611, 463.0289439215346, 438.3343842334538, 466.76840293642994, 465.5264765908211, 464.9912912364087, 471.8132474336733, 483.14407383715803, 438.2711809680484, 449.72070425538584, 456.74754637668093, 456.8327180237003, 458.0672728380412, 466.6097048341425, 446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28208556258498907, "mean_inference_ms": 2.375185719967373, "mean_action_processing_ms": 0.10505767312816111, "mean_env_wait_ms": 2.0472057365569465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006560325622558594, "StateBufferConnector_ms": 0.0037169456481933594, "ViewRequirementAgentConnector_ms": 0.09470629692077637}, "num_episodes": 24, "episode_return_max": 486.3649060282085, "episode_return_min": 422.16507965518474, "episode_return_mean": 454.12032794176065, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296100, "num_agent_steps_trained": 295900, "num_env_steps_sampled": 296100, "num_env_steps_trained": 295900, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 209.55090277884793, "num_env_steps_trained_throughput_per_sec": 204.8942160504291, "timesteps_total": 296100, "num_env_steps_sampled_lifetime": 296100, "num_agent_steps_sampled_lifetime": 296100, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 296100, "timers": {"training_iteration_time_ms": 10418.891, "restore_workers_time_ms": 0.013, "training_step_time_ms": 718.697, "sample_time_ms": 703.319, "synch_weights_time_ms": 13.915}, "counters": {"num_env_steps_sampled": 296100, "num_env_steps_trained": 295900, "num_agent_steps_sampled": 296100, "num_agent_steps_trained": 295900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1974, "num_samples_added_to_queue": 295900}, "done": false, "training_iteration": 142, "trial_id": "13390_00000", "date": "2024-10-13_01-03-11", "timestamp": 1728777791, "time_this_iter_s": 10.750781297683716, "time_total_s": 1479.6892523765564, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371db4a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1479.6892523765564, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 16.706666666666667, "ram_util_percent": 70.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 299837.28125, "policy_loss": 290369.78125, "entropy": 11.430594444274902, "entropy_coeff": 0.01, "var_gnorm": 16.397905349731445, "vf_loss": 953036.6875, "vf_explained_var": -0.045322299003601074}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 541.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 298050, "num_env_steps_trained": 297550, "num_agent_steps_sampled": 298050, "num_agent_steps_trained": 297550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1987, "num_samples_added_to_queue": 297550, "learner_queue": {"size_count": 541, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 85.832, "learner_load_time_ms": 0.378, "learner_load_wait_time_ms": 2670.26, "learner_dequeue_time_ms": 21671.618}}, "env_runners": {"episode_reward_max": 486.3649060282085, "episode_reward_min": 422.16507965518474, "episode_reward_mean": 452.4616345609083, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 422.16507965518474}, "policy_reward_max": {"default_policy": 486.3649060282085}, "policy_reward_mean": {"default_policy": 452.4616345609083}, "custom_metrics": {"num_consolidated_mean": 2.1395, "num_consolidated_min": 1.97, "num_consolidated_max": 2.31, "num_overloaded_mean": 0.027200000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 3.6885999999999997, "num_moves_min": 3.2, "num_moves_max": 4.37, "mean_accuracy_mean": 42.154436666666676, "mean_accuracy_min": 42.05633333333334, "mean_accuracy_max": 42.252666666666684, "num_model_switches_mean": 0.9919999999999999, "num_model_switches_min": 0.74, "num_model_switches_max": 1.27, "num_slav_mean": 0.008377833333333333, "num_slav_min": 0.003016666666666666, "num_slav_max": 0.01608333333333333, "cpu_conserved_cost_mean": 5.2134, "cpu_conserved_cost_min": 4.62, "cpu_conserved_cost_max": 5.82, "mean_cluster_cpu_util_mean": 0.48922310769231553, "mean_cluster_cpu_util_min": 0.4760931294160291, "mean_cluster_cpu_util_max": 0.5041705181442413, "mean_cluster_mem_util_mean": 0.31595918227238146, "mean_cluster_mem_util_min": 0.3070813242702144, "mean_cluster_mem_util_max": 0.3268067262981142, "reward_consolidation_mean_mean": -1.3265736543909352, "reward_consolidation_mean_min": -1.4427355387005392, "reward_consolidation_mean_max": -1.142543025983125, "reward_illegal_mean_mean": -0.04533333333333332, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.21675000000002, "reward_accuracy_mean_min": 5.858333333333351, "reward_accuracy_mean_max": 6.47500000000002, "reward_sla_mean_mean": -0.32022666666666666, "reward_sla_mean_min": -0.6106666666666666, "reward_sla_mean_max": -0.11800000000000001, "reward_consolidation_sum_mean": -132.65736543909352, "reward_consolidation_sum_min": -144.27355387005392, "reward_consolidation_sum_max": -114.2543025983125, "reward_illegal_sum_mean": -4.533333333333333, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 621.675000000002, "reward_accuracy_sum_min": 585.8333333333351, "reward_accuracy_sum_max": 647.500000000002, "reward_sla_sum_mean": -32.022666666666666, "reward_sla_sum_min": -61.06666666666666, "reward_sla_sum_max": -11.8, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4075.0, "global_timestep_min": 2300, "global_timestep_max": 5700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [446.7454780834037, 455.73862438697677, 456.23384812208894, 465.97892107587995, 470.03266624021603, 454.3350391422236, 458.6092692436583, 476.80714612080936, 454.8726187212542, 431.19077644765474, 454.1332328124542, 472.08246672149795, 486.3649060282085, 452.76069633555886, 422.48748667336974, 443.370903774104, 460.71378963721287, 461.2802765847288, 462.39086783027375, 461.0352188613744, 451.394599287217, 472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820688805303631, "mean_inference_ms": 2.3762706248259517, "mean_action_processing_ms": 0.10505578282978612, "mean_env_wait_ms": 2.0474587489476566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006730318069458008, "StateBufferConnector_ms": 0.0037691593170166016, "ViewRequirementAgentConnector_ms": 0.09631800651550293}, "num_episodes": 18, "episode_return_max": 486.3649060282085, "episode_return_min": 422.16507965518474, "episode_return_mean": 452.4616345609083, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298050, "num_agent_steps_trained": 297550, "num_env_steps_sampled": 298050, "num_env_steps_trained": 297550, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 182.5932931905606, "num_env_steps_trained_throughput_per_sec": 154.50201731508972, "timesteps_total": 298050, "num_env_steps_sampled_lifetime": 298050, "num_agent_steps_sampled_lifetime": 298050, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 298050, "timers": {"training_iteration_time_ms": 10412.973, "restore_workers_time_ms": 0.018, "training_step_time_ms": 855.375, "sample_time_ms": 838.434, "synch_weights_time_ms": 15.497}, "counters": {"num_env_steps_sampled": 298050, "num_env_steps_trained": 297550, "num_agent_steps_sampled": 298050, "num_agent_steps_trained": 297550, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1987, "num_samples_added_to_queue": 297550}, "done": false, "training_iteration": 143, "trial_id": "13390_00000", "date": "2024-10-13_01-03-22", "timestamp": 1728777802, "time_this_iter_s": 10.692492723464966, "time_total_s": 1490.3817451000214, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e36f2ca740>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1490.3817451000214, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 23.15, "ram_util_percent": 72.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 302170.71875, "policy_loss": 292684.4375, "entropy": 11.550678253173828, "entropy_coeff": 0.01, "var_gnorm": 16.395647048950195, "vf_loss": 954981.3125, "vf_explained_var": -0.041306495666503906}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 300150, "num_env_steps_trained": 299750, "num_agent_steps_sampled": 300150, "num_agent_steps_trained": 299750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2001, "num_samples_added_to_queue": 299750, "learner_queue": {"size_count": 545, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.009, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 2774.051, "learner_dequeue_time_ms": 21775.378}}, "env_runners": {"episode_reward_max": 480.9666331597082, "episode_reward_min": 422.16507965518474, "episode_reward_mean": 450.86107088245313, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 422.16507965518474}, "policy_reward_max": {"default_policy": 480.9666331597082}, "policy_reward_mean": {"default_policy": 450.86107088245313}, "custom_metrics": {"num_consolidated_mean": 2.1484000000000005, "num_consolidated_min": 2.01, "num_consolidated_max": 2.31, "num_overloaded_mean": 0.028499999999999998, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 3.7697000000000003, "num_moves_min": 3.26, "num_moves_max": 4.28, "mean_accuracy_mean": 42.152980000000014, "mean_accuracy_min": 42.06266666666667, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 1.016, "num_model_switches_min": 0.74, "num_model_switches_max": 1.37, "num_slav_mean": 0.008795833333333334, "num_slav_min": 0.0030500000000000006, "num_slav_max": 0.01608333333333333, "cpu_conserved_cost_mean": 5.267, "cpu_conserved_cost_min": 4.82, "cpu_conserved_cost_max": 5.82, "mean_cluster_cpu_util_mean": 0.49073021456135146, "mean_cluster_cpu_util_min": 0.47917351820401877, "mean_cluster_cpu_util_max": 0.5041705181442413, "mean_cluster_mem_util_mean": 0.31709063662669706, "mean_cluster_mem_util_min": 0.31008125358793304, "mean_cluster_mem_util_max": 0.3268067262981142, "reward_consolidation_mean_mean": -1.3160626245088187, "reward_consolidation_mean_min": -1.4427355387005392, "reward_consolidation_mean_max": -1.142543025983125, "reward_illegal_mean_mean": -0.04749999999999998, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.207833333333354, "reward_accuracy_mean_min": 5.858333333333351, "reward_accuracy_mean_max": 6.47500000000002, "reward_sla_mean_mean": -0.33566000000000007, "reward_sla_mean_min": -0.6106666666666666, "reward_sla_mean_max": -0.122, "reward_consolidation_sum_mean": -131.60626245088187, "reward_consolidation_sum_min": -144.27355387005392, "reward_consolidation_sum_max": -114.2543025983125, "reward_illegal_sum_mean": -4.75, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 620.7833333333351, "reward_accuracy_sum_min": 585.8333333333351, "reward_accuracy_sum_max": 647.500000000002, "reward_sla_sum_mean": -33.566, "reward_sla_sum_min": -61.06666666666666, "reward_sla_sum_max": -12.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4775.0, "global_timestep_min": 3000, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [472.9697767218027, 456.8090621097219, 480.9666331597082, 455.1112522464911, 468.1890158091949, 467.04834749764103, 458.85463766791725, 461.4915623381783, 445.331816381859, 455.51783179506094, 422.7031070090485, 441.28701757592546, 436.64255688568227, 447.3697889061519, 480.85286179902096, 470.98866550915534, 461.0796277681336, 472.04549026775317, 466.34223095434083, 457.0611197416936, 458.0809193091494, 433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820318144244707, "mean_inference_ms": 2.376160993684314, "mean_action_processing_ms": 0.10504431492021686, "mean_env_wait_ms": 2.047445254406498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006699562072753906, "StateBufferConnector_ms": 0.003760814666748047, "ViewRequirementAgentConnector_ms": 0.09634637832641602}, "num_episodes": 21, "episode_return_max": 480.9666331597082, "episode_return_min": 422.16507965518474, "episode_return_mean": 450.86107088245313, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300150, "num_agent_steps_trained": 299750, "num_env_steps_sampled": 300150, "num_env_steps_trained": 299750, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 200.5702199244695, "num_env_steps_trained_throughput_per_sec": 210.12118277801568, "timesteps_total": 300150, "num_env_steps_sampled_lifetime": 300150, "num_agent_steps_sampled_lifetime": 300150, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 300150, "timers": {"training_iteration_time_ms": 10434.595, "restore_workers_time_ms": 0.017, "training_step_time_ms": 755.835, "sample_time_ms": 739.802, "synch_weights_time_ms": 14.584}, "counters": {"num_env_steps_sampled": 300150, "num_env_steps_trained": 299750, "num_agent_steps_sampled": 300150, "num_agent_steps_trained": 299750, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2001, "num_samples_added_to_queue": 299750}, "done": false, "training_iteration": 144, "trial_id": "13390_00000", "date": "2024-10-13_01-03-33", "timestamp": 1728777813, "time_this_iter_s": 10.491066932678223, "time_total_s": 1500.8728120326996, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371db6b90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1500.8728120326996, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 18.226666666666667, "ram_util_percent": 73.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 287497.09375, "policy_loss": 277882.28125, "entropy": 11.188018798828125, "entropy_coeff": 0.01, "var_gnorm": 16.400434494018555, "vf_loss": 967634.5625, "vf_explained_var": -0.03558909893035889}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 549.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 302250, "num_env_steps_trained": 301950, "num_agent_steps_sampled": 302250, "num_agent_steps_trained": 301950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2015, "num_samples_added_to_queue": 301950, "learner_queue": {"size_count": 549, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 83.016, "learner_load_time_ms": 0.347, "learner_load_wait_time_ms": 2730.15, "learner_dequeue_time_ms": 21775.378}}, "env_runners": {"episode_reward_max": 480.1623777757488, "episode_reward_min": 400.1070334155792, "episode_reward_mean": 449.2156507051709, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 400.1070334155792}, "policy_reward_max": {"default_policy": 480.1623777757488}, "policy_reward_mean": {"default_policy": 449.2156507051709}, "custom_metrics": {"num_consolidated_mean": 2.1541, "num_consolidated_min": 2.01, "num_consolidated_max": 2.39, "num_overloaded_mean": 0.029099999999999997, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 3.8360000000000007, "num_moves_min": 3.26, "num_moves_max": 4.28, "mean_accuracy_mean": 42.150446666666674, "mean_accuracy_min": 42.043666666666674, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 1.0377, "num_model_switches_min": 0.74, "num_model_switches_max": 1.47, "num_slav_mean": 0.009171166666666666, "num_slav_min": 0.00445, "num_slav_max": 0.01608333333333333, "cpu_conserved_cost_mean": 5.305199999999998, "cpu_conserved_cost_min": 4.82, "cpu_conserved_cost_max": 6.0, "mean_cluster_cpu_util_mean": 0.49189512551602704, "mean_cluster_cpu_util_min": 0.48073529537322557, "mean_cluster_cpu_util_max": 0.5089847388624613, "mean_cluster_mem_util_mean": 0.31792076926002466, "mean_cluster_mem_util_min": 0.31167887712046843, "mean_cluster_mem_util_max": 0.3270140521398433, "reward_consolidation_mean_mean": -1.3111234929483078, "reward_consolidation_mean_min": -1.4427355387005392, "reward_consolidation_mean_max": -1.1079077949374032, "reward_illegal_mean_mean": -0.04849999999999999, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.199500000000018, "reward_accuracy_mean_min": 5.858333333333351, "reward_accuracy_mean_max": 6.433333333333353, "reward_sla_mean_mean": -0.3477199999999999, "reward_sla_mean_min": -0.6106666666666666, "reward_sla_mean_max": -0.15266666666666664, "reward_consolidation_sum_mean": -131.1123492948308, "reward_consolidation_sum_min": -144.27355387005392, "reward_consolidation_sum_max": -110.79077949374032, "reward_illegal_sum_mean": -4.85, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 619.9500000000019, "reward_accuracy_sum_min": 585.8333333333351, "reward_accuracy_sum_max": 643.3333333333353, "reward_sla_sum_mean": -34.772, "reward_sla_sum_min": -61.06666666666666, "reward_sla_sum_max": -15.266666666666666, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5475.0, "global_timestep_min": 3700, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [433.6209266197586, 475.91025008376937, 470.5824514910618, 452.39311279661456, 454.2332663194148, 479.4324926132404, 460.3227238112662, 445.83787504950067, 451.7685217338346, 437.784257820831, 462.62436565232133, 456.89730725882794, 434.61038715769763, 464.4192695482671, 453.06512839258136, 475.13252612020045, 428.1123640683558, 452.41104815864213, 425.6419080690868, 459.10534892930207, 432.71549544610104, 465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820045150457366, "mean_inference_ms": 2.376082511503699, "mean_action_processing_ms": 0.10503588155797068, "mean_env_wait_ms": 2.0474318934891476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072214603424072266, "StateBufferConnector_ms": 0.003812551498413086, "ViewRequirementAgentConnector_ms": 0.09754705429077148}, "num_episodes": 21, "episode_return_max": 480.1623777757488, "episode_return_min": 400.1070334155792, "episode_return_mean": 449.2156507051709, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302250, "num_agent_steps_trained": 301950, "num_env_steps_sampled": 302250, "num_env_steps_trained": 301950, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 202.75411536921288, "num_env_steps_trained_throughput_per_sec": 212.40907324393729, "timesteps_total": 302250, "num_env_steps_sampled_lifetime": 302250, "num_agent_steps_sampled_lifetime": 302250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 302250, "timers": {"training_iteration_time_ms": 10458.465, "restore_workers_time_ms": 0.017, "training_step_time_ms": 738.246, "sample_time_ms": 720.982, "synch_weights_time_ms": 15.686}, "counters": {"num_env_steps_sampled": 302250, "num_env_steps_trained": 301950, "num_agent_steps_sampled": 302250, "num_agent_steps_trained": 301950, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2015, "num_samples_added_to_queue": 301950}, "done": false, "training_iteration": 145, "trial_id": "13390_00000", "date": "2024-10-13_01-03-43", "timestamp": 1728777823, "time_this_iter_s": 10.369052171707153, "time_total_s": 1511.2418642044067, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c08fa0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1511.2418642044067, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 19.11428571428571, "ram_util_percent": 73.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 286510.59375, "policy_loss": 277213.3125, "entropy": 10.789212226867676, "entropy_coeff": 0.01, "var_gnorm": 16.406890869140625, "vf_loss": 935663.875, "vf_explained_var": -0.03798031806945801}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 552.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 304200, "num_env_steps_trained": 303600, "num_agent_steps_sampled": 304200, "num_agent_steps_trained": 303600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2028, "num_samples_added_to_queue": 304150, "learner_queue": {"size_count": 552, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.434, "learner_load_time_ms": 0.375, "learner_load_wait_time_ms": 2758.859, "learner_dequeue_time_ms": 21871.428}}, "env_runners": {"episode_reward_max": 487.04150903165055, "episode_reward_min": 400.1070334155792, "episode_reward_mean": 451.48752429254796, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 400.1070334155792}, "policy_reward_max": {"default_policy": 487.04150903165055}, "policy_reward_mean": {"default_policy": 451.48752429254796}, "custom_metrics": {"num_consolidated_mean": 2.168, "num_consolidated_min": 2.01, "num_consolidated_max": 2.39, "num_overloaded_mean": 0.0273, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.8432999999999997, "num_moves_min": 3.28, "num_moves_max": 4.28, "mean_accuracy_mean": 42.14538, "mean_accuracy_min": 42.043666666666674, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 1.0402, "num_model_switches_min": 0.72, "num_model_switches_max": 1.47, "num_slav_mean": 0.008987666666666665, "num_slav_min": 0.003016666666666666, "num_slav_max": 0.01608333333333333, "cpu_conserved_cost_mean": 5.3574, "cpu_conserved_cost_min": 4.86, "cpu_conserved_cost_max": 6.0, "mean_cluster_cpu_util_mean": 0.4927991554431831, "mean_cluster_cpu_util_min": 0.48230783035434444, "mean_cluster_cpu_util_max": 0.5089847388624613, "mean_cluster_mem_util_mean": 0.31849309392132374, "mean_cluster_mem_util_min": 0.31167887712046843, "mean_cluster_mem_util_max": 0.3270140521398433, "reward_consolidation_mean_mean": -1.3013914237412048, "reward_consolidation_mean_min": -1.4353216668189714, "reward_consolidation_mean_max": -1.1079077949374032, "reward_illegal_mean_mean": -0.0455, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.2035000000000196, "reward_accuracy_mean_min": 5.83333333333335, "reward_accuracy_mean_max": 6.441666666666686, "reward_sla_mean_mean": -0.34173333333333333, "reward_sla_mean_min": -0.6106666666666666, "reward_sla_mean_max": -0.12066666666666669, "reward_consolidation_sum_mean": -130.13914237412047, "reward_consolidation_sum_min": -143.53216668189714, "reward_consolidation_sum_max": -110.79077949374032, "reward_illegal_sum_mean": -4.55, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 620.3500000000018, "reward_accuracy_sum_min": 583.333333333335, "reward_accuracy_sum_max": 644.1666666666686, "reward_sla_sum_mean": -34.17333333333333, "reward_sla_sum_min": -61.06666666666666, "reward_sla_sum_max": -12.066666666666668, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6175.0, "global_timestep_min": 4400, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [465.11344847543506, 452.3138810198318, 448.42819153797126, 439.04310518139624, 429.96426025770063, 426.1424289500155, 450.42192573639335, 428.80816656005544, 422.16507965518474, 439.03527978312025, 442.0240062140196, 469.71418867464917, 430.84466782418144, 455.7988516250896, 452.7974656553675, 434.7787961863005, 446.7963386030661, 452.5697797678899, 452.7774528618008, 452.9374120442309, 445.3638459898277, 462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2820230096660772, "mean_inference_ms": 2.3764196064595624, "mean_action_processing_ms": 0.10504311076721538, "mean_env_wait_ms": 2.047717078933936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007631063461303711, "StateBufferConnector_ms": 0.003928422927856445, "ViewRequirementAgentConnector_ms": 0.10088467597961426}, "num_episodes": 21, "episode_return_max": 487.04150903165055, "episode_return_min": 400.1070334155792, "episode_return_mean": 451.48752429254796, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304200, "num_agent_steps_trained": 303600, "num_env_steps_sampled": 304200, "num_env_steps_trained": 303600, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 187.57043701640896, "num_env_steps_trained_throughput_per_sec": 158.7134467061922, "timesteps_total": 304200, "num_env_steps_sampled_lifetime": 304200, "num_agent_steps_sampled_lifetime": 304200, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 304200, "timers": {"training_iteration_time_ms": 10452.296, "restore_workers_time_ms": 0.016, "training_step_time_ms": 827.171, "sample_time_ms": 806.752, "synch_weights_time_ms": 18.401}, "counters": {"num_env_steps_sampled": 304200, "num_env_steps_trained": 303600, "num_agent_steps_sampled": 304200, "num_agent_steps_trained": 303600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2028, "num_samples_added_to_queue": 304150}, "done": false, "training_iteration": 146, "trial_id": "13390_00000", "date": "2024-10-13_01-03-53", "timestamp": 1728777833, "time_this_iter_s": 10.411478281021118, "time_total_s": 1521.6533424854279, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371b50ee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1521.6533424854279, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 21.18666666666667, "ram_util_percent": 72.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 279920.1875, "policy_loss": 269188.1875, "entropy": 9.901318550109863, "entropy_coeff": 0.01, "var_gnorm": 16.414798736572266, "vf_loss": 1078646.25, "vf_explained_var": -0.03194117546081543}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 556.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 306300, "num_env_steps_trained": 305800, "num_agent_steps_sampled": 306300, "num_agent_steps_trained": 305800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2042, "num_samples_added_to_queue": 305800, "learner_queue": {"size_count": 556, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 96.248, "learner_load_time_ms": 0.375, "learner_load_wait_time_ms": 2726.205, "learner_dequeue_time_ms": 21871.428}}, "env_runners": {"episode_reward_max": 505.4712297054454, "episode_reward_min": 400.1070334155792, "episode_reward_mean": 459.5153772274531, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 400.1070334155792}, "policy_reward_max": {"default_policy": 505.4712297054454}, "policy_reward_mean": {"default_policy": 459.5153772274531}, "custom_metrics": {"num_consolidated_mean": 2.2028, "num_consolidated_min": 2.01, "num_consolidated_max": 2.43, "num_overloaded_mean": 0.024, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.7729999999999997, "num_moves_min": 3.11, "num_moves_max": 4.28, "mean_accuracy_mean": 42.15266333333336, "mean_accuracy_min": 42.043666666666674, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 0.9979, "num_model_switches_min": 0.66, "num_model_switches_max": 1.47, "num_slav_mean": 0.0084965, "num_slav_min": 0.0028000000000000004, "num_slav_max": 0.015899999999999997, "cpu_conserved_cost_mean": 5.4704, "cpu_conserved_cost_min": 4.9, "cpu_conserved_cost_max": 6.22, "mean_cluster_cpu_util_mean": 0.4942366596486218, "mean_cluster_cpu_util_min": 0.48230783035434444, "mean_cluster_cpu_util_max": 0.5089847388624613, "mean_cluster_mem_util_mean": 0.3192820485375585, "mean_cluster_mem_util_min": 0.3138388381196361, "mean_cluster_mem_util_max": 0.3270140521398433, "reward_consolidation_mean_mean": -1.2756228943921535, "reward_consolidation_mean_min": -1.4353216668189714, "reward_consolidation_mean_max": -1.1079077949374032, "reward_illegal_mean_mean": -0.039999999999999994, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.233250000000018, "reward_accuracy_mean_min": 5.83333333333335, "reward_accuracy_mean_max": 6.516666666666688, "reward_sla_mean_mean": -0.3224733333333334, "reward_sla_mean_min": -0.6073333333333334, "reward_sla_mean_max": -0.11199999999999999, "reward_consolidation_sum_mean": -127.56228943921536, "reward_consolidation_sum_min": -143.53216668189714, "reward_consolidation_sum_max": -110.79077949374032, "reward_illegal_sum_mean": -3.9999999999999996, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 623.3250000000019, "reward_accuracy_sum_min": 583.333333333335, "reward_accuracy_sum_max": 651.6666666666688, "reward_sla_sum_mean": -32.24733333333334, "reward_sla_sum_min": -60.733333333333334, "reward_sla_sum_max": -11.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5244.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [462.5245545097341, 467.5326083645576, 458.78377349295005, 460.2453653781736, 459.7662980901051, 443.9738919857459, 444.5541320174252, 431.3749703006507, 427.39333211490026, 447.11138018215775, 455.7471016479351, 447.17854945322904, 445.7447470224515, 446.64244418045183, 437.0467939931176, 430.7817600292439, 435.6404276706587, 452.082357062355, 463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28208330258689207, "mean_inference_ms": 2.379351743293719, "mean_action_processing_ms": 0.10507157386711694, "mean_env_wait_ms": 2.048523119784783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007839202880859375, "StateBufferConnector_ms": 0.003971099853515625, "ViewRequirementAgentConnector_ms": 0.10270571708679199}, "num_episodes": 21, "episode_return_max": 505.4712297054454, "episode_return_min": 400.1070334155792, "episode_return_mean": 459.5153772274531, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306300, "num_agent_steps_trained": 305800, "num_env_steps_sampled": 306300, "num_env_steps_trained": 305800, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 199.6978562841465, "num_env_steps_trained_throughput_per_sec": 209.207278011963, "timesteps_total": 306300, "num_env_steps_sampled_lifetime": 306300, "num_agent_steps_sampled_lifetime": 306300, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 306300, "timers": {"training_iteration_time_ms": 10452.517, "restore_workers_time_ms": 0.017, "training_step_time_ms": 772.619, "sample_time_ms": 756.078, "synch_weights_time_ms": 15.01}, "counters": {"num_env_steps_sampled": 306300, "num_env_steps_trained": 305800, "num_agent_steps_sampled": 306300, "num_agent_steps_trained": 305800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2042, "num_samples_added_to_queue": 305800}, "done": false, "training_iteration": 147, "trial_id": "13390_00000", "date": "2024-10-13_01-04-04", "timestamp": 1728777844, "time_this_iter_s": 10.527473449707031, "time_total_s": 1532.180815935135, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371db7f70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1532.180815935135, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 18.36, "ram_util_percent": 72.58666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 278573.15625, "policy_loss": 267008.5, "entropy": 9.72599983215332, "entropy_coeff": 0.01, "var_gnorm": 16.417896270751953, "vf_loss": 1161814.875, "vf_explained_var": -0.028500080108642578}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 560.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 308250, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308250, "num_agent_steps_trained": 308000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2055, "num_samples_added_to_queue": 308000, "learner_queue": {"size_count": 560, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 89.249, "learner_load_time_ms": 0.375, "learner_load_wait_time_ms": 2811.715, "learner_dequeue_time_ms": 21871.428}}, "env_runners": {"episode_reward_max": 513.394188065432, "episode_reward_min": 400.1070334155792, "episode_reward_mean": 468.0301592494459, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 400.1070334155792}, "policy_reward_max": {"default_policy": 513.394188065432}, "policy_reward_mean": {"default_policy": 468.0301592494459}, "custom_metrics": {"num_consolidated_mean": 2.2397, "num_consolidated_min": 2.04, "num_consolidated_max": 2.47, "num_overloaded_mean": 0.0206, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.6792000000000002, "num_moves_min": 3.1, "num_moves_max": 4.24, "mean_accuracy_mean": 42.16165666666668, "mean_accuracy_min": 42.043666666666674, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 0.9474999999999999, "num_model_switches_min": 0.5, "num_model_switches_max": 1.47, "num_slav_mean": 0.007918666666666668, "num_slav_min": 0.0028000000000000004, "num_slav_max": 0.015899999999999997, "cpu_conserved_cost_mean": 5.575400000000001, "cpu_conserved_cost_min": 4.94, "cpu_conserved_cost_max": 6.22, "mean_cluster_cpu_util_mean": 0.495102691877656, "mean_cluster_cpu_util_min": 0.48230783035434444, "mean_cluster_cpu_util_max": 0.5089847388624613, "mean_cluster_mem_util_mean": 0.31958047560205516, "mean_cluster_mem_util_min": 0.3133652162447257, "mean_cluster_mem_util_max": 0.3270140521398433, "reward_consolidation_mean_mean": -1.2497017408388928, "reward_consolidation_mean_min": -1.4353216668189714, "reward_consolidation_mean_max": -1.0605583478022482, "reward_illegal_mean_mean": -0.03433333333333333, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.266916666666685, "reward_accuracy_mean_min": 5.83333333333335, "reward_accuracy_mean_max": 6.516666666666688, "reward_sla_mean_mean": -0.30258, "reward_sla_mean_min": -0.5760000000000001, "reward_sla_mean_max": -0.11199999999999999, "reward_consolidation_sum_mean": -124.97017408388929, "reward_consolidation_sum_min": -143.53216668189714, "reward_consolidation_sum_max": -106.05583478022481, "reward_illegal_sum_mean": -3.433333333333333, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 626.6916666666684, "reward_accuracy_sum_min": 583.333333333335, "reward_accuracy_sum_max": 651.6666666666688, "reward_sla_sum_mean": -30.257999999999996, "reward_sla_sum_min": -57.6, "reward_sla_sum_max": -11.2, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4440.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [463.4851960157198, 432.70932407322977, 451.43365926467646, 445.1317158609785, 468.7958420908363, 439.9720308264051, 444.4678333181048, 447.3849340522115, 477.84439367632433, 458.66344086021695, 470.12788083706636, 450.81499588778377, 443.0498614030297, 428.90833104876975, 449.3590392640671, 437.9898869901628, 455.59279904962256, 431.5157695939582, 453.53274543848596, 474.9449937555229, 472.3913216972815, 425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821236502739594, "mean_inference_ms": 2.379574396475957, "mean_action_processing_ms": 0.10507822111871089, "mean_env_wait_ms": 2.0487104002044303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007788181304931641, "StateBufferConnector_ms": 0.003972053527832031, "ViewRequirementAgentConnector_ms": 0.10268425941467285}, "num_episodes": 18, "episode_return_max": 513.394188065432, "episode_return_min": 400.1070334155792, "episode_return_mean": 468.0301592494459, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308250, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308250, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 191.54791196221734, "num_env_steps_trained_throughput_per_sec": 216.105336572758, "timesteps_total": 308250, "num_env_steps_sampled_lifetime": 308250, "num_agent_steps_sampled_lifetime": 308250, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 308250, "timers": {"training_iteration_time_ms": 10409.747, "restore_workers_time_ms": 0.019, "training_step_time_ms": 776.595, "sample_time_ms": 757.964, "synch_weights_time_ms": 16.773}, "counters": {"num_env_steps_sampled": 308250, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308250, "num_agent_steps_trained": 308000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2055, "num_samples_added_to_queue": 308000}, "done": false, "training_iteration": 148, "trial_id": "13390_00000", "date": "2024-10-13_01-04-14", "timestamp": 1728777854, "time_this_iter_s": 10.191538572311401, "time_total_s": 1542.3723545074463, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c08eb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1542.3723545074463, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 19.686666666666664, "ram_util_percent": 73.03999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 267781.65625, "policy_loss": 257336.453125, "entropy": 9.676305770874023, "entropy_coeff": 0.01, "var_gnorm": 16.418750762939453, "vf_loss": 1049843.125, "vf_explained_var": -0.02761244773864746}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 0.36363636363637397}}, "num_env_steps_sampled": 310200, "num_env_steps_trained": 309650, "num_agent_steps_sampled": 310200, "num_agent_steps_trained": 309650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2068, "num_samples_added_to_queue": 310200, "learner_queue": {"size_count": 563, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.574, "learner_load_time_ms": 0.359, "learner_load_wait_time_ms": 2728.908, "learner_dequeue_time_ms": 22071.346}}, "env_runners": {"episode_reward_max": 513.394188065432, "episode_reward_min": 400.1070334155792, "episode_reward_mean": 475.90392055804494, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 400.1070334155792}, "policy_reward_max": {"default_policy": 513.394188065432}, "policy_reward_mean": {"default_policy": 475.90392055804494}, "custom_metrics": {"num_consolidated_mean": 2.2691, "num_consolidated_min": 2.04, "num_consolidated_max": 2.5, "num_overloaded_mean": 0.0189, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.5670000000000006, "num_moves_min": 3.1, "num_moves_max": 4.24, "mean_accuracy_mean": 42.17616000000002, "mean_accuracy_min": 42.043666666666674, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 0.8790000000000002, "num_model_switches_min": 0.5, "num_model_switches_max": 1.47, "num_slav_mean": 0.0072885, "num_slav_min": 0.0022500000000000003, "num_slav_max": 0.015899999999999997, "cpu_conserved_cost_mean": 5.650000000000001, "cpu_conserved_cost_min": 5.02, "cpu_conserved_cost_max": 6.36, "mean_cluster_cpu_util_mean": 0.4955051953983036, "mean_cluster_cpu_util_min": 0.48681109712632425, "mean_cluster_cpu_util_max": 0.5089847388624613, "mean_cluster_mem_util_mean": 0.3195084220575361, "mean_cluster_mem_util_min": 0.3133652162447257, "mean_cluster_mem_util_max": 0.32604226836304134, "reward_consolidation_mean_mean": -1.2273141277529018, "reward_consolidation_mean_min": -1.413144019007585, "reward_consolidation_mean_max": -1.0374798196716322, "reward_illegal_mean_mean": -0.03149999999999999, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.295666666666684, "reward_accuracy_mean_min": 5.83333333333335, "reward_accuracy_mean_max": 6.516666666666688, "reward_sla_mean_mean": -0.2778133333333333, "reward_sla_mean_min": -0.5646666666666667, "reward_sla_mean_max": -0.08733333333333335, "reward_consolidation_sum_mean": -122.73141277529015, "reward_consolidation_sum_min": -141.3144019007585, "reward_consolidation_sum_max": -103.74798196716321, "reward_illegal_sum_mean": -3.15, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 629.5666666666687, "reward_accuracy_sum_min": 583.333333333335, "reward_accuracy_sum_max": 651.6666666666688, "reward_sla_sum_mean": -27.78133333333333, "reward_sla_sum_min": -56.46666666666666, "reward_sla_sum_max": -8.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3502.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [425.10672271467496, 443.0522799963464, 450.74660513570495, 448.22043924579043, 480.1623777757488, 462.70232416461226, 432.9605166164079, 440.8789576289275, 450.51972036918767, 438.7315879253116, 480.10922050626164, 444.5072557799522, 466.1191537969495, 400.1070334155792, 452.9093057967059, 444.88315818331535, 445.17652075908677, 441.15226476591016, 476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2821901915348708, "mean_inference_ms": 2.379951631897448, "mean_action_processing_ms": 0.1050925341402635, "mean_env_wait_ms": 2.049028505107957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007969141006469727, "StateBufferConnector_ms": 0.004048824310302734, "ViewRequirementAgentConnector_ms": 0.10454130172729492}, "num_episodes": 21, "episode_return_max": 513.394188065432, "episode_return_min": 400.1070334155792, "episode_return_mean": 475.90392055804494, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310200, "num_agent_steps_trained": 309650, "num_env_steps_sampled": 310200, "num_env_steps_trained": 309650, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 194.20095386946258, "num_env_steps_trained_throughput_per_sec": 164.32388404339142, "timesteps_total": 310200, "num_env_steps_sampled_lifetime": 310200, "num_agent_steps_sampled_lifetime": 310200, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 310200, "timers": {"training_iteration_time_ms": 10380.498, "restore_workers_time_ms": 0.017, "training_step_time_ms": 775.428, "sample_time_ms": 757.659, "synch_weights_time_ms": 16.001}, "counters": {"num_env_steps_sampled": 310200, "num_env_steps_trained": 309650, "num_agent_steps_sampled": 310200, "num_agent_steps_trained": 309650, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2068, "num_samples_added_to_queue": 310200}, "done": false, "training_iteration": 149, "trial_id": "13390_00000", "date": "2024-10-13_01-04-24", "timestamp": 1728777864, "time_this_iter_s": 10.052407503128052, "time_total_s": 1552.4247620105743, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0bd90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1552.4247620105743, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 20.87857142857143, "ram_util_percent": 73.00714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 290104.125, "policy_loss": 279349.125, "entropy": 10.324105262756348, "entropy_coeff": 0.01, "var_gnorm": 16.416845321655273, "vf_loss": 1081177.125, "vf_explained_var": -0.02288687229156494}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 567.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 311850, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 311850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2080, "num_samples_added_to_queue": 311850, "learner_queue": {"size_count": 567, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.956, "learner_load_time_ms": 0.359, "learner_load_wait_time_ms": 2857.475, "learner_dequeue_time_ms": 22071.346}}, "env_runners": {"episode_reward_max": 513.394188065432, "episode_reward_min": 426.64058911328556, "episode_reward_mean": 482.2197103780212, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 426.64058911328556}, "policy_reward_max": {"default_policy": 513.394188065432}, "policy_reward_mean": {"default_policy": 482.2197103780212}, "custom_metrics": {"num_consolidated_mean": 2.2903000000000002, "num_consolidated_min": 2.04, "num_consolidated_max": 2.5, "num_overloaded_mean": 0.016300000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.5035, "num_moves_min": 3.1, "num_moves_max": 3.96, "mean_accuracy_mean": 42.18490000000001, "mean_accuracy_min": 42.06266666666668, "mean_accuracy_max": 42.259000000000015, "num_model_switches_mean": 0.8329, "num_model_switches_min": 0.5, "num_model_switches_max": 1.32, "num_slav_mean": 0.0068443333333333325, "num_slav_min": 0.0022500000000000003, "num_slav_max": 0.01308333333333333, "cpu_conserved_cost_mean": 5.699400000000001, "cpu_conserved_cost_min": 5.08, "cpu_conserved_cost_max": 6.36, "mean_cluster_cpu_util_mean": 0.49567484494403075, "mean_cluster_cpu_util_min": 0.4852823001361306, "mean_cluster_cpu_util_max": 0.5057725823237851, "mean_cluster_mem_util_mean": 0.3193000996763684, "mean_cluster_mem_util_min": 0.31246981166939347, "mean_cluster_mem_util_max": 0.32604226836304134, "reward_consolidation_mean_mean": -1.2118662295531393, "reward_consolidation_mean_min": -1.397684059825155, "reward_consolidation_mean_max": -1.0374798196716322, "reward_illegal_mean_mean": -0.02716666666666667, "reward_illegal_mean_min": -0.11666666666666664, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.323916666666687, "reward_accuracy_mean_min": 5.83333333333335, "reward_accuracy_mean_max": 6.516666666666688, "reward_sla_mean_mean": -0.2626866666666667, "reward_sla_mean_min": -0.49, "reward_sla_mean_max": -0.08733333333333335, "reward_consolidation_sum_mean": -121.18662295531392, "reward_consolidation_sum_min": -139.7684059825155, "reward_consolidation_sum_max": -103.74798196716321, "reward_illegal_sum_mean": -2.7166666666666672, "reward_illegal_sum_min": -11.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 632.3916666666687, "reward_accuracy_sum_min": 583.333333333335, "reward_accuracy_sum_max": 651.6666666666688, "reward_sla_sum_mean": -26.268666666666658, "reward_sla_sum_min": -49.0, "reward_sla_sum_max": -8.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2699.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [476.81954369612413, 441.2728867769367, 426.64058911328556, 460.00015839654145, 452.1483444515537, 486.9444089067611, 471.338465990437, 474.6468396844274, 487.04150903165055, 467.4251393584958, 471.31027140638014, 457.9640074324547, 428.9649273508195, 467.39057845198016, 455.3905205763215, 454.120685978862, 476.146151268697, 485.64540193122116, 473.2054829571434, 459.4824606293235, 469.69487038898706, 467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2823015829121732, "mean_inference_ms": 2.3821067060567582, "mean_action_processing_ms": 0.10512932003721438, "mean_env_wait_ms": 2.049887329805618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007870912551879883, "StateBufferConnector_ms": 0.004181385040283203, "ViewRequirementAgentConnector_ms": 0.10869860649108887}, "num_episodes": 18, "episode_return_max": 513.394188065432, "episode_return_min": 426.64058911328556, "episode_return_mean": 482.2197103780212, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 311850, "num_env_steps_sampled": 312000, "num_env_steps_trained": 311850, "num_env_steps_sampled_this_iter": 1800, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 167.91848043232693, "num_env_steps_trained_throughput_per_sec": 205.2336983061774, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 10414.883, "restore_workers_time_ms": 0.015, "training_step_time_ms": 928.789, "sample_time_ms": 909.789, "synch_weights_time_ms": 17.285}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 311850, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 311850, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2080, "num_samples_added_to_queue": 311850}, "done": false, "training_iteration": 150, "trial_id": "13390_00000", "date": "2024-10-13_01-04-35", "timestamp": 1728777875, "time_this_iter_s": 10.74311351776123, "time_total_s": 1563.1678755283356, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0bee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1563.1678755283356, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 30.0875, "ram_util_percent": 73.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 296563.59375, "policy_loss": 286456.75, "entropy": 10.445307731628418, "entropy_coeff": 0.01, "var_gnorm": 16.414262771606445, "vf_loss": 1016429.5625, "vf_explained_var": -0.02197265625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 570.0, "diff_num_grad_updates_vs_sampler_policy": 0.4545454545454959}}, "num_env_steps_sampled": 314100, "num_env_steps_trained": 313500, "num_agent_steps_sampled": 314100, "num_agent_steps_trained": 313500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2094, "num_samples_added_to_queue": 314050, "learner_queue": {"size_count": 570, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 80.303, "learner_load_time_ms": 0.366, "learner_load_wait_time_ms": 2861.808, "learner_dequeue_time_ms": 22390.481}}, "env_runners": {"episode_reward_max": 513.394188065432, "episode_reward_min": 445.30399646654064, "episode_reward_mean": 483.57869325901066, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 445.30399646654064}, "policy_reward_max": {"default_policy": 513.394188065432}, "policy_reward_mean": {"default_policy": 483.57869325901066}, "custom_metrics": {"num_consolidated_mean": 2.2880999999999996, "num_consolidated_min": 2.02, "num_consolidated_max": 2.5, "num_overloaded_mean": 0.0147, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.5096000000000007, "num_moves_min": 3.1, "num_moves_max": 4.05, "mean_accuracy_mean": 42.190093333333344, "mean_accuracy_min": 42.10700000000001, "mean_accuracy_max": 42.26533333333336, "num_model_switches_mean": 0.8160999999999998, "num_model_switches_min": 0.5, "num_model_switches_max": 1.1, "num_slav_mean": 0.006880833333333332, "num_slav_min": 0.0022500000000000003, "num_slav_max": 0.011899999999999999, "cpu_conserved_cost_mean": 5.6857999999999995, "cpu_conserved_cost_min": 4.8, "cpu_conserved_cost_max": 6.36, "mean_cluster_cpu_util_mean": 0.4954673314224198, "mean_cluster_cpu_util_min": 0.4833662972581205, "mean_cluster_cpu_util_max": 0.5057725823237851, "mean_cluster_mem_util_mean": 0.3190151928352565, "mean_cluster_mem_util_min": 0.3114201306366429, "mean_cluster_mem_util_max": 0.32604226836304134, "reward_consolidation_mean_mean": -1.2151864007432456, "reward_consolidation_mean_min": -1.4262933686679466, "reward_consolidation_mean_max": -1.0374798196716322, "reward_illegal_mean_mean": -0.024499999999999994, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.3413333333333535, "reward_accuracy_mean_min": 6.016666666666684, "reward_accuracy_mean_max": 6.516666666666688, "reward_sla_mean_mean": -0.26585999999999993, "reward_sla_mean_min": -0.47533333333333333, "reward_sla_mean_max": -0.08733333333333335, "reward_consolidation_sum_mean": -121.51864007432454, "reward_consolidation_sum_min": -142.62933686679466, "reward_consolidation_sum_max": -103.74798196716321, "reward_illegal_sum_mean": -2.45, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 634.1333333333353, "reward_accuracy_sum_min": 601.6666666666684, "reward_accuracy_sum_max": 651.6666666666688, "reward_sla_sum_mean": -26.586, "reward_sla_sum_min": -47.53333333333333, "reward_sla_sum_max": -8.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1761.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156, 470.45568856803624, 472.5826312102124, 459.04821651588713, 473.92976941119315, 496.0862438697509, 488.01104511255465, 471.26634073532716, 464.3190075847593, 447.92247403210746, 476.770337201866, 454.77221359164326, 461.17564348594397, 463.39209844954337, 460.16594169789073, 467.89230253739254, 464.21163909957863, 490.89422157239215, 483.1754180754841, 445.30399646654064, 487.4506046483311, 480.66569801090697], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [467.0346857960967, 476.550744768347, 475.6287002345504, 489.8416857047143, 473.43023546254994, 491.551615949315, 500.12135002589355, 482.43950775229405, 472.3462609278401, 504.8553900514811, 478.7334917298747, 476.60336592646917, 493.98195497883137, 494.66375765329644, 475.8842700051801, 493.8025130220251, 461.80318925340566, 459.325041883702, 468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156, 470.45568856803624, 472.5826312102124, 459.04821651588713, 473.92976941119315, 496.0862438697509, 488.01104511255465, 471.26634073532716, 464.3190075847593, 447.92247403210746, 476.770337201866, 454.77221359164326, 461.17564348594397, 463.39209844954337, 460.16594169789073, 467.89230253739254, 464.21163909957863, 490.89422157239215, 483.1754180754841, 445.30399646654064, 487.4506046483311, 480.66569801090697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28236917940824535, "mean_inference_ms": 2.3828150469891956, "mean_action_processing_ms": 0.10514870141763008, "mean_env_wait_ms": 2.0504157194699038, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007400989532470703, "StateBufferConnector_ms": 0.004052400588989258, "ViewRequirementAgentConnector_ms": 0.10505390167236328}, "num_episodes": 21, "episode_return_max": 513.394188065432, "episode_return_min": 445.30399646654064, "episode_return_mean": 483.57869325901066, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314100, "num_agent_steps_trained": 313500, "num_env_steps_sampled": 314100, "num_env_steps_trained": 313500, "num_env_steps_sampled_this_iter": 2100, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 208.40678745389985, "num_env_steps_trained_throughput_per_sec": 163.74819014234987, "timesteps_total": 314100, "num_env_steps_sampled_lifetime": 314100, "num_agent_steps_sampled_lifetime": 314100, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 314100, "timers": {"training_iteration_time_ms": 10417.362, "restore_workers_time_ms": 0.013, "training_step_time_ms": 722.2, "sample_time_ms": 705.472, "synch_weights_time_ms": 15.1}, "counters": {"num_env_steps_sampled": 314100, "num_env_steps_trained": 313500, "num_agent_steps_sampled": 314100, "num_agent_steps_trained": 313500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2094, "num_samples_added_to_queue": 314050}, "done": false, "training_iteration": 151, "trial_id": "13390_00000", "date": "2024-10-13_01-04-45", "timestamp": 1728777885, "time_this_iter_s": 10.08831787109375, "time_total_s": 1573.2561933994293, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0b220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1573.2561933994293, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 17.285714285714285, "ram_util_percent": 74.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 303485.21875, "policy_loss": 293862.375, "entropy": 10.875842094421387, "entropy_coeff": 0.01, "var_gnorm": 16.40667152404785, "vf_loss": 968265.5, "vf_explained_var": -0.019385457038879395}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 574.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 316050, "num_env_steps_trained": 315700, "num_agent_steps_sampled": 316050, "num_agent_steps_trained": 315700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2107, "num_samples_added_to_queue": 315700, "learner_queue": {"size_count": 574, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 84.054, "learner_load_time_ms": 0.366, "learner_load_wait_time_ms": 2848.792, "learner_dequeue_time_ms": 22390.481}}, "env_runners": {"episode_reward_max": 513.394188065432, "episode_reward_min": 445.30399646654064, "episode_reward_mean": 480.72960614091375, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 445.30399646654064}, "policy_reward_max": {"default_policy": 513.394188065432}, "policy_reward_mean": {"default_policy": 480.72960614091375}, "custom_metrics": {"num_consolidated_mean": 2.269, "num_consolidated_min": 2.02, "num_consolidated_max": 2.5, "num_overloaded_mean": 0.015100000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.5905, "num_moves_min": 3.1, "num_moves_max": 4.41, "mean_accuracy_mean": 42.18458333333335, "mean_accuracy_min": 42.07533333333335, "mean_accuracy_max": 42.26533333333336, "num_model_switches_mean": 0.8331999999999999, "num_model_switches_min": 0.5, "num_model_switches_max": 1.16, "num_slav_mean": 0.006934833333333334, "num_slav_min": 0.0022500000000000003, "num_slav_max": 0.013566666666666664, "cpu_conserved_cost_mean": 5.622000000000001, "cpu_conserved_cost_min": 4.8, "cpu_conserved_cost_max": 6.36, "mean_cluster_cpu_util_mean": 0.49475100609146466, "mean_cluster_cpu_util_min": 0.4833662972581205, "mean_cluster_cpu_util_max": 0.5057725823237851, "mean_cluster_mem_util_mean": 0.3185393980363242, "mean_cluster_mem_util_min": 0.3112790380392664, "mean_cluster_mem_util_max": 0.3237566100490829, "reward_consolidation_mean_mean": -1.2315206052575471, "reward_consolidation_mean_min": -1.433686679460234, "reward_consolidation_mean_max": -1.0374798196716322, "reward_illegal_mean_mean": -0.02516666666666666, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.33258333333335, "reward_accuracy_mean_min": 6.016666666666684, "reward_accuracy_mean_max": 6.516666666666687, "reward_sla_mean_mean": -0.2686, "reward_sla_mean_min": -0.5426666666666667, "reward_sla_mean_max": -0.08733333333333335, "reward_consolidation_sum_mean": -123.15206052575468, "reward_consolidation_sum_min": -143.3686679460234, "reward_consolidation_sum_max": -103.74798196716321, "reward_illegal_sum_mean": -2.516666666666666, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 633.2583333333353, "reward_accuracy_sum_min": 601.6666666666684, "reward_accuracy_sum_max": 651.6666666666687, "reward_sla_sum_mean": -26.860000000000003, "reward_sla_sum_min": -54.26666666666667, "reward_sla_sum_max": -8.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2278.0, "global_timestep_min": 400, "global_timestep_max": 3900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156, 470.45568856803624, 472.5826312102124, 459.04821651588713, 473.92976941119315, 496.0862438697509, 488.01104511255465, 471.26634073532716, 464.3190075847593, 447.92247403210746, 476.770337201866, 454.77221359164326, 461.17564348594397, 463.39209844954337, 460.16594169789073, 467.89230253739254, 464.21163909957863, 490.89422157239215, 483.1754180754841, 445.30399646654064, 487.4506046483311, 480.66569801090697, 481.7171707941167, 460.16044046422587, 450.70492856925466, 482.4837095251169, 448.49799872064506, 446.759423071067, 446.6363489597629, 468.59892168509725, 468.96377592982003, 481.3378324042786, 450.9546041609572, 459.911221785618, 492.41227268573704, 459.61528221999026, 490.9890340857188, 449.78227481799803, 467.8992080173034, 476.2646014194785], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [468.4097870784997, 461.57174449419904, 503.60802948612695, 505.4712297054454, 511.573901124008, 472.4703128331677, 487.3086234731507, 511.0233147522027, 488.76339516890744, 484.0808248804426, 499.3108318864438, 481.93559962228704, 492.5221694233776, 502.3191050595528, 484.23355569770814, 495.3172865454341, 491.51594626702166, 475.576520759087, 510.7322215114706, 513.394188065432, 504.6675987693828, 498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156, 470.45568856803624, 472.5826312102124, 459.04821651588713, 473.92976941119315, 496.0862438697509, 488.01104511255465, 471.26634073532716, 464.3190075847593, 447.92247403210746, 476.770337201866, 454.77221359164326, 461.17564348594397, 463.39209844954337, 460.16594169789073, 467.89230253739254, 464.21163909957863, 490.89422157239215, 483.1754180754841, 445.30399646654064, 487.4506046483311, 480.66569801090697, 481.7171707941167, 460.16044046422587, 450.70492856925466, 482.4837095251169, 448.49799872064506, 446.759423071067, 446.6363489597629, 468.59892168509725, 468.96377592982003, 481.3378324042786, 450.9546041609572, 459.911221785618, 492.41227268573704, 459.61528221999026, 490.9890340857188, 449.78227481799803, 467.8992080173034, 476.2646014194785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28240844406858573, "mean_inference_ms": 2.3821908034925183, "mean_action_processing_ms": 0.10516150176857286, "mean_env_wait_ms": 2.050572542871566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075533390045166016, "StateBufferConnector_ms": 0.004149198532104492, "ViewRequirementAgentConnector_ms": 0.1075906753540039}, "num_episodes": 18, "episode_return_max": 513.394188065432, "episode_return_min": 445.30399646654064, "episode_return_mean": 480.72960614091375, "episodes_this_iter": 18}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316050, "num_agent_steps_trained": 315700, "num_env_steps_sampled": 316050, "num_env_steps_trained": 315700, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 2200, "num_env_steps_sampled_throughput_per_sec": 194.9304222261632, "num_env_steps_trained_throughput_per_sec": 219.92150199874823, "timesteps_total": 316050, "num_env_steps_sampled_lifetime": 316050, "num_agent_steps_sampled_lifetime": 316050, "num_steps_trained_this_iter": 2200, "agent_timesteps_total": 316050, "timers": {"training_iteration_time_ms": 10343.994, "restore_workers_time_ms": 0.015, "training_step_time_ms": 766.853, "sample_time_ms": 748.358, "synch_weights_time_ms": 16.931}, "counters": {"num_env_steps_sampled": 316050, "num_env_steps_trained": 315700, "num_agent_steps_sampled": 316050, "num_agent_steps_trained": 315700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2107, "num_samples_added_to_queue": 315700}, "done": false, "training_iteration": 152, "trial_id": "13390_00000", "date": "2024-10-13_01-04-55", "timestamp": 1728777895, "time_this_iter_s": 10.01542854309082, "time_total_s": 1583.2716219425201, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371c0a500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1583.2716219425201, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 19.05333333333333, "ram_util_percent": 74.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 290990.34375, "policy_loss": 281250.09375, "entropy": 11.22704792022705, "entropy_coeff": 0.01, "var_gnorm": 16.400571823120117, "vf_loss": 980199.5, "vf_explained_var": -0.01615309715270996}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 512.0, "num_grad_updates_lifetime": 577.0, "diff_num_grad_updates_vs_sampler_policy": 0.27272727272725206}}, "num_env_steps_sampled": 318000, "num_env_steps_trained": 317350, "num_agent_steps_sampled": 318000, "num_agent_steps_trained": 317350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2120, "num_samples_added_to_queue": 317900, "learner_queue": {"size_count": 577, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 87.644, "learner_load_time_ms": 0.373, "learner_load_wait_time_ms": 2724.378, "learner_dequeue_time_ms": 22512.163}}, "env_runners": {"episode_reward_max": 504.1853513661719, "episode_reward_min": 427.6933382070748, "episode_reward_mean": 474.05987383106583, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 427.6933382070748}, "policy_reward_max": {"default_policy": 504.1853513661719}, "policy_reward_mean": {"default_policy": 474.05987383106583}, "custom_metrics": {"num_consolidated_mean": 2.2356999999999996, "num_consolidated_min": 2.02, "num_consolidated_max": 2.5, "num_overloaded_mean": 0.016700000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.702900000000001, "num_moves_min": 3.14, "num_moves_max": 4.41, "mean_accuracy_mean": 42.17679333333334, "mean_accuracy_min": 42.07533333333335, "mean_accuracy_max": 42.26533333333336, "num_model_switches_mean": 0.8739999999999999, "num_model_switches_min": 0.59, "num_model_switches_max": 1.22, "num_slav_mean": 0.0074115, "num_slav_min": 0.0022500000000000003, "num_slav_max": 0.013566666666666664, "cpu_conserved_cost_mean": 5.523800000000001, "cpu_conserved_cost_min": 4.8, "cpu_conserved_cost_max": 6.36, "mean_cluster_cpu_util_mean": 0.4939844247952979, "mean_cluster_cpu_util_min": 0.4826108495827964, "mean_cluster_cpu_util_max": 0.5057725823237851, "mean_cluster_mem_util_mean": 0.3181785860081374, "mean_cluster_mem_util_min": 0.31057094473865493, "mean_cluster_mem_util_max": 0.3237566100490829, "reward_consolidation_mean_mean": -1.256837928356027, "reward_consolidation_mean_min": -1.433686679460234, "reward_consolidation_mean_max": -1.0374798196716322, "reward_illegal_mean_mean": -0.027833333333333328, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 6.312250000000019, "reward_accuracy_mean_min": 6.016666666666684, "reward_accuracy_mean_max": 6.516666666666687, "reward_sla_mean_mean": -0.28698, "reward_sla_mean_min": -0.5426666666666667, "reward_sla_mean_max": -0.08733333333333335, "reward_consolidation_sum_mean": -125.6837928356027, "reward_consolidation_sum_min": -143.3686679460234, "reward_consolidation_sum_max": -103.74798196716321, "reward_illegal_sum_mean": -2.7833333333333337, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 631.2250000000021, "reward_accuracy_sum_min": 601.6666666666684, "reward_accuracy_sum_max": 651.6666666666687, "reward_sla_sum_mean": -28.697999999999997, "reward_sla_sum_min": -54.26666666666667, "reward_sla_sum_max": -8.733333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2983.0, "global_timestep_min": 1300, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "cpu_conserved_cost": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156, 470.45568856803624, 472.5826312102124, 459.04821651588713, 473.92976941119315, 496.0862438697509, 488.01104511255465, 471.26634073532716, 464.3190075847593, 447.92247403210746, 476.770337201866, 454.77221359164326, 461.17564348594397, 463.39209844954337, 460.16594169789073, 467.89230253739254, 464.21163909957863, 490.89422157239215, 483.1754180754841, 445.30399646654064, 487.4506046483311, 480.66569801090697, 481.7171707941167, 460.16044046422587, 450.70492856925466, 482.4837095251169, 448.49799872064506, 446.759423071067, 446.6363489597629, 468.59892168509725, 468.96377592982003, 481.3378324042786, 450.9546041609572, 459.911221785618, 492.41227268573704, 459.61528221999026, 490.9890340857188, 449.78227481799803, 467.8992080173034, 476.2646014194785, 477.47263395169085, 461.28596972189393, 436.47534192330136, 480.69123945292466, 474.4462517895782, 427.6933382070748, 453.41406378506997, 450.3074933747618, 460.39904962076406, 472.4063145389765, 471.2909196137578, 447.31549544610095, 455.0008346279222, 471.10343598647717, 435.3801912942842, 460.0425873465552, 494.16685552408103, 460.19050534588513, 449.1401352462779, 485.59709098662955, 455.0132078345382], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [498.8572938560439, 493.6662737214067, 480.5985592007087, 494.4352675987712, 474.7475006853716, 472.47177495507185, 495.1429711535553, 491.27874135672926, 492.5510036857674, 501.43849035913587, 483.3114015047689, 491.0281854457965, 482.12579731335285, 496.3715312680881, 504.154421395719, 486.3097840324121, 480.13038776691536, 485.8849127296008, 491.1827225928312, 499.39077644765484, 504.1853513661719, 485.0862712845368, 480.167473879803, 489.94813427153036, 463.4737061744207, 459.1470498644509, 496.5421974473809, 484.96527460477205, 493.8075116512859, 465.78075786652204, 465.17383715617484, 488.96250571141564, 483.4437174449437, 476.96522586737507, 487.24632794176074, 489.77612781382476, 493.0656645039464, 487.39346614274166, 473.4425203326347, 500.3229278991156, 470.45568856803624, 472.5826312102124, 459.04821651588713, 473.92976941119315, 496.0862438697509, 488.01104511255465, 471.26634073532716, 464.3190075847593, 447.92247403210746, 476.770337201866, 454.77221359164326, 461.17564348594397, 463.39209844954337, 460.16594169789073, 467.89230253739254, 464.21163909957863, 490.89422157239215, 483.1754180754841, 445.30399646654064, 487.4506046483311, 480.66569801090697, 481.7171707941167, 460.16044046422587, 450.70492856925466, 482.4837095251169, 448.49799872064506, 446.759423071067, 446.6363489597629, 468.59892168509725, 468.96377592982003, 481.3378324042786, 450.9546041609572, 459.911221785618, 492.41227268573704, 459.61528221999026, 490.9890340857188, 449.78227481799803, 467.8992080173034, 476.2646014194785, 477.47263395169085, 461.28596972189393, 436.47534192330136, 480.69123945292466, 474.4462517895782, 427.6933382070748, 453.41406378506997, 450.3074933747618, 460.39904962076406, 472.4063145389765, 471.2909196137578, 447.31549544610095, 455.0008346279222, 471.10343598647717, 435.3801912942842, 460.0425873465552, 494.16685552408103, 460.19050534588513, 449.1401352462779, 485.59709098662955, 455.0132078345382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2824907926875135, "mean_inference_ms": 2.3842760027460215, "mean_action_processing_ms": 0.1051923287177955, "mean_env_wait_ms": 2.051465539996116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007643699645996094, "StateBufferConnector_ms": 0.0041675567626953125, "ViewRequirementAgentConnector_ms": 0.10778093338012695}, "num_episodes": 21, "episode_return_max": 504.1853513661719, "episode_return_min": 427.6933382070748, "episode_return_mean": 474.05987383106583, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318000, "num_agent_steps_trained": 317350, "num_env_steps_sampled": 318000, "num_env_steps_trained": 317350, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1650, "num_env_steps_sampled_throughput_per_sec": 193.1106272775323, "num_env_steps_trained_throughput_per_sec": 163.4013000040658, "timesteps_total": 318000, "num_env_steps_sampled_lifetime": 318000, "num_agent_steps_sampled_lifetime": 318000, "num_steps_trained_this_iter": 1650, "agent_timesteps_total": 318000, "timers": {"training_iteration_time_ms": 10285.831, "restore_workers_time_ms": 0.017, "training_step_time_ms": 748.59, "sample_time_ms": 729.944, "synch_weights_time_ms": 16.985}, "counters": {"num_env_steps_sampled": 318000, "num_env_steps_trained": 317350, "num_agent_steps_sampled": 318000, "num_agent_steps_trained": 317350, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2120, "num_samples_added_to_queue": 317900}, "done": false, "training_iteration": 153, "trial_id": "13390_00000", "date": "2024-10-13_01-05-06", "timestamp": 1728777906, "time_this_iter_s": 10.10983943939209, "time_total_s": 1593.3814613819122, "pid": 553761, "hostname": "support", "node_ip": "192.168.1.63", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -4, "penalty_consolidation": 10, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 37.3, "accuracy_upper": 44.9, "consolidation_lower": 0, "consolidation_upper": 0.8, "usage_lower": 0.4, "usage_upper": 0.8, "sla_lower": 0, "sla_upper": 0.1, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x78e371db4490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 512, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "linear", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x78e36b565c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.3, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1593.3814613819122, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 20.414285714285715, "ram_util_percent": 73.72142857142858}}
