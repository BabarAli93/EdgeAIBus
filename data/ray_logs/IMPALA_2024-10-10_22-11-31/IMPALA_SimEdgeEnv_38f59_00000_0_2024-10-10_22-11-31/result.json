{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -170566.5, "policy_loss": -171247.5, "entropy": 29.81866455078125, "entropy_coeff": 0.01, "var_gnorm": 16.00082778930664, "vf_loss": 77045.1328125, "vf_explained_var": 0.0006577968597412109}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 10.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 3150, "num_env_steps_trained": 3000, "num_agent_steps_sampled": 3150, "num_agent_steps_trained": 3000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 21, "num_samples_added_to_queue": 3000, "learner_queue": {"size_count": 10, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.065, "learner_load_time_ms": 0.098, "learner_load_wait_time_ms": 930.155, "learner_dequeue_time_ms": 4405.069}}, "env_runners": {"episode_reward_max": -160.94444444444431, "episode_reward_min": -218.19999999999996, "episode_reward_mean": -185.315074074074, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"default_policy": -218.19999999999996}, "policy_reward_max": {"default_policy": -160.94444444444431}, "policy_reward_mean": {"default_policy": -185.315074074074}, "custom_metrics": {"num_consolidated_mean": 0.6849999999999999, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0606666666666669, "num_overloaded_min": 0.93, "num_overloaded_max": 1.19, "num_moves_mean": 9.975999999999999, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.07719999999999, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.309000000000005, "num_model_switches_mean": 6.041666666666669, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.16039777777777778, "num_slav_min": 0.14303333333333332, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5721345078150875, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5960404056602335, "mean_cluster_mem_util_mean": 0.3669649835672665, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3766641052412526, "reward_consolidation_mean_mean": 0.17007407407407404, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.28, "reward_illegal_mean_mean": -1.7677777777777774, "reward_illegal_mean_min": -1.9833333333333334, "reward_illegal_mean_max": -1.5499999999999998, "reward_accuracy_mean_mean": 0.773201111111111, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0831666666666668, "reward_sla_mean_mean": -1.0286481481481482, "reward_sla_mean_min": -1.58, "reward_sla_mean_max": -0.6238888888888888, "reward_consolidation_sum_mean": 17.007407407407403, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 28.0, "reward_illegal_sum_mean": -176.7777777777778, "reward_illegal_sum_min": -198.33333333333334, "reward_illegal_sum_max": -154.99999999999997, "reward_accuracy_sum_mean": 77.32011111111112, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 108.31666666666669, "reward_sla_sum_mean": -102.86481481481482, "reward_sla_sum_min": -158.0, "reward_sla_sum_max": -62.388888888888886, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 550.0, "global_timestep_min": 100, "global_timestep_max": 1000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.51999999999992, -160.95888888888885, -193.9766666666666, -184.97222222222211, -218.19999999999996, -165.23555555555544, -183.43222222222215, -160.94444444444431, -182.82222222222214, -165.9144444444444, -183.71444444444444, -187.01666666666668, -197.8611111111109, -195.90555555555542, -198.76888888888877, -203.17222222222216, -171.5222222222222, -190.60777777777773, -187.76555555555555, -168.54111111111104, -213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.51999999999992, -160.95888888888885, -193.9766666666666, -184.97222222222211, -218.19999999999996, -165.23555555555544, -183.43222222222215, -160.94444444444431, -182.82222222222214, -165.9144444444444, -183.71444444444444, -187.01666666666668, -197.8611111111109, -195.90555555555542, -198.76888888888877, -203.17222222222216, -171.5222222222222, -190.60777777777773, -187.76555555555555, -168.54111111111104, -213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18063190434797965, "mean_inference_ms": 1.7704535695132548, "mean_action_processing_ms": 0.06979373081351252, "mean_env_wait_ms": 1.1387653211695865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052992502848307295, "StateBufferConnector_ms": 0.0026313463846842446, "ViewRequirementAgentConnector_ms": 0.05848010381062826}, "num_episodes": 30, "episode_return_max": -160.94444444444431, "episode_return_min": -218.19999999999996, "episode_return_mean": -185.315074074074, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3150, "num_agent_steps_trained": 3000, "num_env_steps_sampled": 3150, "num_env_steps_trained": 3000, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 304.35345869867626, "num_env_steps_trained_throughput_per_sec": 289.86043685588214, "timesteps_total": 3150, "num_env_steps_sampled_lifetime": 3150, "num_agent_steps_sampled_lifetime": 3150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 3150, "timers": {"training_iteration_time_ms": 10349.816, "restore_workers_time_ms": 0.012, "training_step_time_ms": 507.48, "sample_time_ms": 493.005, "synch_weights_time_ms": 13.229}, "counters": {"num_env_steps_sampled": 3150, "num_env_steps_trained": 3000, "num_agent_steps_sampled": 3150, "num_agent_steps_trained": 3000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 21, "num_samples_added_to_queue": 3000}, "done": false, "training_iteration": 1, "trial_id": "38f59_00000", "date": "2024-10-10_22-11-42", "timestamp": 1728594702, "time_this_iter_s": 10.358895063400269, "time_total_s": 10.358895063400269, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.358895063400269, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 10.773333333333333, "ram_util_percent": 52.31333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -162518.578125, "policy_loss": -163134.21875, "entropy": 29.818492889404297, "entropy_coeff": 0.01, "var_gnorm": 16.00103187561035, "vf_loss": 70509.46875, "vf_explained_var": 0.0013412237167358398}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 5850, "num_env_steps_trained": 5700, "num_agent_steps_sampled": 5850, "num_agent_steps_trained": 5700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 39, "num_samples_added_to_queue": 5700, "learner_queue": {"size_count": 19, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.872, "learner_load_time_ms": 0.101, "learner_load_wait_time_ms": 1072.98, "learner_dequeue_time_ms": 6063.109}}, "env_runners": {"episode_reward_max": -136.76555555555555, "episode_reward_min": -223.36555555555557, "episode_reward_mean": -178.71892787524362, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 5700, "policy_reward_min": {"default_policy": -223.36555555555557}, "policy_reward_max": {"default_policy": -136.76555555555555}, "policy_reward_mean": {"default_policy": -178.71892787524362}, "custom_metrics": {"num_consolidated_mean": 0.6849122807017545, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0496491228070175, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.986315789473684, "num_moves_min": 9.7, "num_moves_max": 10.25, "mean_accuracy_mean": 41.08399999999999, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 6.019298245614035, "num_model_switches_min": 5.65, "num_model_switches_max": 6.38, "num_slav_mean": 0.15974093567251463, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5709866335633648, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5960404056602335, "mean_cluster_mem_util_mean": 0.36607618653890606, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3766641052412526, "reward_consolidation_mean_mean": 0.18502923976608185, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.34222222222222215, "reward_illegal_mean_mean": -1.7494152046783624, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7881713450292398, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.0951333333333333, "reward_sla_mean_mean": -1.0109746588693955, "reward_sla_mean_min": -1.58, "reward_sla_mean_max": -0.6222222222222222, "reward_consolidation_sum_mean": 18.502923976608184, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 34.222222222222214, "reward_illegal_sum_mean": -174.94152046783623, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 78.81713450292398, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 109.51333333333332, "reward_sla_sum_mean": -101.09746588693957, "reward_sla_sum_min": -158.0, "reward_sla_sum_max": -62.22222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1000.0, "global_timestep_min": 100, "global_timestep_max": 1900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.51999999999992, -160.95888888888885, -193.9766666666666, -184.97222222222211, -218.19999999999996, -165.23555555555544, -183.43222222222215, -160.94444444444431, -182.82222222222214, -165.9144444444444, -183.71444444444444, -187.01666666666668, -197.8611111111109, -195.90555555555542, -198.76888888888877, -203.17222222222216, -171.5222222222222, -190.60777777777773, -187.76555555555555, -168.54111111111104, -213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432, -140.35777777777784, -136.76555555555555, -167.99777777777766, -190.3244444444445, -180.19333333333327, -205.1244444444445, -188.39333333333326, -169.19333333333321, -185.44444444444449, -187.61888888888876, -149.12000000000003, -163.56666666666672, -148.64222222222222, -167.12444444444444, -188.65111111111113, -166.1211111111111, -203.7622222222222, -177.3388888888889, -223.36555555555557, -173.7022222222221, -167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.51999999999992, -160.95888888888885, -193.9766666666666, -184.97222222222211, -218.19999999999996, -165.23555555555544, -183.43222222222215, -160.94444444444431, -182.82222222222214, -165.9144444444444, -183.71444444444444, -187.01666666666668, -197.8611111111109, -195.90555555555542, -198.76888888888877, -203.17222222222216, -171.5222222222222, -190.60777777777773, -187.76555555555555, -168.54111111111104, -213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432, -140.35777777777784, -136.76555555555555, -167.99777777777766, -190.3244444444445, -180.19333333333327, -205.1244444444445, -188.39333333333326, -169.19333333333321, -185.44444444444449, -187.61888888888876, -149.12000000000003, -163.56666666666672, -148.64222222222222, -167.12444444444444, -188.65111111111113, -166.1211111111111, -203.7622222222222, -177.3388888888889, -223.36555555555557, -173.7022222222221, -167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18848268320132253, "mean_inference_ms": 1.8315421996228602, "mean_action_processing_ms": 0.07211903001947034, "mean_env_wait_ms": 1.1731603554816474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005013482612476014, "StateBufferConnector_ms": 0.0028530756632486978, "ViewRequirementAgentConnector_ms": 0.06601810455322266}, "num_episodes": 27, "episode_return_max": -136.76555555555555, "episode_return_min": -223.36555555555557, "episode_return_mean": -178.71892787524362, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5850, "num_agent_steps_trained": 5700, "num_env_steps_sampled": 5850, "num_env_steps_trained": 5700, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.74670692767836, "num_env_steps_trained_throughput_per_sec": 263.74670692767836, "timesteps_total": 5850, "num_env_steps_sampled_lifetime": 5850, "num_agent_steps_sampled_lifetime": 5850, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 5850, "timers": {"training_iteration_time_ms": 10293.46, "restore_workers_time_ms": 0.012, "training_step_time_ms": 586.251, "sample_time_ms": 570.977, "synch_weights_time_ms": 13.769}, "counters": {"num_env_steps_sampled": 5850, "num_env_steps_trained": 5700, "num_agent_steps_sampled": 5850, "num_agent_steps_trained": 5700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 39, "num_samples_added_to_queue": 5700}, "done": false, "training_iteration": 2, "trial_id": "38f59_00000", "date": "2024-10-10_22-11-53", "timestamp": 1728594713, "time_this_iter_s": 10.245123624801636, "time_total_s": 20.604018688201904, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1bb20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.604018688201904, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 19.526666666666667, "ram_util_percent": 54.926666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -183032.828125, "policy_loss": -183821.03125, "entropy": 29.818254470825195, "entropy_coeff": 0.01, "var_gnorm": 16.00217628479004, "vf_loss": 87764.984375, "vf_explained_var": 0.001971304416656494}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 29.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 9000, "num_env_steps_trained": 8700, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 8700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 60, "num_samples_added_to_queue": 9000, "learner_queue": {"size_count": 29, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.697, "learner_load_time_ms": 0.168, "learner_load_wait_time_ms": 917.613, "learner_dequeue_time_ms": 6529.642}}, "env_runners": {"episode_reward_max": -136.76555555555555, "episode_reward_min": -223.36555555555557, "episode_reward_mean": -181.15155555555552, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 9000, "policy_reward_min": {"default_policy": -223.36555555555557}, "policy_reward_max": {"default_policy": -136.76555555555555}, "policy_reward_mean": {"default_policy": -181.15155555555552}, "custom_metrics": {"num_consolidated_mean": 0.675888888888889, "num_consolidated_min": 0.53, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0490000000000002, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.988888888888889, "num_moves_min": 9.7, "num_moves_max": 10.32, "mean_accuracy_mean": 41.093385185185184, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.999222222222222, "num_model_switches_min": 5.62, "num_model_switches_max": 6.38, "num_slav_mean": 0.16073981481481484, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18338333333333331, "mean_cluster_cpu_util_mean": 0.5709602522981041, "mean_cluster_cpu_util_min": 0.5537982262292958, "mean_cluster_cpu_util_max": 0.5960404056602335, "mean_cluster_mem_util_mean": 0.36608003041969256, "mean_cluster_mem_util_min": 0.3573650623223973, "mean_cluster_mem_util_max": 0.3766641052412526, "reward_consolidation_mean_mean": 0.1847654320987654, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.34222222222222215, "reward_illegal_mean_mean": -1.7483333333333329, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333332, "reward_accuracy_mean_mean": 0.7902807407407408, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -1.0382283950617284, "reward_sla_mean_min": -1.6727777777777777, "reward_sla_mean_max": -0.6222222222222222, "reward_consolidation_sum_mean": 18.476543209876542, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 34.222222222222214, "reward_illegal_sum_mean": -174.83333333333334, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.33333333333331, "reward_accuracy_sum_mean": 79.02807407407407, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -103.82283950617283, "reward_sla_sum_min": -167.27777777777777, "reward_sla_sum_max": -62.22222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 1550.0, "global_timestep_min": 100, "global_timestep_max": 3000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-182.51999999999992, -160.95888888888885, -193.9766666666666, -184.97222222222211, -218.19999999999996, -165.23555555555544, -183.43222222222215, -160.94444444444431, -182.82222222222214, -165.9144444444444, -183.71444444444444, -187.01666666666668, -197.8611111111109, -195.90555555555542, -198.76888888888877, -203.17222222222216, -171.5222222222222, -190.60777777777773, -187.76555555555555, -168.54111111111104, -213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432, -140.35777777777784, -136.76555555555555, -167.99777777777766, -190.3244444444445, -180.19333333333327, -205.1244444444445, -188.39333333333326, -169.19333333333321, -185.44444444444449, -187.61888888888876, -149.12000000000003, -163.56666666666672, -148.64222222222222, -167.12444444444444, -188.65111111111113, -166.1211111111111, -203.7622222222222, -177.3388888888889, -223.36555555555557, -173.7022222222221, -167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556, -199.26222222222216, -167.95666666666668, -181.14555555555557, -183.83777777777775, -185.25333333333336, -183.83222222222213, -158.75888888888883, -187.73666666666662, -186.1033333333333, -201.4766666666666, -181.06444444444432, -194.85555555555544, -159.121111111111, -182.82777777777778, -168.48555555555552, -184.80999999999997, -199.5833333333332, -171.0788888888889, -199.9688888888889, -217.7222222222222, -175.9655555555555, -200.80777777777766, -183.06555555555536, -195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-182.51999999999992, -160.95888888888885, -193.9766666666666, -184.97222222222211, -218.19999999999996, -165.23555555555544, -183.43222222222215, -160.94444444444431, -182.82222222222214, -165.9144444444444, -183.71444444444444, -187.01666666666668, -197.8611111111109, -195.90555555555542, -198.76888888888877, -203.17222222222216, -171.5222222222222, -190.60777777777773, -187.76555555555555, -168.54111111111104, -213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432, -140.35777777777784, -136.76555555555555, -167.99777777777766, -190.3244444444445, -180.19333333333327, -205.1244444444445, -188.39333333333326, -169.19333333333321, -185.44444444444449, -187.61888888888876, -149.12000000000003, -163.56666666666672, -148.64222222222222, -167.12444444444444, -188.65111111111113, -166.1211111111111, -203.7622222222222, -177.3388888888889, -223.36555555555557, -173.7022222222221, -167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556, -199.26222222222216, -167.95666666666668, -181.14555555555557, -183.83777777777775, -185.25333333333336, -183.83222222222213, -158.75888888888883, -187.73666666666662, -186.1033333333333, -201.4766666666666, -181.06444444444432, -194.85555555555544, -159.121111111111, -182.82777777777778, -168.48555555555552, -184.80999999999997, -199.5833333333332, -171.0788888888889, -199.9688888888889, -217.7222222222222, -175.9655555555555, -200.80777777777766, -183.06555555555536, -195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18993035702906605, "mean_inference_ms": 1.8312550803188, "mean_action_processing_ms": 0.07244358381906466, "mean_env_wait_ms": 1.1781153064393064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004587438371446397, "StateBufferConnector_ms": 0.002775986989339193, "ViewRequirementAgentConnector_ms": 0.06447129779391819}, "num_episodes": 33, "episode_return_max": -136.76555555555555, "episode_return_min": -223.36555555555557, "episode_return_mean": -181.15155555555552, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 8700, "num_env_steps_sampled": 9000, "num_env_steps_trained": 8700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 309.9040511967142, "num_env_steps_trained_throughput_per_sec": 295.1467154254421, "timesteps_total": 9000, "num_env_steps_sampled_lifetime": 9000, "num_agent_steps_sampled_lifetime": 9000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 9000, "timers": {"training_iteration_time_ms": 10250.454, "restore_workers_time_ms": 0.01, "training_step_time_ms": 469.903, "sample_time_ms": 457.002, "synch_weights_time_ms": 11.652}, "counters": {"num_env_steps_sampled": 9000, "num_env_steps_trained": 8700, "num_agent_steps_sampled": 9000, "num_agent_steps_trained": 8700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 60, "num_samples_added_to_queue": 9000}, "done": false, "training_iteration": 3, "trial_id": "38f59_00000", "date": "2024-10-10_22-12-03", "timestamp": 1728594723, "time_this_iter_s": 10.174571990966797, "time_total_s": 30.7785906791687, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcf730>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.7785906791687, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.0, "ram_util_percent": 56.635714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -181587.5625, "policy_loss": -182394.390625, "entropy": 29.81788444519043, "entropy_coeff": 0.01, "var_gnorm": 16.00376319885254, "vf_loss": 89627.4453125, "vf_explained_var": 0.0025649070739746094}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 11700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 80, "num_samples_added_to_queue": 12000, "learner_queue": {"size_count": 39, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.056, "learner_load_time_ms": 0.165, "learner_load_wait_time_ms": 949.555, "learner_dequeue_time_ms": 6765.059}}, "env_runners": {"episode_reward_max": -136.76555555555555, "episode_reward_min": -223.36555555555557, "episode_reward_mean": -179.4243777777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -223.36555555555557}, "policy_reward_max": {"default_policy": -136.76555555555555}, "policy_reward_mean": {"default_policy": -179.4243777777777}, "custom_metrics": {"num_consolidated_mean": 0.6765000000000001, "num_consolidated_min": 0.53, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.046, "num_overloaded_min": 0.92, "num_overloaded_max": 1.2, "num_moves_mean": 9.979099999999999, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.10304, "mean_accuracy_min": 40.79599999999999, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.985100000000001, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.16211183333333337, "num_slav_min": 0.13931666666666667, "num_slav_max": 0.18098333333333333, "mean_cluster_cpu_util_mean": 0.5705087677397016, "mean_cluster_cpu_util_min": 0.5520417576486554, "mean_cluster_cpu_util_max": 0.5986552598050494, "mean_cluster_mem_util_mean": 0.36574900846752206, "mean_cluster_mem_util_min": 0.35638516551135224, "mean_cluster_mem_util_max": 0.38083032503085634, "reward_consolidation_mean_mean": 0.18759999999999993, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.34222222222222215, "reward_illegal_mean_mean": -1.7433333333333332, "reward_illegal_mean_min": -1.9999999999999998, "reward_illegal_mean_max": -1.5333333333333328, "reward_accuracy_mean_mean": 0.7926173333333331, "reward_accuracy_mean_min": 0.49129999999999996, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -1.0311277777777779, "reward_sla_mean_min": -1.6727777777777777, "reward_sla_mean_max": -0.6222222222222222, "reward_consolidation_sum_mean": 18.759999999999998, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 34.222222222222214, "reward_illegal_sum_mean": -174.33333333333331, "reward_illegal_sum_min": -199.99999999999997, "reward_illegal_sum_max": -153.3333333333333, "reward_accuracy_sum_mean": 79.26173333333335, "reward_accuracy_sum_min": 49.129999999999995, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -103.11277777777775, "reward_sla_sum_min": -167.27777777777777, "reward_sla_sum_max": -62.22222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2350.0, "global_timestep_min": 100, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432, -140.35777777777784, -136.76555555555555, -167.99777777777766, -190.3244444444445, -180.19333333333327, -205.1244444444445, -188.39333333333326, -169.19333333333321, -185.44444444444449, -187.61888888888876, -149.12000000000003, -163.56666666666672, -148.64222222222222, -167.12444444444444, -188.65111111111113, -166.1211111111111, -203.7622222222222, -177.3388888888889, -223.36555555555557, -173.7022222222221, -167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556, -199.26222222222216, -167.95666666666668, -181.14555555555557, -183.83777777777775, -185.25333333333336, -183.83222222222213, -158.75888888888883, -187.73666666666662, -186.1033333333333, -201.4766666666666, -181.06444444444432, -194.85555555555544, -159.121111111111, -182.82777777777778, -168.48555555555552, -184.80999999999997, -199.5833333333332, -171.0788888888889, -199.9688888888889, -217.7222222222222, -175.9655555555555, -200.80777777777766, -183.06555555555536, -195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987, -165.48888888888877, -166.15888888888895, -161.0755555555555, -167.92666666666665, -186.40888888888892, -193.4144444444443, -190.5755555555555, -193.1233333333333, -195.75555555555556, -154.35555555555553, -169.7722222222222, -195.39999999999984, -165.98888888888885, -182.12888888888887, -189.86555555555546, -178.25888888888883, -193.6622222222221, -160.37444444444444, -206.5455555555555, -193.01888888888877, -186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-213.41999999999985, -195.48111111111103, -193.7688888888889, -192.50222222222214, -183.52999999999997, -184.7055555555555, -175.7833333333334, -167.06111111111107, -190.22333333333333, -179.12444444444432, -140.35777777777784, -136.76555555555555, -167.99777777777766, -190.3244444444445, -180.19333333333327, -205.1244444444445, -188.39333333333326, -169.19333333333321, -185.44444444444449, -187.61888888888876, -149.12000000000003, -163.56666666666672, -148.64222222222222, -167.12444444444444, -188.65111111111113, -166.1211111111111, -203.7622222222222, -177.3388888888889, -223.36555555555557, -173.7022222222221, -167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556, -199.26222222222216, -167.95666666666668, -181.14555555555557, -183.83777777777775, -185.25333333333336, -183.83222222222213, -158.75888888888883, -187.73666666666662, -186.1033333333333, -201.4766666666666, -181.06444444444432, -194.85555555555544, -159.121111111111, -182.82777777777778, -168.48555555555552, -184.80999999999997, -199.5833333333332, -171.0788888888889, -199.9688888888889, -217.7222222222222, -175.9655555555555, -200.80777777777766, -183.06555555555536, -195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987, -165.48888888888877, -166.15888888888895, -161.0755555555555, -167.92666666666665, -186.40888888888892, -193.4144444444443, -190.5755555555555, -193.1233333333333, -195.75555555555556, -154.35555555555553, -169.7722222222222, -195.39999999999984, -165.98888888888885, -182.12888888888887, -189.86555555555546, -178.25888888888883, -193.6622222222221, -160.37444444444444, -206.5455555555555, -193.01888888888877, -186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19226433210058494, "mean_inference_ms": 1.8273517202919667, "mean_action_processing_ms": 0.07298956857613777, "mean_env_wait_ms": 1.1858803243027167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043942928314208984, "StateBufferConnector_ms": 0.0028214454650878906, "ViewRequirementAgentConnector_ms": 0.06707501411437988}, "num_episodes": 30, "episode_return_max": -136.76555555555555, "episode_return_min": -223.36555555555557, "episode_return_mean": -179.4243777777777, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 11700, "num_env_steps_sampled": 12000, "num_env_steps_trained": 11700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.87985848157575, "num_env_steps_trained_throughput_per_sec": 297.87985848157575, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 10205.636, "restore_workers_time_ms": 0.012, "training_step_time_ms": 508.853, "sample_time_ms": 493.716, "synch_weights_time_ms": 13.716}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 11700, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 11700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 80, "num_samples_added_to_queue": 12000}, "done": false, "training_iteration": 4, "trial_id": "38f59_00000", "date": "2024-10-10_22-12-13", "timestamp": 1728594733, "time_this_iter_s": 10.080741882324219, "time_total_s": 40.85933256149292, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79c1f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.85933256149292, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.526666666666666, "ram_util_percent": 54.419999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -181038.5, "policy_loss": -181814.8125, "entropy": 29.817455291748047, "entropy_coeff": 0.01, "var_gnorm": 16.005401611328125, "vf_loss": 86576.984375, "vf_explained_var": 0.0038196444511413574}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 49.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 15000, "num_env_steps_trained": 14700, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 14700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 100, "num_samples_added_to_queue": 15000, "learner_queue": {"size_count": 49, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.278, "learner_load_time_ms": 0.194, "learner_load_wait_time_ms": 954.064, "learner_dequeue_time_ms": 7122.148}}, "env_runners": {"episode_reward_max": -143.87555555555556, "episode_reward_min": -221.03444444444435, "episode_reward_mean": -179.20885555555546, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -221.03444444444435}, "policy_reward_max": {"default_policy": -143.87555555555556}, "policy_reward_mean": {"default_policy": -179.20885555555546}, "custom_metrics": {"num_consolidated_mean": 0.6700999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0387, "num_overloaded_min": 0.9, "num_overloaded_max": 1.16, "num_moves_mean": 9.983600000000001, "num_moves_min": 9.6, "num_moves_max": 10.32, "mean_accuracy_mean": 41.106523333333335, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.36600000000001, "num_model_switches_mean": 5.993899999999999, "num_model_switches_min": 5.62, "num_model_switches_max": 6.41, "num_slav_mean": 0.16352483333333334, "num_slav_min": 0.14343333333333336, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5693530325703731, "mean_cluster_cpu_util_min": 0.5485653761912621, "mean_cluster_cpu_util_max": 0.5986552598050494, "mean_cluster_mem_util_mean": 0.3653007348840381, "mean_cluster_mem_util_min": 0.35638516551135224, "mean_cluster_mem_util_max": 0.38083032503085634, "reward_consolidation_mean_mean": 0.1888444444444444, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.3733333333333333, "reward_illegal_mean_mean": -1.7311666666666667, "reward_illegal_mean_min": -1.933333333333333, "reward_illegal_mean_max": -1.4999999999999998, "reward_accuracy_mean_mean": 0.8079503333333333, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.1419333333333332, "reward_sla_mean_mean": -1.0577166666666664, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.6233333333333333, "reward_consolidation_sum_mean": 18.884444444444444, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 37.33333333333333, "reward_illegal_sum_mean": -173.11666666666665, "reward_illegal_sum_min": -193.3333333333333, "reward_illegal_sum_max": -149.99999999999997, "reward_accuracy_sum_mean": 80.79503333333334, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 114.19333333333333, "reward_sla_sum_mean": -105.77166666666668, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -62.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3367.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556, -199.26222222222216, -167.95666666666668, -181.14555555555557, -183.83777777777775, -185.25333333333336, -183.83222222222213, -158.75888888888883, -187.73666666666662, -186.1033333333333, -201.4766666666666, -181.06444444444432, -194.85555555555544, -159.121111111111, -182.82777777777778, -168.48555555555552, -184.80999999999997, -199.5833333333332, -171.0788888888889, -199.9688888888889, -217.7222222222222, -175.9655555555555, -200.80777777777766, -183.06555555555536, -195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987, -165.48888888888877, -166.15888888888895, -161.0755555555555, -167.92666666666665, -186.40888888888892, -193.4144444444443, -190.5755555555555, -193.1233333333333, -195.75555555555556, -154.35555555555553, -169.7722222222222, -195.39999999999984, -165.98888888888885, -182.12888888888887, -189.86555555555546, -178.25888888888883, -193.6622222222221, -160.37444444444444, -206.5455555555555, -193.01888888888877, -186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892, -169.8677777777777, -189.80222222222204, -175.38444444444437, -160.2933333333333, -177.91111111111098, -181.6399999999999, -184.56111111111107, -164.59444444444438, -171.5233333333333, -191.45444444444433, -164.89111111111112, -181.69777777777767, -203.41444444444434, -193.50222222222226, -193.18555555555554, -158.92999999999998, -180.56555555555553, -156.96000000000006, -200.17444444444436, -200.34888888888878, -185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-167.8799999999999, -169.8733333333333, -155.82000000000002, -153.34444444444438, -168.8999999999999, -155.0255555555556, -143.87555555555556, -199.26222222222216, -167.95666666666668, -181.14555555555557, -183.83777777777775, -185.25333333333336, -183.83222222222213, -158.75888888888883, -187.73666666666662, -186.1033333333333, -201.4766666666666, -181.06444444444432, -194.85555555555544, -159.121111111111, -182.82777777777778, -168.48555555555552, -184.80999999999997, -199.5833333333332, -171.0788888888889, -199.9688888888889, -217.7222222222222, -175.9655555555555, -200.80777777777766, -183.06555555555536, -195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987, -165.48888888888877, -166.15888888888895, -161.0755555555555, -167.92666666666665, -186.40888888888892, -193.4144444444443, -190.5755555555555, -193.1233333333333, -195.75555555555556, -154.35555555555553, -169.7722222222222, -195.39999999999984, -165.98888888888885, -182.12888888888887, -189.86555555555546, -178.25888888888883, -193.6622222222221, -160.37444444444444, -206.5455555555555, -193.01888888888877, -186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892, -169.8677777777777, -189.80222222222204, -175.38444444444437, -160.2933333333333, -177.91111111111098, -181.6399999999999, -184.56111111111107, -164.59444444444438, -171.5233333333333, -191.45444444444433, -164.89111111111112, -181.69777777777767, -203.41444444444434, -193.50222222222226, -193.18555555555554, -158.92999999999998, -180.56555555555553, -156.96000000000006, -200.17444444444436, -200.34888888888878, -185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19251686270462798, "mean_inference_ms": 1.817262992479659, "mean_action_processing_ms": 0.0730172954938009, "mean_env_wait_ms": 1.1867823845695735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004146575927734375, "StateBufferConnector_ms": 0.002771615982055664, "ViewRequirementAgentConnector_ms": 0.0660703182220459}, "num_episodes": 30, "episode_return_max": -143.87555555555556, "episode_return_min": -221.03444444444435, "episode_return_mean": -179.20885555555546, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 14700, "num_env_steps_sampled": 15000, "num_env_steps_trained": 14700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.2148142212091, "num_env_steps_trained_throughput_per_sec": 299.2148142212091, "timesteps_total": 15000, "num_env_steps_sampled_lifetime": 15000, "num_agent_steps_sampled_lifetime": 15000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 15000, "timers": {"training_iteration_time_ms": 10169.759, "restore_workers_time_ms": 0.012, "training_step_time_ms": 505.586, "sample_time_ms": 491.39, "synch_weights_time_ms": 12.868}, "counters": {"num_env_steps_sampled": 15000, "num_env_steps_trained": 14700, "num_agent_steps_sampled": 15000, "num_agent_steps_trained": 14700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 100, "num_samples_added_to_queue": 15000}, "done": false, "training_iteration": 5, "trial_id": "38f59_00000", "date": "2024-10-10_22-12-23", "timestamp": 1728594743, "time_this_iter_s": 10.037177085876465, "time_total_s": 50.896509647369385, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcee60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.896509647369385, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 11.121428571428572, "ram_util_percent": 52.03571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -178278.09375, "policy_loss": -179022.359375, "entropy": 29.81671905517578, "entropy_coeff": 0.01, "var_gnorm": 16.0078125, "vf_loss": 83371.9765625, "vf_explained_var": 0.005243539810180664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 17700, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 17700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 120, "num_samples_added_to_queue": 18000, "learner_queue": {"size_count": 59, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.663, "learner_load_time_ms": 0.218, "learner_load_wait_time_ms": 988.036, "learner_dequeue_time_ms": 7285.417}}, "env_runners": {"episode_reward_max": -133.85444444444454, "episode_reward_min": -221.03444444444435, "episode_reward_mean": -179.9842222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -221.03444444444435}, "policy_reward_max": {"default_policy": -133.85444444444454}, "policy_reward_mean": {"default_policy": -179.9842222222222}, "custom_metrics": {"num_consolidated_mean": 0.6786999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.85, "num_overloaded_mean": 1.0453000000000001, "num_overloaded_min": 0.89, "num_overloaded_max": 1.18, "num_moves_mean": 9.986600000000001, "num_moves_min": 9.6, "num_moves_max": 10.27, "mean_accuracy_mean": 41.10766333333333, "mean_accuracy_min": 40.852999999999994, "mean_accuracy_max": 41.347, "num_model_switches_mean": 6.0014, "num_model_switches_min": 5.57, "num_model_switches_max": 6.43, "num_slav_mean": 0.16362916666666671, "num_slav_min": 0.14358333333333329, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.569730862374783, "mean_cluster_cpu_util_min": 0.5485653761912621, "mean_cluster_cpu_util_max": 0.5986552598050494, "mean_cluster_mem_util_mean": 0.36551709762765866, "mean_cluster_mem_util_min": 0.35638516551135224, "mean_cluster_mem_util_max": 0.38083032503085634, "reward_consolidation_mean_mean": 0.18713333333333332, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.3733333333333333, "reward_illegal_mean_mean": -1.7421666666666664, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.79908, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.2159, "reward_sla_mean_mean": -1.0438888888888889, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.5672222222222223, "reward_consolidation_sum_mean": 18.71333333333333, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 37.33333333333333, "reward_illegal_sum_mean": -174.21666666666664, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 79.908, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 121.58999999999999, "reward_sla_sum_mean": -104.38888888888889, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -56.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4350.0, "global_timestep_min": 2100, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987, -165.48888888888877, -166.15888888888895, -161.0755555555555, -167.92666666666665, -186.40888888888892, -193.4144444444443, -190.5755555555555, -193.1233333333333, -195.75555555555556, -154.35555555555553, -169.7722222222222, -195.39999999999984, -165.98888888888885, -182.12888888888887, -189.86555555555546, -178.25888888888883, -193.6622222222221, -160.37444444444444, -206.5455555555555, -193.01888888888877, -186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892, -169.8677777777777, -189.80222222222204, -175.38444444444437, -160.2933333333333, -177.91111111111098, -181.6399999999999, -184.56111111111107, -164.59444444444438, -171.5233333333333, -191.45444444444433, -164.89111111111112, -181.69777777777767, -203.41444444444434, -193.50222222222226, -193.18555555555554, -158.92999999999998, -180.56555555555553, -156.96000000000006, -200.17444444444436, -200.34888888888878, -185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538, -174.14888888888885, -180.61333333333332, -167.4666666666667, -198.4799999999998, -174.75111111111102, -217.80666666666653, -182.33888888888882, -172.65444444444455, -191.85333333333327, -202.49777777777774, -185.97888888888886, -178.42222222222216, -185.78111111111122, -206.91777777777776, -184.79444444444442, -155.67222222222225, -195.73111111111103, -176.2066666666667, -183.53666666666655, -206.0677777777778, -169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-195.3022222222221, -158.12111111111113, -183.96999999999997, -195.7822222222222, -187.8533333333332, -161.41777777777773, -221.03444444444435, -201.58444444444436, -173.42555555555563, -183.44999999999987, -165.48888888888877, -166.15888888888895, -161.0755555555555, -167.92666666666665, -186.40888888888892, -193.4144444444443, -190.5755555555555, -193.1233333333333, -195.75555555555556, -154.35555555555553, -169.7722222222222, -195.39999999999984, -165.98888888888885, -182.12888888888887, -189.86555555555546, -178.25888888888883, -193.6622222222221, -160.37444444444444, -206.5455555555555, -193.01888888888877, -186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892, -169.8677777777777, -189.80222222222204, -175.38444444444437, -160.2933333333333, -177.91111111111098, -181.6399999999999, -184.56111111111107, -164.59444444444438, -171.5233333333333, -191.45444444444433, -164.89111111111112, -181.69777777777767, -203.41444444444434, -193.50222222222226, -193.18555555555554, -158.92999999999998, -180.56555555555553, -156.96000000000006, -200.17444444444436, -200.34888888888878, -185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538, -174.14888888888885, -180.61333333333332, -167.4666666666667, -198.4799999999998, -174.75111111111102, -217.80666666666653, -182.33888888888882, -172.65444444444455, -191.85333333333327, -202.49777777777774, -185.97888888888886, -178.42222222222216, -185.78111111111122, -206.91777777777776, -184.79444444444442, -155.67222222222225, -195.73111111111103, -176.2066666666667, -183.53666666666655, -206.0677777777778, -169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19277879713910712, "mean_inference_ms": 1.8058970064658695, "mean_action_processing_ms": 0.0730265466601925, "mean_env_wait_ms": 1.1868240678203121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042858123779296875, "StateBufferConnector_ms": 0.0028214454650878906, "ViewRequirementAgentConnector_ms": 0.06719684600830078}, "num_episodes": 30, "episode_return_max": -133.85444444444454, "episode_return_min": -221.03444444444435, "episode_return_mean": -179.9842222222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 17700, "num_env_steps_sampled": 18000, "num_env_steps_trained": 17700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.87521985162135, "num_env_steps_trained_throughput_per_sec": 286.87521985162135, "timesteps_total": 18000, "num_env_steps_sampled_lifetime": 18000, "num_agent_steps_sampled_lifetime": 18000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 10217.719, "restore_workers_time_ms": 0.012, "training_step_time_ms": 518.608, "sample_time_ms": 503.83, "synch_weights_time_ms": 13.507}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 17700, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 17700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 120, "num_samples_added_to_queue": 18000}, "done": false, "training_iteration": 6, "trial_id": "38f59_00000", "date": "2024-10-10_22-12-34", "timestamp": 1728594754, "time_this_iter_s": 10.468846321105957, "time_total_s": 61.36535596847534, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79f280>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.36535596847534, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.773333333333335, "ram_util_percent": 52.46666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -167867.390625, "policy_loss": -168557.234375, "entropy": 29.81570053100586, "entropy_coeff": 0.01, "var_gnorm": 16.01045799255371, "vf_loss": 77929.0625, "vf_explained_var": 0.006029486656188965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 70.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 21150, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21150, "num_agent_steps_trained": 21000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 141, "num_samples_added_to_queue": 21000, "learner_queue": {"size_count": 70, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.426, "learner_load_time_ms": 0.23, "learner_load_wait_time_ms": 918.21, "learner_dequeue_time_ms": 7400.526}}, "env_runners": {"episode_reward_max": -133.85444444444454, "episode_reward_min": -217.80666666666653, "episode_reward_mean": -177.95552222222213, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -217.80666666666653}, "policy_reward_max": {"default_policy": -133.85444444444454}, "policy_reward_mean": {"default_policy": -177.95552222222213}, "custom_metrics": {"num_consolidated_mean": 0.6736999999999999, "num_consolidated_min": 0.53, "num_consolidated_max": 0.82, "num_overloaded_mean": 1.034, "num_overloaded_min": 0.89, "num_overloaded_max": 1.18, "num_moves_mean": 10.0122, "num_moves_min": 9.69, "num_moves_max": 10.41, "mean_accuracy_mean": 41.10164666666667, "mean_accuracy_min": 40.871999999999986, "mean_accuracy_max": 41.30266666666667, "num_model_switches_mean": 6.027, "num_model_switches_min": 5.57, "num_model_switches_max": 6.43, "num_slav_mean": 0.16291049999999999, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5682624247271553, "mean_cluster_cpu_util_min": 0.5448263615087542, "mean_cluster_cpu_util_max": 0.5860459555139097, "mean_cluster_mem_util_mean": 0.36478482606597495, "mean_cluster_mem_util_min": 0.3547342837768019, "mean_cluster_mem_util_max": 0.37418666329400957, "reward_consolidation_mean_mean": 0.19382222222222217, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.3733333333333333, "reward_illegal_mean_mean": -1.723333333333333, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.4833333333333332, "reward_accuracy_mean_mean": 0.8237836666666665, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.2159, "reward_sla_mean_mean": -1.0738277777777778, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.5672222222222223, "reward_consolidation_sum_mean": 19.382222222222218, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 37.33333333333333, "reward_illegal_sum_mean": -172.33333333333331, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -148.33333333333331, "reward_accuracy_sum_mean": 82.37836666666666, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 121.58999999999999, "reward_sla_sum_mean": -107.38277777777776, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -56.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5350.0, "global_timestep_min": 3100, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892, -169.8677777777777, -189.80222222222204, -175.38444444444437, -160.2933333333333, -177.91111111111098, -181.6399999999999, -184.56111111111107, -164.59444444444438, -171.5233333333333, -191.45444444444433, -164.89111111111112, -181.69777777777767, -203.41444444444434, -193.50222222222226, -193.18555555555554, -158.92999999999998, -180.56555555555553, -156.96000000000006, -200.17444444444436, -200.34888888888878, -185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538, -174.14888888888885, -180.61333333333332, -167.4666666666667, -198.4799999999998, -174.75111111111102, -217.80666666666653, -182.33888888888882, -172.65444444444455, -191.85333333333327, -202.49777777777774, -185.97888888888886, -178.42222222222216, -185.78111111111122, -206.91777777777776, -184.79444444444442, -155.67222222222225, -195.73111111111103, -176.2066666666667, -183.53666666666655, -206.0677777777778, -169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656, -210.5799999999999, -184.43222222222224, -166.12111111111105, -174.81777777777774, -170.81111111111116, -202.2799999999998, -191.09999999999994, -196.99888888888887, -180.80999999999995, -175.8366666666666, -179.51666666666662, -172.98333333333332, -167.85222222222228, -180.26333333333326, -174.8777777777778, -157.74555555555548, -166.70444444444442, -177.61888888888885, -156.7866666666666, -187.32222222222208, -150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-186.13888888888874, -181.90666666666655, -178.13333333333327, -168.49444444444444, -161.1366666666667, -177.93111111111114, -176.55333333333334, -152.00777777777787, -163.10000000000005, -167.94888888888892, -169.8677777777777, -189.80222222222204, -175.38444444444437, -160.2933333333333, -177.91111111111098, -181.6399999999999, -184.56111111111107, -164.59444444444438, -171.5233333333333, -191.45444444444433, -164.89111111111112, -181.69777777777767, -203.41444444444434, -193.50222222222226, -193.18555555555554, -158.92999999999998, -180.56555555555553, -156.96000000000006, -200.17444444444436, -200.34888888888878, -185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538, -174.14888888888885, -180.61333333333332, -167.4666666666667, -198.4799999999998, -174.75111111111102, -217.80666666666653, -182.33888888888882, -172.65444444444455, -191.85333333333327, -202.49777777777774, -185.97888888888886, -178.42222222222216, -185.78111111111122, -206.91777777777776, -184.79444444444442, -155.67222222222225, -195.73111111111103, -176.2066666666667, -183.53666666666655, -206.0677777777778, -169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656, -210.5799999999999, -184.43222222222224, -166.12111111111105, -174.81777777777774, -170.81111111111116, -202.2799999999998, -191.09999999999994, -196.99888888888887, -180.80999999999995, -175.8366666666666, -179.51666666666662, -172.98333333333332, -167.85222222222228, -180.26333333333326, -174.8777777777778, -157.74555555555548, -166.70444444444442, -177.61888888888885, -156.7866666666666, -187.32222222222208, -150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19322343510313567, "mean_inference_ms": 1.800263791504197, "mean_action_processing_ms": 0.07312667730052821, "mean_env_wait_ms": 1.188576729062028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004183053970336914, "StateBufferConnector_ms": 0.002794981002807617, "ViewRequirementAgentConnector_ms": 0.0657958984375}, "num_episodes": 30, "episode_return_max": -133.85444444444454, "episode_return_min": -217.80666666666653, "episode_return_mean": -177.95552222222213, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21150, "num_agent_steps_trained": 21000, "num_env_steps_sampled": 21150, "num_env_steps_trained": 21000, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 304.6424498495621, "num_env_steps_trained_throughput_per_sec": 319.14923317573175, "timesteps_total": 21150, "num_env_steps_sampled_lifetime": 21150, "num_agent_steps_sampled_lifetime": 21150, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 21150, "timers": {"training_iteration_time_ms": 10235.187, "restore_workers_time_ms": 0.011, "training_step_time_ms": 478.565, "sample_time_ms": 464.31, "synch_weights_time_ms": 12.987}, "counters": {"num_env_steps_sampled": 21150, "num_env_steps_trained": 21000, "num_agent_steps_sampled": 21150, "num_agent_steps_trained": 21000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 141, "num_samples_added_to_queue": 21000}, "done": false, "training_iteration": 7, "trial_id": "38f59_00000", "date": "2024-10-10_22-12-44", "timestamp": 1728594764, "time_this_iter_s": 10.349565267562866, "time_total_s": 71.71492123603821, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79e7d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.71492123603821, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.146666666666667, "ram_util_percent": 52.60666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -178021.453125, "policy_loss": -178764.953125, "entropy": 29.81482696533203, "entropy_coeff": 0.01, "var_gnorm": 16.012174606323242, "vf_loss": 83294.4765625, "vf_explained_var": 0.008299767971038818}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 23700, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 23700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 160, "num_samples_added_to_queue": 24000, "learner_queue": {"size_count": 79, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.867, "learner_load_time_ms": 0.241, "learner_load_wait_time_ms": 1002.219, "learner_dequeue_time_ms": 7480.141}}, "env_runners": {"episode_reward_max": -133.85444444444454, "episode_reward_min": -217.80666666666653, "episode_reward_mean": -179.31509999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -217.80666666666653}, "policy_reward_max": {"default_policy": -133.85444444444454}, "policy_reward_mean": {"default_policy": -179.31509999999997}, "custom_metrics": {"num_consolidated_mean": 0.6777999999999998, "num_consolidated_min": 0.54, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0322000000000002, "num_overloaded_min": 0.86, "num_overloaded_max": 1.18, "num_moves_mean": 10.006100000000002, "num_moves_min": 9.55, "num_moves_max": 10.41, "mean_accuracy_mean": 41.10557333333333, "mean_accuracy_min": 40.871999999999986, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 6.007900000000001, "num_model_switches_min": 5.57, "num_model_switches_max": 6.43, "num_slav_mean": 0.1625808333333333, "num_slav_min": 0.1421666666666667, "num_slav_max": 0.19108333333333338, "mean_cluster_cpu_util_mean": 0.5693141173519698, "mean_cluster_cpu_util_min": 0.5448263615087542, "mean_cluster_cpu_util_max": 0.5906720919611718, "mean_cluster_mem_util_mean": 0.36540684584983785, "mean_cluster_mem_util_min": 0.3547342837768019, "mean_cluster_mem_util_max": 0.3748814075102615, "reward_consolidation_mean_mean": 0.1896222222222222, "reward_consolidation_mean_min": 0.062222222222222213, "reward_consolidation_mean_max": 0.34222222222222215, "reward_illegal_mean_mean": -1.7203333333333333, "reward_illegal_mean_min": -1.9666666666666663, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8344323333333334, "reward_accuracy_mean_min": 0.4552666666666667, "reward_accuracy_mean_max": 1.3107666666666669, "reward_sla_mean_mean": -1.096872222222222, "reward_sla_mean_min": -1.6783333333333332, "reward_sla_mean_max": -0.5672222222222223, "reward_consolidation_sum_mean": 18.962222222222216, "reward_consolidation_sum_min": 6.222222222222221, "reward_consolidation_sum_max": 34.222222222222214, "reward_illegal_sum_mean": -172.03333333333333, "reward_illegal_sum_min": -196.66666666666663, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 83.44323333333334, "reward_accuracy_sum_min": 45.52666666666667, "reward_accuracy_sum_max": 131.07666666666668, "reward_sla_sum_mean": -109.68722222222223, "reward_sla_sum_min": -167.83333333333331, "reward_sla_sum_max": -56.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5882.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538, -174.14888888888885, -180.61333333333332, -167.4666666666667, -198.4799999999998, -174.75111111111102, -217.80666666666653, -182.33888888888882, -172.65444444444455, -191.85333333333327, -202.49777777777774, -185.97888888888886, -178.42222222222216, -185.78111111111122, -206.91777777777776, -184.79444444444442, -155.67222222222225, -195.73111111111103, -176.2066666666667, -183.53666666666655, -206.0677777777778, -169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656, -210.5799999999999, -184.43222222222224, -166.12111111111105, -174.81777777777774, -170.81111111111116, -202.2799999999998, -191.09999999999994, -196.99888888888887, -180.80999999999995, -175.8366666666666, -179.51666666666662, -172.98333333333332, -167.85222222222228, -180.26333333333326, -174.8777777777778, -157.74555555555548, -166.70444444444442, -177.61888888888885, -156.7866666666666, -187.32222222222208, -150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117, -203.84666666666655, -199.15555555555554, -192.49222222222215, -190.19888888888894, -166.36333333333334, -183.65333333333325, -195.03999999999985, -176.23777777777778, -166.30111111111108, -192.1955555555555, -177.46, -196.06111111111107, -153.05000000000004, -207.8955555555555, -171.74333333333334, -161.3866666666666, -197.05666666666662, -183.2366666666666, -190.38777777777761, -169.85999999999996, -179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-185.30444444444436, -182.6899999999998, -168.84777777777768, -167.09111111111105, -172.86999999999986, -197.08555555555552, -148.42888888888888, -195.48222222222213, -158.0277777777778, -190.32555555555538, -174.14888888888885, -180.61333333333332, -167.4666666666667, -198.4799999999998, -174.75111111111102, -217.80666666666653, -182.33888888888882, -172.65444444444455, -191.85333333333327, -202.49777777777774, -185.97888888888886, -178.42222222222216, -185.78111111111122, -206.91777777777776, -184.79444444444442, -155.67222222222225, -195.73111111111103, -176.2066666666667, -183.53666666666655, -206.0677777777778, -169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656, -210.5799999999999, -184.43222222222224, -166.12111111111105, -174.81777777777774, -170.81111111111116, -202.2799999999998, -191.09999999999994, -196.99888888888887, -180.80999999999995, -175.8366666666666, -179.51666666666662, -172.98333333333332, -167.85222222222228, -180.26333333333326, -174.8777777777778, -157.74555555555548, -166.70444444444442, -177.61888888888885, -156.7866666666666, -187.32222222222208, -150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117, -203.84666666666655, -199.15555555555554, -192.49222222222215, -190.19888888888894, -166.36333333333334, -183.65333333333325, -195.03999999999985, -176.23777777777778, -166.30111111111108, -192.1955555555555, -177.46, -196.06111111111107, -153.05000000000004, -207.8955555555555, -171.74333333333334, -161.3866666666666, -197.05666666666662, -183.2366666666666, -190.38777777777761, -169.85999999999996, -179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1941825463281793, "mean_inference_ms": 1.7975166967456395, "mean_action_processing_ms": 0.0733598590161576, "mean_env_wait_ms": 1.1911007562113176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004390239715576172, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.06748270988464355}, "num_episodes": 30, "episode_return_max": -133.85444444444454, "episode_return_min": -217.80666666666653, "episode_return_mean": -179.31509999999997, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 23700, "num_env_steps_sampled": 24000, "num_env_steps_trained": 23700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 283.77119200829253, "num_env_steps_trained_throughput_per_sec": 268.83586611311927, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 10211.203, "restore_workers_time_ms": 0.013, "training_step_time_ms": 499.566, "sample_time_ms": 484.54, "synch_weights_time_ms": 13.634}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 23700, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 23700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 160, "num_samples_added_to_queue": 24000}, "done": false, "training_iteration": 8, "trial_id": "38f59_00000", "date": "2024-10-10_22-12-54", "timestamp": 1728594774, "time_this_iter_s": 10.056932210922241, "time_total_s": 81.77185344696045, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcdb40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 81.77185344696045, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 14.435714285714285, "ram_util_percent": 52.90000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -178947.234375, "policy_loss": -179709.703125, "entropy": 29.813005447387695, "entropy_coeff": 0.01, "var_gnorm": 16.01570701599121, "vf_loss": 85190.09375, "vf_explained_var": 0.009997904300689697}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 89.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 27000, "num_env_steps_trained": 26700, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 26700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 180, "num_samples_added_to_queue": 27000, "learner_queue": {"size_count": 89, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.146, "learner_load_time_ms": 0.266, "learner_load_wait_time_ms": 967.075, "learner_dequeue_time_ms": 8234.323}}, "env_runners": {"episode_reward_max": -132.3677777777779, "episode_reward_min": -210.5799999999999, "episode_reward_mean": -177.69391111111102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -210.5799999999999}, "policy_reward_max": {"default_policy": -132.3677777777779}, "policy_reward_mean": {"default_policy": -177.69391111111102}, "custom_metrics": {"num_consolidated_mean": 0.6744, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0159000000000002, "num_overloaded_min": 0.86, "num_overloaded_max": 1.14, "num_moves_mean": 9.9853, "num_moves_min": 9.55, "num_moves_max": 10.41, "mean_accuracy_mean": 41.102533333333334, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 6.015199999999998, "num_model_switches_min": 5.37, "num_model_switches_max": 6.41, "num_slav_mean": 0.16287416666666665, "num_slav_min": 0.13566666666666669, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5673779722663308, "mean_cluster_cpu_util_min": 0.5448263615087542, "mean_cluster_cpu_util_max": 0.5906720919611718, "mean_cluster_mem_util_mean": 0.36464020461264673, "mean_cluster_mem_util_min": 0.3547342837768019, "mean_cluster_mem_util_max": 0.3748814075102615, "reward_consolidation_mean_mean": 0.19693333333333332, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.3577777777777777, "reward_illegal_mean_mean": -1.6931666666666663, "reward_illegal_mean_min": -1.8999999999999995, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8694053333333334, "reward_accuracy_mean_min": 0.5286, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -1.1501111111111113, "reward_sla_mean_min": -1.843888888888889, "reward_sla_mean_max": -0.6527777777777779, "reward_consolidation_sum_mean": 19.69333333333333, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 35.77777777777777, "reward_illegal_sum_mean": -169.31666666666658, "reward_illegal_sum_min": -189.99999999999994, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 86.94053333333333, "reward_accuracy_sum_min": 52.86, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -115.01111111111112, "reward_sla_sum_min": -184.38888888888889, "reward_sla_sum_max": -65.27777777777779, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4542.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656, -210.5799999999999, -184.43222222222224, -166.12111111111105, -174.81777777777774, -170.81111111111116, -202.2799999999998, -191.09999999999994, -196.99888888888887, -180.80999999999995, -175.8366666666666, -179.51666666666662, -172.98333333333332, -167.85222222222228, -180.26333333333326, -174.8777777777778, -157.74555555555548, -166.70444444444442, -177.61888888888885, -156.7866666666666, -187.32222222222208, -150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117, -203.84666666666655, -199.15555555555554, -192.49222222222215, -190.19888888888894, -166.36333333333334, -183.65333333333325, -195.03999999999985, -176.23777777777778, -166.30111111111108, -192.1955555555555, -177.46, -196.06111111111107, -153.05000000000004, -207.8955555555555, -171.74333333333334, -161.3866666666666, -197.05666666666662, -183.2366666666666, -190.38777777777761, -169.85999999999996, -179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435, -210.5244444444443, -186.2666666666666, -189.10888888888886, -187.01555555555547, -170.78111111111093, -202.27444444444433, -182.3799999999998, -204.7277777777777, -151.05888888888887, -178.03333333333325, -175.69333333333327, -132.3677777777779, -178.96333333333337, -165.3366666666665, -179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-169.6088888888888, -175.3766666666666, -195.5644444444444, -185.9399999999999, -165.7644444444444, -165.91111111111115, -179.0022222222222, -133.85444444444454, -161.4266666666666, -192.80666666666656, -210.5799999999999, -184.43222222222224, -166.12111111111105, -174.81777777777774, -170.81111111111116, -202.2799999999998, -191.09999999999994, -196.99888888888887, -180.80999999999995, -175.8366666666666, -179.51666666666662, -172.98333333333332, -167.85222222222228, -180.26333333333326, -174.8777777777778, -157.74555555555548, -166.70444444444442, -177.61888888888885, -156.7866666666666, -187.32222222222208, -150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117, -203.84666666666655, -199.15555555555554, -192.49222222222215, -190.19888888888894, -166.36333333333334, -183.65333333333325, -195.03999999999985, -176.23777777777778, -166.30111111111108, -192.1955555555555, -177.46, -196.06111111111107, -153.05000000000004, -207.8955555555555, -171.74333333333334, -161.3866666666666, -197.05666666666662, -183.2366666666666, -190.38777777777761, -169.85999999999996, -179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435, -210.5244444444443, -186.2666666666666, -189.10888888888886, -187.01555555555547, -170.78111111111093, -202.27444444444433, -182.3799999999998, -204.7277777777777, -151.05888888888887, -178.03333333333325, -175.69333333333327, -132.3677777777779, -178.96333333333337, -165.3366666666665, -179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19493416044090592, "mean_inference_ms": 1.7953011839554716, "mean_action_processing_ms": 0.07351659684068645, "mean_env_wait_ms": 1.1928164559878045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004365444183349609, "StateBufferConnector_ms": 0.0028319358825683594, "ViewRequirementAgentConnector_ms": 0.06723332405090332}, "num_episodes": 30, "episode_return_max": -132.3677777777779, "episode_return_min": -210.5799999999999, "episode_return_mean": -177.69391111111102, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 26700, "num_env_steps_sampled": 27000, "num_env_steps_trained": 26700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.2913992169918, "num_env_steps_trained_throughput_per_sec": 294.2913992169918, "timesteps_total": 27000, "num_env_steps_sampled_lifetime": 27000, "num_agent_steps_sampled_lifetime": 27000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 27000, "timers": {"training_iteration_time_ms": 10209.29, "restore_workers_time_ms": 0.011, "training_step_time_ms": 500.538, "sample_time_ms": 485.233, "synch_weights_time_ms": 14.068}, "counters": {"num_env_steps_sampled": 27000, "num_env_steps_trained": 26700, "num_agent_steps_sampled": 27000, "num_agent_steps_trained": 26700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 180, "num_samples_added_to_queue": 27000}, "done": false, "training_iteration": 9, "trial_id": "38f59_00000", "date": "2024-10-10_22-13-04", "timestamp": 1728594784, "time_this_iter_s": 10.203702449798584, "time_total_s": 91.97555589675903, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79f430>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.97555589675903, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 11.859999999999998, "ram_util_percent": 53.026666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -180144.015625, "policy_loss": -180903.15625, "entropy": 29.81183624267578, "entropy_coeff": 0.01, "var_gnorm": 16.01836585998535, "vf_loss": 84857.2734375, "vf_explained_var": 0.012659132480621338}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 30000, "num_env_steps_trained": 29700, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 29700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 200, "num_samples_added_to_queue": 30000, "learner_queue": {"size_count": 99, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.394, "learner_load_time_ms": 0.291, "learner_load_wait_time_ms": 985.086, "learner_dequeue_time_ms": 8130.829}}, "env_runners": {"episode_reward_max": -132.3677777777779, "episode_reward_min": -210.5244444444443, "episode_reward_mean": -178.21183333333326, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -210.5244444444443}, "policy_reward_max": {"default_policy": -132.3677777777779}, "policy_reward_mean": {"default_policy": -178.21183333333326}, "custom_metrics": {"num_consolidated_mean": 0.6715000000000002, "num_consolidated_min": 0.52, "num_consolidated_max": 0.87, "num_overloaded_mean": 1.0171, "num_overloaded_min": 0.86, "num_overloaded_max": 1.13, "num_moves_mean": 10.0009, "num_moves_min": 9.55, "num_moves_max": 10.31, "mean_accuracy_mean": 41.09493333333333, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 6.0138000000000025, "num_model_switches_min": 5.37, "num_model_switches_max": 6.41, "num_slav_mean": 0.16209216666666668, "num_slav_min": 0.13566666666666669, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.567058342151638, "mean_cluster_cpu_util_min": 0.5448263615087542, "mean_cluster_cpu_util_max": 0.5906720919611718, "mean_cluster_mem_util_mean": 0.36461953228422167, "mean_cluster_mem_util_min": 0.3547342837768019, "mean_cluster_mem_util_max": 0.3748814075102615, "reward_consolidation_mean_mean": 0.20035555555555554, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.3577777777777777, "reward_illegal_mean_mean": -1.6951666666666663, "reward_illegal_mean_min": -1.883333333333333, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8681983333333334, "reward_accuracy_mean_min": 0.5286, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -1.1555055555555556, "reward_sla_mean_min": -1.843888888888889, "reward_sla_mean_max": -0.655, "reward_consolidation_sum_mean": 20.035555555555554, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 35.77777777777777, "reward_illegal_sum_mean": -169.5166666666666, "reward_illegal_sum_min": -188.33333333333331, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 86.81983333333334, "reward_accuracy_sum_min": 52.86, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -115.55055555555556, "reward_sla_sum_min": -184.38888888888889, "reward_sla_sum_max": -65.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3202.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117, -203.84666666666655, -199.15555555555554, -192.49222222222215, -190.19888888888894, -166.36333333333334, -183.65333333333325, -195.03999999999985, -176.23777777777778, -166.30111111111108, -192.1955555555555, -177.46, -196.06111111111107, -153.05000000000004, -207.8955555555555, -171.74333333333334, -161.3866666666666, -197.05666666666662, -183.2366666666666, -190.38777777777761, -169.85999999999996, -179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435, -210.5244444444443, -186.2666666666666, -189.10888888888886, -187.01555555555547, -170.78111111111093, -202.27444444444433, -182.3799999999998, -204.7277777777777, -151.05888888888887, -178.03333333333325, -175.69333333333327, -132.3677777777779, -178.96333333333337, -165.3366666666665, -179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223, -186.22111111111096, -183.3888888888887, -193.00000000000003, -156.69555555555564, -175.53000000000003, -183.58555555555543, -167.88555555555553, -154.5033333333332, -171.04111111111104, -182.7433333333332, -176.51444444444448, -167.17777777777778, -179.20555555555543, -179.20111111111106, -166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-150.2877777777778, -186.72333333333327, -160.93777777777768, -172.61555555555546, -178.3633333333333, -202.26222222222216, -169.83111111111108, -167.1855555555556, -140.24333333333337, -164.46111111111117, -203.84666666666655, -199.15555555555554, -192.49222222222215, -190.19888888888894, -166.36333333333334, -183.65333333333325, -195.03999999999985, -176.23777777777778, -166.30111111111108, -192.1955555555555, -177.46, -196.06111111111107, -153.05000000000004, -207.8955555555555, -171.74333333333334, -161.3866666666666, -197.05666666666662, -183.2366666666666, -190.38777777777761, -169.85999999999996, -179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435, -210.5244444444443, -186.2666666666666, -189.10888888888886, -187.01555555555547, -170.78111111111093, -202.27444444444433, -182.3799999999998, -204.7277777777777, -151.05888888888887, -178.03333333333325, -175.69333333333327, -132.3677777777779, -178.96333333333337, -165.3366666666665, -179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223, -186.22111111111096, -183.3888888888887, -193.00000000000003, -156.69555555555564, -175.53000000000003, -183.58555555555543, -167.88555555555553, -154.5033333333332, -171.04111111111104, -182.7433333333332, -176.51444444444448, -167.17777777777778, -179.20555555555543, -179.20111111111106, -166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19548768439338338, "mean_inference_ms": 1.7960047469488445, "mean_action_processing_ms": 0.07369939658986097, "mean_env_wait_ms": 1.1948657196837258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004399538040161133, "StateBufferConnector_ms": 0.002850055694580078, "ViewRequirementAgentConnector_ms": 0.0679941177368164}, "num_episodes": 30, "episode_return_max": -132.3677777777779, "episode_return_min": -210.5244444444443, "episode_return_mean": -178.21183333333326, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 29700, "num_env_steps_sampled": 30000, "num_env_steps_trained": 29700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.96120739276466, "num_env_steps_trained_throughput_per_sec": 288.96120739276466, "timesteps_total": 30000, "num_env_steps_sampled_lifetime": 30000, "num_agent_steps_sampled_lifetime": 30000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 30000, "timers": {"training_iteration_time_ms": 10226.563, "restore_workers_time_ms": 0.012, "training_step_time_ms": 534.193, "sample_time_ms": 519.425, "synch_weights_time_ms": 13.479}, "counters": {"num_env_steps_sampled": 30000, "num_env_steps_trained": 29700, "num_agent_steps_sampled": 30000, "num_agent_steps_trained": 29700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 200, "num_samples_added_to_queue": 30000}, "done": false, "training_iteration": 10, "trial_id": "38f59_00000", "date": "2024-10-10_22-13-15", "timestamp": 1728594795, "time_this_iter_s": 10.398211002349854, "time_total_s": 102.37376689910889, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcdcc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.37376689910889, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.899999999999999, "ram_util_percent": 52.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -158787.3125, "policy_loss": -159396.578125, "entropy": 29.80986976623535, "entropy_coeff": 0.01, "var_gnorm": 16.022106170654297, "vf_loss": 69869.5078125, "vf_explained_var": 0.013870537281036377}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 109.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 33000, "num_env_steps_trained": 32700, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 32700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 220, "num_samples_added_to_queue": 33000, "learner_queue": {"size_count": 109, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.164, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 946.949, "learner_dequeue_time_ms": 8176.859}}, "env_runners": {"episode_reward_max": -132.3677777777779, "episode_reward_min": -210.5244444444443, "episode_reward_mean": -176.80877777777772, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -210.5244444444443}, "policy_reward_max": {"default_policy": -132.3677777777779}, "policy_reward_mean": {"default_policy": -176.80877777777772}, "custom_metrics": {"num_consolidated_mean": 0.6641999999999999, "num_consolidated_min": 0.52, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0179, "num_overloaded_min": 0.86, "num_overloaded_max": 1.14, "num_moves_mean": 9.992200000000002, "num_moves_min": 9.65, "num_moves_max": 10.31, "mean_accuracy_mean": 41.08765, "mean_accuracy_min": 40.80233333333333, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 6.0176, "num_model_switches_min": 5.37, "num_model_switches_max": 6.41, "num_slav_mean": 0.16064333333333333, "num_slav_min": 0.13566666666666669, "num_slav_max": 0.19096666666666667, "mean_cluster_cpu_util_mean": 0.5660203376488304, "mean_cluster_cpu_util_min": 0.5491929456301495, "mean_cluster_cpu_util_max": 0.5827409231340624, "mean_cluster_mem_util_mean": 0.36397200655874173, "mean_cluster_mem_util_min": 0.3551576370949223, "mean_cluster_mem_util_max": 0.3728559369528402, "reward_consolidation_mean_mean": 0.19911111111111107, "reward_consolidation_mean_min": 0.04666666666666666, "reward_consolidation_mean_max": 0.3577777777777777, "reward_illegal_mean_mean": -1.6965000000000001, "reward_illegal_mean_min": -1.9, "reward_illegal_mean_max": -1.433333333333333, "reward_accuracy_mean_mean": 0.8582900000000002, "reward_accuracy_mean_min": 0.4887666666666666, "reward_accuracy_mean_max": 1.3840999999999999, "reward_sla_mean_mean": -1.1289888888888888, "reward_sla_mean_min": -1.843888888888889, "reward_sla_mean_max": -0.655, "reward_consolidation_sum_mean": 19.911111111111108, "reward_consolidation_sum_min": 4.666666666666666, "reward_consolidation_sum_max": 35.77777777777777, "reward_illegal_sum_mean": -169.64999999999998, "reward_illegal_sum_min": -190.0, "reward_illegal_sum_max": -143.3333333333333, "reward_accuracy_sum_mean": 85.829, "reward_accuracy_sum_min": 48.876666666666665, "reward_accuracy_sum_max": 138.41, "reward_sla_sum_mean": -112.8988888888889, "reward_sla_sum_min": -184.38888888888889, "reward_sla_sum_max": -65.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2174.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435, -210.5244444444443, -186.2666666666666, -189.10888888888886, -187.01555555555547, -170.78111111111093, -202.27444444444433, -182.3799999999998, -204.7277777777777, -151.05888888888887, -178.03333333333325, -175.69333333333327, -132.3677777777779, -178.96333333333337, -165.3366666666665, -179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223, -186.22111111111096, -183.3888888888887, -193.00000000000003, -156.69555555555564, -175.53000000000003, -183.58555555555543, -167.88555555555553, -154.5033333333332, -171.04111111111104, -182.7433333333332, -176.51444444444448, -167.17777777777778, -179.20555555555543, -179.20111111111106, -166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006, -165.79444444444448, -177.32444444444445, -180.27777777777774, -170.08777777777772, -192.54666666666668, -162.4011111111111, -174.23111111111106, -183.3666666666667, -151.7277777777778, -185.24222222222218, -199.05888888888882, -173.37222222222218, -198.38222222222214, -182.8966666666666, -164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-179.90888888888884, -177.02999999999997, -138.53444444444452, -206.27888888888884, -177.17666666666665, -167.63777777777776, -185.28222222222223, -173.25555555555547, -188.7499999999999, -182.53444444444435, -210.5244444444443, -186.2666666666666, -189.10888888888886, -187.01555555555547, -170.78111111111093, -202.27444444444433, -182.3799999999998, -204.7277777777777, -151.05888888888887, -178.03333333333325, -175.69333333333327, -132.3677777777779, -178.96333333333337, -165.3366666666665, -179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223, -186.22111111111096, -183.3888888888887, -193.00000000000003, -156.69555555555564, -175.53000000000003, -183.58555555555543, -167.88555555555553, -154.5033333333332, -171.04111111111104, -182.7433333333332, -176.51444444444448, -167.17777777777778, -179.20555555555543, -179.20111111111106, -166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006, -165.79444444444448, -177.32444444444445, -180.27777777777774, -170.08777777777772, -192.54666666666668, -162.4011111111111, -174.23111111111106, -183.3666666666667, -151.7277777777778, -185.24222222222218, -199.05888888888882, -173.37222222222218, -198.38222222222214, -182.8966666666666, -164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19574280601330707, "mean_inference_ms": 1.7946968322572188, "mean_action_processing_ms": 0.07376922540562714, "mean_env_wait_ms": 1.1960367177459035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004668474197387695, "StateBufferConnector_ms": 0.002824544906616211, "ViewRequirementAgentConnector_ms": 0.06735658645629883}, "num_episodes": 30, "episode_return_max": -132.3677777777779, "episode_return_min": -210.5244444444443, "episode_return_mean": -176.80877777777772, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 32700, "num_env_steps_sampled": 33000, "num_env_steps_trained": 32700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.81739866081944, "num_env_steps_trained_throughput_per_sec": 298.81739866081944, "timesteps_total": 33000, "num_env_steps_sampled_lifetime": 33000, "num_agent_steps_sampled_lifetime": 33000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 33000, "timers": {"training_iteration_time_ms": 10195.54, "restore_workers_time_ms": 0.011, "training_step_time_ms": 484.628, "sample_time_ms": 470.819, "synch_weights_time_ms": 12.451}, "counters": {"num_env_steps_sampled": 33000, "num_env_steps_trained": 32700, "num_agent_steps_sampled": 33000, "num_agent_steps_trained": 32700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 220, "num_samples_added_to_queue": 33000}, "done": false, "training_iteration": 11, "trial_id": "38f59_00000", "date": "2024-10-10_22-13-25", "timestamp": 1728594805, "time_this_iter_s": 10.05348801612854, "time_total_s": 112.42725491523743, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdce650>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 112.42725491523743, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.278571428571428, "ram_util_percent": 53.40000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -162428.28125, "policy_loss": -163066.453125, "entropy": 29.807737350463867, "entropy_coeff": 0.01, "var_gnorm": 16.025409698486328, "vf_loss": 72758.828125, "vf_explained_var": 0.015937089920043945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 118.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 35550, "num_env_steps_trained": 35400, "num_agent_steps_sampled": 35550, "num_agent_steps_trained": 35400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 237, "num_samples_added_to_queue": 35400, "learner_queue": {"size_count": 118, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.11, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 1101.106, "learner_dequeue_time_ms": 8245.573}}, "env_runners": {"episode_reward_max": -133.62000000000012, "episode_reward_min": -208.22666666666666, "episode_reward_mean": -175.68652222222218, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -208.22666666666666}, "policy_reward_max": {"default_policy": -133.62000000000012}, "policy_reward_mean": {"default_policy": -175.68652222222218}, "custom_metrics": {"num_consolidated_mean": 0.6665000000000001, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0195, "num_overloaded_min": 0.87, "num_overloaded_max": 1.18, "num_moves_mean": 10.003300000000001, "num_moves_min": 9.69, "num_moves_max": 10.31, "mean_accuracy_mean": 41.06858666666667, "mean_accuracy_min": 40.85933333333333, "mean_accuracy_max": 41.271, "num_model_switches_mean": 6.018000000000001, "num_model_switches_min": 5.37, "num_model_switches_max": 6.36, "num_slav_mean": 0.15963166666666664, "num_slav_min": 0.13566666666666669, "num_slav_max": 0.18166666666666664, "mean_cluster_cpu_util_mean": 0.5655649308924489, "mean_cluster_cpu_util_min": 0.5466460293634678, "mean_cluster_cpu_util_max": 0.586652729584692, "mean_cluster_mem_util_mean": 0.3638821965057121, "mean_cluster_mem_util_min": 0.3551576370949223, "mean_cluster_mem_util_max": 0.3739615969172479, "reward_consolidation_mean_mean": 0.19724444444444442, "reward_consolidation_mean_min": 0.04666666666666666, "reward_consolidation_mean_max": 0.3577777777777777, "reward_illegal_mean_mean": -1.6991666666666663, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.8401736666666667, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.2772666666666668, "reward_sla_mean_mean": -1.0951166666666667, "reward_sla_mean_min": -1.8083333333333333, "reward_sla_mean_max": -0.5466666666666667, "reward_consolidation_sum_mean": 19.724444444444444, "reward_consolidation_sum_min": 4.666666666666666, "reward_consolidation_sum_max": 35.77777777777777, "reward_illegal_sum_mean": -169.91666666666669, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 84.01736666666666, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 127.72666666666667, "reward_sla_sum_mean": -109.51166666666666, "reward_sla_sum_min": -180.83333333333334, "reward_sla_sum_max": -54.66666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2358.0, "global_timestep_min": 300, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223, -186.22111111111096, -183.3888888888887, -193.00000000000003, -156.69555555555564, -175.53000000000003, -183.58555555555543, -167.88555555555553, -154.5033333333332, -171.04111111111104, -182.7433333333332, -176.51444444444448, -167.17777777777778, -179.20555555555543, -179.20111111111106, -166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006, -165.79444444444448, -177.32444444444445, -180.27777777777774, -170.08777777777772, -192.54666666666668, -162.4011111111111, -174.23111111111106, -183.3666666666667, -151.7277777777778, -185.24222222222218, -199.05888888888882, -173.37222222222218, -198.38222222222214, -182.8966666666666, -164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112, -184.11444444444433, -195.5633333333332, -182.78777777777773, -178.4666666666666, -153.33222222222216, -135.76222222222228, -134.45555555555552, -183.2177777777777, -175.77888888888887, -187.2066666666666, -195.1133333333333, -139.34444444444443, -174.30333333333328, -196.36111111111111, -146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-179.07333333333327, -133.62000000000012, -182.1699999999999, -169.7666666666666, -207.93555555555542, -163.8755555555556, -174.8088888888888, -173.381111111111, -164.77444444444444, -172.13999999999987, -180.77333333333326, -183.3099999999999, -189.12888888888878, -190.66222222222214, -189.98000000000005, -155.8222222222223, -186.22111111111096, -183.3888888888887, -193.00000000000003, -156.69555555555564, -175.53000000000003, -183.58555555555543, -167.88555555555553, -154.5033333333332, -171.04111111111104, -182.7433333333332, -176.51444444444448, -167.17777777777778, -179.20555555555543, -179.20111111111106, -166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006, -165.79444444444448, -177.32444444444445, -180.27777777777774, -170.08777777777772, -192.54666666666668, -162.4011111111111, -174.23111111111106, -183.3666666666667, -151.7277777777778, -185.24222222222218, -199.05888888888882, -173.37222222222218, -198.38222222222214, -182.8966666666666, -164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112, -184.11444444444433, -195.5633333333332, -182.78777777777773, -178.4666666666666, -153.33222222222216, -135.76222222222228, -134.45555555555552, -183.2177777777777, -175.77888888888887, -187.2066666666666, -195.1133333333333, -139.34444444444443, -174.30333333333328, -196.36111111111111, -146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19654184629147406, "mean_inference_ms": 1.798632282510566, "mean_action_processing_ms": 0.07397524734018626, "mean_env_wait_ms": 1.1991756652303536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004910945892333984, "StateBufferConnector_ms": 0.0029082298278808594, "ViewRequirementAgentConnector_ms": 0.07028579711914062}, "num_episodes": 24, "episode_return_max": -133.62000000000012, "episode_return_min": -208.22666666666666, "episode_return_mean": -175.68652222222218, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35550, "num_agent_steps_trained": 35400, "num_env_steps_sampled": 35550, "num_env_steps_trained": 35400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 252.17926015236372, "num_env_steps_trained_throughput_per_sec": 267.0133342789734, "timesteps_total": 35550, "num_env_steps_sampled_lifetime": 35550, "num_agent_steps_sampled_lifetime": 35550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 35550, "timers": {"training_iteration_time_ms": 10183.017, "restore_workers_time_ms": 0.012, "training_step_time_ms": 609.824, "sample_time_ms": 594.429, "synch_weights_time_ms": 14.047}, "counters": {"num_env_steps_sampled": 35550, "num_env_steps_trained": 35400, "num_agent_steps_sampled": 35550, "num_agent_steps_trained": 35400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 237, "num_samples_added_to_queue": 35400}, "done": false, "training_iteration": 12, "trial_id": "38f59_00000", "date": "2024-10-10_22-13-35", "timestamp": 1728594815, "time_this_iter_s": 10.125850439071655, "time_total_s": 122.55310535430908, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2f9a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.55310535430908, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 15.346666666666668, "ram_util_percent": 53.50666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -150490.8125, "policy_loss": -151034.625, "entropy": 29.80533790588379, "entropy_coeff": 0.01, "var_gnorm": 16.02837562561035, "vf_loss": 63323.5, "vf_explained_var": 0.019060730934143066}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38100, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 256, "num_samples_added_to_queue": 38400, "learner_queue": {"size_count": 127, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.531, "learner_load_time_ms": 0.256, "learner_load_wait_time_ms": 1016.703, "learner_dequeue_time_ms": 8365.063}}, "env_runners": {"episode_reward_max": -131.48888888888902, "episode_reward_min": -208.22666666666666, "episode_reward_mean": -173.61768888888884, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -208.22666666666666}, "policy_reward_max": {"default_policy": -131.48888888888902}, "policy_reward_mean": {"default_policy": -173.61768888888884}, "custom_metrics": {"num_consolidated_mean": 0.6642, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0175, "num_overloaded_min": 0.87, "num_overloaded_max": 1.18, "num_moves_mean": 9.990200000000002, "num_moves_min": 9.69, "num_moves_max": 10.27, "mean_accuracy_mean": 41.06529333333333, "mean_accuracy_min": 40.87833333333333, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 6.028, "num_model_switches_min": 5.5, "num_model_switches_max": 6.39, "num_slav_mean": 0.15841466666666665, "num_slav_min": 0.13548333333333334, "num_slav_max": 0.18166666666666664, "mean_cluster_cpu_util_mean": 0.5653027452122076, "mean_cluster_cpu_util_min": 0.5405806336492726, "mean_cluster_cpu_util_max": 0.586652729584692, "mean_cluster_mem_util_mean": 0.3635803031121732, "mean_cluster_mem_util_min": 0.35396400747007667, "mean_cluster_mem_util_max": 0.3739615969172479, "reward_consolidation_mean_mean": 0.1958444444444444, "reward_consolidation_mean_min": 0.04666666666666666, "reward_consolidation_mean_max": 0.3577777777777778, "reward_illegal_mean_mean": -1.6958333333333329, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4499999999999995, "reward_accuracy_mean_mean": 0.8448453333333333, "reward_accuracy_mean_min": 0.4875, "reward_accuracy_mean_max": 1.2772666666666668, "reward_sla_mean_mean": -1.0810333333333333, "reward_sla_mean_min": -1.7116666666666667, "reward_sla_mean_max": -0.5466666666666667, "reward_consolidation_sum_mean": 19.58444444444444, "reward_consolidation_sum_min": 4.666666666666666, "reward_consolidation_sum_max": 35.77777777777778, "reward_illegal_sum_mean": -169.58333333333331, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -144.99999999999994, "reward_accuracy_sum_mean": 84.48453333333333, "reward_accuracy_sum_min": 48.75, "reward_accuracy_sum_max": 127.72666666666667, "reward_sla_sum_mean": -108.10333333333332, "reward_sla_sum_min": -171.16666666666666, "reward_sla_sum_max": -54.66666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3358.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006, -165.79444444444448, -177.32444444444445, -180.27777777777774, -170.08777777777772, -192.54666666666668, -162.4011111111111, -174.23111111111106, -183.3666666666667, -151.7277777777778, -185.24222222222218, -199.05888888888882, -173.37222222222218, -198.38222222222214, -182.8966666666666, -164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112, -184.11444444444433, -195.5633333333332, -182.78777777777773, -178.4666666666666, -153.33222222222216, -135.76222222222228, -134.45555555555552, -183.2177777777777, -175.77888888888887, -187.2066666666666, -195.1133333333333, -139.34444444444443, -174.30333333333328, -196.36111111111111, -146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778, -171.16666666666663, -172.8899999999999, -193.4333333333333, -157.47999999999993, -185.87444444444426, -162.37555555555554, -188.02666666666653, -165.1588888888889, -167.35555555555555, -184.20999999999995, -163.46777777777774, -164.8033333333333, -150.11222222222236, -178.26888888888888, -171.99777777777777, -151.3322222222223, -182.57666666666654, -179.20444444444448, -142.67666666666676, -189.3344444444444, -179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-166.92777777777772, -163.55111111111106, -181.091111111111, -180.14111111111103, -196.19888888888877, -199.60222222222217, -183.78444444444457, -186.0888888888888, -184.37444444444432, -184.78444444444435, -175.1144444444445, -168.31111111111107, -172.86222222222224, -167.63444444444454, -208.22666666666666, -177.12000000000006, -165.79444444444448, -177.32444444444445, -180.27777777777774, -170.08777777777772, -192.54666666666668, -162.4011111111111, -174.23111111111106, -183.3666666666667, -151.7277777777778, -185.24222222222218, -199.05888888888882, -173.37222222222218, -198.38222222222214, -182.8966666666666, -164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112, -184.11444444444433, -195.5633333333332, -182.78777777777773, -178.4666666666666, -153.33222222222216, -135.76222222222228, -134.45555555555552, -183.2177777777777, -175.77888888888887, -187.2066666666666, -195.1133333333333, -139.34444444444443, -174.30333333333328, -196.36111111111111, -146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778, -171.16666666666663, -172.8899999999999, -193.4333333333333, -157.47999999999993, -185.87444444444426, -162.37555555555554, -188.02666666666653, -165.1588888888889, -167.35555555555555, -184.20999999999995, -163.46777777777774, -164.8033333333333, -150.11222222222236, -178.26888888888888, -171.99777777777777, -151.3322222222223, -182.57666666666654, -179.20444444444448, -142.67666666666676, -189.3344444444444, -179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19756770746354413, "mean_inference_ms": 1.8060406932991078, "mean_action_processing_ms": 0.07428484031180949, "mean_env_wait_ms": 1.2039114873339332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005045413970947266, "StateBufferConnector_ms": 0.002978801727294922, "ViewRequirementAgentConnector_ms": 0.07187056541442871}, "num_episodes": 30, "episode_return_max": -131.48888888888902, "episode_return_min": -208.22666666666666, "episode_return_mean": -173.61768888888884, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38100, "num_env_steps_sampled": 38400, "num_env_steps_trained": 38100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.15701620949864, "num_env_steps_trained_throughput_per_sec": 264.4645416721566, "timesteps_total": 38400, "num_env_steps_sampled_lifetime": 38400, "num_agent_steps_sampled_lifetime": 38400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 38400, "timers": {"training_iteration_time_ms": 10187.504, "restore_workers_time_ms": 0.012, "training_step_time_ms": 513.286, "sample_time_ms": 498.517, "synch_weights_time_ms": 13.507}, "counters": {"num_env_steps_sampled": 38400, "num_env_steps_trained": 38100, "num_agent_steps_sampled": 38400, "num_agent_steps_trained": 38100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 256, "num_samples_added_to_queue": 38400}, "done": false, "training_iteration": 13, "trial_id": "38f59_00000", "date": "2024-10-10_22-13-45", "timestamp": 1728594825, "time_this_iter_s": 10.219144105911255, "time_total_s": 132.77224946022034, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7550>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.77224946022034, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.299999999999999, "ram_util_percent": 53.471428571428575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -152036.609375, "policy_loss": -152572.171875, "entropy": 29.801118850708008, "entropy_coeff": 0.01, "var_gnorm": 16.033193588256836, "vf_loss": 62497.21875, "vf_explained_var": 0.02494412660598755}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 137.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 41400, "num_env_steps_trained": 41100, "num_agent_steps_sampled": 41400, "num_agent_steps_trained": 41100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 276, "num_samples_added_to_queue": 41400, "learner_queue": {"size_count": 137, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.026, "learner_load_time_ms": 0.282, "learner_load_wait_time_ms": 997.276, "learner_dequeue_time_ms": 8430.892}}, "env_runners": {"episode_reward_max": -131.48888888888902, "episode_reward_min": -205.91888888888872, "episode_reward_mean": -171.01839999999993, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -205.91888888888872}, "policy_reward_max": {"default_policy": -131.48888888888902}, "policy_reward_mean": {"default_policy": -171.01839999999993}, "custom_metrics": {"num_consolidated_mean": 0.6625999999999999, "num_consolidated_min": 0.55, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0033, "num_overloaded_min": 0.86, "num_overloaded_max": 1.18, "num_moves_mean": 10.0014, "num_moves_min": 9.69, "num_moves_max": 10.31, "mean_accuracy_mean": 41.050599999999996, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.36599999999999, "num_model_switches_mean": 6.0173999999999985, "num_model_switches_min": 5.5, "num_model_switches_max": 6.39, "num_slav_mean": 0.15774366666666664, "num_slav_min": 0.13548333333333334, "num_slav_max": 0.18166666666666664, "mean_cluster_cpu_util_mean": 0.5642089573097636, "mean_cluster_cpu_util_min": 0.5405806336492726, "mean_cluster_cpu_util_max": 0.586652729584692, "mean_cluster_mem_util_mean": 0.3632591613672896, "mean_cluster_mem_util_min": 0.3533887927322828, "mean_cluster_mem_util_max": 0.3739615969172479, "reward_consolidation_mean_mean": 0.2011333333333333, "reward_consolidation_mean_min": 0.04666666666666666, "reward_consolidation_mean_max": 0.3577777777777778, "reward_illegal_mean_mean": -1.6721666666666664, "reward_illegal_mean_min": -1.9666666666666666, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.8672659999999999, "reward_accuracy_mean_min": 0.4559, "reward_accuracy_mean_max": 1.2355333333333334, "reward_sla_mean_mean": -1.1064166666666666, "reward_sla_mean_min": -1.7894444444444444, "reward_sla_mean_max": -0.5466666666666667, "reward_consolidation_sum_mean": 20.11333333333333, "reward_consolidation_sum_min": 4.666666666666666, "reward_consolidation_sum_max": 35.77777777777778, "reward_illegal_sum_mean": -167.21666666666664, "reward_illegal_sum_min": -196.66666666666666, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 86.7266, "reward_accuracy_sum_min": 45.59, "reward_accuracy_sum_max": 123.55333333333334, "reward_sla_sum_mean": -110.64166666666668, "reward_sla_sum_min": -178.94444444444443, "reward_sla_sum_max": -54.66666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4358.0, "global_timestep_min": 2300, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112, -184.11444444444433, -195.5633333333332, -182.78777777777773, -178.4666666666666, -153.33222222222216, -135.76222222222228, -134.45555555555552, -183.2177777777777, -175.77888888888887, -187.2066666666666, -195.1133333333333, -139.34444444444443, -174.30333333333328, -196.36111111111111, -146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778, -171.16666666666663, -172.8899999999999, -193.4333333333333, -157.47999999999993, -185.87444444444426, -162.37555555555554, -188.02666666666653, -165.1588888888889, -167.35555555555555, -184.20999999999995, -163.46777777777774, -164.8033333333333, -150.11222222222236, -178.26888888888888, -171.99777777777777, -151.3322222222223, -182.57666666666654, -179.20444444444448, -142.67666666666676, -189.3344444444444, -179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551, -186.51444444444445, -166.92888888888874, -161.31222222222218, -184.01666666666657, -182.3933333333333, -168.07000000000005, -157.4488888888888, -162.63555555555564, -170.04222222222225, -180.80777777777783, -166.0577777777777, -186.94111111111104, -167.96222222222227, -166.08999999999997, -183.27444444444447, -196.27666666666667, -162.68, -157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-164.97111111111107, -161.12777777777782, -154.7722222222222, -181.99333333333328, -195.58666666666656, -189.56777777777776, -164.8844444444444, -197.27555555555554, -163.4433333333333, -160.771111111111, -179.0599999999999, -170.69555555555547, -178.91444444444434, -157.13333333333335, -170.50999999999993, -138.8111111111112, -184.11444444444433, -195.5633333333332, -182.78777777777773, -178.4666666666666, -153.33222222222216, -135.76222222222228, -134.45555555555552, -183.2177777777777, -175.77888888888887, -187.2066666666666, -195.1133333333333, -139.34444444444443, -174.30333333333328, -196.36111111111111, -146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778, -171.16666666666663, -172.8899999999999, -193.4333333333333, -157.47999999999993, -185.87444444444426, -162.37555555555554, -188.02666666666653, -165.1588888888889, -167.35555555555555, -184.20999999999995, -163.46777777777774, -164.8033333333333, -150.11222222222236, -178.26888888888888, -171.99777777777777, -151.3322222222223, -182.57666666666654, -179.20444444444448, -142.67666666666676, -189.3344444444444, -179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551, -186.51444444444445, -166.92888888888874, -161.31222222222218, -184.01666666666657, -182.3933333333333, -168.07000000000005, -157.4488888888888, -162.63555555555564, -170.04222222222225, -180.80777777777783, -166.0577777777777, -186.94111111111104, -167.96222222222227, -166.08999999999997, -183.27444444444447, -196.27666666666667, -162.68, -157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19862733118785073, "mean_inference_ms": 1.8141011431830765, "mean_action_processing_ms": 0.07460895129445314, "mean_env_wait_ms": 1.2088982695425543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004875898361206055, "StateBufferConnector_ms": 0.0029854774475097656, "ViewRequirementAgentConnector_ms": 0.07230162620544434}, "num_episodes": 30, "episode_return_max": -131.48888888888902, "episode_return_min": -205.91888888888872, "episode_return_mean": -171.01839999999993, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41400, "num_agent_steps_trained": 41100, "num_env_steps_sampled": 41400, "num_env_steps_trained": 41100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.3072720371336, "num_env_steps_trained_throughput_per_sec": 286.3072720371336, "timesteps_total": 41400, "num_env_steps_sampled_lifetime": 41400, "num_agent_steps_sampled_lifetime": 41400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 41400, "timers": {"training_iteration_time_ms": 10228.212, "restore_workers_time_ms": 0.012, "training_step_time_ms": 524.377, "sample_time_ms": 509.714, "synch_weights_time_ms": 13.253}, "counters": {"num_env_steps_sampled": 41400, "num_env_steps_trained": 41100, "num_agent_steps_sampled": 41400, "num_agent_steps_trained": 41100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 276, "num_samples_added_to_queue": 41400}, "done": false, "training_iteration": 14, "trial_id": "38f59_00000", "date": "2024-10-10_22-13-56", "timestamp": 1728594836, "time_this_iter_s": 10.487255334854126, "time_total_s": 143.25950479507446, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdccb20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.25950479507446, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.226666666666667, "ram_util_percent": 53.686666666666675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -148319.71875, "policy_loss": -148866.109375, "entropy": 29.79353141784668, "entropy_coeff": 0.01, "var_gnorm": 16.039440155029297, "vf_loss": 63576.47265625, "vf_explained_var": 0.025400638580322266}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 44400, "num_env_steps_trained": 44100, "num_agent_steps_sampled": 44400, "num_agent_steps_trained": 44100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 296, "num_samples_added_to_queue": 44400, "learner_queue": {"size_count": 147, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.847, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 950.505, "learner_dequeue_time_ms": 8402.75}}, "env_runners": {"episode_reward_max": -130.78666666666672, "episode_reward_min": -205.91888888888872, "episode_reward_mean": -169.94159999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -205.91888888888872}, "policy_reward_max": {"default_policy": -130.78666666666672}, "policy_reward_mean": {"default_policy": -169.94159999999997}, "custom_metrics": {"num_consolidated_mean": 0.6609000000000002, "num_consolidated_min": 0.54, "num_consolidated_max": 0.78, "num_overloaded_mean": 1.0029000000000001, "num_overloaded_min": 0.86, "num_overloaded_max": 1.15, "num_moves_mean": 10.0156, "num_moves_min": 9.66, "num_moves_max": 10.31, "mean_accuracy_mean": 41.04939666666666, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.37866666666666, "num_model_switches_mean": 6.0045, "num_model_switches_min": 5.5, "num_model_switches_max": 6.39, "num_slav_mean": 0.15717533333333333, "num_slav_min": 0.13548333333333334, "num_slav_max": 0.18166666666666664, "mean_cluster_cpu_util_mean": 0.5639532042597146, "mean_cluster_cpu_util_min": 0.5405806336492726, "mean_cluster_cpu_util_max": 0.5812888739107883, "mean_cluster_mem_util_mean": 0.3629870359170039, "mean_cluster_mem_util_min": 0.3533887927322828, "mean_cluster_mem_util_max": 0.3710083284896237, "reward_consolidation_mean_mean": 0.20377777777777775, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.3577777777777778, "reward_illegal_mean_mean": -1.6714999999999998, "reward_illegal_mean_min": -1.9166666666666665, "reward_illegal_mean_max": -1.4333333333333331, "reward_accuracy_mean_mean": 0.8880173333333334, "reward_accuracy_mean_min": 0.4559, "reward_accuracy_mean_max": 1.2355333333333334, "reward_sla_mean_mean": -1.119711111111111, "reward_sla_mean_min": -1.7894444444444444, "reward_sla_mean_max": -0.6250000000000001, "reward_consolidation_sum_mean": 20.37777777777778, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 35.77777777777778, "reward_illegal_sum_mean": -167.14999999999998, "reward_illegal_sum_min": -191.66666666666666, "reward_illegal_sum_max": -143.33333333333331, "reward_accuracy_sum_mean": 88.80173333333332, "reward_accuracy_sum_min": 45.59, "reward_accuracy_sum_max": 123.55333333333334, "reward_sla_sum_mean": -111.97111111111113, "reward_sla_sum_min": -178.94444444444443, "reward_sla_sum_max": -62.50000000000001, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5366.0, "global_timestep_min": 3300, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778, -171.16666666666663, -172.8899999999999, -193.4333333333333, -157.47999999999993, -185.87444444444426, -162.37555555555554, -188.02666666666653, -165.1588888888889, -167.35555555555555, -184.20999999999995, -163.46777777777774, -164.8033333333333, -150.11222222222236, -178.26888888888888, -171.99777777777777, -151.3322222222223, -182.57666666666654, -179.20444444444448, -142.67666666666676, -189.3344444444444, -179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551, -186.51444444444445, -166.92888888888874, -161.31222222222218, -184.01666666666657, -182.3933333333333, -168.07000000000005, -157.4488888888888, -162.63555555555564, -170.04222222222225, -180.80777777777783, -166.0577777777777, -186.94111111111104, -167.96222222222227, -166.08999999999997, -183.27444444444447, -196.27666666666667, -162.68, -157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333, -182.4488888888889, -151.05111111111117, -177.6711111111111, -174.7633333333333, -138.91111111111113, -181.4288888888889, -167.03, -157.77777777777771, -150.52888888888884, -190.26666666666668, -151.878888888889, -194.34777777777774, -130.78666666666672, -170.06555555555553, -160.99333333333325, -158.51888888888882, -176.14555555555552, -178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-146.24111111111117, -169.00666666666658, -168.77888888888887, -190.71222222222212, -173.8477777777777, -181.6255555555554, -181.12111111111105, -175.08777777777772, -205.91888888888872, -170.5477777777778, -171.16666666666663, -172.8899999999999, -193.4333333333333, -157.47999999999993, -185.87444444444426, -162.37555555555554, -188.02666666666653, -165.1588888888889, -167.35555555555555, -184.20999999999995, -163.46777777777774, -164.8033333333333, -150.11222222222236, -178.26888888888888, -171.99777777777777, -151.3322222222223, -182.57666666666654, -179.20444444444448, -142.67666666666676, -189.3344444444444, -179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551, -186.51444444444445, -166.92888888888874, -161.31222222222218, -184.01666666666657, -182.3933333333333, -168.07000000000005, -157.4488888888888, -162.63555555555564, -170.04222222222225, -180.80777777777783, -166.0577777777777, -186.94111111111104, -167.96222222222227, -166.08999999999997, -183.27444444444447, -196.27666666666667, -162.68, -157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333, -182.4488888888889, -151.05111111111117, -177.6711111111111, -174.7633333333333, -138.91111111111113, -181.4288888888889, -167.03, -157.77777777777771, -150.52888888888884, -190.26666666666668, -151.878888888889, -194.34777777777774, -130.78666666666672, -170.06555555555553, -160.99333333333325, -158.51888888888882, -176.14555555555552, -178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19913586650088455, "mean_inference_ms": 1.820537497396585, "mean_action_processing_ms": 0.07480667707794644, "mean_env_wait_ms": 1.2123362461876972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004483699798583984, "StateBufferConnector_ms": 0.0029206275939941406, "ViewRequirementAgentConnector_ms": 0.07001423835754395}, "num_episodes": 30, "episode_return_max": -130.78666666666672, "episode_return_min": -205.91888888888872, "episode_return_mean": -169.94159999999997, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44400, "num_agent_steps_trained": 44100, "num_env_steps_sampled": 44400, "num_env_steps_trained": 44100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.5008217429491, "num_env_steps_trained_throughput_per_sec": 298.5008217429491, "timesteps_total": 44400, "num_env_steps_sampled_lifetime": 44400, "num_agent_steps_sampled_lifetime": 44400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 44400, "timers": {"training_iteration_time_ms": 10230.61, "restore_workers_time_ms": 0.012, "training_step_time_ms": 513.964, "sample_time_ms": 500.199, "synch_weights_time_ms": 12.487}, "counters": {"num_env_steps_sampled": 44400, "num_env_steps_trained": 44100, "num_agent_steps_sampled": 44400, "num_agent_steps_trained": 44100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 296, "num_samples_added_to_queue": 44400}, "done": false, "training_iteration": 15, "trial_id": "38f59_00000", "date": "2024-10-10_22-14-06", "timestamp": 1728594846, "time_this_iter_s": 10.06593942642212, "time_total_s": 153.32544422149658, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde5ab0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.32544422149658, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 10.959999999999999, "ram_util_percent": 54.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -158740.203125, "policy_loss": -159320.796875, "entropy": 29.777610778808594, "entropy_coeff": 0.01, "var_gnorm": 16.048696517944336, "vf_loss": 66992.34375, "vf_explained_var": 0.03938400745391846}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 157.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47100, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 316, "num_samples_added_to_queue": 47400, "learner_queue": {"size_count": 157, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.468, "learner_load_time_ms": 0.267, "learner_load_wait_time_ms": 953.101, "learner_dequeue_time_ms": 8383.381}}, "env_runners": {"episode_reward_max": -113.07222222222232, "episode_reward_min": -201.11222222222227, "episode_reward_mean": -167.69294444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.11222222222227}, "policy_reward_max": {"default_policy": -113.07222222222232}, "policy_reward_mean": {"default_policy": -167.69294444444444}, "custom_metrics": {"num_consolidated_mean": 0.6690999999999998, "num_consolidated_min": 0.54, "num_consolidated_max": 0.86, "num_overloaded_mean": 1.0016, "num_overloaded_min": 0.84, "num_overloaded_max": 1.15, "num_moves_mean": 10.0183, "num_moves_min": 9.66, "num_moves_max": 10.31, "mean_accuracy_mean": 41.02418999999999, "mean_accuracy_min": 40.78333333333333, "mean_accuracy_max": 41.37866666666666, "num_model_switches_mean": 5.983099999999999, "num_model_switches_min": 5.64, "num_model_switches_max": 6.32, "num_slav_mean": 0.15649400000000002, "num_slav_min": 0.13548333333333334, "num_slav_max": 0.17515, "mean_cluster_cpu_util_mean": 0.563834565062958, "mean_cluster_cpu_util_min": 0.5434795914378214, "mean_cluster_cpu_util_max": 0.5812888739107883, "mean_cluster_mem_util_mean": 0.3631429617113723, "mean_cluster_mem_util_min": 0.3533887927322828, "mean_cluster_mem_util_max": 0.37208191609977326, "reward_consolidation_mean_mean": 0.21482222222222222, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.3733333333333333, "reward_illegal_mean_mean": -1.6693333333333333, "reward_illegal_mean_min": -1.9166666666666665, "reward_illegal_mean_max": -1.3999999999999995, "reward_accuracy_mean_mean": 0.8960649999999998, "reward_accuracy_mean_min": 0.4559, "reward_accuracy_mean_max": 1.339833333333333, "reward_sla_mean_mean": -1.1184833333333333, "reward_sla_mean_min": -1.7894444444444444, "reward_sla_mean_max": -0.5927777777777777, "reward_consolidation_sum_mean": 21.482222222222216, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 37.33333333333333, "reward_illegal_sum_mean": -166.9333333333333, "reward_illegal_sum_min": -191.66666666666666, "reward_illegal_sum_max": -139.99999999999994, "reward_accuracy_sum_mean": 89.6065, "reward_accuracy_sum_min": 45.59, "reward_accuracy_sum_max": 133.9833333333333, "reward_sla_sum_mean": -111.84833333333334, "reward_sla_sum_min": -178.94444444444443, "reward_sla_sum_max": -59.27777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5882.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551, -186.51444444444445, -166.92888888888874, -161.31222222222218, -184.01666666666657, -182.3933333333333, -168.07000000000005, -157.4488888888888, -162.63555555555564, -170.04222222222225, -180.80777777777783, -166.0577777777777, -186.94111111111104, -167.96222222222227, -166.08999999999997, -183.27444444444447, -196.27666666666667, -162.68, -157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333, -182.4488888888889, -151.05111111111117, -177.6711111111111, -174.7633333333333, -138.91111111111113, -181.4288888888889, -167.03, -157.77777777777771, -150.52888888888884, -190.26666666666668, -151.878888888889, -194.34777777777774, -130.78666666666672, -170.06555555555553, -160.99333333333325, -158.51888888888882, -176.14555555555552, -178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563, -199.3822222222221, -176.03555555555562, -148.3477777777778, -145.8411111111112, -159.79444444444437, -113.07222222222232, -190.20000000000016, -185.74777777777774, -143.49666666666673, -177.89888888888888, -171.79, -192.9688888888889, -181.49666666666667, -160.83555555555557, -187.03888888888878, -153.29222222222225, -147.42111111111114, -143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-179.39999999999995, -131.48888888888902, -147.88000000000002, -137.54333333333338, -163.17999999999992, -184.8177777777777, -182.1633333333332, -155.5444444444445, -188.46333333333325, -168.80555555555551, -186.51444444444445, -166.92888888888874, -161.31222222222218, -184.01666666666657, -182.3933333333333, -168.07000000000005, -157.4488888888888, -162.63555555555564, -170.04222222222225, -180.80777777777783, -166.0577777777777, -186.94111111111104, -167.96222222222227, -166.08999999999997, -183.27444444444447, -196.27666666666667, -162.68, -157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333, -182.4488888888889, -151.05111111111117, -177.6711111111111, -174.7633333333333, -138.91111111111113, -181.4288888888889, -167.03, -157.77777777777771, -150.52888888888884, -190.26666666666668, -151.878888888889, -194.34777777777774, -130.78666666666672, -170.06555555555553, -160.99333333333325, -158.51888888888882, -176.14555555555552, -178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563, -199.3822222222221, -176.03555555555562, -148.3477777777778, -145.8411111111112, -159.79444444444437, -113.07222222222232, -190.20000000000016, -185.74777777777774, -143.49666666666673, -177.89888888888888, -171.79, -192.9688888888889, -181.49666666666667, -160.83555555555557, -187.03888888888878, -153.29222222222225, -147.42111111111114, -143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19888997817640294, "mean_inference_ms": 1.8185400566144472, "mean_action_processing_ms": 0.0747604988563081, "mean_env_wait_ms": 1.2124098192120778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004266977310180664, "StateBufferConnector_ms": 0.002850770950317383, "ViewRequirementAgentConnector_ms": 0.06762003898620605}, "num_episodes": 30, "episode_return_max": -113.07222222222232, "episode_return_min": -201.11222222222227, "episode_return_mean": -167.69294444444444, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47100, "num_env_steps_sampled": 47400, "num_env_steps_trained": 47100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.93040744038035, "num_env_steps_trained_throughput_per_sec": 297.93040744038035, "timesteps_total": 47400, "num_env_steps_sampled_lifetime": 47400, "num_agent_steps_sampled_lifetime": 47400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 47400, "timers": {"training_iteration_time_ms": 10191.806, "restore_workers_time_ms": 0.011, "training_step_time_ms": 524.772, "sample_time_ms": 510.16, "synch_weights_time_ms": 13.214}, "counters": {"num_env_steps_sampled": 47400, "num_env_steps_trained": 47100, "num_agent_steps_sampled": 47400, "num_agent_steps_trained": 47100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 316, "num_samples_added_to_queue": 47400}, "done": false, "training_iteration": 16, "trial_id": "38f59_00000", "date": "2024-10-10_22-14-16", "timestamp": 1728594856, "time_this_iter_s": 10.079259157180786, "time_total_s": 163.40470337867737, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdced70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 163.40470337867737, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 11.221428571428572, "ram_util_percent": 54.17142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -114335.3203125, "policy_loss": -114618.875, "entropy": 29.75699234008789, "entropy_coeff": 0.01, "var_gnorm": 16.05806541442871, "vf_loss": 37282.671875, "vf_explained_var": 0.0537908673286438}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 50250, "num_env_steps_trained": 50100, "num_agent_steps_sampled": 50250, "num_agent_steps_trained": 50100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 335, "num_samples_added_to_queue": 50100, "learner_queue": {"size_count": 167, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.226, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1050.414, "learner_dequeue_time_ms": 8426.619}}, "env_runners": {"episode_reward_max": -113.07222222222232, "episode_reward_min": -201.11222222222227, "episode_reward_mean": -164.75368888888886, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.11222222222227}, "policy_reward_max": {"default_policy": -113.07222222222232}, "policy_reward_mean": {"default_policy": -164.75368888888886}, "custom_metrics": {"num_consolidated_mean": 0.6736, "num_consolidated_min": 0.49, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.992, "num_overloaded_min": 0.77, "num_overloaded_max": 1.15, "num_moves_mean": 10.005899999999999, "num_moves_min": 9.66, "num_moves_max": 10.31, "mean_accuracy_mean": 41.01165, "mean_accuracy_min": 40.764333333333326, "mean_accuracy_max": 41.37866666666666, "num_model_switches_mean": 5.972200000000002, "num_model_switches_min": 5.64, "num_model_switches_max": 6.32, "num_slav_mean": 0.15595266666666666, "num_slav_min": 0.13711666666666666, "num_slav_max": 0.17515, "mean_cluster_cpu_util_mean": 0.5625714974074211, "mean_cluster_cpu_util_min": 0.5434795914378214, "mean_cluster_cpu_util_max": 0.5812888739107883, "mean_cluster_mem_util_mean": 0.36256929536761967, "mean_cluster_mem_util_min": 0.3533887927322828, "mean_cluster_mem_util_max": 0.37208191609977326, "reward_consolidation_mean_mean": 0.22446666666666662, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.38888888888888884, "reward_illegal_mean_mean": -1.653333333333333, "reward_illegal_mean_min": -1.9166666666666665, "reward_illegal_mean_max": -1.2833333333333332, "reward_accuracy_mean_mean": 0.9189853333333333, "reward_accuracy_mean_min": 0.4559, "reward_accuracy_mean_max": 1.5769333333333333, "reward_sla_mean_mean": -1.1376555555555554, "reward_sla_mean_min": -1.9505555555555558, "reward_sla_mean_max": -0.5927777777777777, "reward_consolidation_sum_mean": 22.446666666666665, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 38.888888888888886, "reward_illegal_sum_mean": -165.33333333333331, "reward_illegal_sum_min": -191.66666666666666, "reward_illegal_sum_max": -128.33333333333331, "reward_accuracy_sum_mean": 91.89853333333332, "reward_accuracy_sum_min": 45.59, "reward_accuracy_sum_max": 157.69333333333333, "reward_sla_sum_mean": -113.76555555555557, "reward_sla_sum_min": -195.05555555555557, "reward_sla_sum_max": -59.27777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4683.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333, -182.4488888888889, -151.05111111111117, -177.6711111111111, -174.7633333333333, -138.91111111111113, -181.4288888888889, -167.03, -157.77777777777771, -150.52888888888884, -190.26666666666668, -151.878888888889, -194.34777777777774, -130.78666666666672, -170.06555555555553, -160.99333333333325, -158.51888888888882, -176.14555555555552, -178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563, -199.3822222222221, -176.03555555555562, -148.3477777777778, -145.8411111111112, -159.79444444444437, -113.07222222222232, -190.20000000000016, -185.74777777777774, -143.49666666666673, -177.89888888888888, -171.79, -192.9688888888889, -181.49666666666667, -160.83555555555557, -187.03888888888878, -153.29222222222225, -147.42111111111114, -143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333, -173.9044444444445, -173.24000000000007, -161.09222222222218, -166.9966666666666, -176.37111111111113, -153.38111111111115, -170.24666666666658, -144.0822222222222, -114.25111111111116, -178.23333333333335, -171.85333333333332, -145.50333333333336, -178.0399999999999, -124.60777777777783, -151.10555555555553, -163.30777777777777, -153.4655555555555, -140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-157.77888888888887, -165.54111111111104, -160.39444444444442, -195.90999999999983, -175.60222222222208, -169.10222222222228, -195.65333333333322, -152.33444444444444, -176.96333333333322, -173.69888888888886, -159.05444444444447, -153.91555555555558, -147.1933333333333, -182.4488888888889, -151.05111111111117, -177.6711111111111, -174.7633333333333, -138.91111111111113, -181.4288888888889, -167.03, -157.77777777777771, -150.52888888888884, -190.26666666666668, -151.878888888889, -194.34777777777774, -130.78666666666672, -170.06555555555553, -160.99333333333325, -158.51888888888882, -176.14555555555552, -178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563, -199.3822222222221, -176.03555555555562, -148.3477777777778, -145.8411111111112, -159.79444444444437, -113.07222222222232, -190.20000000000016, -185.74777777777774, -143.49666666666673, -177.89888888888888, -171.79, -192.9688888888889, -181.49666666666667, -160.83555555555557, -187.03888888888878, -153.29222222222225, -147.42111111111114, -143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333, -173.9044444444445, -173.24000000000007, -161.09222222222218, -166.9966666666666, -176.37111111111113, -153.38111111111115, -170.24666666666658, -144.0822222222222, -114.25111111111116, -178.23333333333335, -171.85333333333332, -145.50333333333336, -178.0399999999999, -124.60777777777783, -151.10555555555553, -163.30777777777777, -153.4655555555555, -140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1989617412898767, "mean_inference_ms": 1.8177228125180585, "mean_action_processing_ms": 0.07479117155269652, "mean_env_wait_ms": 1.213103601178704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044596195220947266, "StateBufferConnector_ms": 0.0029077529907226562, "ViewRequirementAgentConnector_ms": 0.0690615177154541}, "num_episodes": 27, "episode_return_max": -113.07222222222232, "episode_return_min": -201.11222222222227, "episode_return_mean": -164.75368888888886, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50250, "num_agent_steps_trained": 50100, "num_env_steps_sampled": 50250, "num_env_steps_trained": 50100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.99598555143825, "num_env_steps_trained_throughput_per_sec": 287.3641953173034, "timesteps_total": 50250, "num_env_steps_sampled_lifetime": 50250, "num_agent_steps_sampled_lifetime": 50250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 50250, "timers": {"training_iteration_time_ms": 10201.778, "restore_workers_time_ms": 0.014, "training_step_time_ms": 539.213, "sample_time_ms": 523.664, "synch_weights_time_ms": 14.143}, "counters": {"num_env_steps_sampled": 50250, "num_env_steps_trained": 50100, "num_agent_steps_sampled": 50250, "num_agent_steps_trained": 50100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 335, "num_samples_added_to_queue": 50100}, "done": false, "training_iteration": 17, "trial_id": "38f59_00000", "date": "2024-10-10_22-14-26", "timestamp": 1728594866, "time_this_iter_s": 10.449902772903442, "time_total_s": 173.8546061515808, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18ee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.8546061515808, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 14.800000000000002, "ram_util_percent": 54.45333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -140466.125, "policy_loss": -140932.359375, "entropy": 29.736268997192383, "entropy_coeff": 0.01, "var_gnorm": 16.065876007080078, "vf_loss": 55543.18359375, "vf_explained_var": 0.054628074169158936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 53100, "num_env_steps_trained": 52800, "num_agent_steps_sampled": 53100, "num_agent_steps_trained": 52800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 354, "num_samples_added_to_queue": 53100, "learner_queue": {"size_count": 176, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.855, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 1025.96, "learner_dequeue_time_ms": 8518.904}}, "env_runners": {"episode_reward_max": -113.07222222222232, "episode_reward_min": -201.11222222222227, "episode_reward_mean": -162.06550000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -201.11222222222227}, "policy_reward_max": {"default_policy": -113.07222222222232}, "policy_reward_mean": {"default_policy": -162.06550000000001}, "custom_metrics": {"num_consolidated_mean": 0.6772, "num_consolidated_min": 0.49, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.9747, "num_overloaded_min": 0.77, "num_overloaded_max": 1.13, "num_moves_mean": 9.997399999999999, "num_moves_min": 9.66, "num_moves_max": 10.31, "mean_accuracy_mean": 40.98713999999999, "mean_accuracy_min": 40.74533333333333, "mean_accuracy_max": 41.214, "num_model_switches_mean": 5.979500000000001, "num_model_switches_min": 5.63, "num_model_switches_max": 6.59, "num_slav_mean": 0.155105, "num_slav_min": 0.13473333333333334, "num_slav_max": 0.17515, "mean_cluster_cpu_util_mean": 0.560977183832737, "mean_cluster_cpu_util_min": 0.540843666850405, "mean_cluster_cpu_util_max": 0.5812888739107883, "mean_cluster_mem_util_mean": 0.36213489149372824, "mean_cluster_mem_util_min": 0.35342123589942304, "mean_cluster_mem_util_max": 0.37208191609977326, "reward_consolidation_mean_mean": 0.2366, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.38888888888888884, "reward_illegal_mean_mean": -1.6244999999999996, "reward_illegal_mean_min": -1.8833333333333335, "reward_illegal_mean_max": -1.2833333333333332, "reward_accuracy_mean_mean": 0.9564116666666667, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.5769333333333333, "reward_sla_mean_mean": -1.1891666666666665, "reward_sla_mean_min": -1.9505555555555558, "reward_sla_mean_max": -0.5927777777777777, "reward_consolidation_sum_mean": 23.66, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 38.888888888888886, "reward_illegal_sum_mean": -162.45, "reward_illegal_sum_min": -188.33333333333334, "reward_illegal_sum_max": -128.33333333333331, "reward_accuracy_sum_mean": 95.64116666666666, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 157.69333333333333, "reward_sla_sum_mean": -118.91666666666666, "reward_sla_sum_min": -195.05555555555557, "reward_sla_sum_max": -59.27777777777777, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3343.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563, -199.3822222222221, -176.03555555555562, -148.3477777777778, -145.8411111111112, -159.79444444444437, -113.07222222222232, -190.20000000000016, -185.74777777777774, -143.49666666666673, -177.89888888888888, -171.79, -192.9688888888889, -181.49666666666667, -160.83555555555557, -187.03888888888878, -153.29222222222225, -147.42111111111114, -143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333, -173.9044444444445, -173.24000000000007, -161.09222222222218, -166.9966666666666, -176.37111111111113, -153.38111111111115, -170.24666666666658, -144.0822222222222, -114.25111111111116, -178.23333333333335, -171.85333333333332, -145.50333333333336, -178.0399999999999, -124.60777777777783, -151.10555555555553, -163.30777777777777, -153.4655555555555, -140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227, -163.37333333333328, -158.0044444444444, -124.8333333333334, -172.53777777777785, -154.5366666666667, -165.04555555555555, -173.1955555555556, -172.59333333333325, -162.2611111111111, -176.7222222222222, -177.44555555555547, -160.87333333333336, -156.02555555555557, -143.18555555555565, -121.4800000000001, -160.2833333333333, -150.13666666666668, -145.0855555555555, -131.07000000000008, -155.88555555555553, -147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-178.27000000000004, -176.25444444444426, -171.04999999999984, -153.04111111111106, -172.40222222222224, -188.36777777777772, -158.67666666666668, -156.08555555555554, -181.5922222222221, -201.11222222222227, -167.76555555555564, -176.5777777777777, -141.83555555555563, -199.3822222222221, -176.03555555555562, -148.3477777777778, -145.8411111111112, -159.79444444444437, -113.07222222222232, -190.20000000000016, -185.74777777777774, -143.49666666666673, -177.89888888888888, -171.79, -192.9688888888889, -181.49666666666667, -160.83555555555557, -187.03888888888878, -153.29222222222225, -147.42111111111114, -143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333, -173.9044444444445, -173.24000000000007, -161.09222222222218, -166.9966666666666, -176.37111111111113, -153.38111111111115, -170.24666666666658, -144.0822222222222, -114.25111111111116, -178.23333333333335, -171.85333333333332, -145.50333333333336, -178.0399999999999, -124.60777777777783, -151.10555555555553, -163.30777777777777, -153.4655555555555, -140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227, -163.37333333333328, -158.0044444444444, -124.8333333333334, -172.53777777777785, -154.5366666666667, -165.04555555555555, -173.1955555555556, -172.59333333333325, -162.2611111111111, -176.7222222222222, -177.44555555555547, -160.87333333333336, -156.02555555555557, -143.18555555555565, -121.4800000000001, -160.2833333333333, -150.13666666666668, -145.0855555555555, -131.07000000000008, -155.88555555555553, -147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1991386810494043, "mean_inference_ms": 1.8189692779809616, "mean_action_processing_ms": 0.0748832153220994, "mean_env_wait_ms": 1.2144341700423624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044574737548828125, "StateBufferConnector_ms": 0.002928495407104492, "ViewRequirementAgentConnector_ms": 0.0695195198059082}, "num_episodes": 30, "episode_return_max": -113.07222222222232, "episode_return_min": -201.11222222222227, "episode_return_mean": -162.06550000000001, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53100, "num_agent_steps_trained": 52800, "num_env_steps_sampled": 53100, "num_env_steps_trained": 52800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.47934637271885, "num_env_steps_trained_throughput_per_sec": 262.87517024783887, "timesteps_total": 53100, "num_env_steps_sampled_lifetime": 53100, "num_agent_steps_sampled_lifetime": 53100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 53100, "timers": {"training_iteration_time_ms": 10224.551, "restore_workers_time_ms": 0.011, "training_step_time_ms": 533.974, "sample_time_ms": 520.289, "synch_weights_time_ms": 12.397}, "counters": {"num_env_steps_sampled": 53100, "num_env_steps_trained": 52800, "num_agent_steps_sampled": 53100, "num_agent_steps_trained": 52800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 354, "num_samples_added_to_queue": 53100}, "done": false, "training_iteration": 18, "trial_id": "38f59_00000", "date": "2024-10-10_22-14-37", "timestamp": 1728594877, "time_this_iter_s": 10.280174493789673, "time_total_s": 184.13478064537048, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdce9b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.13478064537048, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.773333333333332, "ram_util_percent": 54.379999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -132080.015625, "policy_loss": -132473.328125, "entropy": 29.71711540222168, "entropy_coeff": 0.01, "var_gnorm": 16.074474334716797, "vf_loss": 48246.76171875, "vf_explained_var": 0.06849628686904907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 186.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 56100, "num_env_steps_trained": 55800, "num_agent_steps_sampled": 56100, "num_agent_steps_trained": 55800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 374, "num_samples_added_to_queue": 56100, "learner_queue": {"size_count": 186, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.327, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 951.71, "learner_dequeue_time_ms": 8491.073}}, "env_runners": {"episode_reward_max": -110.73777777777782, "episode_reward_min": -200.8477777777776, "episode_reward_mean": -157.24435555555553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -200.8477777777776}, "policy_reward_max": {"default_policy": -110.73777777777782}, "policy_reward_mean": {"default_policy": -157.24435555555553}, "custom_metrics": {"num_consolidated_mean": 0.6792999999999999, "num_consolidated_min": 0.49, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.9520000000000001, "num_overloaded_min": 0.77, "num_overloaded_max": 1.1, "num_moves_mean": 10.0029, "num_moves_min": 9.71, "num_moves_max": 10.43, "mean_accuracy_mean": 40.96871, "mean_accuracy_min": 40.73266666666666, "mean_accuracy_max": 41.214, "num_model_switches_mean": 5.975499999999999, "num_model_switches_min": 5.63, "num_model_switches_max": 6.59, "num_slav_mean": 0.1526915, "num_slav_min": 0.13473333333333334, "num_slav_max": 0.16991666666666663, "mean_cluster_cpu_util_mean": 0.5593121623966577, "mean_cluster_cpu_util_min": 0.540843666850405, "mean_cluster_cpu_util_max": 0.5811384177118195, "mean_cluster_mem_util_mean": 0.3614396719355464, "mean_cluster_mem_util_min": 0.35342123589942304, "mean_cluster_mem_util_max": 0.37208191609977326, "reward_consolidation_mean_mean": 0.2442222222222222, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.38888888888888884, "reward_illegal_mean_mean": -1.5866666666666667, "reward_illegal_mean_min": -1.833333333333333, "reward_illegal_mean_max": -1.2833333333333332, "reward_accuracy_mean_mean": 1.003562, "reward_accuracy_mean_min": 0.49256666666666665, "reward_accuracy_mean_max": 1.5769333333333333, "reward_sla_mean_mean": -1.233561111111111, "reward_sla_mean_min": -1.9505555555555558, "reward_sla_mean_max": -0.7377777777777779, "reward_consolidation_sum_mean": 24.422222222222217, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 38.888888888888886, "reward_illegal_sum_mean": -158.66666666666663, "reward_illegal_sum_min": -183.33333333333331, "reward_illegal_sum_max": -128.33333333333331, "reward_accuracy_sum_mean": 100.35619999999999, "reward_accuracy_sum_min": 49.25666666666667, "reward_accuracy_sum_max": 157.69333333333333, "reward_sla_sum_mean": -123.35611111111112, "reward_sla_sum_min": -195.05555555555557, "reward_sla_sum_max": -73.77777777777779, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2159.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333, -173.9044444444445, -173.24000000000007, -161.09222222222218, -166.9966666666666, -176.37111111111113, -153.38111111111115, -170.24666666666658, -144.0822222222222, -114.25111111111116, -178.23333333333335, -171.85333333333332, -145.50333333333336, -178.0399999999999, -124.60777777777783, -151.10555555555553, -163.30777777777777, -153.4655555555555, -140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227, -163.37333333333328, -158.0044444444444, -124.8333333333334, -172.53777777777785, -154.5366666666667, -165.04555555555555, -173.1955555555556, -172.59333333333325, -162.2611111111111, -176.7222222222222, -177.44555555555547, -160.87333333333336, -156.02555555555557, -143.18555555555565, -121.4800000000001, -160.2833333333333, -150.13666666666668, -145.0855555555555, -131.07000000000008, -155.88555555555553, -147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556, -178.32888888888886, -148.98333333333335, -170.22, -137.49444444444455, -143.88111111111112, -142.76000000000002, -162.07555555555552, -136.00111111111113, -182.03111111111096, -135.11222222222221, -155.93444444444444, -164.56111111111107, -153.2355555555556, -170.01888888888897, -141.19555555555556, -149.96666666666667, -160.2811111111112, -160.5611111111111, -135.58777777777786, -165.25333333333327, -172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-143.6133333333334, -200.8477777777776, -149.96333333333337, -131.298888888889, -165.1133333333332, -193.18777777777765, -141.5044444444445, -168.44111111111118, -154.87, -166.82333333333335, -151.94999999999996, -183.96111111111097, -173.5333333333333, -173.9044444444445, -173.24000000000007, -161.09222222222218, -166.9966666666666, -176.37111111111113, -153.38111111111115, -170.24666666666658, -144.0822222222222, -114.25111111111116, -178.23333333333335, -171.85333333333332, -145.50333333333336, -178.0399999999999, -124.60777777777783, -151.10555555555553, -163.30777777777777, -153.4655555555555, -140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227, -163.37333333333328, -158.0044444444444, -124.8333333333334, -172.53777777777785, -154.5366666666667, -165.04555555555555, -173.1955555555556, -172.59333333333325, -162.2611111111111, -176.7222222222222, -177.44555555555547, -160.87333333333336, -156.02555555555557, -143.18555555555565, -121.4800000000001, -160.2833333333333, -150.13666666666668, -145.0855555555555, -131.07000000000008, -155.88555555555553, -147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556, -178.32888888888886, -148.98333333333335, -170.22, -137.49444444444455, -143.88111111111112, -142.76000000000002, -162.07555555555552, -136.00111111111113, -182.03111111111096, -135.11222222222221, -155.93444444444444, -164.56111111111107, -153.2355555555556, -170.01888888888897, -141.19555555555556, -149.96666666666667, -160.2811111111112, -160.5611111111111, -135.58777777777786, -165.25333333333327, -172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1994229227071132, "mean_inference_ms": 1.8199792876103613, "mean_action_processing_ms": 0.07498349745353015, "mean_env_wait_ms": 1.2158179248679313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004511833190917969, "StateBufferConnector_ms": 0.002945423126220703, "ViewRequirementAgentConnector_ms": 0.06990242004394531}, "num_episodes": 30, "episode_return_max": -110.73777777777782, "episode_return_min": -200.8477777777776, "episode_return_mean": -157.24435555555553, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56100, "num_agent_steps_trained": 55800, "num_env_steps_sampled": 56100, "num_env_steps_trained": 55800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.0630251628488, "num_env_steps_trained_throughput_per_sec": 299.0630251628488, "timesteps_total": 56100, "num_env_steps_sampled_lifetime": 56100, "num_agent_steps_sampled_lifetime": 56100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 56100, "timers": {"training_iteration_time_ms": 10208.286, "restore_workers_time_ms": 0.014, "training_step_time_ms": 499.836, "sample_time_ms": 484.916, "synch_weights_time_ms": 13.608}, "counters": {"num_env_steps_sampled": 56100, "num_env_steps_trained": 55800, "num_agent_steps_sampled": 56100, "num_agent_steps_trained": 55800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 374, "num_samples_added_to_queue": 56100}, "done": false, "training_iteration": 19, "trial_id": "38f59_00000", "date": "2024-10-10_22-14-47", "timestamp": 1728594887, "time_this_iter_s": 10.040523529052734, "time_total_s": 194.17530417442322, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde6620>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.17530417442322, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.02142857142857, "ram_util_percent": 54.52142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -140818.984375, "policy_loss": -141274.15625, "entropy": 29.687217712402344, "entropy_coeff": 0.01, "var_gnorm": 16.08357810974121, "vf_loss": 54422.8046875, "vf_explained_var": 0.07583087682723999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 196.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 59100, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 59100, "num_agent_steps_trained": 58800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 394, "num_samples_added_to_queue": 59100, "learner_queue": {"size_count": 196, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.478, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 968.714, "learner_dequeue_time_ms": 8456.148}}, "env_runners": {"episode_reward_max": -110.73777777777782, "episode_reward_min": -188.0166666666666, "episode_reward_mean": -152.6441111111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -188.0166666666666}, "policy_reward_max": {"default_policy": -110.73777777777782}, "policy_reward_mean": {"default_policy": -152.6441111111111}, "custom_metrics": {"num_consolidated_mean": 0.6770999999999999, "num_consolidated_min": 0.49, "num_consolidated_max": 0.82, "num_overloaded_mean": 0.9332, "num_overloaded_min": 0.72, "num_overloaded_max": 1.1, "num_moves_mean": 9.989599999999998, "num_moves_min": 9.68, "num_moves_max": 10.43, "mean_accuracy_mean": 40.93381333333333, "mean_accuracy_min": 40.663, "mean_accuracy_max": 41.214, "num_model_switches_mean": 5.973400000000001, "num_model_switches_min": 5.6, "num_model_switches_max": 6.59, "num_slav_mean": 0.1498338333333333, "num_slav_min": 0.13274999999999998, "num_slav_max": 0.16756666666666667, "mean_cluster_cpu_util_mean": 0.5569988201731558, "mean_cluster_cpu_util_min": 0.535051793490117, "mean_cluster_cpu_util_max": 0.5811384177118195, "mean_cluster_mem_util_mean": 0.3603744178596544, "mean_cluster_mem_util_min": 0.3490613676483252, "mean_cluster_mem_util_max": 0.37000317585895126, "reward_consolidation_mean_mean": 0.2543333333333333, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.46666666666666656, "reward_illegal_mean_mean": -1.555333333333333, "reward_illegal_mean_min": -1.833333333333333, "reward_illegal_mean_max": -1.2, "reward_accuracy_mean_mean": 1.0447366666666666, "reward_accuracy_mean_min": 0.6607666666666668, "reward_accuracy_mean_max": 1.7268333333333337, "reward_sla_mean_mean": -1.2701777777777776, "reward_sla_mean_min": -2.128333333333334, "reward_sla_mean_max": -0.7377777777777779, "reward_consolidation_sum_mean": 25.433333333333326, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 46.66666666666666, "reward_illegal_sum_mean": -155.5333333333333, "reward_illegal_sum_min": -183.33333333333331, "reward_illegal_sum_max": -120.0, "reward_accuracy_sum_mean": 104.47366666666667, "reward_accuracy_sum_min": 66.07666666666668, "reward_accuracy_sum_max": 172.68333333333337, "reward_sla_sum_mean": -127.01777777777778, "reward_sla_sum_min": -212.83333333333337, "reward_sla_sum_max": -73.77777777777779, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2459.0, "global_timestep_min": 300, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227, -163.37333333333328, -158.0044444444444, -124.8333333333334, -172.53777777777785, -154.5366666666667, -165.04555555555555, -173.1955555555556, -172.59333333333325, -162.2611111111111, -176.7222222222222, -177.44555555555547, -160.87333333333336, -156.02555555555557, -143.18555555555565, -121.4800000000001, -160.2833333333333, -150.13666666666668, -145.0855555555555, -131.07000000000008, -155.88555555555553, -147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556, -178.32888888888886, -148.98333333333335, -170.22, -137.49444444444455, -143.88111111111112, -142.76000000000002, -162.07555555555552, -136.00111111111113, -182.03111111111096, -135.11222222222221, -155.93444444444444, -164.56111111111107, -153.2355555555556, -170.01888888888897, -141.19555555555556, -149.96666666666667, -160.2811111111112, -160.5611111111111, -135.58777777777786, -165.25333333333327, -172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555, -134.5322222222223, -135.11333333333337, -163.85111111111107, -134.45444444444448, -140.99555555555563, -165.8444444444443, -188.0166666666666, -172.4066666666666, -153.11333333333346, -158.27999999999997, -124.60222222222227, -123.29222222222226, -149.59111111111113, -123.61666666666676, -149.49333333333325, -143.40999999999997, -141.92000000000007, -152.38111111111107, -157.62333333333325, -113.71333333333334, -160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-140.49111111111117, -171.75000000000003, -155.36333333333337, -149.30666666666673, -153.66222222222228, -159.92333333333335, -174.23444444444445, -181.81222222222218, -161.34555555555553, -147.24222222222227, -163.37333333333328, -158.0044444444444, -124.8333333333334, -172.53777777777785, -154.5366666666667, -165.04555555555555, -173.1955555555556, -172.59333333333325, -162.2611111111111, -176.7222222222222, -177.44555555555547, -160.87333333333336, -156.02555555555557, -143.18555555555565, -121.4800000000001, -160.2833333333333, -150.13666666666668, -145.0855555555555, -131.07000000000008, -155.88555555555553, -147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556, -178.32888888888886, -148.98333333333335, -170.22, -137.49444444444455, -143.88111111111112, -142.76000000000002, -162.07555555555552, -136.00111111111113, -182.03111111111096, -135.11222222222221, -155.93444444444444, -164.56111111111107, -153.2355555555556, -170.01888888888897, -141.19555555555556, -149.96666666666667, -160.2811111111112, -160.5611111111111, -135.58777777777786, -165.25333333333327, -172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555, -134.5322222222223, -135.11333333333337, -163.85111111111107, -134.45444444444448, -140.99555555555563, -165.8444444444443, -188.0166666666666, -172.4066666666666, -153.11333333333346, -158.27999999999997, -124.60222222222227, -123.29222222222226, -149.59111111111113, -123.61666666666676, -149.49333333333325, -143.40999999999997, -141.92000000000007, -152.38111111111107, -157.62333333333325, -113.71333333333334, -160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1996047149567653, "mean_inference_ms": 1.8214478579298805, "mean_action_processing_ms": 0.07504803552217339, "mean_env_wait_ms": 1.2170723931569518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004312276840209961, "StateBufferConnector_ms": 0.0028548240661621094, "ViewRequirementAgentConnector_ms": 0.06785058975219727}, "num_episodes": 30, "episode_return_max": -110.73777777777782, "episode_return_min": -188.0166666666666, "episode_return_mean": -152.6441111111111, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59100, "num_agent_steps_trained": 58800, "num_env_steps_sampled": 59100, "num_env_steps_trained": 58800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.46263984768507, "num_env_steps_trained_throughput_per_sec": 291.46263984768507, "timesteps_total": 59100, "num_env_steps_sampled_lifetime": 59100, "num_agent_steps_sampled_lifetime": 59100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 59100, "timers": {"training_iteration_time_ms": 10199.376, "restore_workers_time_ms": 0.011, "training_step_time_ms": 536.213, "sample_time_ms": 521.777, "synch_weights_time_ms": 13.113}, "counters": {"num_env_steps_sampled": 59100, "num_env_steps_trained": 58800, "num_agent_steps_sampled": 59100, "num_agent_steps_trained": 58800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 394, "num_samples_added_to_queue": 59100}, "done": false, "training_iteration": 20, "trial_id": "38f59_00000", "date": "2024-10-10_22-14-57", "timestamp": 1728594897, "time_this_iter_s": 10.302358627319336, "time_total_s": 204.47766280174255, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7820>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.47766280174255, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.026666666666667, "ram_util_percent": 54.893333333333345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -127681.78125, "policy_loss": -128074.671875, "entropy": 29.63440704345703, "entropy_coeff": 0.01, "var_gnorm": 16.096914291381836, "vf_loss": 48179.58984375, "vf_explained_var": 0.08350116014480591}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 206.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 62100, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 62100, "num_agent_steps_trained": 61800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 414, "num_samples_added_to_queue": 62100, "learner_queue": {"size_count": 206, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.007, "learner_load_time_ms": 0.389, "learner_load_wait_time_ms": 976.742, "learner_dequeue_time_ms": 8348.33}}, "env_runners": {"episode_reward_max": -83.72666666666669, "episode_reward_min": -188.0166666666666, "episode_reward_mean": -147.16251111111112, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -188.0166666666666}, "policy_reward_max": {"default_policy": -83.72666666666669}, "policy_reward_mean": {"default_policy": -147.16251111111112}, "custom_metrics": {"num_consolidated_mean": 0.6799, "num_consolidated_min": 0.48, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.9142, "num_overloaded_min": 0.72, "num_overloaded_max": 1.1, "num_moves_mean": 9.967999999999998, "num_moves_min": 9.68, "num_moves_max": 10.43, "mean_accuracy_mean": 40.89030333333333, "mean_accuracy_min": 40.61866666666666, "mean_accuracy_max": 41.13799999999999, "num_model_switches_mean": 5.9374, "num_model_switches_min": 5.57, "num_model_switches_max": 6.37, "num_slav_mean": 0.14648433333333333, "num_slav_min": 0.1286, "num_slav_max": 0.16651666666666667, "mean_cluster_cpu_util_mean": 0.5538669486105673, "mean_cluster_cpu_util_min": 0.535051793490117, "mean_cluster_cpu_util_max": 0.5740092163456546, "mean_cluster_mem_util_mean": 0.3589177790317604, "mean_cluster_mem_util_min": 0.3490613676483252, "mean_cluster_mem_util_max": 0.3682632748141451, "reward_consolidation_mean_mean": 0.26879999999999993, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.5444444444444444, "reward_illegal_mean_mean": -1.5236666666666658, "reward_illegal_mean_min": -1.833333333333333, "reward_illegal_mean_max": -1.2, "reward_accuracy_mean_mean": 1.0808526666666667, "reward_accuracy_mean_min": 0.6607666666666668, "reward_accuracy_mean_max": 1.7268333333333337, "reward_sla_mean_mean": -1.2976111111111113, "reward_sla_mean_min": -2.128333333333334, "reward_sla_mean_max": -0.8105555555555555, "reward_consolidation_sum_mean": 26.88, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 54.44444444444444, "reward_illegal_sum_mean": -152.36666666666667, "reward_illegal_sum_min": -183.33333333333331, "reward_illegal_sum_max": -120.0, "reward_accuracy_sum_mean": 108.08526666666663, "reward_accuracy_sum_min": 66.07666666666668, "reward_accuracy_sum_max": 172.68333333333337, "reward_sla_sum_mean": -129.76111111111112, "reward_sla_sum_min": -212.83333333333337, "reward_sla_sum_max": -81.05555555555554, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3450.0, "global_timestep_min": 1200, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556, -178.32888888888886, -148.98333333333335, -170.22, -137.49444444444455, -143.88111111111112, -142.76000000000002, -162.07555555555552, -136.00111111111113, -182.03111111111096, -135.11222222222221, -155.93444444444444, -164.56111111111107, -153.2355555555556, -170.01888888888897, -141.19555555555556, -149.96666666666667, -160.2811111111112, -160.5611111111111, -135.58777777777786, -165.25333333333327, -172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555, -134.5322222222223, -135.11333333333337, -163.85111111111107, -134.45444444444448, -140.99555555555563, -165.8444444444443, -188.0166666666666, -172.4066666666666, -153.11333333333346, -158.27999999999997, -124.60222222222227, -123.29222222222226, -149.59111111111113, -123.61666666666676, -149.49333333333325, -143.40999999999997, -141.92000000000007, -152.38111111111107, -157.62333333333325, -113.71333333333334, -160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333, -156.4522222222222, -111.43333333333347, -154.79777777777772, -156.30333333333334, -98.17222222222227, -159.5733333333334, -139.97111111111113, -124.7066666666668, -163.98777777777784, -83.72666666666669, -150.45333333333332, -157.78333333333333, -162.57222222222214, -150.01222222222228, -149.8288888888889, -126.26777777777778, -164.31333333333333, -120.49555555555563, -138.10444444444445, -127.97111111111124, -117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-147.70222222222222, -165.5022222222222, -162.35111111111115, -153.30111111111103, -163.22888888888886, -131.57000000000014, -158.43444444444452, -186.83444444444444, -158.23333333333332, -177.2055555555556, -178.32888888888886, -148.98333333333335, -170.22, -137.49444444444455, -143.88111111111112, -142.76000000000002, -162.07555555555552, -136.00111111111113, -182.03111111111096, -135.11222222222221, -155.93444444444444, -164.56111111111107, -153.2355555555556, -170.01888888888897, -141.19555555555556, -149.96666666666667, -160.2811111111112, -160.5611111111111, -135.58777777777786, -165.25333333333327, -172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555, -134.5322222222223, -135.11333333333337, -163.85111111111107, -134.45444444444448, -140.99555555555563, -165.8444444444443, -188.0166666666666, -172.4066666666666, -153.11333333333346, -158.27999999999997, -124.60222222222227, -123.29222222222226, -149.59111111111113, -123.61666666666676, -149.49333333333325, -143.40999999999997, -141.92000000000007, -152.38111111111107, -157.62333333333325, -113.71333333333334, -160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333, -156.4522222222222, -111.43333333333347, -154.79777777777772, -156.30333333333334, -98.17222222222227, -159.5733333333334, -139.97111111111113, -124.7066666666668, -163.98777777777784, -83.72666666666669, -150.45333333333332, -157.78333333333333, -162.57222222222214, -150.01222222222228, -149.8288888888889, -126.26777777777778, -164.31333333333333, -120.49555555555563, -138.10444444444445, -127.97111111111124, -117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19964168453351214, "mean_inference_ms": 1.8191758545988699, "mean_action_processing_ms": 0.07502272914934062, "mean_env_wait_ms": 1.217101096080473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004688262939453125, "StateBufferConnector_ms": 0.0029015541076660156, "ViewRequirementAgentConnector_ms": 0.06878876686096191}, "num_episodes": 30, "episode_return_max": -83.72666666666669, "episode_return_min": -188.0166666666666, "episode_return_mean": -147.16251111111112, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62100, "num_agent_steps_trained": 61800, "num_env_steps_sampled": 62100, "num_env_steps_trained": 61800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.1227261271622, "num_env_steps_trained_throughput_per_sec": 291.1227261271622, "timesteps_total": 62100, "num_env_steps_sampled_lifetime": 62100, "num_agent_steps_sampled_lifetime": 62100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 62100, "timers": {"training_iteration_time_ms": 10225.912, "restore_workers_time_ms": 0.013, "training_step_time_ms": 521.631, "sample_time_ms": 507.112, "synch_weights_time_ms": 13.179}, "counters": {"num_env_steps_sampled": 62100, "num_env_steps_trained": 61800, "num_agent_steps_sampled": 62100, "num_agent_steps_trained": 61800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 414, "num_samples_added_to_queue": 62100}, "done": false, "training_iteration": 21, "trial_id": "38f59_00000", "date": "2024-10-10_22-15-08", "timestamp": 1728594908, "time_this_iter_s": 10.314340353012085, "time_total_s": 214.79200315475464, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79e3b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.79200315475464, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.753333333333336, "ram_util_percent": 55.053333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -90146.8046875, "policy_loss": -90303.859375, "entropy": 29.563766479492188, "entropy_coeff": 0.01, "var_gnorm": 16.110912322998047, "vf_loss": 24574.025390625, "vf_explained_var": 0.12924784421920776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 216.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 65100, "num_env_steps_trained": 64800, "num_agent_steps_sampled": 65100, "num_agent_steps_trained": 64800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 434, "num_samples_added_to_queue": 65100, "learner_queue": {"size_count": 216, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.03, "learner_load_time_ms": 0.374, "learner_load_wait_time_ms": 962.074, "learner_dequeue_time_ms": 8300.246}}, "env_runners": {"episode_reward_max": -69.56666666666663, "episode_reward_min": -188.0166666666666, "episode_reward_mean": -135.6473888888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -188.0166666666666}, "policy_reward_max": {"default_policy": -69.56666666666663}, "policy_reward_mean": {"default_policy": -135.6473888888889}, "custom_metrics": {"num_consolidated_mean": 0.6888, "num_consolidated_min": 0.48, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.8795999999999999, "num_overloaded_min": 0.68, "num_overloaded_max": 1.1, "num_moves_mean": 9.967799999999999, "num_moves_min": 9.68, "num_moves_max": 10.43, "mean_accuracy_mean": 40.85274666666667, "mean_accuracy_min": 40.612333333333325, "mean_accuracy_max": 41.13799999999999, "num_model_switches_mean": 5.939399999999998, "num_model_switches_min": 5.42, "num_model_switches_max": 6.37, "num_slav_mean": 0.14337366666666668, "num_slav_min": 0.12246666666666667, "num_slav_max": 0.16651666666666667, "mean_cluster_cpu_util_mean": 0.5495239048180504, "mean_cluster_cpu_util_min": 0.5284210159998742, "mean_cluster_cpu_util_max": 0.5740092163456546, "mean_cluster_mem_util_mean": 0.3567191814041017, "mean_cluster_mem_util_min": 0.34727927502224526, "mean_cluster_mem_util_max": 0.3681347649186257, "reward_consolidation_mean_mean": 0.3028666666666667, "reward_consolidation_mean_min": 0.09333333333333332, "reward_consolidation_mean_max": 0.5444444444444444, "reward_illegal_mean_mean": -1.4659999999999997, "reward_illegal_mean_min": -1.833333333333333, "reward_illegal_mean_max": -1.1333333333333333, "reward_accuracy_mean_mean": 1.1619816666666667, "reward_accuracy_mean_min": 0.6607666666666668, "reward_accuracy_mean_max": 1.7521, "reward_sla_mean_mean": -1.3553222222222223, "reward_sla_mean_min": -2.128333333333334, "reward_sla_mean_max": -0.8711111111111112, "reward_consolidation_sum_mean": 30.28666666666667, "reward_consolidation_sum_min": 9.333333333333332, "reward_consolidation_sum_max": 54.44444444444444, "reward_illegal_sum_mean": -146.59999999999997, "reward_illegal_sum_min": -183.33333333333331, "reward_illegal_sum_max": -113.33333333333333, "reward_accuracy_sum_mean": 116.19816666666668, "reward_accuracy_sum_min": 66.07666666666668, "reward_accuracy_sum_max": 175.21, "reward_sla_sum_mean": -135.5322222222222, "reward_sla_sum_min": -212.83333333333337, "reward_sla_sum_max": -87.11111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4450.0, "global_timestep_min": 2200, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555, -134.5322222222223, -135.11333333333337, -163.85111111111107, -134.45444444444448, -140.99555555555563, -165.8444444444443, -188.0166666666666, -172.4066666666666, -153.11333333333346, -158.27999999999997, -124.60222222222227, -123.29222222222226, -149.59111111111113, -123.61666666666676, -149.49333333333325, -143.40999999999997, -141.92000000000007, -152.38111111111107, -157.62333333333325, -113.71333333333334, -160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333, -156.4522222222222, -111.43333333333347, -154.79777777777772, -156.30333333333334, -98.17222222222227, -159.5733333333334, -139.97111111111113, -124.7066666666668, -163.98777777777784, -83.72666666666669, -150.45333333333332, -157.78333333333333, -162.57222222222214, -150.01222222222228, -149.8288888888889, -126.26777777777778, -164.31333333333333, -120.49555555555563, -138.10444444444445, -127.97111111111124, -117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568, -112.83555555555559, -95.40888888888895, -143.39777777777778, -168.14777777777772, -99.14111111111113, -136.37000000000006, -131.4155555555556, -92.23444444444458, -141.58333333333334, -69.56666666666663, -99.21888888888897, -120.3166666666667, -143.5166666666666, -128.72666666666674, -100.66333333333344, -109.99111111111118, -120.76777777777788, -148.98222222222222, -99.57222222222227, -138.05666666666679, -121.25111111111121, -160.46666666666664, -107.43222222222222, -102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-172.27444444444438, -110.73777777777782, -133.15222222222224, -143.26666666666674, -147.26222222222222, -132.21111111111117, -163.09222222222212, -169.55111111111097, -125.40000000000008, -185.1455555555555, -134.5322222222223, -135.11333333333337, -163.85111111111107, -134.45444444444448, -140.99555555555563, -165.8444444444443, -188.0166666666666, -172.4066666666666, -153.11333333333346, -158.27999999999997, -124.60222222222227, -123.29222222222226, -149.59111111111113, -123.61666666666676, -149.49333333333325, -143.40999999999997, -141.92000000000007, -152.38111111111107, -157.62333333333325, -113.71333333333334, -160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333, -156.4522222222222, -111.43333333333347, -154.79777777777772, -156.30333333333334, -98.17222222222227, -159.5733333333334, -139.97111111111113, -124.7066666666668, -163.98777777777784, -83.72666666666669, -150.45333333333332, -157.78333333333333, -162.57222222222214, -150.01222222222228, -149.8288888888889, -126.26777777777778, -164.31333333333333, -120.49555555555563, -138.10444444444445, -127.97111111111124, -117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568, -112.83555555555559, -95.40888888888895, -143.39777777777778, -168.14777777777772, -99.14111111111113, -136.37000000000006, -131.4155555555556, -92.23444444444458, -141.58333333333334, -69.56666666666663, -99.21888888888897, -120.3166666666667, -143.5166666666666, -128.72666666666674, -100.66333333333344, -109.99111111111118, -120.76777777777788, -148.98222222222222, -99.57222222222227, -138.05666666666679, -121.25111111111121, -160.46666666666664, -107.43222222222222, -102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19952570824288243, "mean_inference_ms": 1.8174545469102565, "mean_action_processing_ms": 0.07494686203619062, "mean_env_wait_ms": 1.216573590956173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004715681076049805, "StateBufferConnector_ms": 0.0028562545776367188, "ViewRequirementAgentConnector_ms": 0.06703901290893555}, "num_episodes": 30, "episode_return_max": -69.56666666666663, "episode_return_min": -188.0166666666666, "episode_return_mean": -135.6473888888889, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65100, "num_agent_steps_trained": 64800, "num_env_steps_sampled": 65100, "num_env_steps_trained": 64800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.06748219654315, "num_env_steps_trained_throughput_per_sec": 297.06748219654315, "timesteps_total": 65100, "num_env_steps_sampled_lifetime": 65100, "num_agent_steps_sampled_lifetime": 65100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 65100, "timers": {"training_iteration_time_ms": 10224.597, "restore_workers_time_ms": 0.011, "training_step_time_ms": 505.68, "sample_time_ms": 492.318, "synch_weights_time_ms": 12.08}, "counters": {"num_env_steps_sampled": 65100, "num_env_steps_trained": 64800, "num_agent_steps_sampled": 65100, "num_agent_steps_trained": 64800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 434, "num_samples_added_to_queue": 65100}, "done": false, "training_iteration": 22, "trial_id": "38f59_00000", "date": "2024-10-10_22-15-18", "timestamp": 1728594918, "time_this_iter_s": 10.10814356803894, "time_total_s": 224.90014672279358, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde5c30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.90014672279358, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 10.307142857142859, "ram_util_percent": 54.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -57851.546875, "policy_loss": -57888.2265625, "entropy": 29.434364318847656, "entropy_coeff": 0.01, "var_gnorm": 16.130077362060547, "vf_loss": 12498.61328125, "vf_explained_var": 0.15664440393447876}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 226.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 68100, "num_env_steps_trained": 67800, "num_agent_steps_sampled": 68100, "num_agent_steps_trained": 67800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 454, "num_samples_added_to_queue": 68100, "learner_queue": {"size_count": 226, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.39, "learner_load_time_ms": 0.368, "learner_load_wait_time_ms": 955.815, "learner_dequeue_time_ms": 8316.822}}, "env_runners": {"episode_reward_max": -59.377777777777744, "episode_reward_min": -168.14777777777772, "episode_reward_mean": -123.4710666666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -168.14777777777772}, "policy_reward_max": {"default_policy": -59.377777777777744}, "policy_reward_mean": {"default_policy": -123.4710666666667}, "custom_metrics": {"num_consolidated_mean": 0.6942, "num_consolidated_min": 0.48, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.8402999999999998, "num_overloaded_min": 0.68, "num_overloaded_max": 1.04, "num_moves_mean": 9.937599999999998, "num_moves_min": 9.68, "num_moves_max": 10.28, "mean_accuracy_mean": 40.81677333333333, "mean_accuracy_min": 40.58066666666666, "mean_accuracy_max": 41.062, "num_model_switches_mean": 5.941100000000001, "num_model_switches_min": 5.42, "num_model_switches_max": 6.37, "num_slav_mean": 0.1395785, "num_slav_min": 0.11918333333333334, "num_slav_max": 0.16315000000000002, "mean_cluster_cpu_util_mean": 0.5445204640625908, "mean_cluster_cpu_util_min": 0.5255775902270304, "mean_cluster_cpu_util_max": 0.5740092163456546, "mean_cluster_mem_util_mean": 0.3545806214981774, "mean_cluster_mem_util_min": 0.34406661266827404, "mean_cluster_mem_util_max": 0.3681347649186257, "reward_consolidation_mean_mean": 0.3286888888888889, "reward_consolidation_mean_min": 0.18666666666666665, "reward_consolidation_mean_max": 0.5444444444444444, "reward_illegal_mean_mean": -1.4004999999999996, "reward_illegal_mean_min": -1.733333333333333, "reward_illegal_mean_max": -1.1333333333333333, "reward_accuracy_mean_mean": 1.256806, "reward_accuracy_mean_min": 0.7701333333333332, "reward_accuracy_mean_max": 1.7521, "reward_sla_mean_mean": -1.4197055555555553, "reward_sla_mean_min": -2.1849999999999996, "reward_sla_mean_max": -0.8872222222222221, "reward_consolidation_sum_mean": 32.86888888888888, "reward_consolidation_sum_min": 18.666666666666664, "reward_consolidation_sum_max": 54.44444444444444, "reward_illegal_sum_mean": -140.04999999999995, "reward_illegal_sum_min": -173.3333333333333, "reward_illegal_sum_max": -113.33333333333333, "reward_accuracy_sum_mean": 125.68059999999997, "reward_accuracy_sum_min": 77.01333333333332, "reward_accuracy_sum_max": 175.21, "reward_sla_sum_mean": -141.97055555555553, "reward_sla_sum_min": -218.49999999999997, "reward_sla_sum_max": -88.72222222222221, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5450.0, "global_timestep_min": 3200, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333, -156.4522222222222, -111.43333333333347, -154.79777777777772, -156.30333333333334, -98.17222222222227, -159.5733333333334, -139.97111111111113, -124.7066666666668, -163.98777777777784, -83.72666666666669, -150.45333333333332, -157.78333333333333, -162.57222222222214, -150.01222222222228, -149.8288888888889, -126.26777777777778, -164.31333333333333, -120.49555555555563, -138.10444444444445, -127.97111111111124, -117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568, -112.83555555555559, -95.40888888888895, -143.39777777777778, -168.14777777777772, -99.14111111111113, -136.37000000000006, -131.4155555555556, -92.23444444444458, -141.58333333333334, -69.56666666666663, -99.21888888888897, -120.3166666666667, -143.5166666666666, -128.72666666666674, -100.66333333333344, -109.99111111111118, -120.76777777777788, -148.98222222222222, -99.57222222222227, -138.05666666666679, -121.25111111111121, -160.46666666666664, -107.43222222222222, -102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895, -147.01222222222214, -126.17000000000012, -118.97888888888892, -113.72666666666679, -127.16555555555563, -110.53555555555565, -107.48000000000006, -97.0066666666667, -80.94111111111111, -72.7911111111111, -118.16888888888896, -146.4433333333333, -59.377777777777744, -79.08555555555559, -103.78000000000009, -127.8955555555556, -109.26444444444449, -71.11333333333333, -85.99333333333333, -92.85555555555557, -126.17111111111117, -90.93000000000013, -99.1544444444445, -139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-160.1533333333333, -157.98444444444436, -152.51222222222214, -121.98555555555565, -116.59444444444449, -140.7777777777777, -154.29222222222216, -134.38777777777784, -136.6333333333334, -163.19333333333333, -156.4522222222222, -111.43333333333347, -154.79777777777772, -156.30333333333334, -98.17222222222227, -159.5733333333334, -139.97111111111113, -124.7066666666668, -163.98777777777784, -83.72666666666669, -150.45333333333332, -157.78333333333333, -162.57222222222214, -150.01222222222228, -149.8288888888889, -126.26777777777778, -164.31333333333333, -120.49555555555563, -138.10444444444445, -127.97111111111124, -117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568, -112.83555555555559, -95.40888888888895, -143.39777777777778, -168.14777777777772, -99.14111111111113, -136.37000000000006, -131.4155555555556, -92.23444444444458, -141.58333333333334, -69.56666666666663, -99.21888888888897, -120.3166666666667, -143.5166666666666, -128.72666666666674, -100.66333333333344, -109.99111111111118, -120.76777777777788, -148.98222222222222, -99.57222222222227, -138.05666666666679, -121.25111111111121, -160.46666666666664, -107.43222222222222, -102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895, -147.01222222222214, -126.17000000000012, -118.97888888888892, -113.72666666666679, -127.16555555555563, -110.53555555555565, -107.48000000000006, -97.0066666666667, -80.94111111111111, -72.7911111111111, -118.16888888888896, -146.4433333333333, -59.377777777777744, -79.08555555555559, -103.78000000000009, -127.8955555555556, -109.26444444444449, -71.11333333333333, -85.99333333333333, -92.85555555555557, -126.17111111111117, -90.93000000000013, -99.1544444444445, -139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19926731051842395, "mean_inference_ms": 1.8163005302443207, "mean_action_processing_ms": 0.07484170332891739, "mean_env_wait_ms": 1.2158659895368051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004582881927490234, "StateBufferConnector_ms": 0.002802610397338867, "ViewRequirementAgentConnector_ms": 0.06524348258972168}, "num_episodes": 30, "episode_return_max": -59.377777777777744, "episode_return_min": -168.14777777777772, "episode_return_mean": -123.4710666666667, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68100, "num_agent_steps_trained": 67800, "num_env_steps_sampled": 68100, "num_env_steps_trained": 67800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.40684774869277, "num_env_steps_trained_throughput_per_sec": 298.40684774869277, "timesteps_total": 68100, "num_env_steps_sampled_lifetime": 68100, "num_agent_steps_sampled_lifetime": 68100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 68100, "timers": {"training_iteration_time_ms": 10209.005, "restore_workers_time_ms": 0.012, "training_step_time_ms": 490.511, "sample_time_ms": 476.462, "synch_weights_time_ms": 12.79}, "counters": {"num_env_steps_sampled": 68100, "num_env_steps_trained": 67800, "num_agent_steps_sampled": 68100, "num_agent_steps_trained": 67800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 454, "num_samples_added_to_queue": 68100}, "done": false, "training_iteration": 23, "trial_id": "38f59_00000", "date": "2024-10-10_22-15-28", "timestamp": 1728594928, "time_this_iter_s": 10.065099477767944, "time_total_s": 234.96524620056152, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79d3f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.96524620056152, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 10.46, "ram_util_percent": 55.040000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -28729.498046875, "policy_loss": -28722.798828125, "entropy": 29.0966739654541, "entropy_coeff": 0.01, "var_gnorm": 16.15937614440918, "vf_loss": 8059.04833984375, "vf_explained_var": 0.13813620805740356}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 237.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 71250, "num_env_steps_trained": 71100, "num_agent_steps_sampled": 71250, "num_agent_steps_trained": 71100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 475, "num_samples_added_to_queue": 71100, "learner_queue": {"size_count": 237, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.14, "learner_load_time_ms": 0.39, "learner_load_wait_time_ms": 917.398, "learner_dequeue_time_ms": 8295.761}}, "env_runners": {"episode_reward_max": -23.35000000000002, "episode_reward_min": -168.14777777777772, "episode_reward_mean": -104.52295555555558, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -168.14777777777772}, "policy_reward_max": {"default_policy": -23.35000000000002}, "policy_reward_mean": {"default_policy": -104.52295555555558}, "custom_metrics": {"num_consolidated_mean": 0.709, "num_consolidated_min": 0.53, "num_consolidated_max": 0.86, "num_overloaded_mean": 0.7931999999999999, "num_overloaded_min": 0.59, "num_overloaded_max": 0.98, "num_moves_mean": 9.9113, "num_moves_min": 9.48, "num_moves_max": 10.25, "mean_accuracy_mean": 40.759836666666665, "mean_accuracy_min": 40.39066666666666, "mean_accuracy_max": 41.04933333333334, "num_model_switches_mean": 5.922900000000001, "num_model_switches_min": 5.42, "num_model_switches_max": 6.35, "num_slav_mean": 0.13402833333333333, "num_slav_min": 0.11208333333333334, "num_slav_max": 0.16315000000000002, "mean_cluster_cpu_util_mean": 0.5392476412018613, "mean_cluster_cpu_util_min": 0.5131871203596268, "mean_cluster_cpu_util_max": 0.5632754942445751, "mean_cluster_mem_util_mean": 0.35214789180049655, "mean_cluster_mem_util_min": 0.3402894737219783, "mean_cluster_mem_util_max": 0.3644129962111428, "reward_consolidation_mean_mean": 0.3657111111111111, "reward_consolidation_mean_min": 0.18666666666666665, "reward_consolidation_mean_max": 0.6222222222222221, "reward_illegal_mean_mean": -1.3219999999999996, "reward_illegal_mean_min": -1.6333333333333335, "reward_illegal_mean_max": -0.9833333333333332, "reward_accuracy_mean_mean": 1.3736259999999996, "reward_accuracy_mean_min": 0.8491666666666666, "reward_accuracy_mean_max": 1.9961666666666664, "reward_sla_mean_mean": -1.4625666666666666, "reward_sla_mean_min": -2.1849999999999996, "reward_sla_mean_max": -0.8972222222222223, "reward_consolidation_sum_mean": 36.571111111111115, "reward_consolidation_sum_min": 18.666666666666664, "reward_consolidation_sum_max": 62.222222222222214, "reward_illegal_sum_mean": -132.2, "reward_illegal_sum_min": -163.33333333333334, "reward_illegal_sum_max": -98.33333333333331, "reward_accuracy_sum_mean": 137.3626, "reward_accuracy_sum_min": 84.91666666666666, "reward_accuracy_sum_max": 199.61666666666665, "reward_sla_sum_mean": -146.25666666666666, "reward_sla_sum_min": -218.49999999999997, "reward_sla_sum_max": -89.72222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5748.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568, -112.83555555555559, -95.40888888888895, -143.39777777777778, -168.14777777777772, -99.14111111111113, -136.37000000000006, -131.4155555555556, -92.23444444444458, -141.58333333333334, -69.56666666666663, -99.21888888888897, -120.3166666666667, -143.5166666666666, -128.72666666666674, -100.66333333333344, -109.99111111111118, -120.76777777777788, -148.98222222222222, -99.57222222222227, -138.05666666666679, -121.25111111111121, -160.46666666666664, -107.43222222222222, -102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895, -147.01222222222214, -126.17000000000012, -118.97888888888892, -113.72666666666679, -127.16555555555563, -110.53555555555565, -107.48000000000006, -97.0066666666667, -80.94111111111111, -72.7911111111111, -118.16888888888896, -146.4433333333333, -59.377777777777744, -79.08555555555559, -103.78000000000009, -127.8955555555556, -109.26444444444449, -71.11333333333333, -85.99333333333333, -92.85555555555557, -126.17111111111117, -90.93000000000013, -99.1544444444445, -139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344, -80.4622222222222, -95.95111111111123, -104.15777777777782, -52.27222222222224, -68.17666666666662, -107.16888888888896, -64.72777777777776, -105.66888888888892, -73.07333333333338, -94.9044444444445, -93.50222222222223, -80.03666666666668, -97.39555555555565, -66.82, -88.40111111111119, -72.40555555555558, -67.67888888888885, -40.49555555555557, -78.84111111111112, -23.35000000000002, -116.56555555555563, -107.98888888888894, -72.32777777777784, -74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-117.9833333333334, -167.77444444444447, -138.06666666666666, -159.16000000000008, -121.23111111111113, -131.98444444444453, -148.9011111111111, -134.82999999999998, -134.1222222222223, -120.56555555555568, -112.83555555555559, -95.40888888888895, -143.39777777777778, -168.14777777777772, -99.14111111111113, -136.37000000000006, -131.4155555555556, -92.23444444444458, -141.58333333333334, -69.56666666666663, -99.21888888888897, -120.3166666666667, -143.5166666666666, -128.72666666666674, -100.66333333333344, -109.99111111111118, -120.76777777777788, -148.98222222222222, -99.57222222222227, -138.05666666666679, -121.25111111111121, -160.46666666666664, -107.43222222222222, -102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895, -147.01222222222214, -126.17000000000012, -118.97888888888892, -113.72666666666679, -127.16555555555563, -110.53555555555565, -107.48000000000006, -97.0066666666667, -80.94111111111111, -72.7911111111111, -118.16888888888896, -146.4433333333333, -59.377777777777744, -79.08555555555559, -103.78000000000009, -127.8955555555556, -109.26444444444449, -71.11333333333333, -85.99333333333333, -92.85555555555557, -126.17111111111117, -90.93000000000013, -99.1544444444445, -139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344, -80.4622222222222, -95.95111111111123, -104.15777777777782, -52.27222222222224, -68.17666666666662, -107.16888888888896, -64.72777777777776, -105.66888888888892, -73.07333333333338, -94.9044444444445, -93.50222222222223, -80.03666666666668, -97.39555555555565, -66.82, -88.40111111111119, -72.40555555555558, -67.67888888888885, -40.49555555555557, -78.84111111111112, -23.35000000000002, -116.56555555555563, -107.98888888888894, -72.32777777777784, -74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19875899491928328, "mean_inference_ms": 1.8134517881745507, "mean_action_processing_ms": 0.07466529970640269, "mean_env_wait_ms": 1.2141950553880907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004080772399902344, "StateBufferConnector_ms": 0.002649068832397461, "ViewRequirementAgentConnector_ms": 0.061612606048583984}, "num_episodes": 30, "episode_return_max": -23.35000000000002, "episode_return_min": -168.14777777777772, "episode_return_mean": -104.52295555555558, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71250, "num_agent_steps_trained": 71100, "num_env_steps_sampled": 71250, "num_env_steps_trained": 71100, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 309.1378981358565, "num_env_steps_trained_throughput_per_sec": 323.8587504280402, "timesteps_total": 71250, "num_env_steps_sampled_lifetime": 71250, "num_agent_steps_sampled_lifetime": 71250, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 71250, "timers": {"training_iteration_time_ms": 10180.143, "restore_workers_time_ms": 0.011, "training_step_time_ms": 478.116, "sample_time_ms": 464.021, "synch_weights_time_ms": 12.846}, "counters": {"num_env_steps_sampled": 71250, "num_env_steps_trained": 71100, "num_agent_steps_sampled": 71250, "num_agent_steps_trained": 71100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 475, "num_samples_added_to_queue": 71100}, "done": false, "training_iteration": 24, "trial_id": "38f59_00000", "date": "2024-10-10_22-15-38", "timestamp": 1728594938, "time_this_iter_s": 10.208781480789185, "time_total_s": 245.1740276813507, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7850>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.1740276813507, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 10.8, "ram_util_percent": 55.17857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 23941.21875, "policy_loss": 23945.5859375, "entropy": 28.55923843383789, "entropy_coeff": 0.01, "var_gnorm": 16.19501304626465, "vf_loss": 8130.98486328125, "vf_explained_var": -0.008553385734558105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 74400, "num_env_steps_trained": 74100, "num_agent_steps_sampled": 74400, "num_agent_steps_trained": 74100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 496, "num_samples_added_to_queue": 74400, "learner_queue": {"size_count": 247, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.297, "learner_load_time_ms": 0.376, "learner_load_wait_time_ms": 930.761, "learner_dequeue_time_ms": 8209.323}}, "env_runners": {"episode_reward_max": 82.39888888888886, "episode_reward_min": -147.01222222222214, "episode_reward_mean": -68.33544444444448, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -147.01222222222214}, "policy_reward_max": {"default_policy": 82.39888888888886}, "policy_reward_mean": {"default_policy": -68.33544444444448}, "custom_metrics": {"num_consolidated_mean": 0.7434000000000001, "num_consolidated_min": 0.59, "num_consolidated_max": 0.91, "num_overloaded_mean": 0.7222999999999999, "num_overloaded_min": 0.44, "num_overloaded_max": 0.98, "num_moves_mean": 9.866399999999999, "num_moves_min": 9.48, "num_moves_max": 10.25, "mean_accuracy_mean": 40.664203333333326, "mean_accuracy_min": 40.30833333333332, "mean_accuracy_max": 40.992333333333335, "num_model_switches_mean": 5.8619, "num_model_switches_min": 5.47, "num_model_switches_max": 6.35, "num_slav_mean": 0.12289850000000001, "num_slav_min": 0.08701666666666666, "num_slav_max": 0.14678333333333332, "mean_cluster_cpu_util_mean": 0.5309075199704304, "mean_cluster_cpu_util_min": 0.5043494503809085, "mean_cluster_cpu_util_max": 0.5556551704127597, "mean_cluster_mem_util_mean": 0.34786351589813136, "mean_cluster_mem_util_min": 0.3345575951161056, "mean_cluster_mem_util_max": 0.36138800715433844, "reward_consolidation_mean_mean": 0.4537555555555556, "reward_consolidation_mean_min": 0.18666666666666665, "reward_consolidation_mean_max": 0.8244444444444443, "reward_illegal_mean_mean": -1.2038333333333333, "reward_illegal_mean_min": -1.6333333333333335, "reward_illegal_mean_max": -0.7333333333333333, "reward_accuracy_mean_mean": 1.5656233333333334, "reward_accuracy_mean_min": 1.0546666666666666, "reward_accuracy_mean_max": 2.332499999999999, "reward_sla_mean_mean": -1.4989000000000001, "reward_sla_mean_min": -2.1849999999999996, "reward_sla_mean_max": -0.9233333333333333, "reward_consolidation_sum_mean": 45.37555555555555, "reward_consolidation_sum_min": 18.666666666666664, "reward_consolidation_sum_max": 82.44444444444443, "reward_illegal_sum_mean": -120.38333333333333, "reward_illegal_sum_min": -163.33333333333334, "reward_illegal_sum_max": -73.33333333333333, "reward_accuracy_sum_mean": 156.56233333333333, "reward_accuracy_sum_min": 105.46666666666665, "reward_accuracy_sum_max": 233.24999999999991, "reward_sla_sum_mean": -149.89, "reward_sla_sum_min": -218.49999999999997, "reward_sla_sum_max": -92.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4291.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895, -147.01222222222214, -126.17000000000012, -118.97888888888892, -113.72666666666679, -127.16555555555563, -110.53555555555565, -107.48000000000006, -97.0066666666667, -80.94111111111111, -72.7911111111111, -118.16888888888896, -146.4433333333333, -59.377777777777744, -79.08555555555559, -103.78000000000009, -127.8955555555556, -109.26444444444449, -71.11333333333333, -85.99333333333333, -92.85555555555557, -126.17111111111117, -90.93000000000013, -99.1544444444445, -139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344, -80.4622222222222, -95.95111111111123, -104.15777777777782, -52.27222222222224, -68.17666666666662, -107.16888888888896, -64.72777777777776, -105.66888888888892, -73.07333333333338, -94.9044444444445, -93.50222222222223, -80.03666666666668, -97.39555555555565, -66.82, -88.40111111111119, -72.40555555555558, -67.67888888888885, -40.49555555555557, -78.84111111111112, -23.35000000000002, -116.56555555555563, -107.98888888888894, -72.32777777777784, -74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775, -65.69111111111108, -60.455555555555605, -31.815555555555584, -23.3266666666667, -27.8466666666667, 33.21555555555554, -0.2944444444444496, 6.606666666666637, 43.694444444444414, -23.584444444444493, 20.616666666666635, -61.59999999999998, -53.6488888888889, -64.69888888888886, -35.56222222222226, -26.114444444444462, -1.4933333333333447, -4.538888888888893, 11.768888888888851, -12.728888888888893, -16.2666666666667, 18.159999999999933, -32.10888888888892, -30.80333333333336, -36.51555555555558, -13.201111111111121, -79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-102.17666666666679, -129.5111111111112, -125.66000000000007, -80.70333333333336, -124.22222222222224, -95.73888888888895, -99.25888888888895, -147.01222222222214, -126.17000000000012, -118.97888888888892, -113.72666666666679, -127.16555555555563, -110.53555555555565, -107.48000000000006, -97.0066666666667, -80.94111111111111, -72.7911111111111, -118.16888888888896, -146.4433333333333, -59.377777777777744, -79.08555555555559, -103.78000000000009, -127.8955555555556, -109.26444444444449, -71.11333333333333, -85.99333333333333, -92.85555555555557, -126.17111111111117, -90.93000000000013, -99.1544444444445, -139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344, -80.4622222222222, -95.95111111111123, -104.15777777777782, -52.27222222222224, -68.17666666666662, -107.16888888888896, -64.72777777777776, -105.66888888888892, -73.07333333333338, -94.9044444444445, -93.50222222222223, -80.03666666666668, -97.39555555555565, -66.82, -88.40111111111119, -72.40555555555558, -67.67888888888885, -40.49555555555557, -78.84111111111112, -23.35000000000002, -116.56555555555563, -107.98888888888894, -72.32777777777784, -74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775, -65.69111111111108, -60.455555555555605, -31.815555555555584, -23.3266666666667, -27.8466666666667, 33.21555555555554, -0.2944444444444496, 6.606666666666637, 43.694444444444414, -23.584444444444493, 20.616666666666635, -61.59999999999998, -53.6488888888889, -64.69888888888886, -35.56222222222226, -26.114444444444462, -1.4933333333333447, -4.538888888888893, 11.768888888888851, -12.728888888888893, -16.2666666666667, 18.159999999999933, -32.10888888888892, -30.80333333333336, -36.51555555555558, -13.201111111111121, -79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19817969230858104, "mean_inference_ms": 1.8105154814584439, "mean_action_processing_ms": 0.07445540713420215, "mean_env_wait_ms": 1.2122444551600882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037376880645751953, "StateBufferConnector_ms": 0.002584218978881836, "ViewRequirementAgentConnector_ms": 0.06027555465698242}, "num_episodes": 33, "episode_return_max": 82.39888888888886, "episode_return_min": -147.01222222222214, "episode_return_mean": -68.33544444444448, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74400, "num_agent_steps_trained": 74100, "num_env_steps_sampled": 74400, "num_env_steps_trained": 74100, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 306.16806384396637, "num_env_steps_trained_throughput_per_sec": 291.5886322323489, "timesteps_total": 74400, "num_env_steps_sampled_lifetime": 74400, "num_agent_steps_sampled_lifetime": 74400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 74400, "timers": {"training_iteration_time_ms": 10203.967, "restore_workers_time_ms": 0.011, "training_step_time_ms": 474.939, "sample_time_ms": 460.367, "synch_weights_time_ms": 13.307}, "counters": {"num_env_steps_sampled": 74400, "num_env_steps_trained": 74100, "num_agent_steps_sampled": 74400, "num_agent_steps_trained": 74100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 496, "num_samples_added_to_queue": 74400}, "done": false, "training_iteration": 25, "trial_id": "38f59_00000", "date": "2024-10-10_22-15-48", "timestamp": 1728594948, "time_this_iter_s": 10.298681020736694, "time_total_s": 255.4727087020874, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde54e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.4727087020874, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 10.3, "ram_util_percent": 55.259999999999984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 125126.7890625, "policy_loss": 124703.3828125, "entropy": 27.95003890991211, "entropy_coeff": 0.01, "var_gnorm": 16.227073669433594, "vf_loss": 50725.9921875, "vf_explained_var": -0.24386727809906006}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 258.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 77550, "num_env_steps_trained": 77400, "num_agent_steps_sampled": 77550, "num_agent_steps_trained": 77400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 517, "num_samples_added_to_queue": 77400, "learner_queue": {"size_count": 258, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.594, "learner_load_time_ms": 0.361, "learner_load_wait_time_ms": 913.456, "learner_dequeue_time_ms": 8041.191}}, "env_runners": {"episode_reward_max": 125.21777777777767, "episode_reward_min": -139.94000000000008, "episode_reward_mean": -17.162477777777813, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -139.94000000000008}, "policy_reward_max": {"default_policy": 125.21777777777767}, "policy_reward_mean": {"default_policy": -17.162477777777813}, "custom_metrics": {"num_consolidated_mean": 0.7959999999999999, "num_consolidated_min": 0.6, "num_consolidated_max": 1.06, "num_overloaded_mean": 0.6245999999999999, "num_overloaded_min": 0.36, "num_overloaded_max": 0.91, "num_moves_mean": 9.792799999999998, "num_moves_min": 9.22, "num_moves_max": 10.14, "mean_accuracy_mean": 40.55412999999999, "mean_accuracy_min": 40.18166666666665, "mean_accuracy_max": 40.935333333333325, "num_model_switches_mean": 5.7408, "num_model_switches_min": 5.07, "num_model_switches_max": 6.24, "num_slav_mean": 0.10874000000000002, "num_slav_min": 0.07073333333333333, "num_slav_max": 0.1452, "mean_cluster_cpu_util_mean": 0.5199359877839665, "mean_cluster_cpu_util_min": 0.49004033940788894, "mean_cluster_cpu_util_max": 0.5535119356508883, "mean_cluster_mem_util_mean": 0.3421734984876862, "mean_cluster_mem_util_min": 0.32583382111283327, "mean_cluster_mem_util_max": 0.3601655953098538, "reward_consolidation_mean_mean": 0.5827111111111111, "reward_consolidation_mean_min": 0.2177777777777777, "reward_consolidation_mean_max": 1.011111111111111, "reward_illegal_mean_mean": -1.041, "reward_illegal_mean_min": -1.5166666666666666, "reward_illegal_mean_max": -0.6, "reward_accuracy_mean_mean": 1.8453363333333328, "reward_accuracy_mean_min": 1.0546666666666666, "reward_accuracy_mean_max": 2.6593999999999998, "reward_sla_mean_mean": -1.558672222222222, "reward_sla_mean_min": -2.1422222222222227, "reward_sla_mean_max": -0.9233333333333333, "reward_consolidation_sum_mean": 58.271111111111104, "reward_consolidation_sum_min": 21.77777777777777, "reward_consolidation_sum_max": 101.1111111111111, "reward_illegal_sum_mean": -104.09999999999998, "reward_illegal_sum_min": -151.66666666666666, "reward_illegal_sum_max": -59.99999999999999, "reward_accuracy_sum_mean": 184.5336333333333, "reward_accuracy_sum_min": 105.46666666666665, "reward_accuracy_sum_max": 265.94, "reward_sla_sum_mean": -155.8672222222222, "reward_sla_sum_min": -214.22222222222226, "reward_sla_sum_max": -92.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2951.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344, -80.4622222222222, -95.95111111111123, -104.15777777777782, -52.27222222222224, -68.17666666666662, -107.16888888888896, -64.72777777777776, -105.66888888888892, -73.07333333333338, -94.9044444444445, -93.50222222222223, -80.03666666666668, -97.39555555555565, -66.82, -88.40111111111119, -72.40555555555558, -67.67888888888885, -40.49555555555557, -78.84111111111112, -23.35000000000002, -116.56555555555563, -107.98888888888894, -72.32777777777784, -74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775, -65.69111111111108, -60.455555555555605, -31.815555555555584, -23.3266666666667, -27.8466666666667, 33.21555555555554, -0.2944444444444496, 6.606666666666637, 43.694444444444414, -23.584444444444493, 20.616666666666635, -61.59999999999998, -53.6488888888889, -64.69888888888886, -35.56222222222226, -26.114444444444462, -1.4933333333333447, -4.538888888888893, 11.768888888888851, -12.728888888888893, -16.2666666666667, 18.159999999999933, -32.10888888888892, -30.80333333333336, -36.51555555555558, -13.201111111111121, -79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886, 10.288888888888865, 65.07444444444441, 72.94999999999986, 80.21222222222221, 36.976666666666624, 104.42888888888888, 107.94888888888879, 91.62111111111099, 81.07999999999993, 95.61222222222217, 9.971111111111098, 19.245555555555534, 43.41222222222218, 21.291111111111086, 116.40666666666661, 59.572222222222244, 61.887777777777785, 53.397777777777776, 42.740000000000016, 112.40222222222216, -27.15444444444449, 46.092222222222205, 125.21777777777767, -5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-139.94000000000008, -79.38888888888889, -112.00333333333343, -119.19888888888896, -87.94555555555559, -130.81111111111122, -109.38333333333344, -80.4622222222222, -95.95111111111123, -104.15777777777782, -52.27222222222224, -68.17666666666662, -107.16888888888896, -64.72777777777776, -105.66888888888892, -73.07333333333338, -94.9044444444445, -93.50222222222223, -80.03666666666668, -97.39555555555565, -66.82, -88.40111111111119, -72.40555555555558, -67.67888888888885, -40.49555555555557, -78.84111111111112, -23.35000000000002, -116.56555555555563, -107.98888888888894, -72.32777777777784, -74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775, -65.69111111111108, -60.455555555555605, -31.815555555555584, -23.3266666666667, -27.8466666666667, 33.21555555555554, -0.2944444444444496, 6.606666666666637, 43.694444444444414, -23.584444444444493, 20.616666666666635, -61.59999999999998, -53.6488888888889, -64.69888888888886, -35.56222222222226, -26.114444444444462, -1.4933333333333447, -4.538888888888893, 11.768888888888851, -12.728888888888893, -16.2666666666667, 18.159999999999933, -32.10888888888892, -30.80333333333336, -36.51555555555558, -13.201111111111121, -79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886, 10.288888888888865, 65.07444444444441, 72.94999999999986, 80.21222222222221, 36.976666666666624, 104.42888888888888, 107.94888888888879, 91.62111111111099, 81.07999999999993, 95.61222222222217, 9.971111111111098, 19.245555555555534, 43.41222222222218, 21.291111111111086, 116.40666666666661, 59.572222222222244, 61.887777777777785, 53.397777777777776, 42.740000000000016, 112.40222222222216, -27.15444444444449, 46.092222222222205, 125.21777777777767, -5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19761866712456702, "mean_inference_ms": 1.805556730947087, "mean_action_processing_ms": 0.07425939802704529, "mean_env_wait_ms": 1.2101762151321822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748655319213867, "StateBufferConnector_ms": 0.002608776092529297, "ViewRequirementAgentConnector_ms": 0.06065225601196289}, "num_episodes": 30, "episode_return_max": 125.21777777777767, "episode_return_min": -139.94000000000008, "episode_return_mean": -17.162477777777813, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77550, "num_agent_steps_trained": 77400, "num_env_steps_sampled": 77550, "num_env_steps_trained": 77400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 309.45892495253264, "num_env_steps_trained_throughput_per_sec": 324.19506423598654, "timesteps_total": 77550, "num_env_steps_sampled_lifetime": 77550, "num_agent_steps_sampled_lifetime": 77550, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 77550, "timers": {"training_iteration_time_ms": 10214.926, "restore_workers_time_ms": 0.01, "training_step_time_ms": 476.894, "sample_time_ms": 463.287, "synch_weights_time_ms": 12.364}, "counters": {"num_env_steps_sampled": 77550, "num_env_steps_trained": 77400, "num_agent_steps_sampled": 77550, "num_agent_steps_trained": 77400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 517, "num_samples_added_to_queue": 77400}, "done": false, "training_iteration": 26, "trial_id": "38f59_00000", "date": "2024-10-10_22-15-59", "timestamp": 1728594959, "time_this_iter_s": 10.19432258605957, "time_total_s": 265.667031288147, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcfb50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.667031288147, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 10.521428571428572, "ram_util_percent": 55.45714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 136524.375, "policy_loss": 135987.765625, "entropy": 27.318510055541992, "entropy_coeff": 0.01, "var_gnorm": 16.250595092773438, "vf_loss": 61855.8828125, "vf_explained_var": -0.24034011363983154}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 268.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 80550, "num_env_steps_trained": 80400, "num_agent_steps_sampled": 80550, "num_agent_steps_trained": 80400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 537, "num_samples_added_to_queue": 80400, "learner_queue": {"size_count": 268, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.06, "learner_load_time_ms": 0.333, "learner_load_wait_time_ms": 969.431, "learner_dequeue_time_ms": 8003.113}}, "env_runners": {"episode_reward_max": 192.23555555555555, "episode_reward_min": -86.18000000000008, "episode_reward_mean": 44.96416666666662, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -86.18000000000008}, "policy_reward_max": {"default_policy": 192.23555555555555}, "policy_reward_mean": {"default_policy": 44.96416666666662}, "custom_metrics": {"num_consolidated_mean": 0.8597000000000001, "num_consolidated_min": 0.62, "num_consolidated_max": 1.06, "num_overloaded_mean": 0.526, "num_overloaded_min": 0.31, "num_overloaded_max": 0.79, "num_moves_mean": 9.6981, "num_moves_min": 9.17, "num_moves_max": 10.01, "mean_accuracy_mean": 40.427146666666665, "mean_accuracy_min": 40.04233333333332, "mean_accuracy_max": 40.827666666666666, "num_model_switches_mean": 5.554000000000001, "num_model_switches_min": 4.92, "num_model_switches_max": 6.17, "num_slav_mean": 0.09227733333333331, "num_slav_min": 0.05803333333333334, "num_slav_max": 0.1353, "mean_cluster_cpu_util_mean": 0.5083393142358085, "mean_cluster_cpu_util_min": 0.4846365153362494, "mean_cluster_cpu_util_max": 0.5473293687549239, "mean_cluster_mem_util_mean": 0.33581445466108384, "mean_cluster_mem_util_min": 0.3222842548939407, "mean_cluster_mem_util_max": 0.3555140706176985, "reward_consolidation_mean_mean": 0.7351555555555556, "reward_consolidation_mean_min": 0.31111111111111106, "reward_consolidation_mean_max": 1.0888888888888888, "reward_illegal_mean_mean": -0.8766666666666667, "reward_illegal_mean_min": -1.3166666666666662, "reward_illegal_mean_max": -0.5166666666666666, "reward_accuracy_mean_mean": 2.1342083333333326, "reward_accuracy_mean_min": 1.3334999999999997, "reward_accuracy_mean_max": 2.8680666666666665, "reward_sla_mean_mean": -1.5430555555555554, "reward_sla_mean_min": -2.237777777777778, "reward_sla_mean_max": -1.116111111111111, "reward_consolidation_sum_mean": 73.51555555555555, "reward_consolidation_sum_min": 31.111111111111107, "reward_consolidation_sum_max": 108.88888888888887, "reward_illegal_sum_mean": -87.66666666666664, "reward_illegal_sum_min": -131.66666666666663, "reward_illegal_sum_max": -51.66666666666666, "reward_accuracy_sum_mean": 213.4208333333333, "reward_accuracy_sum_min": 133.34999999999997, "reward_accuracy_sum_max": 286.8066666666667, "reward_sla_sum_mean": -154.30555555555554, "reward_sla_sum_min": -223.7777777777778, "reward_sla_sum_max": -111.6111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2079.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775, -65.69111111111108, -60.455555555555605, -31.815555555555584, -23.3266666666667, -27.8466666666667, 33.21555555555554, -0.2944444444444496, 6.606666666666637, 43.694444444444414, -23.584444444444493, 20.616666666666635, -61.59999999999998, -53.6488888888889, -64.69888888888886, -35.56222222222226, -26.114444444444462, -1.4933333333333447, -4.538888888888893, 11.768888888888851, -12.728888888888893, -16.2666666666667, 18.159999999999933, -32.10888888888892, -30.80333333333336, -36.51555555555558, -13.201111111111121, -79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886, 10.288888888888865, 65.07444444444441, 72.94999999999986, 80.21222222222221, 36.976666666666624, 104.42888888888888, 107.94888888888879, 91.62111111111099, 81.07999999999993, 95.61222222222217, 9.971111111111098, 19.245555555555534, 43.41222222222218, 21.291111111111086, 116.40666666666661, 59.572222222222244, 61.887777777777785, 53.397777777777776, 42.740000000000016, 112.40222222222216, -27.15444444444449, 46.092222222222205, 125.21777777777767, -5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433, 110.91777777777767, 96.41888888888873, 143.8466666666667, 35.80555555555556, 152.75888888888883, 146.8455555555554, 164.8122222222221, 132.58555555555546, 127.82888888888878, 119.72222222222204, 135.31444444444432, 48.49666666666669, 96.78666666666656, 165.6144444444444, 112.75111111111107, 164.3922222222221, 152.9622222222221, 83.16555555555556, 101.70888888888886, 166.5566666666667, 36.251111111111065, 84.19888888888883, 103.4688888888888, 121.79999999999984, 123.05333333333323, 106.20333333333328, 97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-74.63666666666673, -70.57999999999998, -81.44666666666673, -86.18000000000008, -72.88000000000001, -49.63666666666665, -52.89777777777775, -65.69111111111108, -60.455555555555605, -31.815555555555584, -23.3266666666667, -27.8466666666667, 33.21555555555554, -0.2944444444444496, 6.606666666666637, 43.694444444444414, -23.584444444444493, 20.616666666666635, -61.59999999999998, -53.6488888888889, -64.69888888888886, -35.56222222222226, -26.114444444444462, -1.4933333333333447, -4.538888888888893, 11.768888888888851, -12.728888888888893, -16.2666666666667, 18.159999999999933, -32.10888888888892, -30.80333333333336, -36.51555555555558, -13.201111111111121, -79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886, 10.288888888888865, 65.07444444444441, 72.94999999999986, 80.21222222222221, 36.976666666666624, 104.42888888888888, 107.94888888888879, 91.62111111111099, 81.07999999999993, 95.61222222222217, 9.971111111111098, 19.245555555555534, 43.41222222222218, 21.291111111111086, 116.40666666666661, 59.572222222222244, 61.887777777777785, 53.397777777777776, 42.740000000000016, 112.40222222222216, -27.15444444444449, 46.092222222222205, 125.21777777777767, -5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433, 110.91777777777767, 96.41888888888873, 143.8466666666667, 35.80555555555556, 152.75888888888883, 146.8455555555554, 164.8122222222221, 132.58555555555546, 127.82888888888878, 119.72222222222204, 135.31444444444432, 48.49666666666669, 96.78666666666656, 165.6144444444444, 112.75111111111107, 164.3922222222221, 152.9622222222221, 83.16555555555556, 101.70888888888886, 166.5566666666667, 36.251111111111065, 84.19888888888883, 103.4688888888888, 121.79999999999984, 123.05333333333323, 106.20333333333328, 97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19718245882864863, "mean_inference_ms": 1.802086510182142, "mean_action_processing_ms": 0.0741061240640494, "mean_env_wait_ms": 1.2087882751255317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780841827392578, "StateBufferConnector_ms": 0.0026404857635498047, "ViewRequirementAgentConnector_ms": 0.061484575271606445}, "num_episodes": 30, "episode_return_max": 192.23555555555555, "episode_return_min": -86.18000000000008, "episode_return_mean": 44.96416666666662, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80550, "num_agent_steps_trained": 80400, "num_env_steps_sampled": 80550, "num_env_steps_trained": 80400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.35702203026125, "num_env_steps_trained_throughput_per_sec": 294.35702203026125, "timesteps_total": 80550, "num_env_steps_sampled_lifetime": 80550, "num_agent_steps_sampled_lifetime": 80550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 80550, "timers": {"training_iteration_time_ms": 10190.125, "restore_workers_time_ms": 0.012, "training_step_time_ms": 542.249, "sample_time_ms": 528.851, "synch_weights_time_ms": 12.134}, "counters": {"num_env_steps_sampled": 80550, "num_env_steps_trained": 80400, "num_agent_steps_sampled": 80550, "num_agent_steps_trained": 80400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 537, "num_samples_added_to_queue": 80400}, "done": false, "training_iteration": 27, "trial_id": "38f59_00000", "date": "2024-10-10_22-16-09", "timestamp": 1728594969, "time_this_iter_s": 10.200488805770874, "time_total_s": 275.86752009391785, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79d8a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.86752009391785, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 13.346666666666664, "ram_util_percent": 55.42000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 158473.71875, "policy_loss": 157677.21875, "entropy": 26.701263427734375, "entropy_coeff": 0.01, "var_gnorm": 16.26901626586914, "vf_loss": 87661.3828125, "vf_explained_var": -0.19870448112487793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 278.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 83700, "num_env_steps_trained": 83400, "num_agent_steps_sampled": 83700, "num_agent_steps_trained": 83400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 558, "num_samples_added_to_queue": 83700, "learner_queue": {"size_count": 278, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.147, "learner_load_time_ms": 0.309, "learner_load_wait_time_ms": 905.404, "learner_dequeue_time_ms": 8031.434}}, "env_runners": {"episode_reward_max": 266.7555555555555, "episode_reward_min": -79.15000000000005, "episode_reward_mean": 122.97638888888883, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -79.15000000000005}, "policy_reward_max": {"default_policy": 266.7555555555555}, "policy_reward_mean": {"default_policy": 122.97638888888883}, "custom_metrics": {"num_consolidated_mean": 0.9528, "num_consolidated_min": 0.67, "num_consolidated_max": 1.26, "num_overloaded_mean": 0.4207000000000001, "num_overloaded_min": 0.25, "num_overloaded_max": 0.75, "num_moves_mean": 9.532699999999998, "num_moves_min": 9.06, "num_moves_max": 10.01, "mean_accuracy_mean": 40.306749999999994, "mean_accuracy_min": 39.92833333333332, "mean_accuracy_max": 40.751666666666665, "num_model_switches_mean": 5.3588, "num_model_switches_min": 4.69, "num_model_switches_max": 5.95, "num_slav_mean": 0.07555916666666666, "num_slav_min": 0.04663333333333334, "num_slav_max": 0.12018333333333331, "mean_cluster_cpu_util_mean": 0.4968874908402374, "mean_cluster_cpu_util_min": 0.47516525926800496, "mean_cluster_cpu_util_max": 0.5243117559226114, "mean_cluster_mem_util_mean": 0.32920348869621685, "mean_cluster_mem_util_min": 0.31633805846178137, "mean_cluster_mem_util_max": 0.3432409067424438, "reward_consolidation_mean_mean": 0.9398666666666666, "reward_consolidation_mean_min": 0.31111111111111106, "reward_consolidation_mean_max": 1.4311111111111108, "reward_illegal_mean_mean": -0.7011666666666666, "reward_illegal_mean_min": -1.25, "reward_illegal_mean_max": -0.4166666666666666, "reward_accuracy_mean_mean": 2.462608333333333, "reward_accuracy_mean_min": 1.3334999999999997, "reward_accuracy_mean_max": 3.0861666666666663, "reward_sla_mean_mean": -1.4715444444444443, "reward_sla_mean_min": -2.237777777777778, "reward_sla_mean_max": -0.8211111111111111, "reward_consolidation_sum_mean": 93.98666666666666, "reward_consolidation_sum_min": 31.111111111111107, "reward_consolidation_sum_max": 143.1111111111111, "reward_illegal_sum_mean": -70.11666666666666, "reward_illegal_sum_min": -125.0, "reward_illegal_sum_max": -41.66666666666666, "reward_accuracy_sum_mean": 246.2608333333333, "reward_accuracy_sum_min": 133.34999999999997, "reward_accuracy_sum_max": 308.6166666666666, "reward_sla_sum_mean": -147.15444444444447, "reward_sla_sum_min": -223.7777777777778, "reward_sla_sum_max": -82.11111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2867.0, "global_timestep_min": 800, "global_timestep_max": 4500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886, 10.288888888888865, 65.07444444444441, 72.94999999999986, 80.21222222222221, 36.976666666666624, 104.42888888888888, 107.94888888888879, 91.62111111111099, 81.07999999999993, 95.61222222222217, 9.971111111111098, 19.245555555555534, 43.41222222222218, 21.291111111111086, 116.40666666666661, 59.572222222222244, 61.887777777777785, 53.397777777777776, 42.740000000000016, 112.40222222222216, -27.15444444444449, 46.092222222222205, 125.21777777777767, -5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433, 110.91777777777767, 96.41888888888873, 143.8466666666667, 35.80555555555556, 152.75888888888883, 146.8455555555554, 164.8122222222221, 132.58555555555546, 127.82888888888878, 119.72222222222204, 135.31444444444432, 48.49666666666669, 96.78666666666656, 165.6144444444444, 112.75111111111107, 164.3922222222221, 152.9622222222221, 83.16555555555556, 101.70888888888886, 166.5566666666667, 36.251111111111065, 84.19888888888883, 103.4688888888888, 121.79999999999984, 123.05333333333323, 106.20333333333328, 97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999, 177.5588888888888, 210.5588888888889, 174.79666666666674, 237.76666666666665, 144.5066666666666, 235.57777777777773, 184.51000000000002, 197.91555555555558, 214.97222222222214, 186.15444444444452, 200.5033333333333, 205.11999999999998, 226.49777777777774, 198.38444444444445, 181.0744444444444, 166.61, 200.7800000000001, 244.67888888888888, 222.65333333333345, 239.83222222222227, 167.23222222222225, 262.3944444444443, 210.4244444444444, 253.6700000000001, 188.06555555555545, 167.47666666666655, 199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-79.15000000000005, -48.92444444444442, 3.8588888888888797, -25.878888888888927, 24.088888888888835, -13.091111111111111, 82.39888888888886, 10.288888888888865, 65.07444444444441, 72.94999999999986, 80.21222222222221, 36.976666666666624, 104.42888888888888, 107.94888888888879, 91.62111111111099, 81.07999999999993, 95.61222222222217, 9.971111111111098, 19.245555555555534, 43.41222222222218, 21.291111111111086, 116.40666666666661, 59.572222222222244, 61.887777777777785, 53.397777777777776, 42.740000000000016, 112.40222222222216, -27.15444444444449, 46.092222222222205, 125.21777777777767, -5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433, 110.91777777777767, 96.41888888888873, 143.8466666666667, 35.80555555555556, 152.75888888888883, 146.8455555555554, 164.8122222222221, 132.58555555555546, 127.82888888888878, 119.72222222222204, 135.31444444444432, 48.49666666666669, 96.78666666666656, 165.6144444444444, 112.75111111111107, 164.3922222222221, 152.9622222222221, 83.16555555555556, 101.70888888888886, 166.5566666666667, 36.251111111111065, 84.19888888888883, 103.4688888888888, 121.79999999999984, 123.05333333333323, 106.20333333333328, 97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999, 177.5588888888888, 210.5588888888889, 174.79666666666674, 237.76666666666665, 144.5066666666666, 235.57777777777773, 184.51000000000002, 197.91555555555558, 214.97222222222214, 186.15444444444452, 200.5033333333333, 205.11999999999998, 226.49777777777774, 198.38444444444445, 181.0744444444444, 166.61, 200.7800000000001, 244.67888888888888, 222.65333333333345, 239.83222222222227, 167.23222222222225, 262.3944444444443, 210.4244444444444, 253.6700000000001, 188.06555555555545, 167.47666666666655, 199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19671238687146103, "mean_inference_ms": 1.798026993325373, "mean_action_processing_ms": 0.07394595436162024, "mean_env_wait_ms": 1.2072432813106984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038084983825683594, "StateBufferConnector_ms": 0.0026636123657226562, "ViewRequirementAgentConnector_ms": 0.061714887619018555}, "num_episodes": 33, "episode_return_max": 266.7555555555555, "episode_return_min": -79.15000000000005, "episode_return_mean": 122.97638888888883, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83700, "num_agent_steps_trained": 83400, "num_env_steps_sampled": 83700, "num_env_steps_trained": 83400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 313.6195384785308, "num_env_steps_trained_throughput_per_sec": 298.6852747414579, "timesteps_total": 83700, "num_env_steps_sampled_lifetime": 83700, "num_agent_steps_sampled_lifetime": 83700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 83700, "timers": {"training_iteration_time_ms": 10167.423, "restore_workers_time_ms": 0.01, "training_step_time_ms": 464.602, "sample_time_ms": 450.898, "synch_weights_time_ms": 12.452}, "counters": {"num_env_steps_sampled": 83700, "num_env_steps_trained": 83400, "num_agent_steps_sampled": 83700, "num_agent_steps_trained": 83400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 558, "num_samples_added_to_queue": 83700}, "done": false, "training_iteration": 28, "trial_id": "38f59_00000", "date": "2024-10-10_22-16-19", "timestamp": 1728594979, "time_this_iter_s": 10.055255889892578, "time_total_s": 285.9227759838104, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79d570>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 285.9227759838104, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 10.357142857142856, "ram_util_percent": 56.22857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 262976.21875, "policy_loss": 260580.78125, "entropy": 26.06814193725586, "entropy_coeff": 0.01, "var_gnorm": 16.28390884399414, "vf_loss": 247364.25, "vf_explained_var": -0.1367790699005127}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 289.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 86850, "num_env_steps_trained": 86700, "num_agent_steps_sampled": 86850, "num_agent_steps_trained": 86700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 579, "num_samples_added_to_queue": 86700, "learner_queue": {"size_count": 289, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.149, "learner_load_time_ms": 0.244, "learner_load_wait_time_ms": 920.993, "learner_dequeue_time_ms": 7910.312}}, "env_runners": {"episode_reward_max": 320.91111111111104, "episode_reward_min": -5.29666666666667, "episode_reward_mean": 185.95052222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": -5.29666666666667}, "policy_reward_max": {"default_policy": 320.91111111111104}, "policy_reward_mean": {"default_policy": 185.95052222222222}, "custom_metrics": {"num_consolidated_mean": 1.0352, "num_consolidated_min": 0.78, "num_consolidated_max": 1.31, "num_overloaded_mean": 0.3521999999999999, "num_overloaded_min": 0.18, "num_overloaded_max": 0.58, "num_moves_mean": 9.370600000000001, "num_moves_min": 8.83, "num_moves_max": 9.98, "mean_accuracy_mean": 40.19597999999999, "mean_accuracy_min": 39.92833333333332, "mean_accuracy_max": 40.51733333333333, "num_model_switches_mean": 5.1657, "num_model_switches_min": 4.5, "num_model_switches_max": 5.9, "num_slav_mean": 0.06325616666666667, "num_slav_min": 0.03916666666666667, "num_slav_max": 0.10036666666666666, "mean_cluster_cpu_util_mean": 0.4885250311048136, "mean_cluster_cpu_util_min": 0.4721711063209768, "mean_cluster_cpu_util_max": 0.5126783861780254, "mean_cluster_mem_util_mean": 0.3241724256526451, "mean_cluster_mem_util_min": 0.3110851398576308, "mean_cluster_mem_util_max": 0.3383698810958983, "reward_consolidation_mean_mean": 1.1139333333333332, "reward_consolidation_mean_min": 0.5599999999999998, "reward_consolidation_mean_max": 1.6488888888888886, "reward_illegal_mean_mean": -0.587, "reward_illegal_mean_min": -0.9666666666666666, "reward_illegal_mean_max": -0.3, "reward_accuracy_mean_mean": 2.6811663333333327, "reward_accuracy_mean_min": 1.8930666666666662, "reward_accuracy_mean_max": 3.281533333333333, "reward_sla_mean_mean": -1.3485944444444444, "reward_sla_mean_min": -2.237777777777778, "reward_sla_mean_max": -0.8211111111111111, "reward_consolidation_sum_mean": 111.39333333333335, "reward_consolidation_sum_min": 55.999999999999986, "reward_consolidation_sum_max": 164.88888888888886, "reward_illegal_sum_mean": -58.69999999999998, "reward_illegal_sum_min": -96.66666666666666, "reward_illegal_sum_max": -30.0, "reward_accuracy_sum_mean": 268.1166333333333, "reward_accuracy_sum_min": 189.30666666666662, "reward_accuracy_sum_max": 328.1533333333333, "reward_sla_sum_mean": -134.85944444444442, "reward_sla_sum_min": -223.7777777777778, "reward_sla_sum_max": -82.11111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3867.0, "global_timestep_min": 1800, "global_timestep_max": 5500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [-5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433, 110.91777777777767, 96.41888888888873, 143.8466666666667, 35.80555555555556, 152.75888888888883, 146.8455555555554, 164.8122222222221, 132.58555555555546, 127.82888888888878, 119.72222222222204, 135.31444444444432, 48.49666666666669, 96.78666666666656, 165.6144444444444, 112.75111111111107, 164.3922222222221, 152.9622222222221, 83.16555555555556, 101.70888888888886, 166.5566666666667, 36.251111111111065, 84.19888888888883, 103.4688888888888, 121.79999999999984, 123.05333333333323, 106.20333333333328, 97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999, 177.5588888888888, 210.5588888888889, 174.79666666666674, 237.76666666666665, 144.5066666666666, 235.57777777777773, 184.51000000000002, 197.91555555555558, 214.97222222222214, 186.15444444444452, 200.5033333333333, 205.11999999999998, 226.49777777777774, 198.38444444444445, 181.0744444444444, 166.61, 200.7800000000001, 244.67888888888888, 222.65333333333345, 239.83222222222227, 167.23222222222225, 262.3944444444443, 210.4244444444444, 253.6700000000001, 188.06555555555545, 167.47666666666655, 199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555, 178.79333333333332, 209.1577777777777, 241.91777777777762, 228.13666666666657, 299.05222222222216, 212.8222222222224, 258.21999999999997, 261.64666666666665, 312.39444444444433, 299.5144444444441, 249.90555555555557, 253.3511111111112, 243.2077777777777, 223.25777777777782, 301.9311111111111, 265.8922222222221, 277.30444444444447, 299.71666666666664, 252.9799999999999, 245.65222222222215, 199.22444444444432, 227.1311111111111, 255.67333333333332, 271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [-5.29666666666667, 64.42999999999998, 78.86888888888885, 64.73333333333328, 85.60999999999999, 113.43888888888885, 115.52444444444433, 110.91777777777767, 96.41888888888873, 143.8466666666667, 35.80555555555556, 152.75888888888883, 146.8455555555554, 164.8122222222221, 132.58555555555546, 127.82888888888878, 119.72222222222204, 135.31444444444432, 48.49666666666669, 96.78666666666656, 165.6144444444444, 112.75111111111107, 164.3922222222221, 152.9622222222221, 83.16555555555556, 101.70888888888886, 166.5566666666667, 36.251111111111065, 84.19888888888883, 103.4688888888888, 121.79999999999984, 123.05333333333323, 106.20333333333328, 97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999, 177.5588888888888, 210.5588888888889, 174.79666666666674, 237.76666666666665, 144.5066666666666, 235.57777777777773, 184.51000000000002, 197.91555555555558, 214.97222222222214, 186.15444444444452, 200.5033333333333, 205.11999999999998, 226.49777777777774, 198.38444444444445, 181.0744444444444, 166.61, 200.7800000000001, 244.67888888888888, 222.65333333333345, 239.83222222222227, 167.23222222222225, 262.3944444444443, 210.4244444444444, 253.6700000000001, 188.06555555555545, 167.47666666666655, 199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555, 178.79333333333332, 209.1577777777777, 241.91777777777762, 228.13666666666657, 299.05222222222216, 212.8222222222224, 258.21999999999997, 261.64666666666665, 312.39444444444433, 299.5144444444441, 249.90555555555557, 253.3511111111112, 243.2077777777777, 223.25777777777782, 301.9311111111111, 265.8922222222221, 277.30444444444447, 299.71666666666664, 252.9799999999999, 245.65222222222215, 199.22444444444432, 227.1311111111111, 255.67333333333332, 271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19632680279949263, "mean_inference_ms": 1.794316195455442, "mean_action_processing_ms": 0.07380979432817708, "mean_env_wait_ms": 1.2058720117000252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037224292755126953, "StateBufferConnector_ms": 0.0026688575744628906, "ViewRequirementAgentConnector_ms": 0.06187915802001953}, "num_episodes": 30, "episode_return_max": 320.91111111111104, "episode_return_min": -5.29666666666667, "episode_return_mean": 185.95052222222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86850, "num_agent_steps_trained": 86700, "num_env_steps_sampled": 86850, "num_env_steps_trained": 86700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 310.28567152952553, "num_env_steps_trained_throughput_per_sec": 325.0611796975982, "timesteps_total": 86850, "num_env_steps_sampled_lifetime": 86850, "num_agent_steps_sampled_lifetime": 86850, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 86850, "timers": {"training_iteration_time_ms": 10179.484, "restore_workers_time_ms": 0.011, "training_step_time_ms": 474.602, "sample_time_ms": 460.93, "synch_weights_time_ms": 12.295}, "counters": {"num_env_steps_sampled": 86850, "num_env_steps_trained": 86700, "num_agent_steps_sampled": 86850, "num_agent_steps_trained": 86700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 579, "num_samples_added_to_queue": 86700}, "done": false, "training_iteration": 29, "trial_id": "38f59_00000", "date": "2024-10-10_22-16-29", "timestamp": 1728594989, "time_this_iter_s": 10.160994529724121, "time_total_s": 296.08377051353455, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79f220>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.08377051353455, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 10.539999999999997, "ram_util_percent": 55.75333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 306901.8125, "policy_loss": 303416.53125, "entropy": 25.645795822143555, "entropy_coeff": 0.01, "var_gnorm": 16.2913761138916, "vf_loss": 356223.125, "vf_explained_var": -0.10844171047210693}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 89700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 600, "num_samples_added_to_queue": 90000, "learner_queue": {"size_count": 299, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.624, "learner_load_time_ms": 0.245, "learner_load_wait_time_ms": 952.914, "learner_dequeue_time_ms": 7896.652}}, "env_runners": {"episode_reward_max": 393.38999999999993, "episode_reward_min": 97.59777777777771, "episode_reward_mean": 249.88741111111102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 97.59777777777771}, "policy_reward_max": {"default_policy": 393.38999999999993}, "policy_reward_mean": {"default_policy": 249.88741111111102}, "custom_metrics": {"num_consolidated_mean": 1.1308, "num_consolidated_min": 0.92, "num_consolidated_max": 1.46, "num_overloaded_mean": 0.28680000000000005, "num_overloaded_min": 0.12, "num_overloaded_max": 0.44, "num_moves_mean": 9.200700000000001, "num_moves_min": 8.83, "num_moves_max": 9.69, "mean_accuracy_mean": 40.11750999999999, "mean_accuracy_min": 39.877666666666656, "mean_accuracy_max": 40.39699999999999, "num_model_switches_mean": 5.0188999999999995, "num_model_switches_min": 4.42, "num_model_switches_max": 5.64, "num_slav_mean": 0.053723333333333324, "num_slav_min": 0.03661666666666666, "num_slav_max": 0.0839, "mean_cluster_cpu_util_mean": 0.4814960639171244, "mean_cluster_cpu_util_min": 0.4647148888562216, "mean_cluster_cpu_util_max": 0.4980618492028166, "mean_cluster_mem_util_mean": 0.3194901402971526, "mean_cluster_mem_util_min": 0.308456675708258, "mean_cluster_mem_util_max": 0.3294219784221706, "reward_consolidation_mean_mean": 1.3124222222222222, "reward_consolidation_mean_min": 0.84, "reward_consolidation_mean_max": 1.7111111111111108, "reward_illegal_mean_mean": -0.4779999999999999, "reward_illegal_mean_min": -0.7333333333333333, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 2.9108796666666668, "reward_accuracy_mean_min": 2.3748666666666662, "reward_accuracy_mean_max": 3.5294, "reward_sla_mean_mean": -1.2464277777777777, "reward_sla_mean_min": -1.6822222222222216, "reward_sla_mean_max": -0.7594444444444446, "reward_consolidation_sum_mean": 131.24222222222218, "reward_consolidation_sum_min": 84.0, "reward_consolidation_sum_max": 171.1111111111111, "reward_illegal_sum_mean": -47.8, "reward_illegal_sum_min": -73.33333333333333, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 291.0879666666666, "reward_accuracy_sum_min": 237.48666666666662, "reward_accuracy_sum_max": 352.94, "reward_sla_sum_mean": -124.6427777777778, "reward_sla_sum_min": -168.22222222222217, "reward_sla_sum_max": -75.94444444444446, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4978.0, "global_timestep_min": 3100, "global_timestep_max": 6600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999, 177.5588888888888, 210.5588888888889, 174.79666666666674, 237.76666666666665, 144.5066666666666, 235.57777777777773, 184.51000000000002, 197.91555555555558, 214.97222222222214, 186.15444444444452, 200.5033333333333, 205.11999999999998, 226.49777777777774, 198.38444444444445, 181.0744444444444, 166.61, 200.7800000000001, 244.67888888888888, 222.65333333333345, 239.83222222222227, 167.23222222222225, 262.3944444444443, 210.4244444444444, 253.6700000000001, 188.06555555555545, 167.47666666666655, 199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555, 178.79333333333332, 209.1577777777777, 241.91777777777762, 228.13666666666657, 299.05222222222216, 212.8222222222224, 258.21999999999997, 261.64666666666665, 312.39444444444433, 299.5144444444441, 249.90555555555557, 253.3511111111112, 243.2077777777777, 223.25777777777782, 301.9311111111111, 265.8922222222221, 277.30444444444447, 299.71666666666664, 252.9799999999999, 245.65222222222215, 199.22444444444432, 227.1311111111111, 255.67333333333332, 271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104, 294.5455555555554, 310.4555555555554, 278.4477777777777, 304.5266666666665, 311.49111111111114, 307.10888888888866, 268.15999999999997, 246.3955555555556, 312.2266666666665, 362.24222222222187, 274.7722222222222, 280.22888888888866, 305.8199999999999, 339.142222222222, 262.26222222222225, 254.86666666666662, 304.48777777777775, 303.09888888888884, 358.32111111111084, 319.5155555555555, 393.38999999999993, 349.031111111111, 256.42555555555566, 302.6833333333332, 254.45777777777775, 276.9799999999999, 282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [97.59777777777771, 136.14111111111103, 192.23555555555555, 121.3799999999999, 177.5588888888888, 210.5588888888889, 174.79666666666674, 237.76666666666665, 144.5066666666666, 235.57777777777773, 184.51000000000002, 197.91555555555558, 214.97222222222214, 186.15444444444452, 200.5033333333333, 205.11999999999998, 226.49777777777774, 198.38444444444445, 181.0744444444444, 166.61, 200.7800000000001, 244.67888888888888, 222.65333333333345, 239.83222222222227, 167.23222222222225, 262.3944444444443, 210.4244444444444, 253.6700000000001, 188.06555555555545, 167.47666666666655, 199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555, 178.79333333333332, 209.1577777777777, 241.91777777777762, 228.13666666666657, 299.05222222222216, 212.8222222222224, 258.21999999999997, 261.64666666666665, 312.39444444444433, 299.5144444444441, 249.90555555555557, 253.3511111111112, 243.2077777777777, 223.25777777777782, 301.9311111111111, 265.8922222222221, 277.30444444444447, 299.71666666666664, 252.9799999999999, 245.65222222222215, 199.22444444444432, 227.1311111111111, 255.67333333333332, 271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104, 294.5455555555554, 310.4555555555554, 278.4477777777777, 304.5266666666665, 311.49111111111114, 307.10888888888866, 268.15999999999997, 246.3955555555556, 312.2266666666665, 362.24222222222187, 274.7722222222222, 280.22888888888866, 305.8199999999999, 339.142222222222, 262.26222222222225, 254.86666666666662, 304.48777777777775, 303.09888888888884, 358.32111111111084, 319.5155555555555, 393.38999999999993, 349.031111111111, 256.42555555555566, 302.6833333333332, 254.45777777777775, 276.9799999999999, 282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1959857957066318, "mean_inference_ms": 1.7918643680304782, "mean_action_processing_ms": 0.07367083776497423, "mean_env_wait_ms": 1.2046398528976112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038442611694335938, "StateBufferConnector_ms": 0.0027081966400146484, "ViewRequirementAgentConnector_ms": 0.0633091926574707}, "num_episodes": 33, "episode_return_max": 393.38999999999993, "episode_return_min": 97.59777777777771, "episode_return_mean": 249.88741111111102, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 89700, "num_env_steps_sampled": 90000, "num_env_steps_trained": 89700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 300.342248183775, "num_env_steps_trained_throughput_per_sec": 286.0402363655, "timesteps_total": 90000, "num_env_steps_sampled_lifetime": 90000, "num_agent_steps_sampled_lifetime": 90000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 10198.996, "restore_workers_time_ms": 0.011, "training_step_time_ms": 508.477, "sample_time_ms": 495.035, "synch_weights_time_ms": 12.165}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 89700, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 89700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 600, "num_samples_added_to_queue": 90000}, "done": false, "training_iteration": 30, "trial_id": "38f59_00000", "date": "2024-10-10_22-16-40", "timestamp": 1728595000, "time_this_iter_s": 10.497289419174194, "time_total_s": 306.58105993270874, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79c8e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.58105993270874, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 11.493333333333332, "ram_util_percent": 56.63999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 266441.6875, "policy_loss": 263874.78125, "entropy": 25.222137451171875, "entropy_coeff": 0.01, "var_gnorm": 16.298431396484375, "vf_loss": 264257.71875, "vf_explained_var": -0.13076961040496826}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 310.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 93150, "num_env_steps_trained": 93000, "num_agent_steps_sampled": 93150, "num_agent_steps_trained": 93000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 621, "num_samples_added_to_queue": 93000, "learner_queue": {"size_count": 310, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.52, "learner_load_time_ms": 0.251, "learner_load_wait_time_ms": 941.167, "learner_dequeue_time_ms": 7888.846}}, "env_runners": {"episode_reward_max": 411.2866666666666, "episode_reward_min": 166.30888888888896, "episode_reward_mean": 289.1374999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 166.30888888888896}, "policy_reward_max": {"default_policy": 411.2866666666666}, "policy_reward_mean": {"default_policy": 289.1374999999999}, "custom_metrics": {"num_consolidated_mean": 1.1937000000000004, "num_consolidated_min": 1.0, "num_consolidated_max": 1.55, "num_overloaded_mean": 0.2532, "num_overloaded_min": 0.12, "num_overloaded_max": 0.39, "num_moves_mean": 9.0715, "num_moves_min": 8.63, "num_moves_max": 9.56, "mean_accuracy_mean": 40.073809999999995, "mean_accuracy_min": 39.86499999999999, "mean_accuracy_max": 40.32733333333332, "num_model_switches_mean": 4.8913, "num_model_switches_min": 4.42, "num_model_switches_max": 5.43, "num_slav_mean": 0.047217833333333334, "num_slav_min": 0.0337, "num_slav_max": 0.06496666666666666, "mean_cluster_cpu_util_mean": 0.47745809186864774, "mean_cluster_cpu_util_min": 0.46381022837366287, "mean_cluster_cpu_util_max": 0.4980618492028166, "mean_cluster_mem_util_mean": 0.31668174930573495, "mean_cluster_mem_util_min": 0.308456675708258, "mean_cluster_mem_util_max": 0.3294219784221706, "reward_consolidation_mean_mean": 1.4371777777777774, "reward_consolidation_mean_min": 1.0577777777777775, "reward_consolidation_mean_max": 1.8977777777777773, "reward_illegal_mean_mean": -0.4219999999999999, "reward_illegal_mean_min": -0.65, "reward_illegal_mean_max": -0.2, "reward_accuracy_mean_mean": 3.025974999999999, "reward_accuracy_mean_min": 2.559466666666666, "reward_accuracy_mean_max": 3.5294, "reward_sla_mean_mean": -1.1497777777777776, "reward_sla_mean_min": -1.6822222222222216, "reward_sla_mean_max": -0.7122222222222221, "reward_consolidation_sum_mean": 143.71777777777777, "reward_consolidation_sum_min": 105.77777777777776, "reward_consolidation_sum_max": 189.77777777777774, "reward_illegal_sum_mean": -42.2, "reward_illegal_sum_min": -65.0, "reward_illegal_sum_max": -20.0, "reward_accuracy_sum_mean": 302.5974999999999, "reward_accuracy_sum_min": 255.9466666666666, "reward_accuracy_sum_max": 352.94, "reward_sla_sum_mean": -114.97777777777777, "reward_sla_sum_min": -168.22222222222217, "reward_sla_sum_max": -71.22222222222221, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5967.0, "global_timestep_min": 3900, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555, 178.79333333333332, 209.1577777777777, 241.91777777777762, 228.13666666666657, 299.05222222222216, 212.8222222222224, 258.21999999999997, 261.64666666666665, 312.39444444444433, 299.5144444444441, 249.90555555555557, 253.3511111111112, 243.2077777777777, 223.25777777777782, 301.9311111111111, 265.8922222222221, 277.30444444444447, 299.71666666666664, 252.9799999999999, 245.65222222222215, 199.22444444444432, 227.1311111111111, 255.67333333333332, 271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104, 294.5455555555554, 310.4555555555554, 278.4477777777777, 304.5266666666665, 311.49111111111114, 307.10888888888866, 268.15999999999997, 246.3955555555556, 312.2266666666665, 362.24222222222187, 274.7722222222222, 280.22888888888866, 305.8199999999999, 339.142222222222, 262.26222222222225, 254.86666666666662, 304.48777777777775, 303.09888888888884, 358.32111111111084, 319.5155555555555, 393.38999999999993, 349.031111111111, 256.42555555555566, 302.6833333333332, 254.45777777777775, 276.9799999999999, 282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204, 351.6844444444443, 324.39333333333326, 337.4599999999998, 284.95111111111123, 338.08555555555535, 306.5288888888887, 375.6455555555554, 299.45666666666654, 306.1633333333331, 371.9777777777776, 336.1344444444443, 252.74777777777774, 314.69444444444423, 320.4977777777776, 323.92222222222205, 306.7266666666664, 411.2866666666666, 308.3988888888889, 365.51222222222214, 261.0477777777777, 309.3055555555553, 366.88555555555536, 281.98222222222216, 316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [199.83999999999992, 252.90666666666658, 166.30888888888896, 247.7744444444444, 207.81111111111105, 183.61888888888888, 266.7555555555555, 178.79333333333332, 209.1577777777777, 241.91777777777762, 228.13666666666657, 299.05222222222216, 212.8222222222224, 258.21999999999997, 261.64666666666665, 312.39444444444433, 299.5144444444441, 249.90555555555557, 253.3511111111112, 243.2077777777777, 223.25777777777782, 301.9311111111111, 265.8922222222221, 277.30444444444447, 299.71666666666664, 252.9799999999999, 245.65222222222215, 199.22444444444432, 227.1311111111111, 255.67333333333332, 271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104, 294.5455555555554, 310.4555555555554, 278.4477777777777, 304.5266666666665, 311.49111111111114, 307.10888888888866, 268.15999999999997, 246.3955555555556, 312.2266666666665, 362.24222222222187, 274.7722222222222, 280.22888888888866, 305.8199999999999, 339.142222222222, 262.26222222222225, 254.86666666666662, 304.48777777777775, 303.09888888888884, 358.32111111111084, 319.5155555555555, 393.38999999999993, 349.031111111111, 256.42555555555566, 302.6833333333332, 254.45777777777775, 276.9799999999999, 282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204, 351.6844444444443, 324.39333333333326, 337.4599999999998, 284.95111111111123, 338.08555555555535, 306.5288888888887, 375.6455555555554, 299.45666666666654, 306.1633333333331, 371.9777777777776, 336.1344444444443, 252.74777777777774, 314.69444444444423, 320.4977777777776, 323.92222222222205, 306.7266666666664, 411.2866666666666, 308.3988888888889, 365.51222222222214, 261.0477777777777, 309.3055555555553, 366.88555555555536, 281.98222222222216, 316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19558388514673872, "mean_inference_ms": 1.7877279748530694, "mean_action_processing_ms": 0.07355120742626423, "mean_env_wait_ms": 1.2033636292040648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00442194938659668, "StateBufferConnector_ms": 0.0027599334716796875, "ViewRequirementAgentConnector_ms": 0.06419157981872559}, "num_episodes": 30, "episode_return_max": 411.2866666666666, "episode_return_min": 166.30888888888896, "episode_return_mean": 289.1374999999999, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93150, "num_agent_steps_trained": 93000, "num_env_steps_sampled": 93150, "num_env_steps_trained": 93000, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 300.9322984089242, "num_env_steps_trained_throughput_per_sec": 315.2624078569682, "timesteps_total": 93150, "num_env_steps_sampled_lifetime": 93150, "num_agent_steps_sampled_lifetime": 93150, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 93150, "timers": {"training_iteration_time_ms": 10215.25, "restore_workers_time_ms": 0.011, "training_step_time_ms": 488.151, "sample_time_ms": 473.857, "synch_weights_time_ms": 13.037}, "counters": {"num_env_steps_sampled": 93150, "num_env_steps_trained": 93000, "num_agent_steps_sampled": 93150, "num_agent_steps_trained": 93000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 621, "num_samples_added_to_queue": 93000}, "done": false, "training_iteration": 31, "trial_id": "38f59_00000", "date": "2024-10-10_22-16-50", "timestamp": 1728595010, "time_this_iter_s": 10.47772479057312, "time_total_s": 317.05878472328186, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde5f90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.05878472328186, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 10.426666666666668, "ram_util_percent": 56.786666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 296170.65625, "policy_loss": 292761.1875, "entropy": 24.37872314453125, "entropy_coeff": 0.01, "var_gnorm": 16.304410934448242, "vf_loss": 348258.8125, "vf_explained_var": -0.117484450340271}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 320.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 96150, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96150, "num_agent_steps_trained": 96000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 641, "num_samples_added_to_queue": 96000, "learner_queue": {"size_count": 320, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.731, "learner_load_time_ms": 0.228, "learner_load_wait_time_ms": 957.874, "learner_dequeue_time_ms": 7898.145}}, "env_runners": {"episode_reward_max": 468.2599999999997, "episode_reward_min": 228.4011111111112, "episode_reward_mean": 327.37091111111096, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 228.4011111111112}, "policy_reward_max": {"default_policy": 468.2599999999997}, "policy_reward_mean": {"default_policy": 327.37091111111096}, "custom_metrics": {"num_consolidated_mean": 1.2601000000000002, "num_consolidated_min": 1.02, "num_consolidated_max": 1.55, "num_overloaded_mean": 0.2261, "num_overloaded_min": 0.09, "num_overloaded_max": 0.33, "num_moves_mean": 8.9108, "num_moves_min": 8.17, "num_moves_max": 9.41, "mean_accuracy_mean": 40.041889999999995, "mean_accuracy_min": 39.86499999999999, "mean_accuracy_max": 40.321, "num_model_switches_mean": 4.7635000000000005, "num_model_switches_min": 4.35, "num_model_switches_max": 5.22, "num_slav_mean": 0.04120133333333333, "num_slav_min": 0.02541666666666666, "num_slav_max": 0.05739999999999999, "mean_cluster_cpu_util_mean": 0.4744460384264789, "mean_cluster_cpu_util_min": 0.46173550243599054, "mean_cluster_cpu_util_max": 0.48585894704051635, "mean_cluster_mem_util_mean": 0.31434639145067306, "mean_cluster_mem_util_min": 0.30519337290823506, "mean_cluster_mem_util_max": 0.3222800514509601, "reward_consolidation_mean_mean": 1.5588222222222223, "reward_consolidation_mean_min": 1.1666666666666665, "reward_consolidation_mean_max": 2.115555555555555, "reward_illegal_mean_mean": -0.37683333333333324, "reward_illegal_mean_min": -0.5499999999999999, "reward_illegal_mean_max": -0.15, "reward_accuracy_mean_mean": 3.128331333333333, "reward_accuracy_mean_min": 2.7668666666666666, "reward_accuracy_mean_max": 3.6381333333333328, "reward_sla_mean_mean": -1.0366111111111111, "reward_sla_mean_min": -1.5238888888888886, "reward_sla_mean_max": -0.6544444444444446, "reward_consolidation_sum_mean": 155.8822222222222, "reward_consolidation_sum_min": 116.66666666666666, "reward_consolidation_sum_max": 211.55555555555551, "reward_illegal_sum_mean": -37.68333333333332, "reward_illegal_sum_min": -54.99999999999999, "reward_illegal_sum_max": -15.0, "reward_accuracy_sum_mean": 312.8331333333333, "reward_accuracy_sum_min": 276.68666666666667, "reward_accuracy_sum_max": 363.8133333333333, "reward_sla_sum_mean": -103.66111111111115, "reward_sla_sum_min": -152.38888888888886, "reward_sla_sum_max": -65.44444444444446, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5095.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104, 294.5455555555554, 310.4555555555554, 278.4477777777777, 304.5266666666665, 311.49111111111114, 307.10888888888866, 268.15999999999997, 246.3955555555556, 312.2266666666665, 362.24222222222187, 274.7722222222222, 280.22888888888866, 305.8199999999999, 339.142222222222, 262.26222222222225, 254.86666666666662, 304.48777777777775, 303.09888888888884, 358.32111111111084, 319.5155555555555, 393.38999999999993, 349.031111111111, 256.42555555555566, 302.6833333333332, 254.45777777777775, 276.9799999999999, 282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204, 351.6844444444443, 324.39333333333326, 337.4599999999998, 284.95111111111123, 338.08555555555535, 306.5288888888887, 375.6455555555554, 299.45666666666654, 306.1633333333331, 371.9777777777776, 336.1344444444443, 252.74777777777774, 314.69444444444423, 320.4977777777776, 323.92222222222205, 306.7266666666664, 411.2866666666666, 308.3988888888889, 365.51222222222214, 261.0477777777777, 309.3055555555553, 366.88555555555536, 281.98222222222216, 316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332, 346.24444444444424, 371.35444444444414, 324.41222222222217, 409.4999999999997, 421.93444444444424, 468.2599999999997, 368.04777777777775, 395.0833333333331, 397.7988888888886, 365.9433333333331, 346.4255555555553, 284.74555555555554, 344.77444444444427, 371.6755555555552, 373.3622222222221, 387.4344444444441, 349.7344444444442, 358.7733333333332, 368.91888888888866, 366.5288888888887, 333.1222222222219, 364.0355555555553, 320.0455555555556, 353.66333333333307, 365.01444444444434, 364.25111111111084, 394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [271.0777777777777, 228.4011111111112, 276.06999999999994, 268.0622222222224, 270.3366666666666, 239.6488888888889, 320.91111111111104, 294.5455555555554, 310.4555555555554, 278.4477777777777, 304.5266666666665, 311.49111111111114, 307.10888888888866, 268.15999999999997, 246.3955555555556, 312.2266666666665, 362.24222222222187, 274.7722222222222, 280.22888888888866, 305.8199999999999, 339.142222222222, 262.26222222222225, 254.86666666666662, 304.48777777777775, 303.09888888888884, 358.32111111111084, 319.5155555555555, 393.38999999999993, 349.031111111111, 256.42555555555566, 302.6833333333332, 254.45777777777775, 276.9799999999999, 282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204, 351.6844444444443, 324.39333333333326, 337.4599999999998, 284.95111111111123, 338.08555555555535, 306.5288888888887, 375.6455555555554, 299.45666666666654, 306.1633333333331, 371.9777777777776, 336.1344444444443, 252.74777777777774, 314.69444444444423, 320.4977777777776, 323.92222222222205, 306.7266666666664, 411.2866666666666, 308.3988888888889, 365.51222222222214, 261.0477777777777, 309.3055555555553, 366.88555555555536, 281.98222222222216, 316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332, 346.24444444444424, 371.35444444444414, 324.41222222222217, 409.4999999999997, 421.93444444444424, 468.2599999999997, 368.04777777777775, 395.0833333333331, 397.7988888888886, 365.9433333333331, 346.4255555555553, 284.74555555555554, 344.77444444444427, 371.6755555555552, 373.3622222222221, 387.4344444444441, 349.7344444444442, 358.7733333333332, 368.91888888888866, 366.5288888888887, 333.1222222222219, 364.0355555555553, 320.0455555555556, 353.66333333333307, 365.01444444444434, 364.25111111111084, 394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19530168893999858, "mean_inference_ms": 1.7862874527729684, "mean_action_processing_ms": 0.07346686561155792, "mean_env_wait_ms": 1.202664624879674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004433631896972656, "StateBufferConnector_ms": 0.0027589797973632812, "ViewRequirementAgentConnector_ms": 0.06486296653747559}, "num_episodes": 30, "episode_return_max": 468.2599999999997, "episode_return_min": 228.4011111111112, "episode_return_mean": 327.37091111111096, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96150, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96150, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.3312160196282, "num_env_steps_trained_throughput_per_sec": 298.3312160196282, "timesteps_total": 96150, "num_env_steps_sampled_lifetime": 96150, "num_agent_steps_sampled_lifetime": 96150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 96150, "timers": {"training_iteration_time_ms": 10210.972, "restore_workers_time_ms": 0.011, "training_step_time_ms": 510.062, "sample_time_ms": 496.741, "synch_weights_time_ms": 12.023}, "counters": {"num_env_steps_sampled": 96150, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96150, "num_agent_steps_trained": 96000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 641, "num_samples_added_to_queue": 96000}, "done": false, "training_iteration": 32, "trial_id": "38f59_00000", "date": "2024-10-10_22-17-00", "timestamp": 1728595020, "time_this_iter_s": 10.069607734680176, "time_total_s": 327.12839245796204, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79c490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 327.12839245796204, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 10.585714285714285, "ram_util_percent": 57.15000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 332835.0625, "policy_loss": 328135.875, "entropy": 24.387807846069336, "entropy_coeff": 0.01, "var_gnorm": 16.308176040649414, "vf_loss": 477233.34375, "vf_explained_var": -0.07676362991333008}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 330.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 99300, "num_env_steps_trained": 99000, "num_agent_steps_sampled": 99300, "num_agent_steps_trained": 99000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 662, "num_samples_added_to_queue": 99300, "learner_queue": {"size_count": 330, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.201, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 904.402, "learner_dequeue_time_ms": 7906.645}}, "env_runners": {"episode_reward_max": 470.911111111111, "episode_reward_min": 252.74777777777774, "episode_reward_mean": 362.2283333333331, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 252.74777777777774}, "policy_reward_max": {"default_policy": 470.911111111111}, "policy_reward_mean": {"default_policy": 362.2283333333331}, "custom_metrics": {"num_consolidated_mean": 1.3244, "num_consolidated_min": 1.09, "num_consolidated_max": 1.55, "num_overloaded_mean": 0.2002, "num_overloaded_min": 0.08, "num_overloaded_max": 0.31, "num_moves_mean": 8.720600000000001, "num_moves_min": 8.14, "num_moves_max": 9.25, "mean_accuracy_mean": 40.015226666666656, "mean_accuracy_min": 39.80799999999998, "mean_accuracy_max": 40.321, "num_model_switches_mean": 4.6495, "num_model_switches_min": 4.18, "num_model_switches_max": 5.09, "num_slav_mean": 0.03628050000000001, "num_slav_min": 0.023216666666666667, "num_slav_max": 0.05375, "mean_cluster_cpu_util_mean": 0.4709308135786733, "mean_cluster_cpu_util_min": 0.4587121751982896, "mean_cluster_cpu_util_max": 0.48472168414382977, "mean_cluster_mem_util_mean": 0.3120446423584202, "mean_cluster_mem_util_min": 0.30375760354774817, "mean_cluster_mem_util_max": 0.31969486369442296, "reward_consolidation_mean_mean": 1.6848222222222216, "reward_consolidation_mean_min": 1.2599999999999998, "reward_consolidation_mean_max": 2.1311111111111107, "reward_illegal_mean_mean": -0.3336666666666666, "reward_illegal_mean_min": -0.5166666666666666, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 3.2249166666666667, "reward_accuracy_mean_min": 2.7668666666666666, "reward_accuracy_mean_max": 3.6646666666666663, "reward_sla_mean_mean": -0.9537888888888888, "reward_sla_mean_min": -1.5238888888888886, "reward_sla_mean_max": -0.635, "reward_consolidation_sum_mean": 168.4822222222222, "reward_consolidation_sum_min": 125.99999999999999, "reward_consolidation_sum_max": 213.1111111111111, "reward_illegal_sum_mean": -33.36666666666667, "reward_illegal_sum_min": -51.666666666666664, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 322.4916666666667, "reward_accuracy_sum_min": 276.68666666666667, "reward_accuracy_sum_max": 366.46666666666664, "reward_sla_sum_mean": -95.37888888888887, "reward_sla_sum_min": -152.38888888888886, "reward_sla_sum_max": -63.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3621.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204, 351.6844444444443, 324.39333333333326, 337.4599999999998, 284.95111111111123, 338.08555555555535, 306.5288888888887, 375.6455555555554, 299.45666666666654, 306.1633333333331, 371.9777777777776, 336.1344444444443, 252.74777777777774, 314.69444444444423, 320.4977777777776, 323.92222222222205, 306.7266666666664, 411.2866666666666, 308.3988888888889, 365.51222222222214, 261.0477777777777, 309.3055555555553, 366.88555555555536, 281.98222222222216, 316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332, 346.24444444444424, 371.35444444444414, 324.41222222222217, 409.4999999999997, 421.93444444444424, 468.2599999999997, 368.04777777777775, 395.0833333333331, 397.7988888888886, 365.9433333333331, 346.4255555555553, 284.74555555555554, 344.77444444444427, 371.6755555555552, 373.3622222222221, 387.4344444444441, 349.7344444444442, 358.7733333333332, 368.91888888888866, 366.5288888888887, 333.1222222222219, 364.0355555555553, 320.0455555555556, 353.66333333333307, 365.01444444444434, 364.25111111111084, 394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865, 399.0011111111109, 452.1477777777773, 368.4166666666666, 351.8511111111109, 391.332222222222, 412.01333333333304, 390.2422222222221, 359.02222222222184, 386.9299999999997, 435.592222222222, 383.9511111111109, 371.1566666666666, 394.602222222222, 420.35888888888866, 340.411111111111, 384.20222222222196, 400.3411111111109, 428.432222222222, 470.911111111111, 441.62222222222204, 442.0888888888887, 405.48333333333306, 403.421111111111, 399.3922222222219, 374.8088888888884, 396.05333333333317, 390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [282.45222222222213, 259.24222222222227, 298.5566666666666, 311.3666666666664, 269.8344444444444, 350.1066666666666, 342.62222222222204, 351.6844444444443, 324.39333333333326, 337.4599999999998, 284.95111111111123, 338.08555555555535, 306.5288888888887, 375.6455555555554, 299.45666666666654, 306.1633333333331, 371.9777777777776, 336.1344444444443, 252.74777777777774, 314.69444444444423, 320.4977777777776, 323.92222222222205, 306.7266666666664, 411.2866666666666, 308.3988888888889, 365.51222222222214, 261.0477777777777, 309.3055555555553, 366.88555555555536, 281.98222222222216, 316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332, 346.24444444444424, 371.35444444444414, 324.41222222222217, 409.4999999999997, 421.93444444444424, 468.2599999999997, 368.04777777777775, 395.0833333333331, 397.7988888888886, 365.9433333333331, 346.4255555555553, 284.74555555555554, 344.77444444444427, 371.6755555555552, 373.3622222222221, 387.4344444444441, 349.7344444444442, 358.7733333333332, 368.91888888888866, 366.5288888888887, 333.1222222222219, 364.0355555555553, 320.0455555555556, 353.66333333333307, 365.01444444444434, 364.25111111111084, 394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865, 399.0011111111109, 452.1477777777773, 368.4166666666666, 351.8511111111109, 391.332222222222, 412.01333333333304, 390.2422222222221, 359.02222222222184, 386.9299999999997, 435.592222222222, 383.9511111111109, 371.1566666666666, 394.602222222222, 420.35888888888866, 340.411111111111, 384.20222222222196, 400.3411111111109, 428.432222222222, 470.911111111111, 441.62222222222204, 442.0888888888887, 405.48333333333306, 403.421111111111, 399.3922222222219, 374.8088888888884, 396.05333333333317, 390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19495844596860543, "mean_inference_ms": 1.7839324572888813, "mean_action_processing_ms": 0.07336505499423385, "mean_env_wait_ms": 1.2016122223506318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043125152587890625, "StateBufferConnector_ms": 0.0027129650115966797, "ViewRequirementAgentConnector_ms": 0.06326913833618164}, "num_episodes": 33, "episode_return_max": 470.911111111111, "episode_return_min": 252.74777777777774, "episode_return_mean": 362.2283333333331, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99300, "num_agent_steps_trained": 99000, "num_env_steps_sampled": 99300, "num_env_steps_trained": 99000, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 313.3672537912896, "num_env_steps_trained_throughput_per_sec": 298.44500361075205, "timesteps_total": 99300, "num_env_steps_sampled_lifetime": 99300, "num_agent_steps_sampled_lifetime": 99300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 99300, "timers": {"training_iteration_time_ms": 10210.844, "restore_workers_time_ms": 0.01, "training_step_time_ms": 470.541, "sample_time_ms": 457.042, "synch_weights_time_ms": 12.108}, "counters": {"num_env_steps_sampled": 99300, "num_env_steps_trained": 99000, "num_agent_steps_sampled": 99300, "num_agent_steps_trained": 99000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 662, "num_samples_added_to_queue": 99300}, "done": false, "training_iteration": 33, "trial_id": "38f59_00000", "date": "2024-10-10_22-17-10", "timestamp": 1728595030, "time_this_iter_s": 10.061565637588501, "time_total_s": 337.18995809555054, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7bb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.18995809555054, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.413333333333332, "ram_util_percent": 55.94666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 292691.15625, "policy_loss": 289196.3125, "entropy": 24.072900772094727, "entropy_coeff": 0.01, "var_gnorm": 16.31476593017578, "vf_loss": 356706.28125, "vf_explained_var": -0.08899176120758057}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 341.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 102450, "num_env_steps_trained": 102300, "num_agent_steps_sampled": 102450, "num_agent_steps_trained": 102300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 683, "num_samples_added_to_queue": 102300, "learner_queue": {"size_count": 341, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.889, "learner_load_time_ms": 0.282, "learner_load_wait_time_ms": 930.474, "learner_dequeue_time_ms": 7912.86}}, "env_runners": {"episode_reward_max": 478.73222222222176, "episode_reward_min": 284.74555555555554, "episode_reward_mean": 390.75657777777747, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 284.74555555555554}, "policy_reward_max": {"default_policy": 478.73222222222176}, "policy_reward_mean": {"default_policy": 390.75657777777747}, "custom_metrics": {"num_consolidated_mean": 1.3815999999999997, "num_consolidated_min": 1.09, "num_consolidated_max": 1.62, "num_overloaded_mean": 0.18209999999999998, "num_overloaded_min": 0.08, "num_overloaded_max": 0.31, "num_moves_mean": 8.577300000000001, "num_moves_min": 8.08, "num_moves_max": 9.14, "mean_accuracy_mean": 39.983813333333316, "mean_accuracy_min": 39.78266666666666, "mean_accuracy_max": 40.22599999999999, "num_model_switches_mean": 4.5755, "num_model_switches_min": 4.18, "num_model_switches_max": 5.01, "num_slav_mean": 0.03225600000000001, "num_slav_min": 0.01995, "num_slav_max": 0.0435, "mean_cluster_cpu_util_mean": 0.46829110718125994, "mean_cluster_cpu_util_min": 0.45207941671977564, "mean_cluster_cpu_util_max": 0.48472168414382977, "mean_cluster_mem_util_mean": 0.3102318207056029, "mean_cluster_mem_util_min": 0.30100723632279913, "mean_cluster_mem_util_max": 0.318956196719194, "reward_consolidation_mean_mean": 1.7895111111111113, "reward_consolidation_mean_min": 1.3999999999999995, "reward_consolidation_mean_max": 2.1311111111111107, "reward_illegal_mean_mean": -0.30349999999999994, "reward_illegal_mean_min": -0.5166666666666666, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 3.292971333333333, "reward_accuracy_mean_min": 2.790233333333333, "reward_accuracy_mean_max": 3.6646666666666663, "reward_sla_mean_mean": -0.8714166666666666, "reward_sla_mean_min": -1.2522222222222221, "reward_sla_mean_max": -0.5233333333333333, "reward_consolidation_sum_mean": 178.95111111111103, "reward_consolidation_sum_min": 139.99999999999994, "reward_consolidation_sum_max": 213.1111111111111, "reward_illegal_sum_mean": -30.35, "reward_illegal_sum_min": -51.666666666666664, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 329.2971333333333, "reward_accuracy_sum_min": 279.0233333333333, "reward_accuracy_sum_max": 366.46666666666664, "reward_sla_sum_mean": -87.14166666666667, "reward_sla_sum_min": -125.22222222222221, "reward_sla_sum_max": -52.33333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2281.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332, 346.24444444444424, 371.35444444444414, 324.41222222222217, 409.4999999999997, 421.93444444444424, 468.2599999999997, 368.04777777777775, 395.0833333333331, 397.7988888888886, 365.9433333333331, 346.4255555555553, 284.74555555555554, 344.77444444444427, 371.6755555555552, 373.3622222222221, 387.4344444444441, 349.7344444444442, 358.7733333333332, 368.91888888888866, 366.5288888888887, 333.1222222222219, 364.0355555555553, 320.0455555555556, 353.66333333333307, 365.01444444444434, 364.25111111111084, 394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865, 399.0011111111109, 452.1477777777773, 368.4166666666666, 351.8511111111109, 391.332222222222, 412.01333333333304, 390.2422222222221, 359.02222222222184, 386.9299999999997, 435.592222222222, 383.9511111111109, 371.1566666666666, 394.602222222222, 420.35888888888866, 340.411111111111, 384.20222222222196, 400.3411111111109, 428.432222222222, 470.911111111111, 441.62222222222204, 442.0888888888887, 405.48333333333306, 403.421111111111, 399.3922222222219, 374.8088888888884, 396.05333333333317, 390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094, 403.6633333333332, 438.1888888888885, 420.4299999999996, 431.15666666666635, 402.79444444444425, 405.01111111111084, 410.8311111111109, 412.6488888888885, 404.1699999999998, 419.30444444444436, 442.1255555555553, 430.21555555555534, 396.89111111111083, 427.35555555555527, 410.96555555555534, 355.52444444444427, 422.02222222222207, 431.8822222222218, 435.154444444444, 386.42444444444425, 423.72999999999973, 427.65333333333314, 418.8166666666662, 325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [316.1166666666665, 365.59777777777754, 293.471111111111, 336.4188888888888, 333.8977777777777, 342.0044444444444, 329.0833333333332, 346.24444444444424, 371.35444444444414, 324.41222222222217, 409.4999999999997, 421.93444444444424, 468.2599999999997, 368.04777777777775, 395.0833333333331, 397.7988888888886, 365.9433333333331, 346.4255555555553, 284.74555555555554, 344.77444444444427, 371.6755555555552, 373.3622222222221, 387.4344444444441, 349.7344444444442, 358.7733333333332, 368.91888888888866, 366.5288888888887, 333.1222222222219, 364.0355555555553, 320.0455555555556, 353.66333333333307, 365.01444444444434, 364.25111111111084, 394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865, 399.0011111111109, 452.1477777777773, 368.4166666666666, 351.8511111111109, 391.332222222222, 412.01333333333304, 390.2422222222221, 359.02222222222184, 386.9299999999997, 435.592222222222, 383.9511111111109, 371.1566666666666, 394.602222222222, 420.35888888888866, 340.411111111111, 384.20222222222196, 400.3411111111109, 428.432222222222, 470.911111111111, 441.62222222222204, 442.0888888888887, 405.48333333333306, 403.421111111111, 399.3922222222219, 374.8088888888884, 396.05333333333317, 390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094, 403.6633333333332, 438.1888888888885, 420.4299999999996, 431.15666666666635, 402.79444444444425, 405.01111111111084, 410.8311111111109, 412.6488888888885, 404.1699999999998, 419.30444444444436, 442.1255555555553, 430.21555555555534, 396.89111111111083, 427.35555555555527, 410.96555555555534, 355.52444444444427, 422.02222222222207, 431.8822222222218, 435.154444444444, 386.42444444444425, 423.72999999999973, 427.65333333333314, 418.8166666666662, 325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19464167708288557, "mean_inference_ms": 1.781455450539408, "mean_action_processing_ms": 0.07327202025772157, "mean_env_wait_ms": 1.2006289413050313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003850698471069336, "StateBufferConnector_ms": 0.0026798248291015625, "ViewRequirementAgentConnector_ms": 0.06241941452026367}, "num_episodes": 30, "episode_return_max": 478.73222222222176, "episode_return_min": 284.74555555555554, "episode_return_mean": 390.75657777777747, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102450, "num_agent_steps_trained": 102300, "num_env_steps_sampled": 102450, "num_env_steps_trained": 102300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 304.4262021983015, "num_env_steps_trained_throughput_per_sec": 318.92268801726823, "timesteps_total": 102450, "num_env_steps_sampled_lifetime": 102450, "num_agent_steps_sampled_lifetime": 102450, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 102450, "timers": {"training_iteration_time_ms": 10226.614, "restore_workers_time_ms": 0.012, "training_step_time_ms": 491.373, "sample_time_ms": 477.352, "synch_weights_time_ms": 12.748}, "counters": {"num_env_steps_sampled": 102450, "num_env_steps_trained": 102300, "num_agent_steps_sampled": 102450, "num_agent_steps_trained": 102300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 683, "num_samples_added_to_queue": 102300}, "done": false, "training_iteration": 34, "trial_id": "38f59_00000", "date": "2024-10-10_22-17-21", "timestamp": 1728595041, "time_this_iter_s": 10.36198902130127, "time_total_s": 347.5519471168518, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7f10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 347.5519471168518, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 10.38, "ram_util_percent": 55.80666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 300030.40625, "policy_loss": 296067.78125, "entropy": 23.75337791442871, "entropy_coeff": 0.01, "var_gnorm": 16.321311950683594, "vf_loss": 403386.6875, "vf_explained_var": -0.0723416805267334}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 351.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 105600, "num_env_steps_trained": 105300, "num_agent_steps_sampled": 105600, "num_agent_steps_trained": 105300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 704, "num_samples_added_to_queue": 105600, "learner_queue": {"size_count": 351, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.358, "learner_load_time_ms": 0.275, "learner_load_wait_time_ms": 932.788, "learner_dequeue_time_ms": 7926.648}}, "env_runners": {"episode_reward_max": 503.7188888888886, "episode_reward_min": 325.7222222222221, "episode_reward_mean": 413.8088333333331, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 325.7222222222221}, "policy_reward_max": {"default_policy": 503.7188888888886}, "policy_reward_mean": {"default_policy": 413.8088333333331}, "custom_metrics": {"num_consolidated_mean": 1.419, "num_consolidated_min": 1.26, "num_consolidated_max": 1.62, "num_overloaded_mean": 0.16269999999999998, "num_overloaded_min": 0.08, "num_overloaded_max": 0.27, "num_moves_mean": 8.4422, "num_moves_min": 8.08, "num_moves_max": 8.9, "mean_accuracy_mean": 39.97640333333332, "mean_accuracy_min": 39.78266666666666, "mean_accuracy_max": 40.14999999999999, "num_model_switches_mean": 4.5148, "num_model_switches_min": 4.1, "num_model_switches_max": 4.94, "num_slav_mean": 0.03008299999999999, "num_slav_min": 0.016133333333333333, "num_slav_max": 0.041650000000000006, "mean_cluster_cpu_util_mean": 0.4659304565899038, "mean_cluster_cpu_util_min": 0.45207941671977564, "mean_cluster_cpu_util_max": 0.47894977033909775, "mean_cluster_mem_util_mean": 0.3088659807005081, "mean_cluster_mem_util_min": 0.30100723632279913, "mean_cluster_mem_util_max": 0.31784182238296155, "reward_consolidation_mean_mean": 1.8763111111111104, "reward_consolidation_mean_min": 1.5555555555555551, "reward_consolidation_mean_max": 2.2244444444444444, "reward_illegal_mean_mean": -0.27116666666666667, "reward_illegal_mean_min": -0.44999999999999996, "reward_illegal_mean_max": -0.13333333333333333, "reward_accuracy_mean_mean": 3.3674216666666656, "reward_accuracy_mean_min": 2.9691999999999994, "reward_accuracy_mean_max": 3.6766999999999994, "reward_sla_mean_mean": -0.8344777777777779, "reward_sla_mean_min": -1.2522222222222221, "reward_sla_mean_max": -0.4955555555555556, "reward_consolidation_sum_mean": 187.6311111111111, "reward_consolidation_sum_min": 155.55555555555551, "reward_consolidation_sum_max": 222.44444444444443, "reward_illegal_sum_mean": -27.11666666666667, "reward_illegal_sum_min": -44.99999999999999, "reward_illegal_sum_max": -13.333333333333332, "reward_accuracy_sum_mean": 336.7421666666666, "reward_accuracy_sum_min": 296.91999999999996, "reward_accuracy_sum_max": 367.66999999999996, "reward_sla_sum_mean": -83.44777777777779, "reward_sla_sum_min": -125.22222222222221, "reward_sla_sum_max": -49.55555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2378.0, "global_timestep_min": 500, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865, 399.0011111111109, 452.1477777777773, 368.4166666666666, 351.8511111111109, 391.332222222222, 412.01333333333304, 390.2422222222221, 359.02222222222184, 386.9299999999997, 435.592222222222, 383.9511111111109, 371.1566666666666, 394.602222222222, 420.35888888888866, 340.411111111111, 384.20222222222196, 400.3411111111109, 428.432222222222, 470.911111111111, 441.62222222222204, 442.0888888888887, 405.48333333333306, 403.421111111111, 399.3922222222219, 374.8088888888884, 396.05333333333317, 390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094, 403.6633333333332, 438.1888888888885, 420.4299999999996, 431.15666666666635, 402.79444444444425, 405.01111111111084, 410.8311111111109, 412.6488888888885, 404.1699999999998, 419.30444444444436, 442.1255555555553, 430.21555555555534, 396.89111111111083, 427.35555555555527, 410.96555555555534, 355.52444444444427, 422.02222222222207, 431.8822222222218, 435.154444444444, 386.42444444444425, 423.72999999999973, 427.65333333333314, 418.8166666666662, 325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108, 472.5488888888885, 408.0211111111109, 411.6411111111109, 447.03111111111093, 440.3099999999999, 503.7188888888886, 460.2144444444439, 422.8899999999999, 445.2188888888886, 375.8555555555554, 453.44999999999976, 407.0111111111109, 391.272222222222, 339.8088888888886, 461.23111111111086, 408.87111111111085, 430.5033333333329, 415.58999999999975, 468.73777777777735, 499.8388888888885, 432.01555555555524, 458.3655555555553, 399.7711111111108, 461.9477777777777, 387.30111111111086, 431.9555555555552, 407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [394.903333333333, 403.09999999999985, 371.7833333333331, 454.36888888888865, 399.0011111111109, 452.1477777777773, 368.4166666666666, 351.8511111111109, 391.332222222222, 412.01333333333304, 390.2422222222221, 359.02222222222184, 386.9299999999997, 435.592222222222, 383.9511111111109, 371.1566666666666, 394.602222222222, 420.35888888888866, 340.411111111111, 384.20222222222196, 400.3411111111109, 428.432222222222, 470.911111111111, 441.62222222222204, 442.0888888888887, 405.48333333333306, 403.421111111111, 399.3922222222219, 374.8088888888884, 396.05333333333317, 390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094, 403.6633333333332, 438.1888888888885, 420.4299999999996, 431.15666666666635, 402.79444444444425, 405.01111111111084, 410.8311111111109, 412.6488888888885, 404.1699999999998, 419.30444444444436, 442.1255555555553, 430.21555555555534, 396.89111111111083, 427.35555555555527, 410.96555555555534, 355.52444444444427, 422.02222222222207, 431.8822222222218, 435.154444444444, 386.42444444444425, 423.72999999999973, 427.65333333333314, 418.8166666666662, 325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108, 472.5488888888885, 408.0211111111109, 411.6411111111109, 447.03111111111093, 440.3099999999999, 503.7188888888886, 460.2144444444439, 422.8899999999999, 445.2188888888886, 375.8555555555554, 453.44999999999976, 407.0111111111109, 391.272222222222, 339.8088888888886, 461.23111111111086, 408.87111111111085, 430.5033333333329, 415.58999999999975, 468.73777777777735, 499.8388888888885, 432.01555555555524, 458.3655555555553, 399.7711111111108, 461.9477777777777, 387.30111111111086, 431.9555555555552, 407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19440132529166923, "mean_inference_ms": 1.7798742155794658, "mean_action_processing_ms": 0.07317585465069425, "mean_env_wait_ms": 1.1998374892345176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037505626678466797, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.06218862533569336}, "num_episodes": 33, "episode_return_max": 503.7188888888886, "episode_return_min": 325.7222222222221, "episode_return_mean": 413.8088333333331, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105600, "num_agent_steps_trained": 105300, "num_env_steps_sampled": 105600, "num_env_steps_trained": 105300, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 306.6305930915816, "num_env_steps_trained_throughput_per_sec": 292.02913627769675, "timesteps_total": 105600, "num_env_steps_sampled_lifetime": 105600, "num_agent_steps_sampled_lifetime": 105600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 105600, "timers": {"training_iteration_time_ms": 10225.062, "restore_workers_time_ms": 0.011, "training_step_time_ms": 491.392, "sample_time_ms": 477.29, "synch_weights_time_ms": 12.85}, "counters": {"num_env_steps_sampled": 105600, "num_env_steps_trained": 105300, "num_agent_steps_sampled": 105600, "num_agent_steps_trained": 105300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 704, "num_samples_added_to_queue": 105600}, "done": false, "training_iteration": 35, "trial_id": "38f59_00000", "date": "2024-10-10_22-17-31", "timestamp": 1728595051, "time_this_iter_s": 10.284533023834229, "time_total_s": 357.83648014068604, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7910>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.83648014068604, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 10.635714285714284, "ram_util_percent": 56.07857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 346040.9375, "policy_loss": 340784.96875, "entropy": 23.4512939453125, "entropy_coeff": 0.01, "var_gnorm": 16.328039169311523, "vf_loss": 532631.5, "vf_explained_var": -0.062225341796875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 361.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 108600, "num_env_steps_trained": 108300, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 724, "num_samples_added_to_queue": 108600, "learner_queue": {"size_count": 361, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.933, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 978.789, "learner_dequeue_time_ms": 7952.127}}, "env_runners": {"episode_reward_max": 540.5911111111108, "episode_reward_min": 325.7222222222221, "episode_reward_mean": 429.73254444444416, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 325.7222222222221}, "policy_reward_max": {"default_policy": 540.5911111111108}, "policy_reward_mean": {"default_policy": 429.73254444444416}, "custom_metrics": {"num_consolidated_mean": 1.4534, "num_consolidated_min": 1.26, "num_consolidated_max": 1.69, "num_overloaded_mean": 0.15650000000000003, "num_overloaded_min": 0.07, "num_overloaded_max": 0.27, "num_moves_mean": 8.3484, "num_moves_min": 7.92, "num_moves_max": 8.9, "mean_accuracy_mean": 39.961899999999986, "mean_accuracy_min": 39.78266666666666, "mean_accuracy_max": 40.14999999999999, "num_model_switches_mean": 4.4842, "num_model_switches_min": 4.04, "num_model_switches_max": 4.88, "num_slav_mean": 0.02758716666666666, "num_slav_min": 0.012366666666666666, "num_slav_max": 0.0387, "mean_cluster_cpu_util_mean": 0.46532891994975245, "mean_cluster_cpu_util_min": 0.45207941671977564, "mean_cluster_cpu_util_max": 0.47894977033909775, "mean_cluster_mem_util_mean": 0.30832506272245186, "mean_cluster_mem_util_min": 0.30100723632279913, "mean_cluster_mem_util_max": 0.31784182238296155, "reward_consolidation_mean_mean": 1.9375999999999993, "reward_consolidation_mean_min": 1.5555555555555551, "reward_consolidation_mean_max": 2.3022222222222215, "reward_illegal_mean_mean": -0.2608333333333333, "reward_illegal_mean_min": -0.44999999999999996, "reward_illegal_mean_max": -0.11666666666666665, "reward_accuracy_mean_mean": 3.388664333333333, "reward_accuracy_mean_min": 2.9691999999999994, "reward_accuracy_mean_max": 3.754466666666666, "reward_sla_mean_mean": -0.7681055555555555, "reward_sla_mean_min": -1.1266666666666665, "reward_sla_mean_max": -0.3844444444444444, "reward_consolidation_sum_mean": 193.75999999999996, "reward_consolidation_sum_min": 155.55555555555551, "reward_consolidation_sum_max": 230.22222222222214, "reward_illegal_sum_mean": -26.08333333333333, "reward_illegal_sum_min": -44.99999999999999, "reward_illegal_sum_max": -11.666666666666666, "reward_accuracy_sum_mean": 338.86643333333336, "reward_accuracy_sum_min": 296.91999999999996, "reward_accuracy_sum_max": 375.4466666666666, "reward_sla_sum_mean": -76.81055555555555, "reward_sla_sum_min": -112.66666666666666, "reward_sla_sum_max": -38.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3367.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094, 403.6633333333332, 438.1888888888885, 420.4299999999996, 431.15666666666635, 402.79444444444425, 405.01111111111084, 410.8311111111109, 412.6488888888885, 404.1699999999998, 419.30444444444436, 442.1255555555553, 430.21555555555534, 396.89111111111083, 427.35555555555527, 410.96555555555534, 355.52444444444427, 422.02222222222207, 431.8822222222218, 435.154444444444, 386.42444444444425, 423.72999999999973, 427.65333333333314, 418.8166666666662, 325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108, 472.5488888888885, 408.0211111111109, 411.6411111111109, 447.03111111111093, 440.3099999999999, 503.7188888888886, 460.2144444444439, 422.8899999999999, 445.2188888888886, 375.8555555555554, 453.44999999999976, 407.0111111111109, 391.272222222222, 339.8088888888886, 461.23111111111086, 408.87111111111085, 430.5033333333329, 415.58999999999975, 468.73777777777735, 499.8388888888885, 432.01555555555524, 458.3655555555553, 399.7711111111108, 461.9477777777777, 387.30111111111086, 431.9555555555552, 407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516, 434.2555555555553, 438.0255555555551, 488.584444444444, 406.49222222222187, 458.6044444444442, 443.322222222222, 451.4788888888887, 540.5911111111108, 496.82888888888857, 455.6499999999996, 493.01555555555524, 451.5877777777775, 436.8755555555555, 450.27999999999963, 463.1733333333331, 362.64999999999975, 426.6211111111108, 501.8355555555552, 463.94111111111044, 490.0888888888885, 430.9044444444444, 421.58111111111083, 445.4099999999997, 428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [390.62999999999977, 445.0755555555553, 384.3055555555554, 358.1833333333333, 402.7777777777775, 447.4244444444442, 359.15111111111094, 403.6633333333332, 438.1888888888885, 420.4299999999996, 431.15666666666635, 402.79444444444425, 405.01111111111084, 410.8311111111109, 412.6488888888885, 404.1699999999998, 419.30444444444436, 442.1255555555553, 430.21555555555534, 396.89111111111083, 427.35555555555527, 410.96555555555534, 355.52444444444427, 422.02222222222207, 431.8822222222218, 435.154444444444, 386.42444444444425, 423.72999999999973, 427.65333333333314, 418.8166666666662, 325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108, 472.5488888888885, 408.0211111111109, 411.6411111111109, 447.03111111111093, 440.3099999999999, 503.7188888888886, 460.2144444444439, 422.8899999999999, 445.2188888888886, 375.8555555555554, 453.44999999999976, 407.0111111111109, 391.272222222222, 339.8088888888886, 461.23111111111086, 408.87111111111085, 430.5033333333329, 415.58999999999975, 468.73777777777735, 499.8388888888885, 432.01555555555524, 458.3655555555553, 399.7711111111108, 461.9477777777777, 387.30111111111086, 431.9555555555552, 407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516, 434.2555555555553, 438.0255555555551, 488.584444444444, 406.49222222222187, 458.6044444444442, 443.322222222222, 451.4788888888887, 540.5911111111108, 496.82888888888857, 455.6499999999996, 493.01555555555524, 451.5877777777775, 436.8755555555555, 450.27999999999963, 463.1733333333331, 362.64999999999975, 426.6211111111108, 501.8355555555552, 463.94111111111044, 490.0888888888885, 430.9044444444444, 421.58111111111083, 445.4099999999997, 428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19420508486965177, "mean_inference_ms": 1.7766964022048715, "mean_action_processing_ms": 0.07311176175700199, "mean_env_wait_ms": 1.1992573326966909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003776073455810547, "StateBufferConnector_ms": 0.002700328826904297, "ViewRequirementAgentConnector_ms": 0.06229829788208008}, "num_episodes": 30, "episode_return_max": 540.5911111111108, "episode_return_min": 325.7222222222221, "episode_return_mean": 429.73254444444416, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108300, "num_env_steps_sampled": 108600, "num_env_steps_trained": 108300, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.6693179676152, "num_env_steps_trained_throughput_per_sec": 290.6693179676152, "timesteps_total": 108600, "num_env_steps_sampled_lifetime": 108600, "num_agent_steps_sampled_lifetime": 108600, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 108600, "timers": {"training_iteration_time_ms": 10239.257, "restore_workers_time_ms": 0.011, "training_step_time_ms": 482.962, "sample_time_ms": 468.741, "synch_weights_time_ms": 12.88}, "counters": {"num_env_steps_sampled": 108600, "num_env_steps_trained": 108300, "num_agent_steps_sampled": 108600, "num_agent_steps_trained": 108300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 724, "num_samples_added_to_queue": 108600}, "done": false, "training_iteration": 36, "trial_id": "38f59_00000", "date": "2024-10-10_22-17-41", "timestamp": 1728595061, "time_this_iter_s": 10.33348560333252, "time_total_s": 368.16996574401855, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde5db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.16996574401855, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 14.173333333333336, "ram_util_percent": 58.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 336902.34375, "policy_loss": 331797.4375, "entropy": 23.302330017089844, "entropy_coeff": 0.01, "var_gnorm": 16.33271598815918, "vf_loss": 517482.34375, "vf_explained_var": -0.056087613105773926}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 372.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 111750, "num_env_steps_trained": 111600, "num_agent_steps_sampled": 111750, "num_agent_steps_trained": 111600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 745, "num_samples_added_to_queue": 111600, "learner_queue": {"size_count": 372, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 42.915, "learner_load_time_ms": 0.279, "learner_load_wait_time_ms": 924.504, "learner_dequeue_time_ms": 7957.948}}, "env_runners": {"episode_reward_max": 551.075555555555, "episode_reward_min": 325.7222222222221, "episode_reward_mean": 451.8531555555552, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 325.7222222222221}, "policy_reward_max": {"default_policy": 551.075555555555}, "policy_reward_mean": {"default_policy": 451.8531555555552}, "custom_metrics": {"num_consolidated_mean": 1.4894999999999998, "num_consolidated_min": 1.3, "num_consolidated_max": 1.69, "num_overloaded_mean": 0.13990000000000002, "num_overloaded_min": 0.07, "num_overloaded_max": 0.27, "num_moves_mean": 8.261899999999999, "num_moves_min": 7.78, "num_moves_max": 8.73, "mean_accuracy_mean": 39.96721999999999, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.14999999999999, "num_model_switches_mean": 4.453, "num_model_switches_min": 4.04, "num_model_switches_max": 4.88, "num_slav_mean": 0.0254925, "num_slav_min": 0.012366666666666666, "num_slav_max": 0.038599999999999995, "mean_cluster_cpu_util_mean": 0.4638799940035897, "mean_cluster_cpu_util_min": 0.45197117611293225, "mean_cluster_cpu_util_max": 0.47894977033909775, "mean_cluster_mem_util_mean": 0.3072728792463188, "mean_cluster_mem_util_min": 0.3009981409124831, "mean_cluster_mem_util_max": 0.31784182238296155, "reward_consolidation_mean_mean": 2.0223777777777774, "reward_consolidation_mean_min": 1.5555555555555551, "reward_consolidation_mean_max": 2.411111111111111, "reward_illegal_mean_mean": -0.2331666666666666, "reward_illegal_mean_min": -0.44999999999999996, "reward_illegal_mean_max": -0.11666666666666664, "reward_accuracy_mean_mean": 3.4505593333333326, "reward_accuracy_mean_min": 2.9691999999999994, "reward_accuracy_mean_max": 3.754466666666666, "reward_sla_mean_mean": -0.7212388888888889, "reward_sla_mean_min": -1.093888888888889, "reward_sla_mean_max": -0.3844444444444444, "reward_consolidation_sum_mean": 202.23777777777778, "reward_consolidation_sum_min": 155.55555555555551, "reward_consolidation_sum_max": 241.1111111111111, "reward_illegal_sum_mean": -23.316666666666666, "reward_illegal_sum_min": -44.99999999999999, "reward_illegal_sum_max": -11.666666666666664, "reward_accuracy_sum_mean": 345.05593333333337, "reward_accuracy_sum_min": 296.91999999999996, "reward_accuracy_sum_max": 375.4466666666666, "reward_sla_sum_mean": -72.12388888888889, "reward_sla_sum_min": -109.38888888888889, "reward_sla_sum_max": -38.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4367.0, "global_timestep_min": 2300, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108, 472.5488888888885, 408.0211111111109, 411.6411111111109, 447.03111111111093, 440.3099999999999, 503.7188888888886, 460.2144444444439, 422.8899999999999, 445.2188888888886, 375.8555555555554, 453.44999999999976, 407.0111111111109, 391.272222222222, 339.8088888888886, 461.23111111111086, 408.87111111111085, 430.5033333333329, 415.58999999999975, 468.73777777777735, 499.8388888888885, 432.01555555555524, 458.3655555555553, 399.7711111111108, 461.9477777777777, 387.30111111111086, 431.9555555555552, 407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516, 434.2555555555553, 438.0255555555551, 488.584444444444, 406.49222222222187, 458.6044444444442, 443.322222222222, 451.4788888888887, 540.5911111111108, 496.82888888888857, 455.6499999999996, 493.01555555555524, 451.5877777777775, 436.8755555555555, 450.27999999999963, 463.1733333333331, 362.64999999999975, 426.6211111111108, 501.8355555555552, 463.94111111111044, 490.0888888888885, 430.9044444444444, 421.58111111111083, 445.4099999999997, 428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218, 489.91555555555516, 459.74999999999966, 455.54444444444425, 503.0555555555552, 501.23888888888854, 475.25999999999965, 524.4811111111107, 515.7666666666663, 551.075555555555, 514.3622222222219, 497.51999999999975, 434.702222222222, 516.2411111111109, 510.95888888888845, 475.34333333333313, 459.1599999999995, 466.2966666666663, 488.8444444444444, 485.39222222222185, 405.3277777777772, 487.8133333333329, 503.8366666666663, 486.14777777777755, 476.5522222222219, 451.69888888888863, 479.79222222222177, 471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [325.7222222222221, 418.7999999999996, 402.06555555555536, 432.2922222222219, 424.6511111111109, 478.73222222222176, 383.2711111111108, 472.5488888888885, 408.0211111111109, 411.6411111111109, 447.03111111111093, 440.3099999999999, 503.7188888888886, 460.2144444444439, 422.8899999999999, 445.2188888888886, 375.8555555555554, 453.44999999999976, 407.0111111111109, 391.272222222222, 339.8088888888886, 461.23111111111086, 408.87111111111085, 430.5033333333329, 415.58999999999975, 468.73777777777735, 499.8388888888885, 432.01555555555524, 458.3655555555553, 399.7711111111108, 461.9477777777777, 387.30111111111086, 431.9555555555552, 407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516, 434.2555555555553, 438.0255555555551, 488.584444444444, 406.49222222222187, 458.6044444444442, 443.322222222222, 451.4788888888887, 540.5911111111108, 496.82888888888857, 455.6499999999996, 493.01555555555524, 451.5877777777775, 436.8755555555555, 450.27999999999963, 463.1733333333331, 362.64999999999975, 426.6211111111108, 501.8355555555552, 463.94111111111044, 490.0888888888885, 430.9044444444444, 421.58111111111083, 445.4099999999997, 428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218, 489.91555555555516, 459.74999999999966, 455.54444444444425, 503.0555555555552, 501.23888888888854, 475.25999999999965, 524.4811111111107, 515.7666666666663, 551.075555555555, 514.3622222222219, 497.51999999999975, 434.702222222222, 516.2411111111109, 510.95888888888845, 475.34333333333313, 459.1599999999995, 466.2966666666663, 488.8444444444444, 485.39222222222185, 405.3277777777772, 487.8133333333329, 503.8366666666663, 486.14777777777755, 476.5522222222219, 451.69888888888863, 479.79222222222177, 471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1940564528089693, "mean_inference_ms": 1.775012369379972, "mean_action_processing_ms": 0.07305336752693514, "mean_env_wait_ms": 1.1987997884777657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710031509399414, "StateBufferConnector_ms": 0.0026619434356689453, "ViewRequirementAgentConnector_ms": 0.06142377853393555}, "num_episodes": 30, "episode_return_max": 551.075555555555, "episode_return_min": 325.7222222222221, "episode_return_mean": 451.8531555555552, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111750, "num_agent_steps_trained": 111600, "num_env_steps_sampled": 111750, "num_env_steps_trained": 111600, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 310.145160307048, "num_env_steps_trained_throughput_per_sec": 324.91397746452645, "timesteps_total": 111750, "num_env_steps_sampled_lifetime": 111750, "num_agent_steps_sampled_lifetime": 111750, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 111750, "timers": {"training_iteration_time_ms": 10235.74, "restore_workers_time_ms": 0.012, "training_step_time_ms": 484.655, "sample_time_ms": 470.6, "synch_weights_time_ms": 12.672}, "counters": {"num_env_steps_sampled": 111750, "num_env_steps_trained": 111600, "num_agent_steps_sampled": 111750, "num_agent_steps_trained": 111600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 745, "num_samples_added_to_queue": 111600}, "done": false, "training_iteration": 37, "trial_id": "38f59_00000", "date": "2024-10-10_22-17-52", "timestamp": 1728595072, "time_this_iter_s": 10.166217803955078, "time_total_s": 378.33618354797363, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde7640>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 378.33618354797363, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 10.366666666666669, "ram_util_percent": 58.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 342448.9375, "policy_loss": 337190.28125, "entropy": 23.11418914794922, "entropy_coeff": 0.01, "var_gnorm": 16.335163116455078, "vf_loss": 532799.5625, "vf_explained_var": -0.057652950286865234}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 382.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 114900, "num_env_steps_trained": 114600, "num_agent_steps_sampled": 114900, "num_agent_steps_trained": 114600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 766, "num_samples_added_to_queue": 114900, "learner_queue": {"size_count": 382, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.43, "learner_load_time_ms": 0.279, "learner_load_wait_time_ms": 926.6, "learner_dequeue_time_ms": 7933.519}}, "env_runners": {"episode_reward_max": 551.075555555555, "episode_reward_min": 362.64999999999975, "episode_reward_mean": 468.4178666666663, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 362.64999999999975}, "policy_reward_max": {"default_policy": 551.075555555555}, "policy_reward_mean": {"default_policy": 468.4178666666663}, "custom_metrics": {"num_consolidated_mean": 1.5267, "num_consolidated_min": 1.3, "num_consolidated_max": 1.75, "num_overloaded_mean": 0.13040000000000002, "num_overloaded_min": 0.06, "num_overloaded_max": 0.25, "num_moves_mean": 8.1734, "num_moves_min": 7.73, "num_moves_max": 8.58, "mean_accuracy_mean": 39.95208333333332, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.111999999999995, "num_model_switches_mean": 4.4412, "num_model_switches_min": 4.04, "num_model_switches_max": 4.82, "num_slav_mean": 0.023502666666666668, "num_slav_min": 0.012366666666666666, "num_slav_max": 0.03523333333333333, "mean_cluster_cpu_util_mean": 0.4621662740157679, "mean_cluster_cpu_util_min": 0.45197117611293225, "mean_cluster_cpu_util_max": 0.476663840896252, "mean_cluster_mem_util_mean": 0.30630834708049887, "mean_cluster_mem_util_min": 0.3009981409124831, "mean_cluster_mem_util_max": 0.31354994384884755, "reward_consolidation_mean_mean": 2.0909777777777774, "reward_consolidation_mean_min": 1.7266666666666663, "reward_consolidation_mean_max": 2.5666666666666664, "reward_illegal_mean_mean": -0.2173333333333333, "reward_illegal_mean_min": -0.41666666666666663, "reward_illegal_mean_max": -0.09999999999999998, "reward_accuracy_mean_mean": 3.4825120000000003, "reward_accuracy_mean_min": 3.0798333333333336, "reward_accuracy_mean_max": 3.7563666666666666, "reward_sla_mean_mean": -0.6719777777777778, "reward_sla_mean_min": -0.9594444444444445, "reward_sla_mean_max": -0.3844444444444444, "reward_consolidation_sum_mean": 209.09777777777776, "reward_consolidation_sum_min": 172.66666666666663, "reward_consolidation_sum_max": 256.66666666666663, "reward_illegal_sum_mean": -21.73333333333333, "reward_illegal_sum_min": -41.666666666666664, "reward_illegal_sum_max": -9.999999999999998, "reward_accuracy_sum_mean": 348.2511999999999, "reward_accuracy_sum_min": 307.98333333333335, "reward_accuracy_sum_max": 375.63666666666666, "reward_sla_sum_mean": -67.19777777777779, "reward_sla_sum_min": -95.94444444444446, "reward_sla_sum_max": -38.44444444444444, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5467.0, "global_timestep_min": 3400, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516, 434.2555555555553, 438.0255555555551, 488.584444444444, 406.49222222222187, 458.6044444444442, 443.322222222222, 451.4788888888887, 540.5911111111108, 496.82888888888857, 455.6499999999996, 493.01555555555524, 451.5877777777775, 436.8755555555555, 450.27999999999963, 463.1733333333331, 362.64999999999975, 426.6211111111108, 501.8355555555552, 463.94111111111044, 490.0888888888885, 430.9044444444444, 421.58111111111083, 445.4099999999997, 428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218, 489.91555555555516, 459.74999999999966, 455.54444444444425, 503.0555555555552, 501.23888888888854, 475.25999999999965, 524.4811111111107, 515.7666666666663, 551.075555555555, 514.3622222222219, 497.51999999999975, 434.702222222222, 516.2411111111109, 510.95888888888845, 475.34333333333313, 459.1599999999995, 466.2966666666663, 488.8444444444444, 485.39222222222185, 405.3277777777772, 487.8133333333329, 503.8366666666663, 486.14777777777755, 476.5522222222219, 451.69888888888863, 479.79222222222177, 471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444, 463.67111111111086, 419.5511111111107, 473.1188888888886, 466.60555555555516, 513.8099999999996, 469.79444444444414, 524.2266666666662, 479.3577777777774, 468.8944444444439, 504.82333333333304, 459.9855555555554, 465.39444444444416, 464.78333333333296, 525.4588888888885, 502.24888888888864, 476.7266666666663, 469.9333333333329, 472.4222222222217, 493.73333333333306, 530.3266666666665, 432.90222222222195, 546.081111111111, 474.5322222222219, 397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [407.52888888888873, 429.0066666666664, 405.6733333333331, 394.592222222222, 435.4133333333333, 419.0288888888886, 416.53555555555516, 434.2555555555553, 438.0255555555551, 488.584444444444, 406.49222222222187, 458.6044444444442, 443.322222222222, 451.4788888888887, 540.5911111111108, 496.82888888888857, 455.6499999999996, 493.01555555555524, 451.5877777777775, 436.8755555555555, 450.27999999999963, 463.1733333333331, 362.64999999999975, 426.6211111111108, 501.8355555555552, 463.94111111111044, 490.0888888888885, 430.9044444444444, 421.58111111111083, 445.4099999999997, 428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218, 489.91555555555516, 459.74999999999966, 455.54444444444425, 503.0555555555552, 501.23888888888854, 475.25999999999965, 524.4811111111107, 515.7666666666663, 551.075555555555, 514.3622222222219, 497.51999999999975, 434.702222222222, 516.2411111111109, 510.95888888888845, 475.34333333333313, 459.1599999999995, 466.2966666666663, 488.8444444444444, 485.39222222222185, 405.3277777777772, 487.8133333333329, 503.8366666666663, 486.14777777777755, 476.5522222222219, 451.69888888888863, 479.79222222222177, 471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444, 463.67111111111086, 419.5511111111107, 473.1188888888886, 466.60555555555516, 513.8099999999996, 469.79444444444414, 524.2266666666662, 479.3577777777774, 468.8944444444439, 504.82333333333304, 459.9855555555554, 465.39444444444416, 464.78333333333296, 525.4588888888885, 502.24888888888864, 476.7266666666663, 469.9333333333329, 472.4222222222217, 493.73333333333306, 530.3266666666665, 432.90222222222195, 546.081111111111, 474.5322222222219, 397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1939083843971291, "mean_inference_ms": 1.7733274995184722, "mean_action_processing_ms": 0.07299302915766476, "mean_env_wait_ms": 1.198256626774849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003704071044921875, "StateBufferConnector_ms": 0.002629518508911133, "ViewRequirementAgentConnector_ms": 0.06111431121826172}, "num_episodes": 33, "episode_return_max": 551.075555555555, "episode_return_min": 362.64999999999975, "episode_return_mean": 468.4178666666663, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114900, "num_agent_steps_trained": 114600, "num_env_steps_sampled": 114900, "num_env_steps_trained": 114600, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 305.60773877212193, "num_env_steps_trained_throughput_per_sec": 291.05498930678283, "timesteps_total": 114900, "num_env_steps_sampled_lifetime": 114900, "num_agent_steps_sampled_lifetime": 114900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 114900, "timers": {"training_iteration_time_ms": 10262.072, "restore_workers_time_ms": 0.011, "training_step_time_ms": 496.359, "sample_time_ms": 482.318, "synch_weights_time_ms": 12.648}, "counters": {"num_env_steps_sampled": 114900, "num_env_steps_trained": 114600, "num_agent_steps_sampled": 114900, "num_agent_steps_trained": 114600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 766, "num_samples_added_to_queue": 114900}, "done": false, "training_iteration": 38, "trial_id": "38f59_00000", "date": "2024-10-10_22-18-02", "timestamp": 1728595082, "time_this_iter_s": 10.316837310791016, "time_total_s": 388.65302085876465, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde67a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 388.65302085876465, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 10.564285714285715, "ram_util_percent": 58.457142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 330421.5625, "policy_loss": 324736.0, "entropy": 22.15215301513672, "entropy_coeff": 0.01, "var_gnorm": 16.343032836914062, "vf_loss": 575203.5625, "vf_explained_var": -0.04477357864379883}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 393.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 118050, "num_env_steps_trained": 117900, "num_agent_steps_sampled": 118050, "num_agent_steps_trained": 117900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 787, "num_samples_added_to_queue": 117900, "learner_queue": {"size_count": 393, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.48, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 925.309, "learner_dequeue_time_ms": 7908.074}}, "env_runners": {"episode_reward_max": 572.043333333333, "episode_reward_min": 397.56111111111085, "episode_reward_mean": 485.5516888888886, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 397.56111111111085}, "policy_reward_max": {"default_policy": 572.043333333333}, "policy_reward_mean": {"default_policy": 485.5516888888886}, "custom_metrics": {"num_consolidated_mean": 1.5656, "num_consolidated_min": 1.39, "num_consolidated_max": 1.82, "num_overloaded_mean": 0.11930000000000002, "num_overloaded_min": 0.05, "num_overloaded_max": 0.21, "num_moves_mean": 8.0836, "num_moves_min": 7.44, "num_moves_max": 8.52, "mean_accuracy_mean": 39.941189999999985, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.111999999999995, "num_model_switches_mean": 4.4199, "num_model_switches_min": 4.04, "num_model_switches_max": 4.82, "num_slav_mean": 0.0221045, "num_slav_min": 0.011716666666666667, "num_slav_max": 0.03281666666666666, "mean_cluster_cpu_util_mean": 0.4600729470963939, "mean_cluster_cpu_util_min": 0.45179883565560375, "mean_cluster_cpu_util_max": 0.4716602775918167, "mean_cluster_mem_util_mean": 0.30511692815702224, "mean_cluster_mem_util_min": 0.29918346501047677, "mean_cluster_mem_util_max": 0.3121717446683315, "reward_consolidation_mean_mean": 2.1695333333333324, "reward_consolidation_mean_min": 1.8355555555555554, "reward_consolidation_mean_max": 2.675555555555554, "reward_illegal_mean_mean": -0.1988333333333333, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.08333333333333331, "reward_accuracy_mean_mean": 3.524228, "reward_accuracy_mean_min": 3.1961666666666666, "reward_accuracy_mean_max": 3.7752999999999997, "reward_sla_mean_mean": -0.6394111111111112, "reward_sla_mean_min": -0.9594444444444445, "reward_sla_mean_max": -0.33333333333333337, "reward_consolidation_sum_mean": 216.95333333333326, "reward_consolidation_sum_min": 183.55555555555554, "reward_consolidation_sum_max": 267.55555555555543, "reward_illegal_sum_mean": -19.883333333333333, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -8.333333333333332, "reward_accuracy_sum_mean": 352.4228, "reward_accuracy_sum_min": 319.6166666666667, "reward_accuracy_sum_max": 377.53, "reward_sla_sum_mean": -63.94111111111112, "reward_sla_sum_min": -95.94444444444446, "reward_sla_sum_max": -33.333333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5765.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218, 489.91555555555516, 459.74999999999966, 455.54444444444425, 503.0555555555552, 501.23888888888854, 475.25999999999965, 524.4811111111107, 515.7666666666663, 551.075555555555, 514.3622222222219, 497.51999999999975, 434.702222222222, 516.2411111111109, 510.95888888888845, 475.34333333333313, 459.1599999999995, 466.2966666666663, 488.8444444444444, 485.39222222222185, 405.3277777777772, 487.8133333333329, 503.8366666666663, 486.14777777777755, 476.5522222222219, 451.69888888888863, 479.79222222222177, 471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444, 463.67111111111086, 419.5511111111107, 473.1188888888886, 466.60555555555516, 513.8099999999996, 469.79444444444414, 524.2266666666662, 479.3577777777774, 468.8944444444439, 504.82333333333304, 459.9855555555554, 465.39444444444416, 464.78333333333296, 525.4588888888885, 502.24888888888864, 476.7266666666663, 469.9333333333329, 472.4222222222217, 493.73333333333306, 530.3266666666665, 432.90222222222195, 546.081111111111, 474.5322222222219, 397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277, 468.75888888888863, 453.60111111111087, 457.73888888888825, 497.9577777777773, 527.391111111111, 537.3655555555553, 452.2455555555552, 517.3977777777774, 505.283333333333, 532.4766666666662, 451.49555555555514, 532.3677777777774, 502.0688888888886, 504.33333333333303, 512.1077777777774, 476.7655555555551, 503.1699999999996, 511.77555555555506, 527.7988888888885, 497.3299999999994, 502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [428.1388888888887, 446.9999999999996, 444.2633333333331, 467.2944444444443, 444.1999999999997, 470.39555555555535, 467.2222222222218, 489.91555555555516, 459.74999999999966, 455.54444444444425, 503.0555555555552, 501.23888888888854, 475.25999999999965, 524.4811111111107, 515.7666666666663, 551.075555555555, 514.3622222222219, 497.51999999999975, 434.702222222222, 516.2411111111109, 510.95888888888845, 475.34333333333313, 459.1599999999995, 466.2966666666663, 488.8444444444444, 485.39222222222185, 405.3277777777772, 487.8133333333329, 503.8366666666663, 486.14777777777755, 476.5522222222219, 451.69888888888863, 479.79222222222177, 471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444, 463.67111111111086, 419.5511111111107, 473.1188888888886, 466.60555555555516, 513.8099999999996, 469.79444444444414, 524.2266666666662, 479.3577777777774, 468.8944444444439, 504.82333333333304, 459.9855555555554, 465.39444444444416, 464.78333333333296, 525.4588888888885, 502.24888888888864, 476.7266666666663, 469.9333333333329, 472.4222222222217, 493.73333333333306, 530.3266666666665, 432.90222222222195, 546.081111111111, 474.5322222222219, 397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277, 468.75888888888863, 453.60111111111087, 457.73888888888825, 497.9577777777773, 527.391111111111, 537.3655555555553, 452.2455555555552, 517.3977777777774, 505.283333333333, 532.4766666666662, 451.49555555555514, 532.3677777777774, 502.0688888888886, 504.33333333333303, 512.1077777777774, 476.7655555555551, 503.1699999999996, 511.77555555555506, 527.7988888888885, 497.3299999999994, 502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19367520851095393, "mean_inference_ms": 1.7712309526444694, "mean_action_processing_ms": 0.07291222388169318, "mean_env_wait_ms": 1.1972880373894284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036432743072509766, "StateBufferConnector_ms": 0.0026013851165771484, "ViewRequirementAgentConnector_ms": 0.060265302658081055}, "num_episodes": 30, "episode_return_max": 572.043333333333, "episode_return_min": 397.56111111111085, "episode_return_mean": 485.5516888888886, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118050, "num_agent_steps_trained": 117900, "num_env_steps_sampled": 118050, "num_env_steps_trained": 117900, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 308.3305165507795, "num_env_steps_trained_throughput_per_sec": 323.01292210081664, "timesteps_total": 118050, "num_env_steps_sampled_lifetime": 118050, "num_agent_steps_sampled_lifetime": 118050, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 118050, "timers": {"training_iteration_time_ms": 10268.509, "restore_workers_time_ms": 0.011, "training_step_time_ms": 487.085, "sample_time_ms": 473.661, "synch_weights_time_ms": 12.158}, "counters": {"num_env_steps_sampled": 118050, "num_env_steps_trained": 117900, "num_agent_steps_sampled": 118050, "num_agent_steps_trained": 117900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 787, "num_samples_added_to_queue": 117900}, "done": false, "training_iteration": 39, "trial_id": "38f59_00000", "date": "2024-10-10_22-18-12", "timestamp": 1728595092, "time_this_iter_s": 10.232000589370728, "time_total_s": 398.8850214481354, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde6320>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 398.8850214481354, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 10.819999999999999, "ram_util_percent": 57.11333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 333515.96875, "policy_loss": 328000.21875, "entropy": 21.651012420654297, "entropy_coeff": 0.01, "var_gnorm": 16.353797912597656, "vf_loss": 558068.0, "vf_explained_var": -0.04235494136810303}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 403.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 121200, "num_env_steps_trained": 120900, "num_agent_steps_sampled": 121200, "num_agent_steps_trained": 120900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 808, "num_samples_added_to_queue": 121200, "learner_queue": {"size_count": 403, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 45.081, "learner_load_time_ms": 0.296, "learner_load_wait_time_ms": 923.017, "learner_dequeue_time_ms": 7890.805}}, "env_runners": {"episode_reward_max": 607.9222222222223, "episode_reward_min": 397.56111111111085, "episode_reward_mean": 507.4397444444441, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 397.56111111111085}, "policy_reward_max": {"default_policy": 607.9222222222223}, "policy_reward_mean": {"default_policy": 507.4397444444441}, "custom_metrics": {"num_consolidated_mean": 1.6262999999999996, "num_consolidated_min": 1.39, "num_consolidated_max": 1.83, "num_overloaded_mean": 0.109, "num_overloaded_min": 0.03, "num_overloaded_max": 0.21, "num_moves_mean": 7.878299999999999, "num_moves_min": 7.16, "num_moves_max": 8.47, "mean_accuracy_mean": 39.90800333333332, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.09299999999999, "num_model_switches_mean": 4.335299999999999, "num_model_switches_min": 3.93, "num_model_switches_max": 4.68, "num_slav_mean": 0.019739166666666665, "num_slav_min": 0.008199999999999999, "num_slav_max": 0.0304, "mean_cluster_cpu_util_mean": 0.45811868777033815, "mean_cluster_cpu_util_min": 0.4484773624773393, "mean_cluster_cpu_util_max": 0.4716602775918167, "mean_cluster_mem_util_mean": 0.30392140947824275, "mean_cluster_mem_util_min": 0.2971850322196389, "mean_cluster_mem_util_max": 0.3116556892060622, "reward_consolidation_mean_mean": 2.272044444444444, "reward_consolidation_mean_min": 1.866666666666666, "reward_consolidation_mean_max": 2.675555555555554, "reward_illegal_mean_mean": -0.18166666666666667, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.5617863333333326, "reward_accuracy_mean_min": 3.1961666666666666, "reward_accuracy_mean_max": 3.8644666666666665, "reward_sla_mean_mean": -0.5777666666666668, "reward_sla_mean_min": -0.908888888888889, "reward_sla_mean_max": -0.245, "reward_consolidation_sum_mean": 227.20444444444445, "reward_consolidation_sum_min": 186.6666666666666, "reward_consolidation_sum_max": 267.55555555555543, "reward_illegal_sum_mean": -18.16666666666667, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 356.17863333333327, "reward_accuracy_sum_min": 319.6166666666667, "reward_accuracy_sum_max": 386.44666666666666, "reward_sla_sum_mean": -57.776666666666664, "reward_sla_sum_min": -90.8888888888889, "reward_sla_sum_max": -24.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4302.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444, 463.67111111111086, 419.5511111111107, 473.1188888888886, 466.60555555555516, 513.8099999999996, 469.79444444444414, 524.2266666666662, 479.3577777777774, 468.8944444444439, 504.82333333333304, 459.9855555555554, 465.39444444444416, 464.78333333333296, 525.4588888888885, 502.24888888888864, 476.7266666666663, 469.9333333333329, 472.4222222222217, 493.73333333333306, 530.3266666666665, 432.90222222222195, 546.081111111111, 474.5322222222219, 397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277, 468.75888888888863, 453.60111111111087, 457.73888888888825, 497.9577777777773, 527.391111111111, 537.3655555555553, 452.2455555555552, 517.3977777777774, 505.283333333333, 532.4766666666662, 451.49555555555514, 532.3677777777774, 502.0688888888886, 504.33333333333303, 512.1077777777774, 476.7655555555551, 503.1699999999996, 511.77555555555506, 527.7988888888885, 497.3299999999994, 502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441, 546.7288888888883, 557.6999999999997, 506.2899999999995, 541.7599999999995, 505.4655555555551, 538.8799999999995, 548.1399999999996, 573.9744444444442, 567.6877777777773, 529.6411111111108, 572.0055555555551, 554.3222222222217, 584.8377777777775, 527.4288888888884, 560.3677777777776, 558.5755555555552, 548.1588888888886, 499.19777777777745, 559.5544444444442, 507.8133333333329, 501.7422222222219, 521.6377777777774, 516.6022222222218, 534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [471.2133333333331, 483.19666666666626, 487.7066666666662, 498.374444444444, 463.67111111111086, 419.5511111111107, 473.1188888888886, 466.60555555555516, 513.8099999999996, 469.79444444444414, 524.2266666666662, 479.3577777777774, 468.8944444444439, 504.82333333333304, 459.9855555555554, 465.39444444444416, 464.78333333333296, 525.4588888888885, 502.24888888888864, 476.7266666666663, 469.9333333333329, 472.4222222222217, 493.73333333333306, 530.3266666666665, 432.90222222222195, 546.081111111111, 474.5322222222219, 397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277, 468.75888888888863, 453.60111111111087, 457.73888888888825, 497.9577777777773, 527.391111111111, 537.3655555555553, 452.2455555555552, 517.3977777777774, 505.283333333333, 532.4766666666662, 451.49555555555514, 532.3677777777774, 502.0688888888886, 504.33333333333303, 512.1077777777774, 476.7655555555551, 503.1699999999996, 511.77555555555506, 527.7988888888885, 497.3299999999994, 502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441, 546.7288888888883, 557.6999999999997, 506.2899999999995, 541.7599999999995, 505.4655555555551, 538.8799999999995, 548.1399999999996, 573.9744444444442, 567.6877777777773, 529.6411111111108, 572.0055555555551, 554.3222222222217, 584.8377777777775, 527.4288888888884, 560.3677777777776, 558.5755555555552, 548.1588888888886, 499.19777777777745, 559.5544444444442, 507.8133333333329, 501.7422222222219, 521.6377777777774, 516.6022222222218, 534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19350853933842985, "mean_inference_ms": 1.770721357934354, "mean_action_processing_ms": 0.07283737646202675, "mean_env_wait_ms": 1.1965609351999043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003838777542114258, "StateBufferConnector_ms": 0.002614736557006836, "ViewRequirementAgentConnector_ms": 0.06038689613342285}, "num_episodes": 33, "episode_return_max": 607.9222222222223, "episode_return_min": 397.56111111111085, "episode_return_mean": 507.4397444444441, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121200, "num_agent_steps_trained": 120900, "num_env_steps_sampled": 121200, "num_env_steps_trained": 120900, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 309.13738457529104, "num_env_steps_trained_throughput_per_sec": 294.41655673837244, "timesteps_total": 121200, "num_env_steps_sampled_lifetime": 121200, "num_agent_steps_sampled_lifetime": 121200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 121200, "timers": {"training_iteration_time_ms": 10238.67, "restore_workers_time_ms": 0.011, "training_step_time_ms": 482.764, "sample_time_ms": 469.036, "synch_weights_time_ms": 12.409}, "counters": {"num_env_steps_sampled": 121200, "num_env_steps_trained": 120900, "num_agent_steps_sampled": 121200, "num_agent_steps_trained": 120900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 808, "num_samples_added_to_queue": 121200}, "done": false, "training_iteration": 40, "trial_id": "38f59_00000", "date": "2024-10-10_22-18-22", "timestamp": 1728595102, "time_this_iter_s": 10.203014135360718, "time_total_s": 409.0880355834961, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde73d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 409.0880355834961, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 10.313333333333334, "ram_util_percent": 57.12000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 359713.96875, "policy_loss": 352695.8125, "entropy": 21.360645294189453, "entropy_coeff": 0.01, "var_gnorm": 16.36172103881836, "vf_loss": 708226.5, "vf_explained_var": -0.0320897102355957}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 413.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 124050, "num_env_steps_trained": 123900, "num_agent_steps_sampled": 124050, "num_agent_steps_trained": 123900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 827, "num_samples_added_to_queue": 123900, "learner_queue": {"size_count": 413, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.408, "learner_load_time_ms": 0.286, "learner_load_wait_time_ms": 995.404, "learner_dequeue_time_ms": 7980.111}}, "env_runners": {"episode_reward_max": 626.9322222222218, "episode_reward_min": 397.56111111111085, "episode_reward_mean": 528.8264222222218, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 397.56111111111085}, "policy_reward_max": {"default_policy": 626.9322222222218}, "policy_reward_mean": {"default_policy": 528.8264222222218}, "custom_metrics": {"num_consolidated_mean": 1.6808, "num_consolidated_min": 1.48, "num_consolidated_max": 1.96, "num_overloaded_mean": 0.09870000000000002, "num_overloaded_min": 0.03, "num_overloaded_max": 0.21, "num_moves_mean": 7.6892999999999985, "num_moves_min": 6.93, "num_moves_max": 8.36, "mean_accuracy_mean": 39.90268333333333, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.16899999999999, "num_model_switches_mean": 4.2732, "num_model_switches_min": 3.93, "num_model_switches_max": 4.68, "num_slav_mean": 0.017523, "num_slav_min": 0.008199999999999999, "num_slav_max": 0.029666666666666668, "mean_cluster_cpu_util_mean": 0.45689497887924074, "mean_cluster_cpu_util_min": 0.44676180292888057, "mean_cluster_cpu_util_max": 0.4716602775918167, "mean_cluster_mem_util_mean": 0.3029624847082293, "mean_cluster_mem_util_min": 0.29630712509687424, "mean_cluster_mem_util_max": 0.3116556892060622, "reward_consolidation_mean_mean": 2.368177777777777, "reward_consolidation_mean_min": 1.866666666666666, "reward_consolidation_mean_max": 2.893333333333332, "reward_illegal_mean_mean": -0.16449999999999995, "reward_illegal_mean_min": -0.35, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.6015753333333334, "reward_accuracy_mean_min": 3.1961666666666666, "reward_accuracy_mean_max": 3.8644666666666665, "reward_sla_mean_mean": -0.5169888888888889, "reward_sla_mean_min": -0.908888888888889, "reward_sla_mean_max": -0.245, "reward_consolidation_sum_mean": 236.81777777777774, "reward_consolidation_sum_min": 186.6666666666666, "reward_consolidation_sum_max": 289.3333333333332, "reward_illegal_sum_mean": -16.449999999999996, "reward_illegal_sum_min": -35.0, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 360.1575333333333, "reward_accuracy_sum_min": 319.6166666666667, "reward_accuracy_sum_max": 386.44666666666666, "reward_sla_sum_mean": -51.69888888888889, "reward_sla_sum_min": -90.8888888888889, "reward_sla_sum_max": -24.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3068.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277, 468.75888888888863, 453.60111111111087, 457.73888888888825, 497.9577777777773, 527.391111111111, 537.3655555555553, 452.2455555555552, 517.3977777777774, 505.283333333333, 532.4766666666662, 451.49555555555514, 532.3677777777774, 502.0688888888886, 504.33333333333303, 512.1077777777774, 476.7655555555551, 503.1699999999996, 511.77555555555506, 527.7988888888885, 497.3299999999994, 502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441, 546.7288888888883, 557.6999999999997, 506.2899999999995, 541.7599999999995, 505.4655555555551, 538.8799999999995, 548.1399999999996, 573.9744444444442, 567.6877777777773, 529.6411111111108, 572.0055555555551, 554.3222222222217, 584.8377777777775, 527.4288888888884, 560.3677777777776, 558.5755555555552, 548.1588888888886, 499.19777777777745, 559.5544444444442, 507.8133333333329, 501.7422222222219, 521.6377777777774, 516.6022222222218, 534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886, 541.0688888888885, 558.5555555555549, 546.5977777777774, 565.4055555555551, 583.2611111111107, 626.9322222222218, 549.6822222222219, 586.3644444444442, 582.3833333333332, 548.8966666666664, 506.5766666666662, 561.5388888888886, 557.8877777777775, 573.2744444444443, 602.0888888888883, 533.6166666666663, 543.5788888888883, 551.0811111111107, 545.2966666666663, 544.0377777777774, 575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [397.56111111111085, 434.21888888888856, 481.79333333333307, 480.9699999999996, 432.0144444444441, 481.80999999999983, 437.6988888888885, 526.9588888888885, 507.59555555555517, 478.12333333333277, 468.75888888888863, 453.60111111111087, 457.73888888888825, 497.9577777777773, 527.391111111111, 537.3655555555553, 452.2455555555552, 517.3977777777774, 505.283333333333, 532.4766666666662, 451.49555555555514, 532.3677777777774, 502.0688888888886, 504.33333333333303, 512.1077777777774, 476.7655555555551, 503.1699999999996, 511.77555555555506, 527.7988888888885, 497.3299999999994, 502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441, 546.7288888888883, 557.6999999999997, 506.2899999999995, 541.7599999999995, 505.4655555555551, 538.8799999999995, 548.1399999999996, 573.9744444444442, 567.6877777777773, 529.6411111111108, 572.0055555555551, 554.3222222222217, 584.8377777777775, 527.4288888888884, 560.3677777777776, 558.5755555555552, 548.1588888888886, 499.19777777777745, 559.5544444444442, 507.8133333333329, 501.7422222222219, 521.6377777777774, 516.6022222222218, 534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886, 541.0688888888885, 558.5555555555549, 546.5977777777774, 565.4055555555551, 583.2611111111107, 626.9322222222218, 549.6822222222219, 586.3644444444442, 582.3833333333332, 548.8966666666664, 506.5766666666662, 561.5388888888886, 557.8877777777775, 573.2744444444443, 602.0888888888883, 533.6166666666663, 543.5788888888883, 551.0811111111107, 545.2966666666663, 544.0377777777774, 575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19325162292427167, "mean_inference_ms": 1.7667227810692419, "mean_action_processing_ms": 0.07277333473390328, "mean_env_wait_ms": 1.1956469678889934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042917728424072266, "StateBufferConnector_ms": 0.002688169479370117, "ViewRequirementAgentConnector_ms": 0.062155723571777344}, "num_episodes": 27, "episode_return_max": 626.9322222222218, "episode_return_min": 397.56111111111085, "episode_return_mean": 528.8264222222218, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124050, "num_agent_steps_trained": 123900, "num_env_steps_sampled": 124050, "num_env_steps_trained": 123900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.0714076555316, "num_env_steps_trained_throughput_per_sec": 294.8120080584543, "timesteps_total": 124050, "num_env_steps_sampled_lifetime": 124050, "num_agent_steps_sampled_lifetime": 124050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 124050, "timers": {"training_iteration_time_ms": 10209.521, "restore_workers_time_ms": 0.011, "training_step_time_ms": 495.106, "sample_time_ms": 481.792, "synch_weights_time_ms": 12.07}, "counters": {"num_env_steps_sampled": 124050, "num_env_steps_trained": 123900, "num_agent_steps_sampled": 124050, "num_agent_steps_trained": 123900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 827, "num_samples_added_to_queue": 123900}, "done": false, "training_iteration": 41, "trial_id": "38f59_00000", "date": "2024-10-10_22-18-33", "timestamp": 1728595113, "time_this_iter_s": 10.191723346710205, "time_total_s": 419.2797589302063, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79ce20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 419.2797589302063, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 15.235714285714286, "ram_util_percent": 59.72142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 360145.09375, "policy_loss": 353253.3125, "entropy": 21.22702407836914, "entropy_coeff": 0.01, "var_gnorm": 16.36358070373535, "vf_loss": 695548.0, "vf_explained_var": -0.025046586990356445}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 423.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 127050, "num_env_steps_trained": 126900, "num_agent_steps_sampled": 127050, "num_agent_steps_trained": 126900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 847, "num_samples_added_to_queue": 126900, "learner_queue": {"size_count": 423, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.239, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 956.135, "learner_dequeue_time_ms": 7991.142}}, "env_runners": {"episode_reward_max": 626.9322222222218, "episode_reward_min": 467.6377777777774, "episode_reward_mean": 549.3787999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 467.6377777777774}, "policy_reward_max": {"default_policy": 626.9322222222218}, "policy_reward_mean": {"default_policy": 549.3787999999996}, "custom_metrics": {"num_consolidated_mean": 1.7324000000000002, "num_consolidated_min": 1.5, "num_consolidated_max": 1.96, "num_overloaded_mean": 0.0863, "num_overloaded_min": 0.03, "num_overloaded_max": 0.17, "num_moves_mean": 7.5009000000000015, "num_moves_min": 6.93, "num_moves_max": 8.26, "mean_accuracy_mean": 39.91230999999999, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.16899999999999, "num_model_switches_mean": 4.1983999999999995, "num_model_switches_min": 3.87, "num_model_switches_max": 4.68, "num_slav_mean": 0.016139333333333335, "num_slav_min": 0.008199999999999999, "num_slav_max": 0.029666666666666668, "mean_cluster_cpu_util_mean": 0.45586301806591734, "mean_cluster_cpu_util_min": 0.44522925508846584, "mean_cluster_cpu_util_max": 0.46657573656055334, "mean_cluster_mem_util_mean": 0.30232751243756995, "mean_cluster_mem_util_min": 0.2946372789833233, "mean_cluster_mem_util_max": 0.3093962075547519, "reward_consolidation_mean_mean": 2.470533333333333, "reward_consolidation_mean_min": 2.1155555555555554, "reward_consolidation_mean_max": 2.893333333333332, "reward_illegal_mean_mean": -0.1438333333333333, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.05, "reward_accuracy_mean_mean": 3.649604666666667, "reward_accuracy_mean_min": 3.3162999999999996, "reward_accuracy_mean_max": 3.8644666666666665, "reward_sla_mean_mean": -0.48251666666666665, "reward_sla_mean_min": -0.908888888888889, "reward_sla_mean_max": -0.245, "reward_consolidation_sum_mean": 247.05333333333328, "reward_consolidation_sum_min": 211.55555555555554, "reward_consolidation_sum_max": 289.3333333333332, "reward_illegal_sum_mean": -14.383333333333333, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -5.0, "reward_accuracy_sum_mean": 364.9604666666666, "reward_accuracy_sum_min": 331.62999999999994, "reward_accuracy_sum_max": 386.44666666666666, "reward_sla_sum_mean": -48.25166666666666, "reward_sla_sum_min": -90.8888888888889, "reward_sla_sum_max": -24.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2196.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441, 546.7288888888883, 557.6999999999997, 506.2899999999995, 541.7599999999995, 505.4655555555551, 538.8799999999995, 548.1399999999996, 573.9744444444442, 567.6877777777773, 529.6411111111108, 572.0055555555551, 554.3222222222217, 584.8377777777775, 527.4288888888884, 560.3677777777776, 558.5755555555552, 548.1588888888886, 499.19777777777745, 559.5544444444442, 507.8133333333329, 501.7422222222219, 521.6377777777774, 516.6022222222218, 534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886, 541.0688888888885, 558.5555555555549, 546.5977777777774, 565.4055555555551, 583.2611111111107, 626.9322222222218, 549.6822222222219, 586.3644444444442, 582.3833333333332, 548.8966666666664, 506.5766666666662, 561.5388888888886, 557.8877777777775, 573.2744444444443, 602.0888888888883, 533.6166666666663, 543.5788888888883, 551.0811111111107, 545.2966666666663, 544.0377777777774, 575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885, 540.5366666666664, 581.4944444444438, 576.342222222222, 538.664444444444, 542.2944444444439, 555.9055555555549, 539.1366666666663, 587.7666666666662, 606.0266666666663, 561.3144444444441, 529.0944444444441, 526.3777777777775, 568.6422222222219, 565.4966666666661, 574.2833333333332, 571.8488888888886, 515.8744444444441, 552.2911111111107, 559.3188888888885, 563.5611111111106, 498.07444444444394, 539.0511111111109, 531.5911111111108, 595.0722222222221, 560.6444444444442, 572.5588888888885, 505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [502.2999999999997, 477.48777777777747, 508.8566666666662, 546.6966666666663, 510.7611111111109, 467.6377777777774, 486.2922222222219, 572.043333333333, 515.8188888888885, 515.6344444444441, 546.7288888888883, 557.6999999999997, 506.2899999999995, 541.7599999999995, 505.4655555555551, 538.8799999999995, 548.1399999999996, 573.9744444444442, 567.6877777777773, 529.6411111111108, 572.0055555555551, 554.3222222222217, 584.8377777777775, 527.4288888888884, 560.3677777777776, 558.5755555555552, 548.1588888888886, 499.19777777777745, 559.5544444444442, 507.8133333333329, 501.7422222222219, 521.6377777777774, 516.6022222222218, 534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886, 541.0688888888885, 558.5555555555549, 546.5977777777774, 565.4055555555551, 583.2611111111107, 626.9322222222218, 549.6822222222219, 586.3644444444442, 582.3833333333332, 548.8966666666664, 506.5766666666662, 561.5388888888886, 557.8877777777775, 573.2744444444443, 602.0888888888883, 533.6166666666663, 543.5788888888883, 551.0811111111107, 545.2966666666663, 544.0377777777774, 575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885, 540.5366666666664, 581.4944444444438, 576.342222222222, 538.664444444444, 542.2944444444439, 555.9055555555549, 539.1366666666663, 587.7666666666662, 606.0266666666663, 561.3144444444441, 529.0944444444441, 526.3777777777775, 568.6422222222219, 565.4966666666661, 574.2833333333332, 571.8488888888886, 515.8744444444441, 552.2911111111107, 559.3188888888885, 563.5611111111106, 498.07444444444394, 539.0511111111109, 531.5911111111108, 595.0722222222221, 560.6444444444442, 572.5588888888885, 505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1931481292313214, "mean_inference_ms": 1.7667197212028016, "mean_action_processing_ms": 0.07274345512935154, "mean_env_wait_ms": 1.1955384760740322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004345417022705078, "StateBufferConnector_ms": 0.002710103988647461, "ViewRequirementAgentConnector_ms": 0.06313180923461914}, "num_episodes": 30, "episode_return_max": 626.9322222222218, "episode_return_min": 467.6377777777774, "episode_return_mean": 549.3787999999996, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 127050, "num_agent_steps_trained": 126900, "num_env_steps_sampled": 127050, "num_env_steps_trained": 126900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.562209926251, "num_env_steps_trained_throughput_per_sec": 297.562209926251, "timesteps_total": 127050, "num_env_steps_sampled_lifetime": 127050, "num_agent_steps_sampled_lifetime": 127050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 127050, "timers": {"training_iteration_time_ms": 10212.119, "restore_workers_time_ms": 0.013, "training_step_time_ms": 503.885, "sample_time_ms": 489.777, "synch_weights_time_ms": 12.831}, "counters": {"num_env_steps_sampled": 127050, "num_env_steps_trained": 126900, "num_agent_steps_sampled": 127050, "num_agent_steps_trained": 126900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 847, "num_samples_added_to_queue": 126900}, "done": false, "training_iteration": 42, "trial_id": "38f59_00000", "date": "2024-10-10_22-18-43", "timestamp": 1728595123, "time_this_iter_s": 10.095114707946777, "time_total_s": 429.3748736381531, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc6f80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 429.3748736381531, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 10.393333333333333, "ram_util_percent": 59.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 336502.96875, "policy_loss": 330507.96875, "entropy": 21.197771072387695, "entropy_coeff": 0.01, "var_gnorm": 16.364286422729492, "vf_loss": 605859.9375, "vf_explained_var": -0.019024252891540527}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 433.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 130200, "num_env_steps_trained": 129900, "num_agent_steps_sampled": 130200, "num_agent_steps_trained": 129900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 868, "num_samples_added_to_queue": 130200, "learner_queue": {"size_count": 433, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.411, "learner_load_time_ms": 0.343, "learner_load_wait_time_ms": 910.235, "learner_dequeue_time_ms": 7951.227}}, "env_runners": {"episode_reward_max": 626.9322222222218, "episode_reward_min": 479.99777777777734, "episode_reward_mean": 561.983944444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 479.99777777777734}, "policy_reward_max": {"default_policy": 626.9322222222218}, "policy_reward_mean": {"default_policy": 561.983944444444}, "custom_metrics": {"num_consolidated_mean": 1.7681000000000002, "num_consolidated_min": 1.58, "num_consolidated_max": 1.97, "num_overloaded_mean": 0.0789, "num_overloaded_min": 0.02, "num_overloaded_max": 0.17, "num_moves_mean": 7.363200000000001, "num_moves_min": 6.82, "num_moves_max": 7.82, "mean_accuracy_mean": 39.93035999999999, "mean_accuracy_min": 39.71299999999999, "mean_accuracy_max": 40.16899999999999, "num_model_switches_mean": 4.1530000000000005, "num_model_switches_min": 3.69, "num_model_switches_max": 4.5, "num_slav_mean": 0.015273833333333335, "num_slav_min": 0.007566666666666666, "num_slav_max": 0.024849999999999997, "mean_cluster_cpu_util_mean": 0.45481171748490906, "mean_cluster_cpu_util_min": 0.44353203705880195, "mean_cluster_cpu_util_max": 0.46657573656055334, "mean_cluster_mem_util_mean": 0.30163813709671633, "mean_cluster_mem_util_min": 0.2939696315551537, "mean_cluster_mem_util_max": 0.3093962075547519, "reward_consolidation_mean_mean": 2.5322888888888886, "reward_consolidation_mean_min": 2.2088888888888887, "reward_consolidation_mean_max": 2.893333333333332, "reward_illegal_mean_mean": -0.13149999999999998, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 3.680128333333333, "reward_accuracy_mean_min": 3.3162999999999996, "reward_accuracy_mean_max": 3.9169666666666667, "reward_sla_mean_mean": -0.46107777777777775, "reward_sla_mean_min": -0.7472222222222221, "reward_sla_mean_max": -0.245, "reward_consolidation_sum_mean": 253.22888888888883, "reward_consolidation_sum_min": 220.88888888888886, "reward_consolidation_sum_max": 289.3333333333332, "reward_illegal_sum_mean": -13.15, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 368.0128333333334, "reward_accuracy_sum_min": 331.62999999999994, "reward_accuracy_sum_max": 391.69666666666666, "reward_sla_sum_mean": -46.10777777777778, "reward_sla_sum_min": -74.72222222222221, "reward_sla_sum_max": -24.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2750.0, "global_timestep_min": 500, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886, 541.0688888888885, 558.5555555555549, 546.5977777777774, 565.4055555555551, 583.2611111111107, 626.9322222222218, 549.6822222222219, 586.3644444444442, 582.3833333333332, 548.8966666666664, 506.5766666666662, 561.5388888888886, 557.8877777777775, 573.2744444444443, 602.0888888888883, 533.6166666666663, 543.5788888888883, 551.0811111111107, 545.2966666666663, 544.0377777777774, 575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885, 540.5366666666664, 581.4944444444438, 576.342222222222, 538.664444444444, 542.2944444444439, 555.9055555555549, 539.1366666666663, 587.7666666666662, 606.0266666666663, 561.3144444444441, 529.0944444444441, 526.3777777777775, 568.6422222222219, 565.4966666666661, 574.2833333333332, 571.8488888888886, 515.8744444444441, 552.2911111111107, 559.3188888888885, 563.5611111111106, 498.07444444444394, 539.0511111111109, 531.5911111111108, 595.0722222222221, 560.6444444444442, 572.5588888888885, 505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665, 565.2999999999996, 521.963333333333, 543.0077777777776, 604.5622222222219, 561.4877777777776, 604.3422222222218, 577.5555555555554, 573.115555555555, 544.4822222222218, 479.99777777777734, 591.9411111111108, 578.1366666666664, 536.9277777777774, 547.3844444444441, 593.7033333333326, 612.5299999999997, 575.0711111111108, 613.1311111111108, 518.2055555555551, 573.8311111111108, 561.2088888888887, 570.1044444444442, 608.1355555555555, 564.674444444444, 594.4377777777776, 607.2311111111109, 562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [534.0499999999996, 556.4533333333329, 502.4733333333328, 607.9222222222223, 540.1588888888884, 564.2111111111108, 567.7777777777774, 574.6688888888888, 552.3311111111108, 544.8388888888886, 541.0688888888885, 558.5555555555549, 546.5977777777774, 565.4055555555551, 583.2611111111107, 626.9322222222218, 549.6822222222219, 586.3644444444442, 582.3833333333332, 548.8966666666664, 506.5766666666662, 561.5388888888886, 557.8877777777775, 573.2744444444443, 602.0888888888883, 533.6166666666663, 543.5788888888883, 551.0811111111107, 545.2966666666663, 544.0377777777774, 575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885, 540.5366666666664, 581.4944444444438, 576.342222222222, 538.664444444444, 542.2944444444439, 555.9055555555549, 539.1366666666663, 587.7666666666662, 606.0266666666663, 561.3144444444441, 529.0944444444441, 526.3777777777775, 568.6422222222219, 565.4966666666661, 574.2833333333332, 571.8488888888886, 515.8744444444441, 552.2911111111107, 559.3188888888885, 563.5611111111106, 498.07444444444394, 539.0511111111109, 531.5911111111108, 595.0722222222221, 560.6444444444442, 572.5588888888885, 505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665, 565.2999999999996, 521.963333333333, 543.0077777777776, 604.5622222222219, 561.4877777777776, 604.3422222222218, 577.5555555555554, 573.115555555555, 544.4822222222218, 479.99777777777734, 591.9411111111108, 578.1366666666664, 536.9277777777774, 547.3844444444441, 593.7033333333326, 612.5299999999997, 575.0711111111108, 613.1311111111108, 518.2055555555551, 573.8311111111108, 561.2088888888887, 570.1044444444442, 608.1355555555555, 564.674444444444, 594.4377777777776, 607.2311111111109, 562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19302716151191177, "mean_inference_ms": 1.7666175583960437, "mean_action_processing_ms": 0.07271519032331036, "mean_env_wait_ms": 1.1954217971307717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004235267639160156, "StateBufferConnector_ms": 0.0027408599853515625, "ViewRequirementAgentConnector_ms": 0.06358790397644043}, "num_episodes": 33, "episode_return_max": 626.9322222222218, "episode_return_min": 479.99777777777734, "episode_return_mean": 561.983944444444, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130200, "num_agent_steps_trained": 129900, "num_env_steps_sampled": 130200, "num_env_steps_trained": 129900, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 309.99835358086307, "num_env_steps_trained_throughput_per_sec": 295.2365272198696, "timesteps_total": 130200, "num_env_steps_sampled_lifetime": 130200, "num_agent_steps_sampled_lifetime": 130200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 130200, "timers": {"training_iteration_time_ms": 10223.043, "restore_workers_time_ms": 0.012, "training_step_time_ms": 483.54, "sample_time_ms": 470.197, "synch_weights_time_ms": 12.107}, "counters": {"num_env_steps_sampled": 130200, "num_env_steps_trained": 129900, "num_agent_steps_sampled": 130200, "num_agent_steps_trained": 129900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 868, "num_samples_added_to_queue": 130200}, "done": false, "training_iteration": 43, "trial_id": "38f59_00000", "date": "2024-10-10_22-18-53", "timestamp": 1728595133, "time_this_iter_s": 10.170892000198364, "time_total_s": 439.54576563835144, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc4a60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 439.54576563835144, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 10.428571428571429, "ram_util_percent": 59.17857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 366455.96875, "policy_loss": 358629.0625, "entropy": 20.86776351928711, "entropy_coeff": 0.01, "var_gnorm": 16.371562957763672, "vf_loss": 788950.125, "vf_explained_var": -0.010251402854919434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 444.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 133350, "num_env_steps_trained": 133200, "num_agent_steps_sampled": 133350, "num_agent_steps_trained": 133200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 889, "num_samples_added_to_queue": 133200, "learner_queue": {"size_count": 444, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.843, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 936.434, "learner_dequeue_time_ms": 7949.929}}, "env_runners": {"episode_reward_max": 635.015555555555, "episode_reward_min": 479.99777777777734, "episode_reward_mean": 570.894222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 479.99777777777734}, "policy_reward_max": {"default_policy": 635.015555555555}, "policy_reward_mean": {"default_policy": 570.894222222222}, "custom_metrics": {"num_consolidated_mean": 1.7848000000000004, "num_consolidated_min": 1.59, "num_consolidated_max": 1.97, "num_overloaded_mean": 0.0714, "num_overloaded_min": 0.02, "num_overloaded_max": 0.17, "num_moves_mean": 7.3213, "num_moves_min": 6.73, "num_moves_max": 7.82, "mean_accuracy_mean": 39.93935333333332, "mean_accuracy_min": 39.75733333333332, "mean_accuracy_max": 40.14999999999999, "num_model_switches_mean": 4.1319, "num_model_switches_min": 3.69, "num_model_switches_max": 4.5, "num_slav_mean": 0.015127666666666666, "num_slav_min": 0.007566666666666666, "num_slav_max": 0.024849999999999997, "mean_cluster_cpu_util_mean": 0.4544638846461985, "mean_cluster_cpu_util_min": 0.44353203705880195, "mean_cluster_cpu_util_max": 0.46657573656055334, "mean_cluster_mem_util_mean": 0.3018509859729757, "mean_cluster_mem_util_min": 0.2939696315551537, "mean_cluster_mem_util_max": 0.3093962075547519, "reward_consolidation_mean_mean": 2.5789555555555546, "reward_consolidation_mean_min": 2.2088888888888887, "reward_consolidation_mean_max": 2.908888888888888, "reward_illegal_mean_mean": -0.11899999999999998, "reward_illegal_mean_min": -0.2833333333333333, "reward_illegal_mean_max": -0.03333333333333333, "reward_accuracy_mean_mean": 3.7099033333333336, "reward_accuracy_mean_min": 3.3162999999999996, "reward_accuracy_mean_max": 3.9169666666666667, "reward_sla_mean_mean": -0.4609166666666667, "reward_sla_mean_min": -0.7472222222222221, "reward_sla_mean_max": -0.24833333333333335, "reward_consolidation_sum_mean": 257.89555555555546, "reward_consolidation_sum_min": 220.88888888888886, "reward_consolidation_sum_max": 290.8888888888888, "reward_illegal_sum_mean": -11.9, "reward_illegal_sum_min": -28.333333333333332, "reward_illegal_sum_max": -3.333333333333333, "reward_accuracy_sum_mean": 370.99033333333335, "reward_accuracy_sum_min": 331.62999999999994, "reward_accuracy_sum_max": 391.69666666666666, "reward_sla_sum_mean": -46.091666666666676, "reward_sla_sum_min": -74.72222222222221, "reward_sla_sum_max": -24.833333333333336, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3767.0, "global_timestep_min": 1700, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885, 540.5366666666664, 581.4944444444438, 576.342222222222, 538.664444444444, 542.2944444444439, 555.9055555555549, 539.1366666666663, 587.7666666666662, 606.0266666666663, 561.3144444444441, 529.0944444444441, 526.3777777777775, 568.6422222222219, 565.4966666666661, 574.2833333333332, 571.8488888888886, 515.8744444444441, 552.2911111111107, 559.3188888888885, 563.5611111111106, 498.07444444444394, 539.0511111111109, 531.5911111111108, 595.0722222222221, 560.6444444444442, 572.5588888888885, 505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665, 565.2999999999996, 521.963333333333, 543.0077777777776, 604.5622222222219, 561.4877777777776, 604.3422222222218, 577.5555555555554, 573.115555555555, 544.4822222222218, 479.99777777777734, 591.9411111111108, 578.1366666666664, 536.9277777777774, 547.3844444444441, 593.7033333333326, 612.5299999999997, 575.0711111111108, 613.1311111111108, 518.2055555555551, 573.8311111111108, 561.2088888888887, 570.1044444444442, 608.1355555555555, 564.674444444444, 594.4377777777776, 607.2311111111109, 562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557, 610.5911111111111, 547.7388888888886, 603.6944444444439, 578.2088888888886, 621.1777777777777, 580.6155555555553, 581.0877777777772, 586.1966666666665, 595.4766666666665, 617.3488888888885, 584.7899999999996, 621.7444444444443, 572.093333333333, 580.2922222222222, 612.8888888888887, 560.9466666666663, 593.4988888888886, 611.36, 548.174444444444, 596.2088888888889, 554.5311111111106, 590.5122222222224, 578.5722222222219, 588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [575.6399999999994, 586.883333333333, 508.284444444444, 603.7544444444443, 574.8488888888885, 527.1855555555552, 592.8188888888885, 540.5366666666664, 581.4944444444438, 576.342222222222, 538.664444444444, 542.2944444444439, 555.9055555555549, 539.1366666666663, 587.7666666666662, 606.0266666666663, 561.3144444444441, 529.0944444444441, 526.3777777777775, 568.6422222222219, 565.4966666666661, 574.2833333333332, 571.8488888888886, 515.8744444444441, 552.2911111111107, 559.3188888888885, 563.5611111111106, 498.07444444444394, 539.0511111111109, 531.5911111111108, 595.0722222222221, 560.6444444444442, 572.5588888888885, 505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665, 565.2999999999996, 521.963333333333, 543.0077777777776, 604.5622222222219, 561.4877777777776, 604.3422222222218, 577.5555555555554, 573.115555555555, 544.4822222222218, 479.99777777777734, 591.9411111111108, 578.1366666666664, 536.9277777777774, 547.3844444444441, 593.7033333333326, 612.5299999999997, 575.0711111111108, 613.1311111111108, 518.2055555555551, 573.8311111111108, 561.2088888888887, 570.1044444444442, 608.1355555555555, 564.674444444444, 594.4377777777776, 607.2311111111109, 562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557, 610.5911111111111, 547.7388888888886, 603.6944444444439, 578.2088888888886, 621.1777777777777, 580.6155555555553, 581.0877777777772, 586.1966666666665, 595.4766666666665, 617.3488888888885, 584.7899999999996, 621.7444444444443, 572.093333333333, 580.2922222222222, 612.8888888888887, 560.9466666666663, 593.4988888888886, 611.36, 548.174444444444, 596.2088888888889, 554.5311111111106, 590.5122222222224, 578.5722222222219, 588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19294979418783495, "mean_inference_ms": 1.767542074464925, "mean_action_processing_ms": 0.07268366666902022, "mean_env_wait_ms": 1.1953236347974288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003828287124633789, "StateBufferConnector_ms": 0.002697467803955078, "ViewRequirementAgentConnector_ms": 0.06237912178039551}, "num_episodes": 30, "episode_return_max": 635.015555555555, "episode_return_min": 479.99777777777734, "episode_return_mean": 570.894222222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133350, "num_agent_steps_trained": 133200, "num_env_steps_sampled": 133350, "num_env_steps_trained": 133200, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 303.04912608600733, "num_env_steps_trained_throughput_per_sec": 317.4800368520077, "timesteps_total": 133350, "num_env_steps_sampled_lifetime": 133350, "num_agent_steps_sampled_lifetime": 133350, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 133350, "timers": {"training_iteration_time_ms": 10227.745, "restore_workers_time_ms": 0.011, "training_step_time_ms": 500.647, "sample_time_ms": 486.811, "synch_weights_time_ms": 12.554}, "counters": {"num_env_steps_sampled": 133350, "num_env_steps_trained": 133200, "num_agent_steps_sampled": 133350, "num_agent_steps_trained": 133200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 889, "num_samples_added_to_queue": 133200}, "done": false, "training_iteration": 44, "trial_id": "38f59_00000", "date": "2024-10-10_22-19-03", "timestamp": 1728595143, "time_this_iter_s": 10.410189867019653, "time_total_s": 449.9559555053711, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79d930>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 449.9559555053711, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 10.84, "ram_util_percent": 58.85333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 355600.15625, "policy_loss": 347679.5625, "entropy": 20.149402618408203, "entropy_coeff": 0.01, "var_gnorm": 16.384279251098633, "vf_loss": 798103.9375, "vf_explained_var": -0.004435539245605469}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 454.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 136500, "num_env_steps_trained": 136200, "num_agent_steps_sampled": 136500, "num_agent_steps_trained": 136200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 910, "num_samples_added_to_queue": 136500, "learner_queue": {"size_count": 454, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.656, "learner_load_time_ms": 0.316, "learner_load_wait_time_ms": 945.788, "learner_dequeue_time_ms": 7966.03}}, "env_runners": {"episode_reward_max": 659.9622222222221, "episode_reward_min": 479.99777777777734, "episode_reward_mean": 589.3475777777774, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 479.99777777777734}, "policy_reward_max": {"default_policy": 659.9622222222221}, "policy_reward_mean": {"default_policy": 589.3475777777774}, "custom_metrics": {"num_consolidated_mean": 1.8222999999999996, "num_consolidated_min": 1.64, "num_consolidated_max": 1.99, "num_overloaded_mean": 0.059000000000000004, "num_overloaded_min": 0.01, "num_overloaded_max": 0.14, "num_moves_mean": 7.210699999999999, "num_moves_min": 6.62, "num_moves_max": 7.82, "mean_accuracy_mean": 39.91104333333332, "mean_accuracy_min": 39.72566666666665, "mean_accuracy_max": 40.14999999999999, "num_model_switches_mean": 4.0793, "num_model_switches_min": 3.69, "num_model_switches_max": 4.5, "num_slav_mean": 0.014044166666666667, "num_slav_min": 0.0059499999999999996, "num_slav_max": 0.023283333333333333, "mean_cluster_cpu_util_mean": 0.45286528664926096, "mean_cluster_cpu_util_min": 0.44353203705880195, "mean_cluster_cpu_util_max": 0.462518625589677, "mean_cluster_mem_util_mean": 0.30111671162526193, "mean_cluster_mem_util_min": 0.2939696315551537, "mean_cluster_mem_util_max": 0.3071395165977784, "reward_consolidation_mean_mean": 2.6666888888888884, "reward_consolidation_mean_min": 2.2711111111111104, "reward_consolidation_mean_max": 2.97111111111111, "reward_illegal_mean_mean": -0.09833333333333333, "reward_illegal_mean_min": -0.2333333333333333, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.755814666666666, "reward_accuracy_mean_min": 3.4471999999999996, "reward_accuracy_mean_max": 3.9637666666666664, "reward_sla_mean_mean": -0.43069444444444444, "reward_sla_mean_min": -0.7472222222222221, "reward_sla_mean_max": -0.1711111111111111, "reward_consolidation_sum_mean": 266.66888888888883, "reward_consolidation_sum_min": 227.11111111111106, "reward_consolidation_sum_max": 297.11111111111103, "reward_illegal_sum_mean": -9.833333333333332, "reward_illegal_sum_min": -23.333333333333332, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 375.5814666666667, "reward_accuracy_sum_min": 344.71999999999997, "reward_accuracy_sum_max": 396.37666666666667, "reward_sla_sum_mean": -43.06944444444444, "reward_sla_sum_min": -74.72222222222221, "reward_sla_sum_max": -17.11111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4878.0, "global_timestep_min": 3000, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665, 565.2999999999996, 521.963333333333, 543.0077777777776, 604.5622222222219, 561.4877777777776, 604.3422222222218, 577.5555555555554, 573.115555555555, 544.4822222222218, 479.99777777777734, 591.9411111111108, 578.1366666666664, 536.9277777777774, 547.3844444444441, 593.7033333333326, 612.5299999999997, 575.0711111111108, 613.1311111111108, 518.2055555555551, 573.8311111111108, 561.2088888888887, 570.1044444444442, 608.1355555555555, 564.674444444444, 594.4377777777776, 607.2311111111109, 562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557, 610.5911111111111, 547.7388888888886, 603.6944444444439, 578.2088888888886, 621.1777777777777, 580.6155555555553, 581.0877777777772, 586.1966666666665, 595.4766666666665, 617.3488888888885, 584.7899999999996, 621.7444444444443, 572.093333333333, 580.2922222222222, 612.8888888888887, 560.9466666666663, 593.4988888888886, 611.36, 548.174444444444, 596.2088888888889, 554.5311111111106, 590.5122222222224, 578.5722222222219, 588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885, 635.0544444444441, 621.4844444444439, 569.26, 599.1966666666664, 577.3477777777775, 604.8766666666662, 622.1922222222217, 601.252222222222, 650.494444444444, 604.0099999999995, 634.1155555555555, 574.6088888888886, 652.2655555555551, 585.9011111111108, 619.7555555555554, 626.5344444444439, 560.3788888888885, 607.7299999999996, 612.8066666666664, 603.193333333333, 604.6077777777775, 626.9799999999997, 611.4866666666665, 626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [505.6611111111108, 551.7133333333328, 556.2477777777774, 616.5266666666665, 565.2999999999996, 521.963333333333, 543.0077777777776, 604.5622222222219, 561.4877777777776, 604.3422222222218, 577.5555555555554, 573.115555555555, 544.4822222222218, 479.99777777777734, 591.9411111111108, 578.1366666666664, 536.9277777777774, 547.3844444444441, 593.7033333333326, 612.5299999999997, 575.0711111111108, 613.1311111111108, 518.2055555555551, 573.8311111111108, 561.2088888888887, 570.1044444444442, 608.1355555555555, 564.674444444444, 594.4377777777776, 607.2311111111109, 562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557, 610.5911111111111, 547.7388888888886, 603.6944444444439, 578.2088888888886, 621.1777777777777, 580.6155555555553, 581.0877777777772, 586.1966666666665, 595.4766666666665, 617.3488888888885, 584.7899999999996, 621.7444444444443, 572.093333333333, 580.2922222222222, 612.8888888888887, 560.9466666666663, 593.4988888888886, 611.36, 548.174444444444, 596.2088888888889, 554.5311111111106, 590.5122222222224, 578.5722222222219, 588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885, 635.0544444444441, 621.4844444444439, 569.26, 599.1966666666664, 577.3477777777775, 604.8766666666662, 622.1922222222217, 601.252222222222, 650.494444444444, 604.0099999999995, 634.1155555555555, 574.6088888888886, 652.2655555555551, 585.9011111111108, 619.7555555555554, 626.5344444444439, 560.3788888888885, 607.7299999999996, 612.8066666666664, 603.193333333333, 604.6077777777775, 626.9799999999997, 611.4866666666665, 626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19284348710427257, "mean_inference_ms": 1.768152385793138, "mean_action_processing_ms": 0.07264055588191766, "mean_env_wait_ms": 1.1950600039554191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003674745559692383, "StateBufferConnector_ms": 0.0026695728302001953, "ViewRequirementAgentConnector_ms": 0.06153535842895508}, "num_episodes": 33, "episode_return_max": 659.9622222222221, "episode_return_min": 479.99777777777734, "episode_return_mean": 589.3475777777774, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136500, "num_agent_steps_trained": 136200, "num_env_steps_sampled": 136500, "num_env_steps_trained": 136200, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 300.5527238768512, "num_env_steps_trained_throughput_per_sec": 286.24068940652495, "timesteps_total": 136500, "num_env_steps_sampled_lifetime": 136500, "num_agent_steps_sampled_lifetime": 136500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 136500, "timers": {"training_iteration_time_ms": 10248.52, "restore_workers_time_ms": 0.011, "training_step_time_ms": 505.815, "sample_time_ms": 492.097, "synch_weights_time_ms": 12.463}, "counters": {"num_env_steps_sampled": 136500, "num_env_steps_trained": 136200, "num_agent_steps_sampled": 136500, "num_agent_steps_trained": 136200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 910, "num_samples_added_to_queue": 136500}, "done": false, "training_iteration": 45, "trial_id": "38f59_00000", "date": "2024-10-10_22-19-14", "timestamp": 1728595154, "time_this_iter_s": 10.500919103622437, "time_total_s": 460.45687460899353, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc4a30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 460.45687460899353, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 10.293333333333333, "ram_util_percent": 58.95333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 353524.46875, "policy_loss": 345085.5625, "entropy": 19.30406951904297, "entropy_coeff": 0.01, "var_gnorm": 16.399982452392578, "vf_loss": 849681.0625, "vf_explained_var": 0.002014636993408203}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 464.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 139500, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139500, "num_agent_steps_trained": 139200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 930, "num_samples_added_to_queue": 139500, "learner_queue": {"size_count": 464, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.16, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 967.07, "learner_dequeue_time_ms": 8022.828}}, "env_runners": {"episode_reward_max": 677.6044444444441, "episode_reward_min": 517.5866666666662, "episode_reward_mean": 608.0452222222219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 517.5866666666662}, "policy_reward_max": {"default_policy": 677.6044444444441}, "policy_reward_mean": {"default_policy": 608.0452222222219}, "custom_metrics": {"num_consolidated_mean": 1.8721, "num_consolidated_min": 1.66, "num_consolidated_max": 2.14, "num_overloaded_mean": 0.051699999999999996, "num_overloaded_min": 0.01, "num_overloaded_max": 0.13, "num_moves_mean": 7.0017, "num_moves_min": 6.13, "num_moves_max": 7.82, "mean_accuracy_mean": 39.88298666666665, "mean_accuracy_min": 39.62433333333332, "mean_accuracy_max": 40.14999999999999, "num_model_switches_mean": 3.988300000000001, "num_model_switches_min": 3.41, "num_model_switches_max": 4.5, "num_slav_mean": 0.012246666666666666, "num_slav_min": 0.0051666666666666675, "num_slav_max": 0.021400000000000002, "mean_cluster_cpu_util_mean": 0.4521593448439451, "mean_cluster_cpu_util_min": 0.44367428569225614, "mean_cluster_cpu_util_max": 0.464989289885013, "mean_cluster_mem_util_mean": 0.3007610052258245, "mean_cluster_mem_util_min": 0.295061498069692, "mean_cluster_mem_util_max": 0.3071395165977784, "reward_consolidation_mean_mean": 2.763288888888888, "reward_consolidation_mean_min": 2.3644444444444437, "reward_consolidation_mean_max": 3.1577777777777767, "reward_illegal_mean_mean": -0.08616666666666664, "reward_illegal_mean_min": -0.21666666666666667, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.782163333333333, "reward_accuracy_mean_min": 3.4718333333333335, "reward_accuracy_mean_max": 3.9637666666666664, "reward_sla_mean_mean": -0.3788333333333334, "reward_sla_mean_min": -0.6566666666666666, "reward_sla_mean_max": -0.1711111111111111, "reward_consolidation_sum_mean": 276.3288888888888, "reward_consolidation_sum_min": 236.44444444444437, "reward_consolidation_sum_max": 315.77777777777766, "reward_illegal_sum_mean": -8.616666666666667, "reward_illegal_sum_min": -21.666666666666668, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 378.21633333333324, "reward_accuracy_sum_min": 347.18333333333334, "reward_accuracy_sum_max": 396.37666666666667, "reward_sla_sum_mean": -37.88333333333333, "reward_sla_sum_min": -65.66666666666666, "reward_sla_sum_max": -17.11111111111111, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5867.0, "global_timestep_min": 3800, "global_timestep_max": 7500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557, 610.5911111111111, 547.7388888888886, 603.6944444444439, 578.2088888888886, 621.1777777777777, 580.6155555555553, 581.0877777777772, 586.1966666666665, 595.4766666666665, 617.3488888888885, 584.7899999999996, 621.7444444444443, 572.093333333333, 580.2922222222222, 612.8888888888887, 560.9466666666663, 593.4988888888886, 611.36, 548.174444444444, 596.2088888888889, 554.5311111111106, 590.5122222222224, 578.5722222222219, 588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885, 635.0544444444441, 621.4844444444439, 569.26, 599.1966666666664, 577.3477777777775, 604.8766666666662, 622.1922222222217, 601.252222222222, 650.494444444444, 604.0099999999995, 634.1155555555555, 574.6088888888886, 652.2655555555551, 585.9011111111108, 619.7555555555554, 626.5344444444439, 560.3788888888885, 607.7299999999996, 612.8066666666664, 603.193333333333, 604.6077777777775, 626.9799999999997, 611.4866666666665, 626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331, 611.3455555555552, 619.3755555555556, 592.0066666666663, 654.611111111111, 624.4255555555551, 677.1044444444445, 597.235555555555, 665.2066666666664, 619.5166666666667, 627.8288888888885, 629.6933333333333, 637.0688888888884, 659.3111111111107, 641.314444444444, 637.1766666666663, 641.6544444444442, 677.6044444444441, 624.5522222222221, 671.451111111111, 629.5977777777773, 655.7066666666666, 600.2466666666664, 622.5344444444441, 605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [562.5977777777773, 524.4111111111109, 581.2699999999996, 579.056666666666, 547.9488888888885, 587.9966666666667, 586.8055555555557, 610.5911111111111, 547.7388888888886, 603.6944444444439, 578.2088888888886, 621.1777777777777, 580.6155555555553, 581.0877777777772, 586.1966666666665, 595.4766666666665, 617.3488888888885, 584.7899999999996, 621.7444444444443, 572.093333333333, 580.2922222222222, 612.8888888888887, 560.9466666666663, 593.4988888888886, 611.36, 548.174444444444, 596.2088888888889, 554.5311111111106, 590.5122222222224, 578.5722222222219, 588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885, 635.0544444444441, 621.4844444444439, 569.26, 599.1966666666664, 577.3477777777775, 604.8766666666662, 622.1922222222217, 601.252222222222, 650.494444444444, 604.0099999999995, 634.1155555555555, 574.6088888888886, 652.2655555555551, 585.9011111111108, 619.7555555555554, 626.5344444444439, 560.3788888888885, 607.7299999999996, 612.8066666666664, 603.193333333333, 604.6077777777775, 626.9799999999997, 611.4866666666665, 626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331, 611.3455555555552, 619.3755555555556, 592.0066666666663, 654.611111111111, 624.4255555555551, 677.1044444444445, 597.235555555555, 665.2066666666664, 619.5166666666667, 627.8288888888885, 629.6933333333333, 637.0688888888884, 659.3111111111107, 641.314444444444, 637.1766666666663, 641.6544444444442, 677.6044444444441, 624.5522222222221, 671.451111111111, 629.5977777777773, 655.7066666666666, 600.2466666666664, 622.5344444444441, 605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19263049147335784, "mean_inference_ms": 1.7659424272976185, "mean_action_processing_ms": 0.07258471609296421, "mean_env_wait_ms": 1.1943526700437856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670215606689453, "StateBufferConnector_ms": 0.002667665481567383, "ViewRequirementAgentConnector_ms": 0.06125211715698242}, "num_episodes": 30, "episode_return_max": 677.6044444444441, "episode_return_min": 517.5866666666662, "episode_return_mean": 608.0452222222219, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139500, "num_agent_steps_trained": 139200, "num_env_steps_sampled": 139500, "num_env_steps_trained": 139200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.7233980042914, "num_env_steps_trained_throughput_per_sec": 295.7233980042914, "timesteps_total": 139500, "num_env_steps_sampled_lifetime": 139500, "num_agent_steps_sampled_lifetime": 139500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 139500, "timers": {"training_iteration_time_ms": 10230.88, "restore_workers_time_ms": 0.011, "training_step_time_ms": 520.556, "sample_time_ms": 506.906, "synch_weights_time_ms": 12.403}, "counters": {"num_env_steps_sampled": 139500, "num_env_steps_trained": 139200, "num_agent_steps_sampled": 139500, "num_agent_steps_trained": 139200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 930, "num_samples_added_to_queue": 139500}, "done": false, "training_iteration": 46, "trial_id": "38f59_00000", "date": "2024-10-10_22-19-24", "timestamp": 1728595164, "time_this_iter_s": 10.155194997787476, "time_total_s": 470.612069606781, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc19c00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.612069606781, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 10.346666666666666, "ram_util_percent": 59.08666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 329885.625, "policy_loss": 321000.34375, "entropy": 17.955360412597656, "entropy_coeff": 0.01, "var_gnorm": 16.413625717163086, "vf_loss": 893914.9375, "vf_explained_var": 0.008711099624633789}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 474.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142200, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 950, "num_samples_added_to_queue": 142500, "learner_queue": {"size_count": 474, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.244, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 958.408, "learner_dequeue_time_ms": 8069.23}}, "env_runners": {"episode_reward_max": 701.4677777777778, "episode_reward_min": 517.5866666666662, "episode_reward_mean": 633.2796444444442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 517.5866666666662}, "policy_reward_max": {"default_policy": 701.4677777777778}, "policy_reward_mean": {"default_policy": 633.2796444444442}, "custom_metrics": {"num_consolidated_mean": 1.9468000000000003, "num_consolidated_min": 1.66, "num_consolidated_max": 2.14, "num_overloaded_mean": 0.041999999999999996, "num_overloaded_min": 0.01, "num_overloaded_max": 0.13, "num_moves_mean": 6.656999999999999, "num_moves_min": 5.6, "num_moves_max": 7.55, "mean_accuracy_mean": 39.85467666666665, "mean_accuracy_min": 39.62433333333332, "mean_accuracy_max": 40.06766666666665, "num_model_switches_mean": 3.864699999999999, "num_model_switches_min": 3.35, "num_model_switches_max": 4.35, "num_slav_mean": 0.01011, "num_slav_min": 0.0026999999999999997, "num_slav_max": 0.020550000000000002, "mean_cluster_cpu_util_mean": 0.4513711993083083, "mean_cluster_cpu_util_min": 0.44367428569225614, "mean_cluster_cpu_util_max": 0.464989289885013, "mean_cluster_mem_util_mean": 0.3000561062763713, "mean_cluster_mem_util_min": 0.29577819935991273, "mean_cluster_mem_util_max": 0.3071395165977784, "reward_consolidation_mean_mean": 2.9028222222222224, "reward_consolidation_mean_min": 2.4111111111111105, "reward_consolidation_mean_max": 3.251111111111111, "reward_illegal_mean_mean": -0.06999999999999999, "reward_illegal_mean_min": -0.21666666666666667, "reward_illegal_mean_max": -0.016666666666666666, "reward_accuracy_mean_mean": 3.8177686666666664, "reward_accuracy_mean_min": 3.477533333333333, "reward_accuracy_mean_max": 3.9637666666666664, "reward_sla_mean_mean": -0.31779444444444443, "reward_sla_mean_min": -0.6294444444444445, "reward_sla_mean_max": -0.09, "reward_consolidation_sum_mean": 290.2822222222222, "reward_consolidation_sum_min": 241.11111111111106, "reward_consolidation_sum_max": 325.1111111111111, "reward_illegal_sum_mean": -7.0, "reward_illegal_sum_min": -21.666666666666668, "reward_illegal_sum_max": -1.6666666666666665, "reward_accuracy_sum_mean": 381.7768666666666, "reward_accuracy_sum_min": 347.75333333333333, "reward_accuracy_sum_max": 396.37666666666667, "reward_sla_sum_mean": -31.77944444444444, "reward_sla_sum_min": -62.94444444444444, "reward_sla_sum_max": -9.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5229.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885, 635.0544444444441, 621.4844444444439, 569.26, 599.1966666666664, 577.3477777777775, 604.8766666666662, 622.1922222222217, 601.252222222222, 650.494444444444, 604.0099999999995, 634.1155555555555, 574.6088888888886, 652.2655555555551, 585.9011111111108, 619.7555555555554, 626.5344444444439, 560.3788888888885, 607.7299999999996, 612.8066666666664, 603.193333333333, 604.6077777777775, 626.9799999999997, 611.4866666666665, 626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331, 611.3455555555552, 619.3755555555556, 592.0066666666663, 654.611111111111, 624.4255555555551, 677.1044444444445, 597.235555555555, 665.2066666666664, 619.5166666666667, 627.8288888888885, 629.6933333333333, 637.0688888888884, 659.3111111111107, 641.314444444444, 637.1766666666663, 641.6544444444442, 677.6044444444441, 624.5522222222221, 671.451111111111, 629.5977777777773, 655.7066666666666, 600.2466666666664, 622.5344444444441, 605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222, 693.1199999999997, 688.6022222222224, 665.0688888888889, 658.6611111111108, 690.7888888888887, 701.4677777777778, 683.9477777777772, 669.1755555555552, 689.6511111111109, 700.1533333333331, 636.1933333333332, 661.7966666666665, 661.9544444444441, 671.033333333333, 640.8355555555556, 662.2422222222219, 672.8733333333328, 633.4555555555552, 671.3988888888888, 696.2944444444443, 677.3033333333332, 640.8599999999996, 633.6211111111112, 643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [588.2388888888886, 586.1488888888887, 517.5866666666662, 604.7244444444441, 586.3755555555553, 635.015555555555, 598.1988888888885, 635.0544444444441, 621.4844444444439, 569.26, 599.1966666666664, 577.3477777777775, 604.8766666666662, 622.1922222222217, 601.252222222222, 650.494444444444, 604.0099999999995, 634.1155555555555, 574.6088888888886, 652.2655555555551, 585.9011111111108, 619.7555555555554, 626.5344444444439, 560.3788888888885, 607.7299999999996, 612.8066666666664, 603.193333333333, 604.6077777777775, 626.9799999999997, 611.4866666666665, 626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331, 611.3455555555552, 619.3755555555556, 592.0066666666663, 654.611111111111, 624.4255555555551, 677.1044444444445, 597.235555555555, 665.2066666666664, 619.5166666666667, 627.8288888888885, 629.6933333333333, 637.0688888888884, 659.3111111111107, 641.314444444444, 637.1766666666663, 641.6544444444442, 677.6044444444441, 624.5522222222221, 671.451111111111, 629.5977777777773, 655.7066666666666, 600.2466666666664, 622.5344444444441, 605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222, 693.1199999999997, 688.6022222222224, 665.0688888888889, 658.6611111111108, 690.7888888888887, 701.4677777777778, 683.9477777777772, 669.1755555555552, 689.6511111111109, 700.1533333333331, 636.1933333333332, 661.7966666666665, 661.9544444444441, 671.033333333333, 640.8355555555556, 662.2422222222219, 672.8733333333328, 633.4555555555552, 671.3988888888888, 696.2944444444443, 677.3033333333332, 640.8599999999996, 633.6211111111112, 643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.192532208917131, "mean_inference_ms": 1.766029664523428, "mean_action_processing_ms": 0.0725601555994799, "mean_env_wait_ms": 1.1942432078043015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707408905029297, "StateBufferConnector_ms": 0.002681255340576172, "ViewRequirementAgentConnector_ms": 0.0618891716003418}, "num_episodes": 30, "episode_return_max": 701.4677777777778, "episode_return_min": 517.5866666666662, "episode_return_mean": 633.2796444444442, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142200, "num_env_steps_sampled": 142500, "num_env_steps_trained": 142200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.3730535343472, "num_env_steps_trained_throughput_per_sec": 294.3730535343472, "timesteps_total": 142500, "num_env_steps_sampled_lifetime": 142500, "num_agent_steps_sampled_lifetime": 142500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 142500, "timers": {"training_iteration_time_ms": 10234.342, "restore_workers_time_ms": 0.011, "training_step_time_ms": 501.092, "sample_time_ms": 487.411, "synch_weights_time_ms": 12.349}, "counters": {"num_env_steps_sampled": 142500, "num_env_steps_trained": 142200, "num_agent_steps_sampled": 142500, "num_agent_steps_trained": 142200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 950, "num_samples_added_to_queue": 142500}, "done": false, "training_iteration": 47, "trial_id": "38f59_00000", "date": "2024-10-10_22-19-34", "timestamp": 1728595174, "time_this_iter_s": 10.202253341674805, "time_total_s": 480.8143229484558, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcef20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 480.8143229484558, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 11.457142857142857, "ram_util_percent": 59.28571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 310287.375, "policy_loss": 301443.46875, "entropy": 17.13593101501465, "entropy_coeff": 0.01, "var_gnorm": 16.422157287597656, "vf_loss": 889532.3125, "vf_explained_var": 0.01702219247817993}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 485.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 145650, "num_env_steps_trained": 145500, "num_agent_steps_sampled": 145650, "num_agent_steps_trained": 145500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 971, "num_samples_added_to_queue": 145500, "learner_queue": {"size_count": 485, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.747, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 912.507, "learner_dequeue_time_ms": 8069.596}}, "env_runners": {"episode_reward_max": 723.9588888888889, "episode_reward_min": 569.8911111111106, "episode_reward_mean": 657.7214333333329, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 569.8911111111106}, "policy_reward_max": {"default_policy": 723.9588888888889}, "policy_reward_mean": {"default_policy": 657.7214333333329}, "custom_metrics": {"num_consolidated_mean": 2.0346, "num_consolidated_min": 1.82, "num_consolidated_max": 2.27, "num_overloaded_mean": 0.0365, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 6.2709, "num_moves_min": 5.37, "num_moves_max": 7.41, "mean_accuracy_mean": 39.84061666666665, "mean_accuracy_min": 39.60533333333331, "mean_accuracy_max": 40.06766666666665, "num_model_switches_mean": 3.7128999999999994, "num_model_switches_min": 3.03, "num_model_switches_max": 4.16, "num_slav_mean": 0.007846166666666668, "num_slav_min": 0.0019666666666666665, "num_slav_max": 0.01505, "mean_cluster_cpu_util_mean": 0.45211593851356713, "mean_cluster_cpu_util_min": 0.44367428569225614, "mean_cluster_cpu_util_max": 0.46598800047536165, "mean_cluster_mem_util_mean": 0.3001651784350871, "mean_cluster_mem_util_min": 0.29577819935991273, "mean_cluster_mem_util_max": 0.3086032637633112, "reward_consolidation_mean_mean": 3.0493555555555543, "reward_consolidation_mean_min": 2.6444444444444435, "reward_consolidation_mean_max": 3.453333333333332, "reward_illegal_mean_mean": -0.06083333333333333, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.8383976666666673, "reward_accuracy_mean_min": 3.5761333333333334, "reward_accuracy_mean_max": 3.989033333333333, "reward_sla_mean_mean": -0.24970555555555557, "reward_sla_mean_min": -0.4922222222222222, "reward_sla_mean_max": -0.06333333333333332, "reward_consolidation_sum_mean": 304.9355555555555, "reward_consolidation_sum_min": 264.44444444444434, "reward_consolidation_sum_max": 345.3333333333332, "reward_illegal_sum_mean": -6.083333333333332, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 383.8397666666665, "reward_accuracy_sum_min": 357.61333333333334, "reward_accuracy_sum_max": 398.9033333333333, "reward_sla_sum_mean": -24.970555555555553, "reward_sla_sum_min": -49.22222222222222, "reward_sla_sum_max": -6.333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3872.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331, 611.3455555555552, 619.3755555555556, 592.0066666666663, 654.611111111111, 624.4255555555551, 677.1044444444445, 597.235555555555, 665.2066666666664, 619.5166666666667, 627.8288888888885, 629.6933333333333, 637.0688888888884, 659.3111111111107, 641.314444444444, 637.1766666666663, 641.6544444444442, 677.6044444444441, 624.5522222222221, 671.451111111111, 629.5977777777773, 655.7066666666666, 600.2466666666664, 622.5344444444441, 605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222, 693.1199999999997, 688.6022222222224, 665.0688888888889, 658.6611111111108, 690.7888888888887, 701.4677777777778, 683.9477777777772, 669.1755555555552, 689.6511111111109, 700.1533333333331, 636.1933333333332, 661.7966666666665, 661.9544444444441, 671.033333333333, 640.8355555555556, 662.2422222222219, 672.8733333333328, 633.4555555555552, 671.3988888888888, 696.2944444444443, 677.3033333333332, 640.8599999999996, 633.6211111111112, 643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221, 690.7255555555552, 664.5455555555553, 720.2566666666664, 674.8577777777778, 682.2866666666664, 642.0511111111106, 703.6055555555553, 723.9588888888889, 656.2911111111108, 671.7577777777774, 706.3877777777775, 684.7555555555554, 689.612222222222, 688.4611111111108, 696.4777777777774, 698.2544444444442, 700.764444444444, 707.204444444444, 654.9188888888884, 698.2633333333329, 644.8699999999995, 684.0655555555552, 703.2288888888888, 659.2066666666663, 688.5577777777775, 647.2977777777775, 710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [626.533333333333, 594.1333333333329, 625.7633333333329, 637.645555555555, 592.3499999999995, 625.1344444444443, 635.9233333333328, 625.0422222222217, 659.9622222222221, 639.9933333333331, 611.3455555555552, 619.3755555555556, 592.0066666666663, 654.611111111111, 624.4255555555551, 677.1044444444445, 597.235555555555, 665.2066666666664, 619.5166666666667, 627.8288888888885, 629.6933333333333, 637.0688888888884, 659.3111111111107, 641.314444444444, 637.1766666666663, 641.6544444444442, 677.6044444444441, 624.5522222222221, 671.451111111111, 629.5977777777773, 655.7066666666666, 600.2466666666664, 622.5344444444441, 605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222, 693.1199999999997, 688.6022222222224, 665.0688888888889, 658.6611111111108, 690.7888888888887, 701.4677777777778, 683.9477777777772, 669.1755555555552, 689.6511111111109, 700.1533333333331, 636.1933333333332, 661.7966666666665, 661.9544444444441, 671.033333333333, 640.8355555555556, 662.2422222222219, 672.8733333333328, 633.4555555555552, 671.3988888888888, 696.2944444444443, 677.3033333333332, 640.8599999999996, 633.6211111111112, 643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221, 690.7255555555552, 664.5455555555553, 720.2566666666664, 674.8577777777778, 682.2866666666664, 642.0511111111106, 703.6055555555553, 723.9588888888889, 656.2911111111108, 671.7577777777774, 706.3877777777775, 684.7555555555554, 689.612222222222, 688.4611111111108, 696.4777777777774, 698.2544444444442, 700.764444444444, 707.204444444444, 654.9188888888884, 698.2633333333329, 644.8699999999995, 684.0655555555552, 703.2288888888888, 659.2066666666663, 688.5577777777775, 647.2977777777775, 710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19233741344926458, "mean_inference_ms": 1.7637765611463443, "mean_action_processing_ms": 0.07250931822620427, "mean_env_wait_ms": 1.1935444510862927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036382675170898438, "StateBufferConnector_ms": 0.0026590824127197266, "ViewRequirementAgentConnector_ms": 0.06086277961730957}, "num_episodes": 30, "episode_return_max": 723.9588888888889, "episode_return_min": 569.8911111111106, "episode_return_mean": 657.7214333333329, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145650, "num_agent_steps_trained": 145500, "num_env_steps_sampled": 145650, "num_env_steps_trained": 145500, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 310.2665077172234, "num_env_steps_trained_throughput_per_sec": 325.0411033228055, "timesteps_total": 145650, "num_env_steps_sampled_lifetime": 145650, "num_agent_steps_sampled_lifetime": 145650, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 145650, "timers": {"training_iteration_time_ms": 10218.865, "restore_workers_time_ms": 0.011, "training_step_time_ms": 477.901, "sample_time_ms": 464.628, "synch_weights_time_ms": 12.009}, "counters": {"num_env_steps_sampled": 145650, "num_env_steps_trained": 145500, "num_agent_steps_sampled": 145650, "num_agent_steps_trained": 145500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 971, "num_samples_added_to_queue": 145500}, "done": false, "training_iteration": 48, "trial_id": "38f59_00000", "date": "2024-10-10_22-19-45", "timestamp": 1728595185, "time_this_iter_s": 10.169091939926147, "time_total_s": 490.98341488838196, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79cbe0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 490.98341488838196, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 10.379999999999999, "ram_util_percent": 59.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 321586.34375, "policy_loss": 312258.15625, "entropy": 17.27204704284668, "entropy_coeff": 0.01, "var_gnorm": 16.432147979736328, "vf_loss": 938001.25, "vf_explained_var": 0.023244917392730713}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 495.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 148800, "num_env_steps_trained": 148500, "num_agent_steps_sampled": 148800, "num_agent_steps_trained": 148500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 992, "num_samples_added_to_queue": 148800, "learner_queue": {"size_count": 495, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.532, "learner_load_time_ms": 0.266, "learner_load_wait_time_ms": 904.56, "learner_dequeue_time_ms": 7977.347}}, "env_runners": {"episode_reward_max": 741.2844444444443, "episode_reward_min": 569.8911111111106, "episode_reward_mean": 677.8260555555552, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 569.8911111111106}, "policy_reward_max": {"default_policy": 741.2844444444443}, "policy_reward_mean": {"default_policy": 677.8260555555552}, "custom_metrics": {"num_consolidated_mean": 2.1031000000000004, "num_consolidated_min": 1.86, "num_consolidated_max": 2.35, "num_overloaded_mean": 0.0288, "num_overloaded_min": 0.0, "num_overloaded_max": 0.1, "num_moves_mean": 5.9152999999999984, "num_moves_min": 5.2, "num_moves_max": 6.85, "mean_accuracy_mean": 39.864303333333325, "mean_accuracy_min": 39.60533333333331, "mean_accuracy_max": 40.08033333333332, "num_model_switches_mean": 3.6066999999999996, "num_model_switches_min": 3.03, "num_model_switches_max": 4.16, "num_slav_mean": 0.006795333333333335, "num_slav_min": 0.0019666666666666665, "num_slav_max": 0.014766666666666666, "mean_cluster_cpu_util_mean": 0.4530519987654528, "mean_cluster_cpu_util_min": 0.4409856040636042, "mean_cluster_cpu_util_max": 0.46598800047536165, "mean_cluster_mem_util_mean": 0.3005940322214328, "mean_cluster_mem_util_min": 0.2940814464393353, "mean_cluster_mem_util_max": 0.3086032637633112, "reward_consolidation_mean_mean": 3.1751999999999985, "reward_consolidation_mean_min": 2.659999999999999, "reward_consolidation_mean_max": 3.624444444444443, "reward_illegal_mean_mean": -0.048, "reward_illegal_mean_min": -0.16666666666666663, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.871305, "reward_accuracy_mean_min": 3.5761333333333334, "reward_accuracy_mean_max": 3.9934666666666665, "reward_sla_mean_mean": -0.22024444444444444, "reward_sla_mean_min": -0.4922222222222222, "reward_sla_mean_max": -0.06333333333333332, "reward_consolidation_sum_mean": 317.51999999999987, "reward_consolidation_sum_min": 265.9999999999999, "reward_consolidation_sum_max": 362.4444444444443, "reward_illegal_sum_mean": -4.8, "reward_illegal_sum_min": -16.666666666666664, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 387.1305, "reward_accuracy_sum_min": 357.61333333333334, "reward_accuracy_sum_max": 399.34666666666664, "reward_sla_sum_mean": -22.024444444444445, "reward_sla_sum_min": -49.22222222222222, "reward_sla_sum_max": -6.333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2415.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222, 693.1199999999997, 688.6022222222224, 665.0688888888889, 658.6611111111108, 690.7888888888887, 701.4677777777778, 683.9477777777772, 669.1755555555552, 689.6511111111109, 700.1533333333331, 636.1933333333332, 661.7966666666665, 661.9544444444441, 671.033333333333, 640.8355555555556, 662.2422222222219, 672.8733333333328, 633.4555555555552, 671.3988888888888, 696.2944444444443, 677.3033333333332, 640.8599999999996, 633.6211111111112, 643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221, 690.7255555555552, 664.5455555555553, 720.2566666666664, 674.8577777777778, 682.2866666666664, 642.0511111111106, 703.6055555555553, 723.9588888888889, 656.2911111111108, 671.7577777777774, 706.3877777777775, 684.7555555555554, 689.612222222222, 688.4611111111108, 696.4777777777774, 698.2544444444442, 700.764444444444, 707.204444444444, 654.9188888888884, 698.2633333333329, 644.8699999999995, 684.0655555555552, 703.2288888888888, 659.2066666666663, 688.5577777777775, 647.2977777777775, 710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444, 719.1499999999995, 689.4499999999996, 705.5944444444445, 705.0722222222221, 741.2844444444443, 708.4422222222219, 676.2611111111107, 688.4255555555552, 694.402222222222, 680.6822222222219, 676.7022222222217, 694.6999999999997, 684.6844444444442, 707.181111111111, 674.8055555555553, 696.0988888888887, 666.0433333333331, 698.4055555555555, 688.2399999999994, 675.5888888888886, 682.513333333333, 691.8566666666663, 678.6888888888886, 647.7299999999997, 685.9966666666664, 715.7977777777775, 718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [605.8311111111109, 637.5922222222223, 640.1422222222219, 569.8911111111106, 585.4344444444441, 611.1099999999994, 655.812222222222, 693.1199999999997, 688.6022222222224, 665.0688888888889, 658.6611111111108, 690.7888888888887, 701.4677777777778, 683.9477777777772, 669.1755555555552, 689.6511111111109, 700.1533333333331, 636.1933333333332, 661.7966666666665, 661.9544444444441, 671.033333333333, 640.8355555555556, 662.2422222222219, 672.8733333333328, 633.4555555555552, 671.3988888888888, 696.2944444444443, 677.3033333333332, 640.8599999999996, 633.6211111111112, 643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221, 690.7255555555552, 664.5455555555553, 720.2566666666664, 674.8577777777778, 682.2866666666664, 642.0511111111106, 703.6055555555553, 723.9588888888889, 656.2911111111108, 671.7577777777774, 706.3877777777775, 684.7555555555554, 689.612222222222, 688.4611111111108, 696.4777777777774, 698.2544444444442, 700.764444444444, 707.204444444444, 654.9188888888884, 698.2633333333329, 644.8699999999995, 684.0655555555552, 703.2288888888888, 659.2066666666663, 688.5577777777775, 647.2977777777775, 710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444, 719.1499999999995, 689.4499999999996, 705.5944444444445, 705.0722222222221, 741.2844444444443, 708.4422222222219, 676.2611111111107, 688.4255555555552, 694.402222222222, 680.6822222222219, 676.7022222222217, 694.6999999999997, 684.6844444444442, 707.181111111111, 674.8055555555553, 696.0988888888887, 666.0433333333331, 698.4055555555555, 688.2399999999994, 675.5888888888886, 682.513333333333, 691.8566666666663, 678.6888888888886, 647.7299999999997, 685.9966666666664, 715.7977777777775, 718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19225178810485768, "mean_inference_ms": 1.7642652045819238, "mean_action_processing_ms": 0.07247690226232498, "mean_env_wait_ms": 1.1933411107899639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003632783889770508, "StateBufferConnector_ms": 0.0026171207427978516, "ViewRequirementAgentConnector_ms": 0.06057429313659668}, "num_episodes": 33, "episode_return_max": 741.2844444444443, "episode_return_min": 569.8911111111106, "episode_return_mean": 677.8260555555552, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148800, "num_agent_steps_trained": 148500, "num_env_steps_sampled": 148800, "num_env_steps_trained": 148500, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 313.41596674218476, "num_env_steps_trained_throughput_per_sec": 298.4913968973188, "timesteps_total": 148800, "num_env_steps_sampled_lifetime": 148800, "num_agent_steps_sampled_lifetime": 148800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 148800, "timers": {"training_iteration_time_ms": 10202.288, "restore_workers_time_ms": 0.011, "training_step_time_ms": 478.352, "sample_time_ms": 464.065, "synch_weights_time_ms": 13.01}, "counters": {"num_env_steps_sampled": 148800, "num_env_steps_trained": 148500, "num_agent_steps_sampled": 148800, "num_agent_steps_trained": 148500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 992, "num_samples_added_to_queue": 148800}, "done": false, "training_iteration": 49, "trial_id": "38f59_00000", "date": "2024-10-10_22-19-55", "timestamp": 1728595195, "time_this_iter_s": 10.060292720794678, "time_total_s": 501.04370760917664, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1bf40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 501.04370760917664, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 10.87142857142857, "ram_util_percent": 59.64285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 309069.0, "policy_loss": 299649.78125, "entropy": 16.890789031982422, "entropy_coeff": 0.01, "var_gnorm": 16.4399356842041, "vf_loss": 946990.0, "vf_explained_var": 0.03079742193222046}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 506.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 151950, "num_env_steps_trained": 151800, "num_agent_steps_sampled": 151950, "num_agent_steps_trained": 151800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1013, "num_samples_added_to_queue": 151800, "learner_queue": {"size_count": 506, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.062, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 908.896, "learner_dequeue_time_ms": 7908.95}}, "env_runners": {"episode_reward_max": 741.2844444444443, "episode_reward_min": 642.0511111111106, "episode_reward_mean": 690.5798333333332, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 642.0511111111106}, "policy_reward_max": {"default_policy": 741.2844444444443}, "policy_reward_mean": {"default_policy": 690.5798333333332}, "custom_metrics": {"num_consolidated_mean": 2.1428, "num_consolidated_min": 1.98, "num_consolidated_max": 2.35, "num_overloaded_mean": 0.024700000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 5.6662, "num_moves_min": 4.92, "num_moves_max": 6.18, "mean_accuracy_mean": 39.904456666666654, "mean_accuracy_min": 39.60533333333331, "mean_accuracy_max": 40.08033333333332, "num_model_switches_mean": 3.5025999999999997, "num_model_switches_min": 3.03, "num_model_switches_max": 3.96, "num_slav_mean": 0.005855166666666666, "num_slav_min": 0.0015666666666666667, "num_slav_max": 0.013466666666666665, "mean_cluster_cpu_util_mean": 0.4535433593447095, "mean_cluster_cpu_util_min": 0.4409856040636042, "mean_cluster_cpu_util_max": 0.46598800047536165, "mean_cluster_mem_util_mean": 0.30088215408557933, "mean_cluster_mem_util_min": 0.2940814464393353, "mean_cluster_mem_util_max": 0.3086032637633112, "reward_consolidation_mean_mean": 3.2458222222222215, "reward_consolidation_mean_min": 2.955555555555555, "reward_consolidation_mean_max": 3.624444444444443, "reward_illegal_mean_mean": -0.041166666666666664, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.891531666666667, "reward_accuracy_mean_min": 3.7051333333333334, "reward_accuracy_mean_max": 3.9934666666666665, "reward_sla_mean_mean": -0.19038888888888889, "reward_sla_mean_min": -0.44888888888888895, "reward_sla_mean_max": -0.052222222222222225, "reward_consolidation_sum_mean": 324.58222222222213, "reward_consolidation_sum_min": 295.5555555555555, "reward_consolidation_sum_max": 362.4444444444443, "reward_illegal_sum_mean": -4.116666666666667, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 389.1531666666666, "reward_accuracy_sum_min": 370.5133333333333, "reward_accuracy_sum_max": 399.34666666666664, "reward_sla_sum_mean": -19.038888888888888, "reward_sla_sum_min": -44.88888888888889, "reward_sla_sum_max": -5.222222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2167.0, "global_timestep_min": 100, "global_timestep_max": 3800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221, 690.7255555555552, 664.5455555555553, 720.2566666666664, 674.8577777777778, 682.2866666666664, 642.0511111111106, 703.6055555555553, 723.9588888888889, 656.2911111111108, 671.7577777777774, 706.3877777777775, 684.7555555555554, 689.612222222222, 688.4611111111108, 696.4777777777774, 698.2544444444442, 700.764444444444, 707.204444444444, 654.9188888888884, 698.2633333333329, 644.8699999999995, 684.0655555555552, 703.2288888888888, 659.2066666666663, 688.5577777777775, 647.2977777777775, 710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444, 719.1499999999995, 689.4499999999996, 705.5944444444445, 705.0722222222221, 741.2844444444443, 708.4422222222219, 676.2611111111107, 688.4255555555552, 694.402222222222, 680.6822222222219, 676.7022222222217, 694.6999999999997, 684.6844444444442, 707.181111111111, 674.8055555555553, 696.0988888888887, 666.0433333333331, 698.4055555555555, 688.2399999999994, 675.5888888888886, 682.513333333333, 691.8566666666663, 678.6888888888886, 647.7299999999997, 685.9966666666664, 715.7977777777775, 718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333, 722.4899999999996, 680.5833333333331, 711.3611111111109, 674.2999999999997, 694.6666666666663, 683.642222222222, 719.2355555555555, 676.9466666666666, 699.627777777777, 695.9822222222219, 723.5211111111107, 662.2077777777777, 723.9588888888885, 692.8566666666662, 706.7033333333334, 718.4344444444445, 726.4711111111108, 707.9755555555555, 684.902222222222, 694.531111111111, 702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [643.0088888888887, 659.0622222222215, 663.4644444444442, 685.8188888888886, 662.9855555555553, 662.4077777777773, 644.0322222222221, 690.7255555555552, 664.5455555555553, 720.2566666666664, 674.8577777777778, 682.2866666666664, 642.0511111111106, 703.6055555555553, 723.9588888888889, 656.2911111111108, 671.7577777777774, 706.3877777777775, 684.7555555555554, 689.612222222222, 688.4611111111108, 696.4777777777774, 698.2544444444442, 700.764444444444, 707.204444444444, 654.9188888888884, 698.2633333333329, 644.8699999999995, 684.0655555555552, 703.2288888888888, 659.2066666666663, 688.5577777777775, 647.2977777777775, 710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444, 719.1499999999995, 689.4499999999996, 705.5944444444445, 705.0722222222221, 741.2844444444443, 708.4422222222219, 676.2611111111107, 688.4255555555552, 694.402222222222, 680.6822222222219, 676.7022222222217, 694.6999999999997, 684.6844444444442, 707.181111111111, 674.8055555555553, 696.0988888888887, 666.0433333333331, 698.4055555555555, 688.2399999999994, 675.5888888888886, 682.513333333333, 691.8566666666663, 678.6888888888886, 647.7299999999997, 685.9966666666664, 715.7977777777775, 718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333, 722.4899999999996, 680.5833333333331, 711.3611111111109, 674.2999999999997, 694.6666666666663, 683.642222222222, 719.2355555555555, 676.9466666666666, 699.627777777777, 695.9822222222219, 723.5211111111107, 662.2077777777777, 723.9588888888885, 692.8566666666662, 706.7033333333334, 718.4344444444445, 726.4711111111108, 707.9755555555555, 684.902222222222, 694.531111111111, 702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19210444507622654, "mean_inference_ms": 1.7621453658962063, "mean_action_processing_ms": 0.07241501470939164, "mean_env_wait_ms": 1.1924858434037207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003789186477661133, "StateBufferConnector_ms": 0.0026047229766845703, "ViewRequirementAgentConnector_ms": 0.05951070785522461}, "num_episodes": 30, "episode_return_max": 741.2844444444443, "episode_return_min": 642.0511111111106, "episode_return_mean": 690.5798333333332, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151950, "num_agent_steps_trained": 151800, "num_env_steps_sampled": 151950, "num_env_steps_trained": 151800, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 313.18633899092237, "num_env_steps_trained_throughput_per_sec": 328.0999741809663, "timesteps_total": 151950, "num_env_steps_sampled_lifetime": 151950, "num_agent_steps_sampled_lifetime": 151950, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 151950, "timers": {"training_iteration_time_ms": 10189.115, "restore_workers_time_ms": 0.012, "training_step_time_ms": 472.571, "sample_time_ms": 458.923, "synch_weights_time_ms": 12.374}, "counters": {"num_env_steps_sampled": 151950, "num_env_steps_trained": 151800, "num_agent_steps_sampled": 151950, "num_agent_steps_trained": 151800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1013, "num_samples_added_to_queue": 151800}, "done": false, "training_iteration": 50, "trial_id": "38f59_00000", "date": "2024-10-10_22-20-05", "timestamp": 1728595205, "time_this_iter_s": 10.066617250442505, "time_total_s": 511.11032485961914, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79f910>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.11032485961914, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 10.513333333333332, "ram_util_percent": 59.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 294861.3125, "policy_loss": 285464.6875, "entropy": 16.297569274902344, "entropy_coeff": 0.01, "var_gnorm": 16.449684143066406, "vf_loss": 944552.4375, "vf_explained_var": 0.037341296672821045}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 516.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 155100, "num_env_steps_trained": 154800, "num_agent_steps_sampled": 155100, "num_agent_steps_trained": 154800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1034, "num_samples_added_to_queue": 155100, "learner_queue": {"size_count": 516, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.959, "learner_load_time_ms": 0.247, "learner_load_wait_time_ms": 909.428, "learner_dequeue_time_ms": 7912.796}}, "env_runners": {"episode_reward_max": 741.2844444444443, "episode_reward_min": 647.7299999999997, "episode_reward_mean": 700.5763999999997, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 647.7299999999997}, "policy_reward_max": {"default_policy": 741.2844444444443}, "policy_reward_mean": {"default_policy": 700.5763999999997}, "custom_metrics": {"num_consolidated_mean": 2.1668000000000003, "num_consolidated_min": 1.99, "num_consolidated_max": 2.35, "num_overloaded_mean": 0.0199, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 5.4475, "num_moves_min": 4.87, "num_moves_max": 6.14, "mean_accuracy_mean": 39.98032999999999, "mean_accuracy_min": 39.71933333333332, "mean_accuracy_max": 40.25133333333333, "num_model_switches_mean": 3.4160999999999997, "num_model_switches_min": 2.88, "num_model_switches_max": 3.92, "num_slav_mean": 0.005529333333333334, "num_slav_min": 0.0015666666666666667, "num_slav_max": 0.011516666666666666, "mean_cluster_cpu_util_mean": 0.4535655089006475, "mean_cluster_cpu_util_min": 0.4409856040636042, "mean_cluster_cpu_util_max": 0.46334627465938766, "mean_cluster_mem_util_mean": 0.3008863889660294, "mean_cluster_mem_util_min": 0.2925826826616722, "mean_cluster_mem_util_max": 0.3073253971841901, "reward_consolidation_mean_mean": 3.3010444444444436, "reward_consolidation_mean_min": 3.064444444444444, "reward_consolidation_mean_max": 3.624444444444443, "reward_illegal_mean_mean": -0.033166666666666664, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.918080666666666, "reward_accuracy_mean_min": 3.7273, "reward_accuracy_mean_max": 4.009933333333334, "reward_sla_mean_mean": -0.18019444444444446, "reward_sla_mean_min": -0.38388888888888884, "reward_sla_mean_max": -0.052222222222222225, "reward_consolidation_sum_mean": 330.10444444444437, "reward_consolidation_sum_min": 306.4444444444444, "reward_consolidation_sum_max": 362.4444444444443, "reward_illegal_sum_mean": -3.316666666666667, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 391.80806666666666, "reward_accuracy_sum_min": 372.73, "reward_accuracy_sum_max": 400.99333333333334, "reward_sla_sum_mean": -18.019444444444446, "reward_sla_sum_min": -38.388888888888886, "reward_sla_sum_max": -5.222222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3278.0, "global_timestep_min": 1400, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444, 719.1499999999995, 689.4499999999996, 705.5944444444445, 705.0722222222221, 741.2844444444443, 708.4422222222219, 676.2611111111107, 688.4255555555552, 694.402222222222, 680.6822222222219, 676.7022222222217, 694.6999999999997, 684.6844444444442, 707.181111111111, 674.8055555555553, 696.0988888888887, 666.0433333333331, 698.4055555555555, 688.2399999999994, 675.5888888888886, 682.513333333333, 691.8566666666663, 678.6888888888886, 647.7299999999997, 685.9966666666664, 715.7977777777775, 718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333, 722.4899999999996, 680.5833333333331, 711.3611111111109, 674.2999999999997, 694.6666666666663, 683.642222222222, 719.2355555555555, 676.9466666666666, 699.627777777777, 695.9822222222219, 723.5211111111107, 662.2077777777777, 723.9588888888885, 692.8566666666662, 706.7033333333334, 718.4344444444445, 726.4711111111108, 707.9755555555555, 684.902222222222, 694.531111111111, 702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223, 698.1788888888889, 725.6044444444447, 683.9499999999997, 725.3688888888885, 717.3933333333332, 707.7544444444441, 713.171111111111, 718.4844444444442, 700.8699999999999, 716.3911111111112, 678.7411111111111, 697.6366666666667, 696.9666666666667, 730.7455555555551, 706.69, 703.9155555555551, 706.4988888888885, 717.1133333333332, 712.541111111111, 706.3977777777774, 701.5822222222221, 711.2977777777775, 697.3377777777775, 693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [710.8955555555553, 669.6399999999999, 686.1777777777777, 716.6244444444444, 719.1499999999995, 689.4499999999996, 705.5944444444445, 705.0722222222221, 741.2844444444443, 708.4422222222219, 676.2611111111107, 688.4255555555552, 694.402222222222, 680.6822222222219, 676.7022222222217, 694.6999999999997, 684.6844444444442, 707.181111111111, 674.8055555555553, 696.0988888888887, 666.0433333333331, 698.4055555555555, 688.2399999999994, 675.5888888888886, 682.513333333333, 691.8566666666663, 678.6888888888886, 647.7299999999997, 685.9966666666664, 715.7977777777775, 718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333, 722.4899999999996, 680.5833333333331, 711.3611111111109, 674.2999999999997, 694.6666666666663, 683.642222222222, 719.2355555555555, 676.9466666666666, 699.627777777777, 695.9822222222219, 723.5211111111107, 662.2077777777777, 723.9588888888885, 692.8566666666662, 706.7033333333334, 718.4344444444445, 726.4711111111108, 707.9755555555555, 684.902222222222, 694.531111111111, 702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223, 698.1788888888889, 725.6044444444447, 683.9499999999997, 725.3688888888885, 717.3933333333332, 707.7544444444441, 713.171111111111, 718.4844444444442, 700.8699999999999, 716.3911111111112, 678.7411111111111, 697.6366666666667, 696.9666666666667, 730.7455555555551, 706.69, 703.9155555555551, 706.4988888888885, 717.1133333333332, 712.541111111111, 706.3977777777774, 701.5822222222221, 711.2977777777775, 697.3377777777775, 693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19200238811867082, "mean_inference_ms": 1.7617497299913345, "mean_action_processing_ms": 0.07236051123461675, "mean_env_wait_ms": 1.1919097700348735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962039947509766, "StateBufferConnector_ms": 0.0026445388793945312, "ViewRequirementAgentConnector_ms": 0.05963277816772461}, "num_episodes": 33, "episode_return_max": 741.2844444444443, "episode_return_min": 647.7299999999997, "episode_return_mean": 700.5763999999997, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155100, "num_agent_steps_trained": 154800, "num_env_steps_sampled": 155100, "num_env_steps_trained": 154800, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 308.7624782778177, "num_env_steps_trained_throughput_per_sec": 294.05950312173115, "timesteps_total": 155100, "num_env_steps_sampled_lifetime": 155100, "num_agent_steps_sampled_lifetime": 155100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 155100, "timers": {"training_iteration_time_ms": 10191.719, "restore_workers_time_ms": 0.012, "training_step_time_ms": 481.143, "sample_time_ms": 467.555, "synch_weights_time_ms": 12.277}, "counters": {"num_env_steps_sampled": 155100, "num_env_steps_trained": 154800, "num_agent_steps_sampled": 155100, "num_agent_steps_trained": 154800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1034, "num_samples_added_to_queue": 155100}, "done": false, "training_iteration": 51, "trial_id": "38f59_00000", "date": "2024-10-10_22-20-15", "timestamp": 1728595215, "time_this_iter_s": 10.212238550186157, "time_total_s": 521.3225634098053, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1e79c610>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 521.3225634098053, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 10.492857142857144, "ram_util_percent": 58.878571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 267018.90625, "policy_loss": 258575.78125, "entropy": 15.362740516662598, "entropy_coeff": 0.01, "var_gnorm": 16.46488380432129, "vf_loss": 848921.4375, "vf_explained_var": 0.047554194927215576}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 526.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 158100, "num_env_steps_trained": 157800, "num_agent_steps_sampled": 158100, "num_agent_steps_trained": 157800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1054, "num_samples_added_to_queue": 158100, "learner_queue": {"size_count": 526, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.562, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 954.128, "learner_dequeue_time_ms": 7919.858}}, "env_runners": {"episode_reward_max": 754.0766666666667, "episode_reward_min": 662.2077777777777, "episode_reward_mean": 710.087722222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 662.2077777777777}, "policy_reward_max": {"default_policy": 754.0766666666667}, "policy_reward_mean": {"default_policy": 710.087722222222}, "custom_metrics": {"num_consolidated_mean": 2.1981, "num_consolidated_min": 2.01, "num_consolidated_max": 2.39, "num_overloaded_mean": 0.016900000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 5.1764, "num_moves_min": 4.39, "num_moves_max": 6.14, "mean_accuracy_mean": 40.054999999999986, "mean_accuracy_min": 39.79533333333332, "mean_accuracy_max": 40.416, "num_model_switches_mean": 3.299, "num_model_switches_min": 2.85, "num_model_switches_max": 3.82, "num_slav_mean": 0.005087166666666667, "num_slav_min": 0.0015666666666666667, "num_slav_max": 0.010166666666666666, "mean_cluster_cpu_util_mean": 0.4542653506383386, "mean_cluster_cpu_util_min": 0.44230212377539585, "mean_cluster_cpu_util_max": 0.46334627465938766, "mean_cluster_mem_util_mean": 0.3012043331934039, "mean_cluster_mem_util_min": 0.2925826826616722, "mean_cluster_mem_util_max": 0.3073253971841901, "reward_consolidation_mean_mean": 3.357666666666666, "reward_consolidation_mean_min": 3.064444444444444, "reward_consolidation_mean_max": 3.6711111111111103, "reward_illegal_mean_mean": -0.028166666666666663, "reward_illegal_mean_min": -0.1, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.937421666666667, "reward_accuracy_mean_min": 3.7626999999999997, "reward_accuracy_mean_max": 4.0416, "reward_sla_mean_mean": -0.16604444444444444, "reward_sla_mean_min": -0.33888888888888885, "reward_sla_mean_max": -0.052222222222222225, "reward_consolidation_sum_mean": 335.7666666666666, "reward_consolidation_sum_min": 306.4444444444444, "reward_consolidation_sum_max": 367.11111111111103, "reward_illegal_sum_mean": -2.816666666666667, "reward_illegal_sum_min": -10.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 393.7421666666666, "reward_accuracy_sum_min": 376.27, "reward_accuracy_sum_max": 404.16, "reward_sla_sum_mean": -16.604444444444447, "reward_sla_sum_min": -33.888888888888886, "reward_sla_sum_max": -5.222222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4267.0, "global_timestep_min": 2200, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333, 722.4899999999996, 680.5833333333331, 711.3611111111109, 674.2999999999997, 694.6666666666663, 683.642222222222, 719.2355555555555, 676.9466666666666, 699.627777777777, 695.9822222222219, 723.5211111111107, 662.2077777777777, 723.9588888888885, 692.8566666666662, 706.7033333333334, 718.4344444444445, 726.4711111111108, 707.9755555555555, 684.902222222222, 694.531111111111, 702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223, 698.1788888888889, 725.6044444444447, 683.9499999999997, 725.3688888888885, 717.3933333333332, 707.7544444444441, 713.171111111111, 718.4844444444442, 700.8699999999999, 716.3911111111112, 678.7411111111111, 697.6366666666667, 696.9666666666667, 730.7455555555551, 706.69, 703.9155555555551, 706.4988888888885, 717.1133333333332, 712.541111111111, 706.3977777777774, 701.5822222222221, 711.2977777777775, 697.3377777777775, 693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334, 706.2844444444441, 715.7144444444444, 731.3422222222221, 728.8111111111108, 727.6833333333333, 719.4277777777775, 754.0766666666667, 747.4522222222218, 710.8177777777773, 726.4866666666667, 714.1255555555558, 711.6944444444441, 729.1755555555555, 733.0644444444446, 716.9644444444443, 706.0188888888887, 713.024444444444, 727.5488888888887, 734.8644444444444, 747.6155555555554, 718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [718.4022222222221, 694.6433333333332, 710.7411111111109, 718.7288888888887, 712.9522222222221, 688.6333333333332, 671.6133333333333, 722.4899999999996, 680.5833333333331, 711.3611111111109, 674.2999999999997, 694.6666666666663, 683.642222222222, 719.2355555555555, 676.9466666666666, 699.627777777777, 695.9822222222219, 723.5211111111107, 662.2077777777777, 723.9588888888885, 692.8566666666662, 706.7033333333334, 718.4344444444445, 726.4711111111108, 707.9755555555555, 684.902222222222, 694.531111111111, 702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223, 698.1788888888889, 725.6044444444447, 683.9499999999997, 725.3688888888885, 717.3933333333332, 707.7544444444441, 713.171111111111, 718.4844444444442, 700.8699999999999, 716.3911111111112, 678.7411111111111, 697.6366666666667, 696.9666666666667, 730.7455555555551, 706.69, 703.9155555555551, 706.4988888888885, 717.1133333333332, 712.541111111111, 706.3977777777774, 701.5822222222221, 711.2977777777775, 697.3377777777775, 693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334, 706.2844444444441, 715.7144444444444, 731.3422222222221, 728.8111111111108, 727.6833333333333, 719.4277777777775, 754.0766666666667, 747.4522222222218, 710.8177777777773, 726.4866666666667, 714.1255555555558, 711.6944444444441, 729.1755555555555, 733.0644444444446, 716.9644444444443, 706.0188888888887, 713.024444444444, 727.5488888888887, 734.8644444444444, 747.6155555555554, 718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1918001054627159, "mean_inference_ms": 1.758828773794697, "mean_action_processing_ms": 0.07229193388704531, "mean_env_wait_ms": 1.1908600868104013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039751529693603516, "StateBufferConnector_ms": 0.002661466598510742, "ViewRequirementAgentConnector_ms": 0.059891700744628906}, "num_episodes": 30, "episode_return_max": 754.0766666666667, "episode_return_min": 662.2077777777777, "episode_return_mean": 710.087722222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158100, "num_agent_steps_trained": 157800, "num_env_steps_sampled": 158100, "num_env_steps_trained": 157800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.1549019849557, "num_env_steps_trained_throughput_per_sec": 297.1549019849557, "timesteps_total": 158100, "num_env_steps_sampled_lifetime": 158100, "num_agent_steps_sampled_lifetime": 158100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 158100, "timers": {"training_iteration_time_ms": 10193.101, "restore_workers_time_ms": 0.013, "training_step_time_ms": 510.025, "sample_time_ms": 495.183, "synch_weights_time_ms": 13.542}, "counters": {"num_env_steps_sampled": 158100, "num_env_steps_trained": 157800, "num_agent_steps_sampled": 158100, "num_agent_steps_trained": 157800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1054, "num_samples_added_to_queue": 158100}, "done": false, "training_iteration": 52, "trial_id": "38f59_00000", "date": "2024-10-10_22-20-25", "timestamp": 1728595225, "time_this_iter_s": 10.10484004020691, "time_total_s": 531.4274034500122, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc79a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 531.4274034500122, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 10.346666666666666, "ram_util_percent": 59.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 267408.03125, "policy_loss": 257039.5625, "entropy": 14.81197452545166, "entropy_coeff": 0.01, "var_gnorm": 16.476057052612305, "vf_loss": 1041289.3125, "vf_explained_var": 0.05276244878768921}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 536.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 160950, "num_env_steps_trained": 160800, "num_agent_steps_sampled": 160950, "num_agent_steps_trained": 160800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1073, "num_samples_added_to_queue": 160800, "learner_queue": {"size_count": 536, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.798, "learner_load_time_ms": 0.282, "learner_load_wait_time_ms": 993.774, "learner_dequeue_time_ms": 7935.737}}, "env_runners": {"episode_reward_max": 767.323333333333, "episode_reward_min": 664.6588888888888, "episode_reward_mean": 718.3530222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 664.6588888888888}, "policy_reward_max": {"default_policy": 767.323333333333}, "policy_reward_mean": {"default_policy": 718.3530222222222}, "custom_metrics": {"num_consolidated_mean": 2.2351, "num_consolidated_min": 2.01, "num_consolidated_max": 2.39, "num_overloaded_mean": 0.016300000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 4.9468, "num_moves_min": 4.1, "num_moves_max": 5.95, "mean_accuracy_mean": 40.142463333333325, "mean_accuracy_min": 39.89033333333332, "mean_accuracy_max": 40.416, "num_model_switches_mean": 3.1904999999999997, "num_model_switches_min": 2.69, "num_model_switches_max": 3.75, "num_slav_mean": 0.004672000000000001, "num_slav_min": 0.0005166666666666667, "num_slav_max": 0.010049999999999998, "mean_cluster_cpu_util_mean": 0.4553273829527224, "mean_cluster_cpu_util_min": 0.44230212377539585, "mean_cluster_cpu_util_max": 0.46516501988135966, "mean_cluster_mem_util_mean": 0.3015353144877149, "mean_cluster_mem_util_min": 0.2925826826616722, "mean_cluster_mem_util_max": 0.306927938517179, "reward_consolidation_mean_mean": 3.4158444444444434, "reward_consolidation_mean_min": 3.0644444444444447, "reward_consolidation_mean_max": 3.7177777777777767, "reward_illegal_mean_mean": -0.02716666666666666, "reward_illegal_mean_min": -0.1, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9482413333333337, "reward_accuracy_mean_min": 3.7626999999999997, "reward_accuracy_mean_max": 4.0416, "reward_sla_mean_mean": -0.15338888888888888, "reward_sla_mean_min": -0.335, "reward_sla_mean_max": -0.017222222222222222, "reward_consolidation_sum_mean": 341.5844444444444, "reward_consolidation_sum_min": 306.44444444444446, "reward_consolidation_sum_max": 371.77777777777766, "reward_illegal_sum_mean": -2.7166666666666663, "reward_illegal_sum_min": -10.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 394.8241333333333, "reward_accuracy_sum_min": 376.27, "reward_accuracy_sum_max": 404.16, "reward_sla_sum_mean": -15.338888888888889, "reward_sla_sum_min": -33.5, "reward_sla_sum_max": -1.7222222222222223, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5150.0, "global_timestep_min": 2900, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223, 698.1788888888889, 725.6044444444447, 683.9499999999997, 725.3688888888885, 717.3933333333332, 707.7544444444441, 713.171111111111, 718.4844444444442, 700.8699999999999, 716.3911111111112, 678.7411111111111, 697.6366666666667, 696.9666666666667, 730.7455555555551, 706.69, 703.9155555555551, 706.4988888888885, 717.1133333333332, 712.541111111111, 706.3977777777774, 701.5822222222221, 711.2977777777775, 697.3377777777775, 693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334, 706.2844444444441, 715.7144444444444, 731.3422222222221, 728.8111111111108, 727.6833333333333, 719.4277777777775, 754.0766666666667, 747.4522222222218, 710.8177777777773, 726.4866666666667, 714.1255555555558, 711.6944444444441, 729.1755555555555, 733.0644444444446, 716.9644444444443, 706.0188888888887, 713.024444444444, 727.5488888888887, 734.8644444444444, 747.6155555555554, 718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327, 711.0555555555554, 720.6322222222218, 741.751111111111, 730.1177777777774, 730.1811111111111, 692.9711111111108, 747.6666666666664, 735.1655555555554, 746.5699999999999, 753.4588888888886, 734.9922222222223, 723.0799999999995, 732.6544444444442, 767.323333333333, 714.7288888888883, 704.1888888888888, 739.1455555555553, 755.605555555555, 697.1066666666665, 716.682222222222, 748.141111111111, 755.5266666666665, 717.5655555555554, 723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [702.0311111111105, 717.9655555555555, 717.4811111111107, 681.0711111111108, 719.7988888888885, 710.1011111111109, 664.6588888888888, 713.7333333333328, 666.0388888888883, 688.4122222222223, 698.1788888888889, 725.6044444444447, 683.9499999999997, 725.3688888888885, 717.3933333333332, 707.7544444444441, 713.171111111111, 718.4844444444442, 700.8699999999999, 716.3911111111112, 678.7411111111111, 697.6366666666667, 696.9666666666667, 730.7455555555551, 706.69, 703.9155555555551, 706.4988888888885, 717.1133333333332, 712.541111111111, 706.3977777777774, 701.5822222222221, 711.2977777777775, 697.3377777777775, 693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334, 706.2844444444441, 715.7144444444444, 731.3422222222221, 728.8111111111108, 727.6833333333333, 719.4277777777775, 754.0766666666667, 747.4522222222218, 710.8177777777773, 726.4866666666667, 714.1255555555558, 711.6944444444441, 729.1755555555555, 733.0644444444446, 716.9644444444443, 706.0188888888887, 713.024444444444, 727.5488888888887, 734.8644444444444, 747.6155555555554, 718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327, 711.0555555555554, 720.6322222222218, 741.751111111111, 730.1177777777774, 730.1811111111111, 692.9711111111108, 747.6666666666664, 735.1655555555554, 746.5699999999999, 753.4588888888886, 734.9922222222223, 723.0799999999995, 732.6544444444442, 767.323333333333, 714.7288888888883, 704.1888888888888, 739.1455555555553, 755.605555555555, 697.1066666666665, 716.682222222222, 748.141111111111, 755.5266666666665, 717.5655555555554, 723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19168665757900272, "mean_inference_ms": 1.7570855150315654, "mean_action_processing_ms": 0.07225770080813099, "mean_env_wait_ms": 1.1903305172555059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00395512580871582, "StateBufferConnector_ms": 0.0027120113372802734, "ViewRequirementAgentConnector_ms": 0.06155204772949219}, "num_episodes": 27, "episode_return_max": 767.323333333333, "episode_return_min": 664.6588888888888, "episode_return_mean": 718.3530222222222, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160950, "num_agent_steps_trained": 160800, "num_env_steps_sampled": 160950, "num_env_steps_trained": 160800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.6429801488002, "num_env_steps_trained_throughput_per_sec": 299.624189630316, "timesteps_total": 160950, "num_env_steps_sampled_lifetime": 160950, "num_agent_steps_sampled_lifetime": 160950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 160950, "timers": {"training_iteration_time_ms": 10178.221, "restore_workers_time_ms": 0.014, "training_step_time_ms": 544.568, "sample_time_ms": 528.873, "synch_weights_time_ms": 14.294}, "counters": {"num_env_steps_sampled": 160950, "num_env_steps_trained": 160800, "num_agent_steps_sampled": 160950, "num_agent_steps_trained": 160800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1073, "num_samples_added_to_queue": 160800}, "done": false, "training_iteration": 53, "trial_id": "38f59_00000", "date": "2024-10-10_22-20-35", "timestamp": 1728595235, "time_this_iter_s": 10.020756483078003, "time_total_s": 541.4481599330902, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2ddb0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 541.4481599330902, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 14.592857142857143, "ram_util_percent": 60.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 284570.71875, "policy_loss": 274135.4375, "entropy": 14.73753547668457, "entropy_coeff": 0.01, "var_gnorm": 16.47842788696289, "vf_loss": 1047950.5, "vf_explained_var": 0.06232577562332153}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 546.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 164100, "num_env_steps_trained": 163800, "num_agent_steps_sampled": 164100, "num_agent_steps_trained": 163800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1094, "num_samples_added_to_queue": 164100, "learner_queue": {"size_count": 546, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 43.315, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 960.271, "learner_dequeue_time_ms": 7949.258}}, "env_runners": {"episode_reward_max": 767.323333333333, "episode_reward_min": 690.0044444444442, "episode_reward_mean": 730.5343111111109, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 690.0044444444442}, "policy_reward_max": {"default_policy": 767.323333333333}, "policy_reward_mean": {"default_policy": 730.5343111111109}, "custom_metrics": {"num_consolidated_mean": 2.2832000000000003, "num_consolidated_min": 2.08, "num_consolidated_max": 2.44, "num_overloaded_mean": 0.014000000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.7028, "num_moves_min": 4.1, "num_moves_max": 5.53, "mean_accuracy_mean": 40.211433333333325, "mean_accuracy_min": 40.00433333333333, "mean_accuracy_max": 40.416, "num_model_switches_mean": 3.0698999999999996, "num_model_switches_min": 2.69, "num_model_switches_max": 3.64, "num_slav_mean": 0.003984499999999999, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.010049999999999998, "mean_cluster_cpu_util_mean": 0.45708305640094393, "mean_cluster_cpu_util_min": 0.44230212377539585, "mean_cluster_cpu_util_max": 0.46551618815237206, "mean_cluster_mem_util_mean": 0.30241813447752514, "mean_cluster_mem_util_min": 0.2925826826616722, "mean_cluster_mem_util_max": 0.3079102831955567, "reward_consolidation_mean_mean": 3.4954888888888878, "reward_consolidation_mean_min": 3.1888888888888873, "reward_consolidation_mean_max": 3.7488888888888887, "reward_illegal_mean_mean": -0.02333333333333333, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9641986666666664, "reward_accuracy_mean_min": 3.817733333333334, "reward_accuracy_mean_max": 4.0416, "reward_sla_mean_mean": -0.13101111111111108, "reward_sla_mean_min": -0.335, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 349.54888888888877, "reward_consolidation_sum_min": 318.88888888888874, "reward_consolidation_sum_max": 374.88888888888886, "reward_illegal_sum_mean": -2.3333333333333335, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 396.4198666666666, "reward_accuracy_sum_min": 381.77333333333337, "reward_accuracy_sum_max": 404.16, "reward_sla_sum_mean": -13.10111111111111, "reward_sla_sum_min": -33.5, "reward_sla_sum_max": -0.8888888888888888, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6016.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334, 706.2844444444441, 715.7144444444444, 731.3422222222221, 728.8111111111108, 727.6833333333333, 719.4277777777775, 754.0766666666667, 747.4522222222218, 710.8177777777773, 726.4866666666667, 714.1255555555558, 711.6944444444441, 729.1755555555555, 733.0644444444446, 716.9644444444443, 706.0188888888887, 713.024444444444, 727.5488888888887, 734.8644444444444, 747.6155555555554, 718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327, 711.0555555555554, 720.6322222222218, 741.751111111111, 730.1177777777774, 730.1811111111111, 692.9711111111108, 747.6666666666664, 735.1655555555554, 746.5699999999999, 753.4588888888886, 734.9922222222223, 723.0799999999995, 732.6544444444442, 767.323333333333, 714.7288888888883, 704.1888888888888, 739.1455555555553, 755.605555555555, 697.1066666666665, 716.682222222222, 748.141111111111, 755.5266666666665, 717.5655555555554, 723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665, 744.5999999999999, 690.0044444444442, 734.6588888888889, 756.0044444444444, 720.1322222222219, 734.7344444444441, 756.8299999999998, 743.2299999999997, 724.3333333333331, 745.2111111111108, 757.8477777777775, 741.5988888888885, 750.5455555555553, 766.4288888888882, 722.0411111111113, 753.1477777777776, 722.5088888888885, 726.0533333333328, 751.401111111111, 723.5399999999995, 750.028888888889, 757.7288888888887, 739.1788888888889, 734.9366666666664, 724.6622222222215, 731.8966666666663, 737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [693.2422222222222, 698.8688888888888, 713.2199999999998, 708.044444444444, 718.4299999999997, 714.1477777777776, 719.9488888888889, 723.8999999999999, 718.5433333333333, 720.1233333333334, 706.2844444444441, 715.7144444444444, 731.3422222222221, 728.8111111111108, 727.6833333333333, 719.4277777777775, 754.0766666666667, 747.4522222222218, 710.8177777777773, 726.4866666666667, 714.1255555555558, 711.6944444444441, 729.1755555555555, 733.0644444444446, 716.9644444444443, 706.0188888888887, 713.024444444444, 727.5488888888887, 734.8644444444444, 747.6155555555554, 718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327, 711.0555555555554, 720.6322222222218, 741.751111111111, 730.1177777777774, 730.1811111111111, 692.9711111111108, 747.6666666666664, 735.1655555555554, 746.5699999999999, 753.4588888888886, 734.9922222222223, 723.0799999999995, 732.6544444444442, 767.323333333333, 714.7288888888883, 704.1888888888888, 739.1455555555553, 755.605555555555, 697.1066666666665, 716.682222222222, 748.141111111111, 755.5266666666665, 717.5655555555554, 723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665, 744.5999999999999, 690.0044444444442, 734.6588888888889, 756.0044444444444, 720.1322222222219, 734.7344444444441, 756.8299999999998, 743.2299999999997, 724.3333333333331, 745.2111111111108, 757.8477777777775, 741.5988888888885, 750.5455555555553, 766.4288888888882, 722.0411111111113, 753.1477777777776, 722.5088888888885, 726.0533333333328, 751.401111111111, 723.5399999999995, 750.028888888889, 757.7288888888887, 739.1788888888889, 734.9366666666664, 724.6622222222215, 731.8966666666663, 737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19165343700212653, "mean_inference_ms": 1.757481325742696, "mean_action_processing_ms": 0.07224683978515452, "mean_env_wait_ms": 1.1903679507522025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037567615509033203, "StateBufferConnector_ms": 0.0026726722717285156, "ViewRequirementAgentConnector_ms": 0.06174302101135254}, "num_episodes": 33, "episode_return_max": 767.323333333333, "episode_return_min": 690.0044444444442, "episode_return_mean": 730.5343111111109, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164100, "num_agent_steps_trained": 163800, "num_env_steps_sampled": 164100, "num_env_steps_trained": 163800, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 300.8755755341856, "num_env_steps_trained_throughput_per_sec": 286.54816717541485, "timesteps_total": 164100, "num_env_steps_sampled_lifetime": 164100, "num_agent_steps_sampled_lifetime": 164100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 164100, "timers": {"training_iteration_time_ms": 10185.73, "restore_workers_time_ms": 0.012, "training_step_time_ms": 509.779, "sample_time_ms": 495.361, "synch_weights_time_ms": 13.097}, "counters": {"num_env_steps_sampled": 164100, "num_env_steps_trained": 163800, "num_agent_steps_sampled": 164100, "num_agent_steps_trained": 163800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1094, "num_samples_added_to_queue": 164100}, "done": false, "training_iteration": 54, "trial_id": "38f59_00000", "date": "2024-10-10_22-20-46", "timestamp": 1728595246, "time_this_iter_s": 10.483383655548096, "time_total_s": 551.9315435886383, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc188e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 551.9315435886383, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 10.520000000000001, "ram_util_percent": 62.29333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 251832.0625, "policy_loss": 242808.09375, "entropy": 14.260322570800781, "entropy_coeff": 0.01, "var_gnorm": 16.478979110717773, "vf_loss": 906675.3125, "vf_explained_var": 0.0720413327217102}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 557.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 167250, "num_env_steps_trained": 167100, "num_agent_steps_sampled": 167250, "num_agent_steps_trained": 167100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1115, "num_samples_added_to_queue": 167100, "learner_queue": {"size_count": 557, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 51.986, "learner_load_time_ms": 0.259, "learner_load_wait_time_ms": 929.13, "learner_dequeue_time_ms": 7924.339}}, "env_runners": {"episode_reward_max": 780.8522222222219, "episode_reward_min": 690.0044444444442, "episode_reward_mean": 738.8510999999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 690.0044444444442}, "policy_reward_max": {"default_policy": 780.8522222222219}, "policy_reward_mean": {"default_policy": 738.8510999999999}, "custom_metrics": {"num_consolidated_mean": 2.3327000000000004, "num_consolidated_min": 2.17, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.0159, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 4.5419, "num_moves_min": 3.98, "num_moves_max": 5.18, "mean_accuracy_mean": 40.254816666666656, "mean_accuracy_min": 40.03599999999999, "mean_accuracy_max": 40.40966666666666, "num_model_switches_mean": 2.9919, "num_model_switches_min": 2.61, "num_model_switches_max": 3.49, "num_slav_mean": 0.0033321666666666673, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.010049999999999998, "mean_cluster_cpu_util_mean": 0.4594425672894596, "mean_cluster_cpu_util_min": 0.4484270782129544, "mean_cluster_cpu_util_max": 0.4762070691742948, "mean_cluster_mem_util_mean": 0.30363687699847874, "mean_cluster_mem_util_min": 0.29665070449065706, "mean_cluster_mem_util_max": 0.31332326918109016, "reward_consolidation_mean_mean": 3.563466666666666, "reward_consolidation_mean_min": 3.235555555555555, "reward_consolidation_mean_max": 3.9355555555555553, "reward_illegal_mean_mean": -0.026499999999999996, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9605443333333334, "reward_accuracy_mean_min": 3.709633333333333, "reward_accuracy_mean_max": 4.035266666666667, "reward_sla_mean_mean": -0.10899999999999999, "reward_sla_mean_min": -0.335, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 356.3466666666665, "reward_consolidation_sum_min": 323.5555555555555, "reward_consolidation_sum_max": 393.55555555555554, "reward_illegal_sum_mean": -2.65, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 396.0544333333333, "reward_accuracy_sum_min": 370.9633333333333, "reward_accuracy_sum_max": 403.52666666666664, "reward_sla_sum_mean": -10.9, "reward_sla_sum_min": -33.5, "reward_sla_sum_max": -0.8888888888888888, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4676.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327, 711.0555555555554, 720.6322222222218, 741.751111111111, 730.1177777777774, 730.1811111111111, 692.9711111111108, 747.6666666666664, 735.1655555555554, 746.5699999999999, 753.4588888888886, 734.9922222222223, 723.0799999999995, 732.6544444444442, 767.323333333333, 714.7288888888883, 704.1888888888888, 739.1455555555553, 755.605555555555, 697.1066666666665, 716.682222222222, 748.141111111111, 755.5266666666665, 717.5655555555554, 723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665, 744.5999999999999, 690.0044444444442, 734.6588888888889, 756.0044444444444, 720.1322222222219, 734.7344444444441, 756.8299999999998, 743.2299999999997, 724.3333333333331, 745.2111111111108, 757.8477777777775, 741.5988888888885, 750.5455555555553, 766.4288888888882, 722.0411111111113, 753.1477777777776, 722.5088888888885, 726.0533333333328, 751.401111111111, 723.5399999999995, 750.028888888889, 757.7288888888887, 739.1788888888889, 734.9366666666664, 724.6622222222215, 731.8966666666663, 737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777, 722.0711111111107, 759.9455555555558, 761.5722222222219, 754.0355555555553, 745.5699999999998, 760.1577777777777, 769.5211111111108, 728.9466666666668, 740.9377777777777, 756.2222222222222, 742.9599999999998, 780.8522222222219, 756.2033333333333, 736.9144444444443, 696.0188888888887, 718.5344444444443, 762.3377777777779, 728.5255555555555, 771.4022222222217, 716.9422222222222, 760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [718.8755555555553, 747.1677777777775, 712.6444444444443, 712.0177777777777, 692.4055555555552, 728.0566666666664, 702.0144444444442, 741.0011111111107, 719.8477777777779, 732.0433333333327, 711.0555555555554, 720.6322222222218, 741.751111111111, 730.1177777777774, 730.1811111111111, 692.9711111111108, 747.6666666666664, 735.1655555555554, 746.5699999999999, 753.4588888888886, 734.9922222222223, 723.0799999999995, 732.6544444444442, 767.323333333333, 714.7288888888883, 704.1888888888888, 739.1455555555553, 755.605555555555, 697.1066666666665, 716.682222222222, 748.141111111111, 755.5266666666665, 717.5655555555554, 723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665, 744.5999999999999, 690.0044444444442, 734.6588888888889, 756.0044444444444, 720.1322222222219, 734.7344444444441, 756.8299999999998, 743.2299999999997, 724.3333333333331, 745.2111111111108, 757.8477777777775, 741.5988888888885, 750.5455555555553, 766.4288888888882, 722.0411111111113, 753.1477777777776, 722.5088888888885, 726.0533333333328, 751.401111111111, 723.5399999999995, 750.028888888889, 757.7288888888887, 739.1788888888889, 734.9366666666664, 724.6622222222215, 731.8966666666663, 737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777, 722.0711111111107, 759.9455555555558, 761.5722222222219, 754.0355555555553, 745.5699999999998, 760.1577777777777, 769.5211111111108, 728.9466666666668, 740.9377777777777, 756.2222222222222, 742.9599999999998, 780.8522222222219, 756.2033333333333, 736.9144444444443, 696.0188888888887, 718.5344444444443, 762.3377777777779, 728.5255555555555, 771.4022222222217, 716.9422222222222, 760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19163311074148823, "mean_inference_ms": 1.7577886784365804, "mean_action_processing_ms": 0.07223872503081076, "mean_env_wait_ms": 1.190386217472816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003677845001220703, "StateBufferConnector_ms": 0.0026438236236572266, "ViewRequirementAgentConnector_ms": 0.06092476844787598}, "num_episodes": 30, "episode_return_max": 780.8522222222219, "episode_return_min": 690.0044444444442, "episode_return_mean": 738.8510999999999, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167250, "num_agent_steps_trained": 167100, "num_env_steps_sampled": 167250, "num_env_steps_trained": 167100, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 305.7872271760062, "num_env_steps_trained_throughput_per_sec": 320.3485237081969, "timesteps_total": 167250, "num_env_steps_sampled_lifetime": 167250, "num_agent_steps_sampled_lifetime": 167250, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 167250, "timers": {"training_iteration_time_ms": 10167.789, "restore_workers_time_ms": 0.011, "training_step_time_ms": 494.279, "sample_time_ms": 479.76, "synch_weights_time_ms": 13.156}, "counters": {"num_env_steps_sampled": 167250, "num_env_steps_trained": 167100, "num_agent_steps_sampled": 167250, "num_agent_steps_trained": 167100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1115, "num_samples_added_to_queue": 167100}, "done": false, "training_iteration": 55, "trial_id": "38f59_00000", "date": "2024-10-10_22-20-56", "timestamp": 1728595256, "time_this_iter_s": 10.31046438217163, "time_total_s": 562.2420079708099, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2fc40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 562.2420079708099, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 10.473333333333333, "ram_util_percent": 61.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 247284.0625, "policy_loss": 238112.65625, "entropy": 14.382370948791504, "entropy_coeff": 0.01, "var_gnorm": 16.48612403869629, "vf_loss": 921455.4375, "vf_explained_var": 0.08098834753036499}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 567.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 170400, "num_env_steps_trained": 170100, "num_agent_steps_sampled": 170400, "num_agent_steps_trained": 170100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1136, "num_samples_added_to_queue": 170400, "learner_queue": {"size_count": 567, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.279, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 910.61, "learner_dequeue_time_ms": 7924.572}}, "env_runners": {"episode_reward_max": 780.8522222222219, "episode_reward_min": 690.0044444444442, "episode_reward_mean": 745.2060444444442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 690.0044444444442}, "policy_reward_max": {"default_policy": 780.8522222222219}, "policy_reward_mean": {"default_policy": 745.2060444444442}, "custom_metrics": {"num_consolidated_mean": 2.3719999999999994, "num_consolidated_min": 2.18, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.0174, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 4.4674, "num_moves_min": 3.98, "num_moves_max": 5.11, "mean_accuracy_mean": 40.273246666666665, "mean_accuracy_min": 40.07399999999999, "mean_accuracy_max": 40.45399999999999, "num_model_switches_mean": 2.9449000000000005, "num_model_switches_min": 2.53, "num_model_switches_max": 3.36, "num_slav_mean": 0.0028225000000000004, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.006900000000000001, "mean_cluster_cpu_util_mean": 0.4611033682661362, "mean_cluster_cpu_util_min": 0.4484270782129544, "mean_cluster_cpu_util_max": 0.4762070691742948, "mean_cluster_mem_util_mean": 0.3043759256634088, "mean_cluster_mem_util_min": 0.29665070449065706, "mean_cluster_mem_util_max": 0.31332326918109016, "reward_consolidation_mean_mean": 3.6165111111111106, "reward_consolidation_mean_min": 3.235555555555555, "reward_consolidation_mean_max": 3.9355555555555553, "reward_illegal_mean_mean": -0.028999999999999998, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9562160000000004, "reward_accuracy_mean_min": 3.709633333333333, "reward_accuracy_mean_max": 4.040966666666667, "reward_sla_mean_mean": -0.09166666666666666, "reward_sla_mean_min": -0.23, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 361.65111111111105, "reward_consolidation_sum_min": 323.5555555555555, "reward_consolidation_sum_max": 393.55555555555554, "reward_illegal_sum_mean": -2.9, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 395.62160000000006, "reward_accuracy_sum_min": 370.9633333333333, "reward_accuracy_sum_max": 404.0966666666667, "reward_sla_sum_mean": -9.166666666666666, "reward_sla_sum_min": -23.0, "reward_sla_sum_max": -0.8888888888888888, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3230.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665, 744.5999999999999, 690.0044444444442, 734.6588888888889, 756.0044444444444, 720.1322222222219, 734.7344444444441, 756.8299999999998, 743.2299999999997, 724.3333333333331, 745.2111111111108, 757.8477777777775, 741.5988888888885, 750.5455555555553, 766.4288888888882, 722.0411111111113, 753.1477777777776, 722.5088888888885, 726.0533333333328, 751.401111111111, 723.5399999999995, 750.028888888889, 757.7288888888887, 739.1788888888889, 734.9366666666664, 724.6622222222215, 731.8966666666663, 737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777, 722.0711111111107, 759.9455555555558, 761.5722222222219, 754.0355555555553, 745.5699999999998, 760.1577777777777, 769.5211111111108, 728.9466666666668, 740.9377777777777, 756.2222222222222, 742.9599999999998, 780.8522222222219, 756.2033333333333, 736.9144444444443, 696.0188888888887, 718.5344444444443, 762.3377777777779, 728.5255555555555, 771.4022222222217, 716.9422222222222, 760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663, 727.5244444444444, 707.4711111111111, 731.1277777777776, 756.8166666666668, 762.9666666666664, 773.6399999999999, 750.1399999999995, 747.8822222222218, 718.3866666666663, 722.1777777777776, 743.2788888888888, 722.8199999999999, 740.144444444444, 762.0377777777774, 761.6355555555556, 778.4299999999998, 764.0999999999997, 741.0155555555555, 755.9499999999997, 763.753333333333, 728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [723.1733333333331, 747.2855555555552, 732.7055555555555, 723.1666666666665, 744.5999999999999, 690.0044444444442, 734.6588888888889, 756.0044444444444, 720.1322222222219, 734.7344444444441, 756.8299999999998, 743.2299999999997, 724.3333333333331, 745.2111111111108, 757.8477777777775, 741.5988888888885, 750.5455555555553, 766.4288888888882, 722.0411111111113, 753.1477777777776, 722.5088888888885, 726.0533333333328, 751.401111111111, 723.5399999999995, 750.028888888889, 757.7288888888887, 739.1788888888889, 734.9366666666664, 724.6622222222215, 731.8966666666663, 737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777, 722.0711111111107, 759.9455555555558, 761.5722222222219, 754.0355555555553, 745.5699999999998, 760.1577777777777, 769.5211111111108, 728.9466666666668, 740.9377777777777, 756.2222222222222, 742.9599999999998, 780.8522222222219, 756.2033333333333, 736.9144444444443, 696.0188888888887, 718.5344444444443, 762.3377777777779, 728.5255555555555, 771.4022222222217, 716.9422222222222, 760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663, 727.5244444444444, 707.4711111111111, 731.1277777777776, 756.8166666666668, 762.9666666666664, 773.6399999999999, 750.1399999999995, 747.8822222222218, 718.3866666666663, 722.1777777777776, 743.2788888888888, 722.8199999999999, 740.144444444444, 762.0377777777774, 761.6355555555556, 778.4299999999998, 764.0999999999997, 741.0155555555555, 755.9499999999997, 763.753333333333, 728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19169120011432333, "mean_inference_ms": 1.760427168360783, "mean_action_processing_ms": 0.07223883188343182, "mean_env_wait_ms": 1.190812541834313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036563873291015625, "StateBufferConnector_ms": 0.002641439437866211, "ViewRequirementAgentConnector_ms": 0.06081271171569824}, "num_episodes": 33, "episode_return_max": 780.8522222222219, "episode_return_min": 690.0044444444442, "episode_return_mean": 745.2060444444442, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 170400, "num_agent_steps_trained": 170100, "num_env_steps_sampled": 170400, "num_env_steps_trained": 170100, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 307.24021955068986, "num_env_steps_trained_throughput_per_sec": 292.6097329054189, "timesteps_total": 170400, "num_env_steps_sampled_lifetime": 170400, "num_agent_steps_sampled_lifetime": 170400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 170400, "timers": {"training_iteration_time_ms": 10178.584, "restore_workers_time_ms": 0.012, "training_step_time_ms": 485.944, "sample_time_ms": 472.112, "synch_weights_time_ms": 12.5}, "counters": {"num_env_steps_sampled": 170400, "num_env_steps_trained": 170100, "num_agent_steps_sampled": 170400, "num_agent_steps_trained": 170100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1136, "num_samples_added_to_queue": 170400}, "done": false, "training_iteration": 56, "trial_id": "38f59_00000", "date": "2024-10-10_22-21-06", "timestamp": 1728595266, "time_this_iter_s": 10.270818948745728, "time_total_s": 572.5128269195557, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc6c50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 572.5128269195557, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 10.89285714285714, "ram_util_percent": 61.16428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 241547.71875, "policy_loss": 232373.109375, "entropy": 14.117127418518066, "entropy_coeff": 0.01, "var_gnorm": 16.49796485900879, "vf_loss": 921696.125, "vf_explained_var": 0.08795249462127686}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 577.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 173400, "num_env_steps_trained": 173100, "num_agent_steps_sampled": 173400, "num_agent_steps_trained": 173100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1156, "num_samples_added_to_queue": 173400, "learner_queue": {"size_count": 577, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.502, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 954.42, "learner_dequeue_time_ms": 7980.685}}, "env_runners": {"episode_reward_max": 787.7577777777776, "episode_reward_min": 696.0188888888887, "episode_reward_mean": 749.1947777777776, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 696.0188888888887}, "policy_reward_max": {"default_policy": 787.7577777777776}, "policy_reward_mean": {"default_policy": 749.1947777777776}, "custom_metrics": {"num_consolidated_mean": 2.3986, "num_consolidated_min": 2.26, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.0184, "num_overloaded_min": 0.0, "num_overloaded_max": 0.08, "num_moves_mean": 4.409800000000001, "num_moves_min": 3.98, "num_moves_max": 4.86, "mean_accuracy_mean": 40.278503333333326, "mean_accuracy_min": 40.10566666666665, "mean_accuracy_max": 40.52366666666666, "num_model_switches_mean": 2.9206, "num_model_switches_min": 2.53, "num_model_switches_max": 3.27, "num_slav_mean": 0.0025271666666666663, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.00605, "mean_cluster_cpu_util_mean": 0.4628806936835124, "mean_cluster_cpu_util_min": 0.45170034558092254, "mean_cluster_cpu_util_max": 0.4762070691742948, "mean_cluster_mem_util_mean": 0.3053070240427395, "mean_cluster_mem_util_min": 0.299578829759752, "mean_cluster_mem_util_max": 0.31332326918109016, "reward_consolidation_mean_mean": 3.6524444444444435, "reward_consolidation_mean_min": 3.3755555555555543, "reward_consolidation_mean_max": 3.9355555555555553, "reward_illegal_mean_mean": -0.030666666666666665, "reward_illegal_mean_min": -0.13333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9525366666666666, "reward_accuracy_mean_min": 3.709633333333333, "reward_accuracy_mean_max": 4.040966666666667, "reward_sla_mean_mean": -0.0823666666666667, "reward_sla_mean_min": -0.20166666666666663, "reward_sla_mean_max": -0.011111111111111112, "reward_consolidation_sum_mean": 365.24444444444435, "reward_consolidation_sum_min": 337.55555555555543, "reward_consolidation_sum_max": 393.55555555555554, "reward_illegal_sum_mean": -3.066666666666667, "reward_illegal_sum_min": -13.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 395.2536666666667, "reward_accuracy_sum_min": 370.9633333333333, "reward_accuracy_sum_max": 404.0966666666667, "reward_sla_sum_mean": -8.236666666666665, "reward_sla_sum_min": -20.166666666666664, "reward_sla_sum_max": -1.1111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2035.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777, 722.0711111111107, 759.9455555555558, 761.5722222222219, 754.0355555555553, 745.5699999999998, 760.1577777777777, 769.5211111111108, 728.9466666666668, 740.9377777777777, 756.2222222222222, 742.9599999999998, 780.8522222222219, 756.2033333333333, 736.9144444444443, 696.0188888888887, 718.5344444444443, 762.3377777777779, 728.5255555555555, 771.4022222222217, 716.9422222222222, 760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663, 727.5244444444444, 707.4711111111111, 731.1277777777776, 756.8166666666668, 762.9666666666664, 773.6399999999999, 750.1399999999995, 747.8822222222218, 718.3866666666663, 722.1777777777776, 743.2788888888888, 722.8199999999999, 740.144444444444, 762.0377777777774, 761.6355555555556, 778.4299999999998, 764.0999999999997, 741.0155555555555, 755.9499999999997, 763.753333333333, 728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778, 754.8977777777774, 733.3277777777777, 724.8511111111108, 737.4588888888887, 716.802222222222, 777.6966666666668, 762.5944444444444, 759.0866666666664, 745.8811111111111, 759.8399999999996, 744.7844444444445, 752.2444444444444, 765.1499999999996, 761.2411111111113, 767.8566666666669, 741.6833333333332, 744.9366666666665, 753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [737.6722222222221, 758.5833333333331, 757.4444444444442, 756.6388888888886, 754.2588888888886, 754.9022222222219, 751.2677777777777, 722.0711111111107, 759.9455555555558, 761.5722222222219, 754.0355555555553, 745.5699999999998, 760.1577777777777, 769.5211111111108, 728.9466666666668, 740.9377777777777, 756.2222222222222, 742.9599999999998, 780.8522222222219, 756.2033333333333, 736.9144444444443, 696.0188888888887, 718.5344444444443, 762.3377777777779, 728.5255555555555, 771.4022222222217, 716.9422222222222, 760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663, 727.5244444444444, 707.4711111111111, 731.1277777777776, 756.8166666666668, 762.9666666666664, 773.6399999999999, 750.1399999999995, 747.8822222222218, 718.3866666666663, 722.1777777777776, 743.2788888888888, 722.8199999999999, 740.144444444444, 762.0377777777774, 761.6355555555556, 778.4299999999998, 764.0999999999997, 741.0155555555555, 755.9499999999997, 763.753333333333, 728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778, 754.8977777777774, 733.3277777777777, 724.8511111111108, 737.4588888888887, 716.802222222222, 777.6966666666668, 762.5944444444444, 759.0866666666664, 745.8811111111111, 759.8399999999996, 744.7844444444445, 752.2444444444444, 765.1499999999996, 761.2411111111113, 767.8566666666669, 741.6833333333332, 744.9366666666665, 753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915597987168749, "mean_inference_ms": 1.7580188811799728, "mean_action_processing_ms": 0.07219018044130872, "mean_env_wait_ms": 1.190059043215734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035920143127441406, "StateBufferConnector_ms": 0.0026285648345947266, "ViewRequirementAgentConnector_ms": 0.06051445007324219}, "num_episodes": 30, "episode_return_max": 787.7577777777776, "episode_return_min": 696.0188888888887, "episode_return_mean": 749.1947777777776, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173400, "num_agent_steps_trained": 173100, "num_env_steps_sampled": 173400, "num_env_steps_trained": 173100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.4309815599528, "num_env_steps_trained_throughput_per_sec": 298.4309815599528, "timesteps_total": 173400, "num_env_steps_sampled_lifetime": 173400, "num_agent_steps_sampled_lifetime": 173400, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 173400, "timers": {"training_iteration_time_ms": 10164.726, "restore_workers_time_ms": 0.013, "training_step_time_ms": 504.958, "sample_time_ms": 491.454, "synch_weights_time_ms": 12.084}, "counters": {"num_env_steps_sampled": 173400, "num_env_steps_trained": 173100, "num_agent_steps_sampled": 173400, "num_agent_steps_trained": 173100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1156, "num_samples_added_to_queue": 173400}, "done": false, "training_iteration": 57, "trial_id": "38f59_00000", "date": "2024-10-10_22-21-17", "timestamp": 1728595277, "time_this_iter_s": 10.061790466308594, "time_total_s": 582.5746173858643, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc6890>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 582.5746173858643, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 10.32666666666667, "ram_util_percent": 59.83999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 239630.296875, "policy_loss": 229813.890625, "entropy": 13.805113792419434, "entropy_coeff": 0.01, "var_gnorm": 16.5067138671875, "vf_loss": 985782.9375, "vf_explained_var": 0.09267288446426392}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 587.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 176250, "num_env_steps_trained": 176100, "num_agent_steps_sampled": 176250, "num_agent_steps_trained": 176100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1175, "num_samples_added_to_queue": 176100, "learner_queue": {"size_count": 587, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.147, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 1015.107, "learner_dequeue_time_ms": 8091.653}}, "env_runners": {"episode_reward_max": 788.7988888888887, "episode_reward_min": 707.4711111111111, "episode_reward_mean": 751.8786111111112, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 707.4711111111111}, "policy_reward_max": {"default_policy": 788.7988888888887}, "policy_reward_mean": {"default_policy": 751.8786111111112}, "custom_metrics": {"num_consolidated_mean": 2.4182, "num_consolidated_min": 2.27, "num_consolidated_max": 2.59, "num_overloaded_mean": 0.019200000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 4.3268, "num_moves_min": 3.8, "num_moves_max": 4.86, "mean_accuracy_mean": 40.26773666666666, "mean_accuracy_min": 39.978999999999985, "mean_accuracy_max": 40.52366666666666, "num_model_switches_mean": 2.9061000000000003, "num_model_switches_min": 2.53, "num_model_switches_max": 3.23, "num_slav_mean": 0.0023745, "num_slav_min": 0.00025, "num_slav_max": 0.00605, "mean_cluster_cpu_util_mean": 0.464013484447742, "mean_cluster_cpu_util_min": 0.45170034558092254, "mean_cluster_cpu_util_max": 0.4762070691742948, "mean_cluster_mem_util_mean": 0.30593601474102294, "mean_cluster_mem_util_min": 0.299578829759752, "mean_cluster_mem_util_max": 0.31332326918109016, "reward_consolidation_mean_mean": 3.67951111111111, "reward_consolidation_mean_min": 3.3755555555555548, "reward_consolidation_mean_max": 3.9355555555555553, "reward_illegal_mean_mean": -0.031999999999999994, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9482416666666666, "reward_accuracy_mean_min": 3.8202666666666665, "reward_accuracy_mean_max": 4.040966666666667, "reward_sla_mean_mean": -0.07696666666666666, "reward_sla_mean_min": -0.20166666666666663, "reward_sla_mean_max": -0.008333333333333333, "reward_consolidation_sum_mean": 367.9511111111111, "reward_consolidation_sum_min": 337.5555555555555, "reward_consolidation_sum_max": 393.55555555555554, "reward_illegal_sum_mean": -3.2, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 394.8241666666667, "reward_accuracy_sum_min": 382.02666666666664, "reward_accuracy_sum_max": 404.0966666666667, "reward_sla_sum_mean": -7.696666666666667, "reward_sla_sum_min": -20.166666666666664, "reward_sla_sum_max": -0.8333333333333334, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2450.0, "global_timestep_min": 200, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663, 727.5244444444444, 707.4711111111111, 731.1277777777776, 756.8166666666668, 762.9666666666664, 773.6399999999999, 750.1399999999995, 747.8822222222218, 718.3866666666663, 722.1777777777776, 743.2788888888888, 722.8199999999999, 740.144444444444, 762.0377777777774, 761.6355555555556, 778.4299999999998, 764.0999999999997, 741.0155555555555, 755.9499999999997, 763.753333333333, 728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778, 754.8977777777774, 733.3277777777777, 724.8511111111108, 737.4588888888887, 716.802222222222, 777.6966666666668, 762.5944444444444, 759.0866666666664, 745.8811111111111, 759.8399999999996, 744.7844444444445, 752.2444444444444, 765.1499999999996, 761.2411111111113, 767.8566666666669, 741.6833333333332, 744.9366666666665, 753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996, 752.7288888888886, 776.9088888888887, 762.6022222222218, 733.9777777777776, 752.0433333333333, 774.911111111111, 788.7988888888887, 745.2477777777773, 743.4444444444435, 735.7166666666662, 742.8122222222221, 753.1988888888889, 750.562222222222, 763.6322222222219, 777.8711111111108, 779.3188888888886, 777.2188888888886, 764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [760.3544444444444, 778.402222222222, 734.8644444444443, 759.4955555555553, 744.5788888888886, 743.758888888889, 760.6933333333333, 761.9655555555555, 755.2699999999999, 753.2866666666663, 727.5244444444444, 707.4711111111111, 731.1277777777776, 756.8166666666668, 762.9666666666664, 773.6399999999999, 750.1399999999995, 747.8822222222218, 718.3866666666663, 722.1777777777776, 743.2788888888888, 722.8199999999999, 740.144444444444, 762.0377777777774, 761.6355555555556, 778.4299999999998, 764.0999999999997, 741.0155555555555, 755.9499999999997, 763.753333333333, 728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778, 754.8977777777774, 733.3277777777777, 724.8511111111108, 737.4588888888887, 716.802222222222, 777.6966666666668, 762.5944444444444, 759.0866666666664, 745.8811111111111, 759.8399999999996, 744.7844444444445, 752.2444444444444, 765.1499999999996, 761.2411111111113, 767.8566666666669, 741.6833333333332, 744.9366666666665, 753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996, 752.7288888888886, 776.9088888888887, 762.6022222222218, 733.9777777777776, 752.0433333333333, 774.911111111111, 788.7988888888887, 745.2477777777773, 743.4444444444435, 735.7166666666662, 742.8122222222221, 753.1988888888889, 750.562222222222, 763.6322222222219, 777.8711111111108, 779.3188888888886, 777.2188888888886, 764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19150157189539677, "mean_inference_ms": 1.756388200720844, "mean_action_processing_ms": 0.07217183183135253, "mean_env_wait_ms": 1.1897035848875668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038301944732666016, "StateBufferConnector_ms": 0.0027108192443847656, "ViewRequirementAgentConnector_ms": 0.06265115737915039}, "num_episodes": 27, "episode_return_max": 788.7988888888887, "episode_return_min": 707.4711111111111, "episode_return_mean": 751.8786111111112, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176250, "num_agent_steps_trained": 176100, "num_env_steps_sampled": 176250, "num_env_steps_trained": 176100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 278.8901355536601, "num_env_steps_trained_throughput_per_sec": 293.56856374069486, "timesteps_total": 176250, "num_env_steps_sampled_lifetime": 176250, "num_agent_steps_sampled_lifetime": 176250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 176250, "timers": {"training_iteration_time_ms": 10171.378, "restore_workers_time_ms": 0.013, "training_step_time_ms": 554.864, "sample_time_ms": 540.951, "synch_weights_time_ms": 12.369}, "counters": {"num_env_steps_sampled": 176250, "num_env_steps_trained": 176100, "num_agent_steps_sampled": 176250, "num_agent_steps_trained": 176100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1175, "num_samples_added_to_queue": 176100}, "done": false, "training_iteration": 58, "trial_id": "38f59_00000", "date": "2024-10-10_22-21-27", "timestamp": 1728595287, "time_this_iter_s": 10.227478981018066, "time_total_s": 592.8020963668823, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde74f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 592.8020963668823, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.257142857142856, "ram_util_percent": 61.92857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 238261.09375, "policy_loss": 227945.078125, "entropy": 13.287153244018555, "entropy_coeff": 0.01, "var_gnorm": 16.5189208984375, "vf_loss": 1035587.9375, "vf_explained_var": 0.10298913717269897}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 597.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 179250, "num_env_steps_trained": 179100, "num_agent_steps_sampled": 179250, "num_agent_steps_trained": 179100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1195, "num_samples_added_to_queue": 179100, "learner_queue": {"size_count": 597, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.975, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 989.017, "learner_dequeue_time_ms": 8167.688}}, "env_runners": {"episode_reward_max": 797.1611111111109, "episode_reward_min": 708.6677777777777, "episode_reward_mean": 756.4428555555554, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 708.6677777777777}, "policy_reward_max": {"default_policy": 797.1611111111109}, "policy_reward_mean": {"default_policy": 756.4428555555554}, "custom_metrics": {"num_consolidated_mean": 2.4424, "num_consolidated_min": 2.27, "num_consolidated_max": 2.58, "num_overloaded_mean": 0.019600000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.06, "num_moves_mean": 4.189699999999999, "num_moves_min": 3.51, "num_moves_max": 4.74, "mean_accuracy_mean": 40.268939999999986, "mean_accuracy_min": 39.978999999999985, "mean_accuracy_max": 40.52366666666666, "num_model_switches_mean": 2.8712999999999997, "num_model_switches_min": 2.5, "num_model_switches_max": 3.23, "num_slav_mean": 0.0020073333333333328, "num_slav_min": 0.0002333333333333333, "num_slav_max": 0.00605, "mean_cluster_cpu_util_mean": 0.46550795918084537, "mean_cluster_cpu_util_min": 0.45304961503383745, "mean_cluster_cpu_util_max": 0.4787924608701834, "mean_cluster_mem_util_mean": 0.3069484336357961, "mean_cluster_mem_util_min": 0.30112447795573927, "mean_cluster_mem_util_max": 0.31451579856626194, "reward_consolidation_mean_mean": 3.7160666666666655, "reward_consolidation_mean_min": 3.406666666666666, "reward_consolidation_mean_max": 3.982222222222221, "reward_illegal_mean_mean": -0.03266666666666666, "reward_illegal_mean_min": -0.1, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.946623, "reward_accuracy_mean_min": 3.7639666666666667, "reward_accuracy_mean_max": 4.037166666666668, "reward_sla_mean_mean": -0.06559444444444444, "reward_sla_mean_min": -0.20166666666666663, "reward_sla_mean_max": -0.0077777777777777776, "reward_consolidation_sum_mean": 371.60666666666657, "reward_consolidation_sum_min": 340.6666666666666, "reward_consolidation_sum_max": 398.2222222222221, "reward_illegal_sum_mean": -3.266666666666666, "reward_illegal_sum_min": -10.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 394.6623, "reward_accuracy_sum_min": 376.39666666666665, "reward_accuracy_sum_max": 403.71666666666675, "reward_sla_sum_mean": -6.559444444444445, "reward_sla_sum_min": -20.166666666666664, "reward_sla_sum_max": -0.7777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3449.0, "global_timestep_min": 1200, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778, 754.8977777777774, 733.3277777777777, 724.8511111111108, 737.4588888888887, 716.802222222222, 777.6966666666668, 762.5944444444444, 759.0866666666664, 745.8811111111111, 759.8399999999996, 744.7844444444445, 752.2444444444444, 765.1499999999996, 761.2411111111113, 767.8566666666669, 741.6833333333332, 744.9366666666665, 753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996, 752.7288888888886, 776.9088888888887, 762.6022222222218, 733.9777777777776, 752.0433333333333, 774.911111111111, 788.7988888888887, 745.2477777777773, 743.4444444444435, 735.7166666666662, 742.8122222222221, 753.1988888888889, 750.562222222222, 763.6322222222219, 777.8711111111108, 779.3188888888886, 777.2188888888886, 764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554, 775.6955555555554, 782.9499999999998, 787.3233333333333, 775.0533333333333, 773.3111111111107, 785.8233333333334, 784.7111111111113, 768.9277777777776, 788.2266666666668, 751.1522222222218, 751.0811111111108, 722.6200000000001, 735.697777777778, 712.1744444444444, 779.0688888888886, 734.621111111111, 729.8155555555552, 758.4444444444442, 758.8844444444442, 765.7711111111112, 746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [728.9888888888887, 762.9466666666667, 740.0499999999998, 759.37, 725.3855555555552, 743.2677777777772, 761.1811111111114, 764.6166666666664, 752.8477777777772, 752.7399999999994, 745.2022222222222, 748.8966666666668, 741.087777777778, 754.8977777777774, 733.3277777777777, 724.8511111111108, 737.4588888888887, 716.802222222222, 777.6966666666668, 762.5944444444444, 759.0866666666664, 745.8811111111111, 759.8399999999996, 744.7844444444445, 752.2444444444444, 765.1499999999996, 761.2411111111113, 767.8566666666669, 741.6833333333332, 744.9366666666665, 753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996, 752.7288888888886, 776.9088888888887, 762.6022222222218, 733.9777777777776, 752.0433333333333, 774.911111111111, 788.7988888888887, 745.2477777777773, 743.4444444444435, 735.7166666666662, 742.8122222222221, 753.1988888888889, 750.562222222222, 763.6322222222219, 777.8711111111108, 779.3188888888886, 777.2188888888886, 764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554, 775.6955555555554, 782.9499999999998, 787.3233333333333, 775.0533333333333, 773.3111111111107, 785.8233333333334, 784.7111111111113, 768.9277777777776, 788.2266666666668, 751.1522222222218, 751.0811111111108, 722.6200000000001, 735.697777777778, 712.1744444444444, 779.0688888888886, 734.621111111111, 729.8155555555552, 758.4444444444442, 758.8844444444442, 765.7711111111112, 746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19154536916756854, "mean_inference_ms": 1.7561045242584996, "mean_action_processing_ms": 0.07218745447647411, "mean_env_wait_ms": 1.1899603235339082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039708614349365234, "StateBufferConnector_ms": 0.0027937889099121094, "ViewRequirementAgentConnector_ms": 0.06485533714294434}, "num_episodes": 30, "episode_return_max": 797.1611111111109, "episode_return_min": 708.6677777777777, "episode_return_mean": 756.4428555555554, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179250, "num_agent_steps_trained": 179100, "num_env_steps_sampled": 179250, "num_env_steps_trained": 179100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.70000472786035, "num_env_steps_trained_throughput_per_sec": 286.70000472786035, "timesteps_total": 179250, "num_env_steps_sampled_lifetime": 179250, "num_agent_steps_sampled_lifetime": 179250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 179250, "timers": {"training_iteration_time_ms": 10212.714, "restore_workers_time_ms": 0.012, "training_step_time_ms": 496.403, "sample_time_ms": 481.919, "synch_weights_time_ms": 12.976}, "counters": {"num_env_steps_sampled": 179250, "num_env_steps_trained": 179100, "num_agent_steps_sampled": 179250, "num_agent_steps_trained": 179100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1195, "num_samples_added_to_queue": 179100}, "done": false, "training_iteration": 59, "trial_id": "38f59_00000", "date": "2024-10-10_22-21-37", "timestamp": 1728595297, "time_this_iter_s": 10.473706722259521, "time_total_s": 603.2758030891418, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2db10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 603.2758030891418, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 14.033333333333331, "ram_util_percent": 63.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 232695.25, "policy_loss": 222699.40625, "entropy": 12.820631980895996, "entropy_coeff": 0.01, "var_gnorm": 16.53390884399414, "vf_loss": 1003430.6875, "vf_explained_var": 0.11025488376617432}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 607.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 182250, "num_env_steps_trained": 182100, "num_agent_steps_sampled": 182250, "num_agent_steps_trained": 182100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1215, "num_samples_added_to_queue": 182100, "learner_queue": {"size_count": 607, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.577, "learner_load_time_ms": 0.294, "learner_load_wait_time_ms": 958.27, "learner_dequeue_time_ms": 8164.793}}, "env_runners": {"episode_reward_max": 797.491111111111, "episode_reward_min": 708.6677777777777, "episode_reward_mean": 763.048033333333, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 708.6677777777777}, "policy_reward_max": {"default_policy": 797.491111111111}, "policy_reward_mean": {"default_policy": 763.048033333333}, "custom_metrics": {"num_consolidated_mean": 2.4818000000000002, "num_consolidated_min": 2.3, "num_consolidated_max": 2.62, "num_overloaded_mean": 0.0202, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 4.0073, "num_moves_min": 3.37, "num_moves_max": 4.68, "mean_accuracy_mean": 40.291549999999994, "mean_accuracy_min": 39.978999999999985, "mean_accuracy_max": 40.52366666666666, "num_model_switches_mean": 2.8275, "num_model_switches_min": 2.48, "num_model_switches_max": 3.23, "num_slav_mean": 0.0017084999999999997, "num_slav_min": 0.0002333333333333333, "num_slav_max": 0.004833333333333334, "mean_cluster_cpu_util_mean": 0.4671637300102491, "mean_cluster_cpu_util_min": 0.45586924303592746, "mean_cluster_cpu_util_max": 0.4787924608701834, "mean_cluster_mem_util_mean": 0.308271045618775, "mean_cluster_mem_util_min": 0.30176982853267886, "mean_cluster_mem_util_max": 0.3147817133815551, "reward_consolidation_mean_mean": 3.7737777777777763, "reward_consolidation_mean_min": 3.406666666666666, "reward_consolidation_mean_max": 4.013333333333333, "reward_illegal_mean_mean": -0.033666666666666664, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.946247, "reward_accuracy_mean_min": 3.7444, "reward_accuracy_mean_max": 4.050466666666667, "reward_sla_mean_mean": -0.05587777777777779, "reward_sla_mean_min": -0.1611111111111111, "reward_sla_mean_max": -0.0077777777777777776, "reward_consolidation_sum_mean": 377.3777777777777, "reward_consolidation_sum_min": 340.6666666666666, "reward_consolidation_sum_max": 401.3333333333333, "reward_illegal_sum_mean": -3.3666666666666663, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 394.6247, "reward_accuracy_sum_min": 374.44, "reward_accuracy_sum_max": 405.0466666666667, "reward_sla_sum_mean": -5.587777777777778, "reward_sla_sum_min": -16.11111111111111, "reward_sla_sum_max": -0.7777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4457.0, "global_timestep_min": 2300, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996, 752.7288888888886, 776.9088888888887, 762.6022222222218, 733.9777777777776, 752.0433333333333, 774.911111111111, 788.7988888888887, 745.2477777777773, 743.4444444444435, 735.7166666666662, 742.8122222222221, 753.1988888888889, 750.562222222222, 763.6322222222219, 777.8711111111108, 779.3188888888886, 777.2188888888886, 764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554, 775.6955555555554, 782.9499999999998, 787.3233333333333, 775.0533333333333, 773.3111111111107, 785.8233333333334, 784.7111111111113, 768.9277777777776, 788.2266666666668, 751.1522222222218, 751.0811111111108, 722.6200000000001, 735.697777777778, 712.1744444444444, 779.0688888888886, 734.621111111111, 729.8155555555552, 758.4444444444442, 758.8844444444442, 765.7711111111112, 746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109, 791.3122222222222, 777.5177777777776, 768.8544444444441, 774.102222222222, 790.7477777777775, 758.6900000000002, 754.6133333333329, 776.8677777777775, 791.323333333333, 791.7599999999996, 759.6499999999999, 762.063333333333, 793.4977777777776, 787.9233333333331, 784.4999999999999, 778.8588888888885, 774.4044444444439, 742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [753.5077777777774, 744.5966666666665, 766.2133333333329, 744.0833333333333, 744.3788888888886, 757.3711111111108, 787.7577777777776, 759.5288888888886, 708.6677777777777, 735.5222222222222, 778.9166666666663, 732.8411111111109, 764.7699999999996, 752.7288888888886, 776.9088888888887, 762.6022222222218, 733.9777777777776, 752.0433333333333, 774.911111111111, 788.7988888888887, 745.2477777777773, 743.4444444444435, 735.7166666666662, 742.8122222222221, 753.1988888888889, 750.562222222222, 763.6322222222219, 777.8711111111108, 779.3188888888886, 777.2188888888886, 764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554, 775.6955555555554, 782.9499999999998, 787.3233333333333, 775.0533333333333, 773.3111111111107, 785.8233333333334, 784.7111111111113, 768.9277777777776, 788.2266666666668, 751.1522222222218, 751.0811111111108, 722.6200000000001, 735.697777777778, 712.1744444444444, 779.0688888888886, 734.621111111111, 729.8155555555552, 758.4444444444442, 758.8844444444442, 765.7711111111112, 746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109, 791.3122222222222, 777.5177777777776, 768.8544444444441, 774.102222222222, 790.7477777777775, 758.6900000000002, 754.6133333333329, 776.8677777777775, 791.323333333333, 791.7599999999996, 759.6499999999999, 762.063333333333, 793.4977777777776, 787.9233333333331, 784.4999999999999, 778.8588888888885, 774.4044444444439, 742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19165808351995306, "mean_inference_ms": 1.757378737256817, "mean_action_processing_ms": 0.07222489766760358, "mean_env_wait_ms": 1.1906132600474337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004440784454345703, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.06617164611816406}, "num_episodes": 30, "episode_return_max": 797.491111111111, "episode_return_min": 708.6677777777777, "episode_return_mean": 763.048033333333, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182250, "num_agent_steps_trained": 182100, "num_env_steps_sampled": 182250, "num_env_steps_trained": 182100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.7425536837128, "num_env_steps_trained_throughput_per_sec": 295.7425536837128, "timesteps_total": 182250, "num_env_steps_sampled_lifetime": 182250, "num_agent_steps_sampled_lifetime": 182250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 182250, "timers": {"training_iteration_time_ms": 10221.318, "restore_workers_time_ms": 0.011, "training_step_time_ms": 501.227, "sample_time_ms": 486.309, "synch_weights_time_ms": 13.585}, "counters": {"num_env_steps_sampled": 182250, "num_env_steps_trained": 182100, "num_agent_steps_sampled": 182250, "num_agent_steps_trained": 182100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1215, "num_samples_added_to_queue": 182100}, "done": false, "training_iteration": 60, "trial_id": "38f59_00000", "date": "2024-10-10_22-21-47", "timestamp": 1728595307, "time_this_iter_s": 10.16087532043457, "time_total_s": 613.4366784095764, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde5c90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 613.4366784095764, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 11.020000000000001, "ram_util_percent": 62.61333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 228248.125, "policy_loss": 217671.0625, "entropy": 12.784284591674805, "entropy_coeff": 0.01, "var_gnorm": 16.54043197631836, "vf_loss": 1061542.75, "vf_explained_var": 0.11495393514633179}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 616.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 185100, "num_env_steps_trained": 184800, "num_agent_steps_sampled": 185100, "num_agent_steps_trained": 184800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1234, "num_samples_added_to_queue": 185100, "learner_queue": {"size_count": 616, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.277, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 1030.599, "learner_dequeue_time_ms": 8206.429}}, "env_runners": {"episode_reward_max": 801.4399999999997, "episode_reward_min": 712.1744444444444, "episode_reward_mean": 768.8009888888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 712.1744444444444}, "policy_reward_max": {"default_policy": 801.4399999999997}, "policy_reward_mean": {"default_policy": 768.8009888888888}, "custom_metrics": {"num_consolidated_mean": 2.5212, "num_consolidated_min": 2.31, "num_consolidated_max": 2.65, "num_overloaded_mean": 0.021599999999999998, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.8238, "num_moves_min": 3.31, "num_moves_max": 4.49, "mean_accuracy_mean": 40.334173333333325, "mean_accuracy_min": 39.978999999999985, "mean_accuracy_max": 40.55533333333333, "num_model_switches_mean": 2.7567000000000004, "num_model_switches_min": 2.33, "num_model_switches_max": 3.13, "num_slav_mean": 0.0014876666666666667, "num_slav_min": 0.0002333333333333333, "num_slav_max": 0.004533333333333334, "mean_cluster_cpu_util_mean": 0.46906935300675195, "mean_cluster_cpu_util_min": 0.45586924303592746, "mean_cluster_cpu_util_max": 0.47901132968976695, "mean_cluster_mem_util_mean": 0.30962360008180484, "mean_cluster_mem_util_min": 0.30273707967364166, "mean_cluster_mem_util_max": 0.31528527350813745, "reward_consolidation_mean_mean": 3.8282222222222213, "reward_consolidation_mean_min": 3.4844444444444433, "reward_consolidation_mean_max": 4.075555555555554, "reward_illegal_mean_mean": -0.036, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9445210000000004, "reward_accuracy_mean_min": 3.7444, "reward_accuracy_mean_max": 4.053000000000001, "reward_sla_mean_mean": -0.04873333333333335, "reward_sla_mean_min": -0.14944444444444444, "reward_sla_mean_max": -0.0077777777777777776, "reward_consolidation_sum_mean": 382.82222222222214, "reward_consolidation_sum_min": 348.44444444444434, "reward_consolidation_sum_max": 407.55555555555543, "reward_illegal_sum_mean": -3.6, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 394.4521, "reward_accuracy_sum_min": 374.44, "reward_accuracy_sum_max": 405.30000000000007, "reward_sla_sum_mean": -4.873333333333334, "reward_sla_sum_min": -14.944444444444445, "reward_sla_sum_max": -0.7777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5459.0, "global_timestep_min": 3300, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554, 775.6955555555554, 782.9499999999998, 787.3233333333333, 775.0533333333333, 773.3111111111107, 785.8233333333334, 784.7111111111113, 768.9277777777776, 788.2266666666668, 751.1522222222218, 751.0811111111108, 722.6200000000001, 735.697777777778, 712.1744444444444, 779.0688888888886, 734.621111111111, 729.8155555555552, 758.4444444444442, 758.8844444444442, 765.7711111111112, 746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109, 791.3122222222222, 777.5177777777776, 768.8544444444441, 774.102222222222, 790.7477777777775, 758.6900000000002, 754.6133333333329, 776.8677777777775, 791.323333333333, 791.7599999999996, 759.6499999999999, 762.063333333333, 793.4977777777776, 787.9233333333331, 784.4999999999999, 778.8588888888885, 774.4044444444439, 742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332, 796.6833333333333, 781.7888888888886, 780.6322222222219, 759.155555555555, 784.2699999999998, 765.2766666666662, 766.7744444444443, 739.0966666666668, 782.3700000000001, 796.7877777777777, 757.8166666666664, 778.8066666666663, 756.0333333333332, 771.4711111111108, 771.4722222222218, 758.5366666666663, 767.32, 799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [764.6122222222222, 767.9366666666666, 754.7066666666665, 722.8911111111111, 738.2088888888885, 757.6877777777776, 780.6733333333328, 769.7988888888884, 728.8666666666662, 752.4455555555554, 775.6955555555554, 782.9499999999998, 787.3233333333333, 775.0533333333333, 773.3111111111107, 785.8233333333334, 784.7111111111113, 768.9277777777776, 788.2266666666668, 751.1522222222218, 751.0811111111108, 722.6200000000001, 735.697777777778, 712.1744444444444, 779.0688888888886, 734.621111111111, 729.8155555555552, 758.4444444444442, 758.8844444444442, 765.7711111111112, 746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109, 791.3122222222222, 777.5177777777776, 768.8544444444441, 774.102222222222, 790.7477777777775, 758.6900000000002, 754.6133333333329, 776.8677777777775, 791.323333333333, 791.7599999999996, 759.6499999999999, 762.063333333333, 793.4977777777776, 787.9233333333331, 784.4999999999999, 778.8588888888885, 774.4044444444439, 742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332, 796.6833333333333, 781.7888888888886, 780.6322222222219, 759.155555555555, 784.2699999999998, 765.2766666666662, 766.7744444444443, 739.0966666666668, 782.3700000000001, 796.7877777777777, 757.8166666666664, 778.8066666666663, 756.0333333333332, 771.4711111111108, 771.4722222222218, 758.5366666666663, 767.32, 799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19179162203712313, "mean_inference_ms": 1.759775320124946, "mean_action_processing_ms": 0.07228667573228281, "mean_env_wait_ms": 1.1915621293836407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004640817642211914, "StateBufferConnector_ms": 0.0028693675994873047, "ViewRequirementAgentConnector_ms": 0.06715583801269531}, "num_episodes": 30, "episode_return_max": 801.4399999999997, "episode_return_min": 712.1744444444444, "episode_return_mean": 768.8009888888888, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185100, "num_agent_steps_trained": 184800, "num_env_steps_sampled": 185100, "num_env_steps_trained": 184800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.9314253001452, "num_env_steps_trained_throughput_per_sec": 263.30345554750596, "timesteps_total": 185100, "num_env_steps_sampled_lifetime": 185100, "num_agent_steps_sampled_lifetime": 185100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 185100, "timers": {"training_iteration_time_ms": 10226.55, "restore_workers_time_ms": 0.012, "training_step_time_ms": 529.259, "sample_time_ms": 514.481, "synch_weights_time_ms": 13.474}, "counters": {"num_env_steps_sampled": 185100, "num_env_steps_trained": 184800, "num_agent_steps_sampled": 185100, "num_agent_steps_trained": 184800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1234, "num_samples_added_to_queue": 185100}, "done": false, "training_iteration": 61, "trial_id": "38f59_00000", "date": "2024-10-10_22-21-58", "timestamp": 1728595318, "time_this_iter_s": 10.265387535095215, "time_total_s": 623.7020659446716, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe20140490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 623.7020659446716, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 14.533333333333335, "ram_util_percent": 62.54666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 182368.1875, "policy_loss": 173065.90625, "entropy": 11.509222984313965, "entropy_coeff": 0.01, "var_gnorm": 16.558502197265625, "vf_loss": 933681.8125, "vf_explained_var": 0.13856655359268188}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 188100, "num_env_steps_trained": 187800, "num_agent_steps_sampled": 188100, "num_agent_steps_trained": 187800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1254, "num_samples_added_to_queue": 188100, "learner_queue": {"size_count": 626, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.515, "learner_load_time_ms": 0.308, "learner_load_wait_time_ms": 985.547, "learner_dequeue_time_ms": 8252.045}}, "env_runners": {"episode_reward_max": 812.9855555555549, "episode_reward_min": 730.9399999999998, "episode_reward_mean": 776.7422888888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 730.9399999999998}, "policy_reward_max": {"default_policy": 812.9855555555549}, "policy_reward_mean": {"default_policy": 776.7422888888888}, "custom_metrics": {"num_consolidated_mean": 2.5646, "num_consolidated_min": 2.38, "num_consolidated_max": 2.73, "num_overloaded_mean": 0.021099999999999994, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.6178, "num_moves_min": 2.93, "num_moves_max": 4.21, "mean_accuracy_mean": 40.363116666666656, "mean_accuracy_min": 40.124666666666656, "mean_accuracy_max": 40.55533333333333, "num_model_switches_mean": 2.639, "num_model_switches_min": 2.13, "num_model_switches_max": 3.13, "num_slav_mean": 0.0013115000000000002, "num_slav_min": 0.00021666666666666668, "num_slav_max": 0.0033166666666666674, "mean_cluster_cpu_util_mean": 0.4714407671249882, "mean_cluster_cpu_util_min": 0.4582125294957642, "mean_cluster_cpu_util_max": 0.48141335227218596, "mean_cluster_mem_util_mean": 0.310969773960217, "mean_cluster_mem_util_min": 0.30356339554809264, "mean_cluster_mem_util_max": 0.316761769138035, "reward_consolidation_mean_mean": 3.8965111111111104, "reward_consolidation_mean_min": 3.5933333333333333, "reward_consolidation_mean_max": 4.168888888888888, "reward_illegal_mean_mean": -0.035166666666666666, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9494006666666666, "reward_accuracy_mean_min": 3.7444, "reward_accuracy_mean_max": 4.053000000000001, "reward_sla_mean_mean": -0.04332222222222222, "reward_sla_mean_min": -0.11055555555555556, "reward_sla_mean_max": -0.007222222222222222, "reward_consolidation_sum_mean": 389.65111111111105, "reward_consolidation_sum_min": 359.3333333333333, "reward_consolidation_sum_max": 416.8888888888888, "reward_illegal_sum_mean": -3.516666666666666, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 394.94006666666667, "reward_accuracy_sum_min": 374.44, "reward_accuracy_sum_max": 405.30000000000007, "reward_sla_sum_mean": -4.332222222222223, "reward_sla_sum_min": -11.055555555555555, "reward_sla_sum_max": -0.7222222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5748.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109, 791.3122222222222, 777.5177777777776, 768.8544444444441, 774.102222222222, 790.7477777777775, 758.6900000000002, 754.6133333333329, 776.8677777777775, 791.323333333333, 791.7599999999996, 759.6499999999999, 762.063333333333, 793.4977777777776, 787.9233333333331, 784.4999999999999, 778.8588888888885, 774.4044444444439, 742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332, 796.6833333333333, 781.7888888888886, 780.6322222222219, 759.155555555555, 784.2699999999998, 765.2766666666662, 766.7744444444443, 739.0966666666668, 782.3700000000001, 796.7877777777777, 757.8166666666664, 778.8066666666663, 756.0333333333332, 771.4711111111108, 771.4722222222218, 758.5366666666663, 767.32, 799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333, 764.2044444444442, 801.9399999999995, 784.9733333333329, 774.1022222222222, 746.7044444444441, 774.0544444444439, 793.071111111111, 766.4066666666664, 808.4877777777774, 772.3799999999997, 758.0055555555552, 776.6966666666664, 769.0377777777776, 786.3933333333331, 797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [746.9755555555554, 735.3955555555552, 761.5855555555552, 768.5244444444442, 787.073333333333, 781.9922222222218, 763.1833333333334, 789.4388888888886, 787.7099999999997, 797.1611111111109, 791.3122222222222, 777.5177777777776, 768.8544444444441, 774.102222222222, 790.7477777777775, 758.6900000000002, 754.6133333333329, 776.8677777777775, 791.323333333333, 791.7599999999996, 759.6499999999999, 762.063333333333, 793.4977777777776, 787.9233333333331, 784.4999999999999, 778.8588888888885, 774.4044444444439, 742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332, 796.6833333333333, 781.7888888888886, 780.6322222222219, 759.155555555555, 784.2699999999998, 765.2766666666662, 766.7744444444443, 739.0966666666668, 782.3700000000001, 796.7877777777777, 757.8166666666664, 778.8066666666663, 756.0333333333332, 771.4711111111108, 771.4722222222218, 758.5366666666663, 767.32, 799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333, 764.2044444444442, 801.9399999999995, 784.9733333333329, 774.1022222222222, 746.7044444444441, 774.0544444444439, 793.071111111111, 766.4066666666664, 808.4877777777774, 772.3799999999997, 758.0055555555552, 776.6966666666664, 769.0377777777776, 786.3933333333331, 797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19188561516426725, "mean_inference_ms": 1.7603948693704217, "mean_action_processing_ms": 0.07232605594852812, "mean_env_wait_ms": 1.192038544325921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004641294479370117, "StateBufferConnector_ms": 0.002860546112060547, "ViewRequirementAgentConnector_ms": 0.06736350059509277}, "num_episodes": 30, "episode_return_max": 812.9855555555549, "episode_return_min": 730.9399999999998, "episode_return_mean": 776.7422888888888, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188100, "num_agent_steps_trained": 187800, "num_env_steps_sampled": 188100, "num_env_steps_trained": 187800, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 289.0150077771375, "num_env_steps_trained_throughput_per_sec": 289.0150077771375, "timesteps_total": 188100, "num_env_steps_sampled_lifetime": 188100, "num_agent_steps_sampled_lifetime": 188100, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 188100, "timers": {"training_iteration_time_ms": 10254.984, "restore_workers_time_ms": 0.014, "training_step_time_ms": 526.835, "sample_time_ms": 510.681, "synch_weights_time_ms": 14.696}, "counters": {"num_env_steps_sampled": 188100, "num_env_steps_trained": 187800, "num_agent_steps_sampled": 188100, "num_agent_steps_trained": 187800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1254, "num_samples_added_to_queue": 188100}, "done": false, "training_iteration": 62, "trial_id": "38f59_00000", "date": "2024-10-10_22-22-08", "timestamp": 1728595328, "time_this_iter_s": 10.405483961105347, "time_total_s": 634.107549905777, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe20140040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 634.107549905777, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 12.986666666666668, "ram_util_percent": 62.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 163195.390625, "policy_loss": 153886.34375, "entropy": 10.8844575881958, "entropy_coeff": 0.01, "var_gnorm": 16.583242416381836, "vf_loss": 934170.5625, "vf_explained_var": 0.15681278705596924}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 636.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 190950, "num_env_steps_trained": 190800, "num_agent_steps_sampled": 190950, "num_agent_steps_trained": 190800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1273, "num_samples_added_to_queue": 190800, "learner_queue": {"size_count": 636, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.18, "learner_load_time_ms": 0.334, "learner_load_wait_time_ms": 1002.688, "learner_dequeue_time_ms": 8303.063}}, "env_runners": {"episode_reward_max": 830.62, "episode_reward_min": 730.9399999999998, "episode_reward_mean": 785.2248888888887, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 730.9399999999998}, "policy_reward_max": {"default_policy": 830.62}, "policy_reward_mean": {"default_policy": 785.2248888888887}, "custom_metrics": {"num_consolidated_mean": 2.6152999999999995, "num_consolidated_min": 2.43, "num_consolidated_max": 2.81, "num_overloaded_mean": 0.0208, "num_overloaded_min": 0.0, "num_overloaded_max": 0.07, "num_moves_mean": 3.3489, "num_moves_min": 2.33, "num_moves_max": 3.95, "mean_accuracy_mean": 40.37667, "mean_accuracy_min": 40.225999999999985, "mean_accuracy_max": 40.55533333333333, "num_model_switches_mean": 2.4754, "num_model_switches_min": 1.82, "num_model_switches_max": 2.97, "num_slav_mean": 0.0012091666666666665, "num_slav_min": 0.00021666666666666668, "num_slav_max": 0.0031333333333333335, "mean_cluster_cpu_util_mean": 0.47458894181936706, "mean_cluster_cpu_util_min": 0.4582125294957642, "mean_cluster_cpu_util_max": 0.48956472413184576, "mean_cluster_mem_util_mean": 0.31272934485598036, "mean_cluster_mem_util_min": 0.30356339554809264, "mean_cluster_mem_util_max": 0.3209022727761991, "reward_consolidation_mean_mean": 3.97491111111111, "reward_consolidation_mean_min": 3.6399999999999992, "reward_consolidation_mean_max": 4.324444444444444, "reward_illegal_mean_mean": -0.03466666666666666, "reward_illegal_mean_min": -0.11666666666666665, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9518433333333336, "reward_accuracy_mean_min": 3.7444, "reward_accuracy_mean_max": 4.053000000000001, "reward_sla_mean_mean": -0.03983888888888889, "reward_sla_mean_min": -0.10444444444444445, "reward_sla_mean_max": -0.007222222222222222, "reward_consolidation_sum_mean": 397.49111111111097, "reward_consolidation_sum_min": 363.99999999999994, "reward_consolidation_sum_max": 432.4444444444444, "reward_illegal_sum_mean": -3.466666666666665, "reward_illegal_sum_min": -11.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 395.18433333333337, "reward_accuracy_sum_min": 374.44, "reward_accuracy_sum_max": 405.30000000000007, "reward_sla_sum_mean": -3.9838888888888886, "reward_sla_sum_min": -10.444444444444445, "reward_sla_sum_max": -0.7222222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4549.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332, 796.6833333333333, 781.7888888888886, 780.6322222222219, 759.155555555555, 784.2699999999998, 765.2766666666662, 766.7744444444443, 739.0966666666668, 782.3700000000001, 796.7877777777777, 757.8166666666664, 778.8066666666663, 756.0333333333332, 771.4711111111108, 771.4722222222218, 758.5366666666663, 767.32, 799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333, 764.2044444444442, 801.9399999999995, 784.9733333333329, 774.1022222222222, 746.7044444444441, 774.0544444444439, 793.071111111111, 766.4066666666664, 808.4877777777774, 772.3799999999997, 758.0055555555552, 776.6966666666664, 769.0377777777776, 786.3933333333331, 797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886, 778.1655555555552, 806.5666666666665, 813.4233333333334, 830.62, 829.6199999999994, 821.0966666666666, 785.2111111111108, 815.6055555555553, 772.4844444444444, 811.1699999999998, 814.3299999999997, 807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [742.594444444444, 768.2600000000002, 764.7833333333335, 779.9522222222218, 766.8533333333335, 769.8933333333333, 760.1077777777776, 743.5155555555552, 761.8066666666663, 730.9399999999998, 765.6544444444445, 797.491111111111, 768.8933333333332, 796.6833333333333, 781.7888888888886, 780.6322222222219, 759.155555555555, 784.2699999999998, 765.2766666666662, 766.7744444444443, 739.0966666666668, 782.3700000000001, 796.7877777777777, 757.8166666666664, 778.8066666666663, 756.0333333333332, 771.4711111111108, 771.4722222222218, 758.5366666666663, 767.32, 799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333, 764.2044444444442, 801.9399999999995, 784.9733333333329, 774.1022222222222, 746.7044444444441, 774.0544444444439, 793.071111111111, 766.4066666666664, 808.4877777777774, 772.3799999999997, 758.0055555555552, 776.6966666666664, 769.0377777777776, 786.3933333333331, 797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886, 778.1655555555552, 806.5666666666665, 813.4233333333334, 830.62, 829.6199999999994, 821.0966666666666, 785.2111111111108, 815.6055555555553, 772.4844444444444, 811.1699999999998, 814.3299999999997, 807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19201541278764875, "mean_inference_ms": 1.7605133228202459, "mean_action_processing_ms": 0.07236943904699253, "mean_env_wait_ms": 1.1925415466756988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004500389099121094, "StateBufferConnector_ms": 0.0028922557830810547, "ViewRequirementAgentConnector_ms": 0.06774091720581055}, "num_episodes": 27, "episode_return_max": 830.62, "episode_return_min": 730.9399999999998, "episode_return_mean": 785.2248888888887, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190950, "num_agent_steps_trained": 190800, "num_env_steps_sampled": 190950, "num_env_steps_trained": 190800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.9694193808849, "num_env_steps_trained_throughput_per_sec": 295.75728355882626, "timesteps_total": 190950, "num_env_steps_sampled_lifetime": 190950, "num_agent_steps_sampled_lifetime": 190950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 190950, "timers": {"training_iteration_time_ms": 10268.076, "restore_workers_time_ms": 0.012, "training_step_time_ms": 529.082, "sample_time_ms": 514.343, "synch_weights_time_ms": 13.38}, "counters": {"num_env_steps_sampled": 190950, "num_env_steps_trained": 190800, "num_agent_steps_sampled": 190950, "num_agent_steps_trained": 190800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1273, "num_samples_added_to_queue": 190800}, "done": false, "training_iteration": 63, "trial_id": "38f59_00000", "date": "2024-10-10_22-22-18", "timestamp": 1728595338, "time_this_iter_s": 10.15828275680542, "time_total_s": 644.2658326625824, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2c7c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.2658326625824, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 13.614285714285716, "ram_util_percent": 62.79285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 153839.0, "policy_loss": 143785.96875, "entropy": 10.313498497009277, "entropy_coeff": 0.01, "var_gnorm": 16.6059513092041, "vf_loss": 1008396.5, "vf_explained_var": 0.1634005308151245}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 645.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 193800, "num_env_steps_trained": 193500, "num_agent_steps_sampled": 193800, "num_agent_steps_trained": 193500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1292, "num_samples_added_to_queue": 193800, "learner_queue": {"size_count": 645, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.074, "learner_load_time_ms": 0.33, "learner_load_wait_time_ms": 1011.755, "learner_dequeue_time_ms": 8387.813}}, "env_runners": {"episode_reward_max": 842.2733333333334, "episode_reward_min": 743.0555555555554, "episode_reward_mean": 799.5584111111109, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 743.0555555555554}, "policy_reward_max": {"default_policy": 842.2733333333334}, "policy_reward_mean": {"default_policy": 799.5584111111109}, "custom_metrics": {"num_consolidated_mean": 2.6844, "num_consolidated_min": 2.46, "num_consolidated_max": 2.86, "num_overloaded_mean": 0.017700000000000004, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 3.0181, "num_moves_min": 2.28, "num_moves_max": 3.94, "mean_accuracy_mean": 40.38667666666666, "mean_accuracy_min": 40.225999999999985, "mean_accuracy_max": 40.54266666666666, "num_model_switches_mean": 2.2497999999999996, "num_model_switches_min": 1.76, "num_model_switches_max": 2.89, "num_slav_mean": 0.001093, "num_slav_min": 0.00021666666666666668, "num_slav_max": 0.0031333333333333335, "mean_cluster_cpu_util_mean": 0.4789671936696993, "mean_cluster_cpu_util_min": 0.46565082731926966, "mean_cluster_cpu_util_max": 0.49169552970677133, "mean_cluster_mem_util_mean": 0.3150572876356239, "mean_cluster_mem_util_min": 0.3075617481486265, "mean_cluster_mem_util_max": 0.32377439615086545, "reward_consolidation_mean_mean": 4.095466666666666, "reward_consolidation_mean_min": 3.686666666666665, "reward_consolidation_mean_max": 4.4177777777777765, "reward_illegal_mean_mean": -0.02949999999999999, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9656230000000003, "reward_accuracy_mean_min": 3.824066666666667, "reward_accuracy_mean_max": 4.053000000000001, "reward_sla_mean_mean": -0.036005555555555555, "reward_sla_mean_min": -0.10444444444444445, "reward_sla_mean_max": -0.007222222222222222, "reward_consolidation_sum_mean": 409.54666666666657, "reward_consolidation_sum_min": 368.6666666666665, "reward_consolidation_sum_max": 441.77777777777766, "reward_illegal_sum_mean": -2.95, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 396.56230000000005, "reward_accuracy_sum_min": 382.4066666666667, "reward_accuracy_sum_max": 405.30000000000007, "reward_sla_sum_mean": -3.6005555555555553, "reward_sla_sum_min": -10.444444444444445, "reward_sla_sum_max": -0.7222222222222222, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3209.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333, 764.2044444444442, 801.9399999999995, 784.9733333333329, 774.1022222222222, 746.7044444444441, 774.0544444444439, 793.071111111111, 766.4066666666664, 808.4877777777774, 772.3799999999997, 758.0055555555552, 776.6966666666664, 769.0377777777776, 786.3933333333331, 797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886, 778.1655555555552, 806.5666666666665, 813.4233333333334, 830.62, 829.6199999999994, 821.0966666666666, 785.2111111111108, 815.6055555555553, 772.4844444444444, 811.1699999999998, 814.3299999999997, 807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775, 826.1077777777778, 786.8544444444444, 831.4677777777775, 811.5488888888887, 830.6588888888882, 815.6766666666662, 810.6522222222221, 842.2733333333334, 801.0044444444443, 825.674444444444, 811.7977777777775, 788.5433333333334, 817.0266666666663, 812.932222222222, 794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [799.2166666666666, 801.4399999999997, 765.2499999999999, 771.9311111111107, 743.0555555555554, 783.4799999999998, 757.4144444444441, 793.4777777777778, 763.7666666666668, 799.5511111111107, 794.6888888888889, 797.1377777777775, 779.7433333333333, 764.2044444444442, 801.9399999999995, 784.9733333333329, 774.1022222222222, 746.7044444444441, 774.0544444444439, 793.071111111111, 766.4066666666664, 808.4877777777774, 772.3799999999997, 758.0055555555552, 776.6966666666664, 769.0377777777776, 786.3933333333331, 797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886, 778.1655555555552, 806.5666666666665, 813.4233333333334, 830.62, 829.6199999999994, 821.0966666666666, 785.2111111111108, 815.6055555555553, 772.4844444444444, 811.1699999999998, 814.3299999999997, 807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775, 826.1077777777778, 786.8544444444444, 831.4677777777775, 811.5488888888887, 830.6588888888882, 815.6766666666662, 810.6522222222221, 842.2733333333334, 801.0044444444443, 825.674444444444, 811.7977777777775, 788.5433333333334, 817.0266666666663, 812.932222222222, 794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1921964836891535, "mean_inference_ms": 1.7617806008014725, "mean_action_processing_ms": 0.07243528949375952, "mean_env_wait_ms": 1.1933281369548996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282236099243164, "StateBufferConnector_ms": 0.0028924942016601562, "ViewRequirementAgentConnector_ms": 0.06831145286560059}, "num_episodes": 30, "episode_return_max": 842.2733333333334, "episode_return_min": 743.0555555555554, "episode_return_mean": 799.5584111111109, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193800, "num_agent_steps_trained": 193500, "num_env_steps_sampled": 193800, "num_env_steps_trained": 193500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 283.1045921627425, "num_env_steps_trained_throughput_per_sec": 268.2043504699666, "timesteps_total": 193800, "num_env_steps_sampled_lifetime": 193800, "num_agent_steps_sampled_lifetime": 193800, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 193800, "timers": {"training_iteration_time_ms": 10227.826, "restore_workers_time_ms": 0.011, "training_step_time_ms": 509.298, "sample_time_ms": 495.1, "synch_weights_time_ms": 12.905}, "counters": {"num_env_steps_sampled": 193800, "num_env_steps_trained": 193500, "num_agent_steps_sampled": 193800, "num_agent_steps_trained": 193500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1292, "num_samples_added_to_queue": 193800}, "done": false, "training_iteration": 64, "trial_id": "38f59_00000", "date": "2024-10-10_22-22-29", "timestamp": 1728595349, "time_this_iter_s": 10.08549451828003, "time_total_s": 654.3513271808624, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18b80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 654.3513271808624, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 14.799999999999999, "ram_util_percent": 63.31333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 147192.25, "policy_loss": 136883.4375, "entropy": 9.967769622802734, "entropy_coeff": 0.01, "var_gnorm": 16.627214431762695, "vf_loss": 1033872.1875, "vf_explained_var": 0.17084527015686035}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 654.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 196500, "num_env_steps_trained": 196200, "num_agent_steps_sampled": 196500, "num_agent_steps_trained": 196200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1310, "num_samples_added_to_queue": 196500, "learner_queue": {"size_count": 654, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.321, "learner_load_time_ms": 0.328, "learner_load_wait_time_ms": 1047.942, "learner_dequeue_time_ms": 8454.397}}, "env_runners": {"episode_reward_max": 843.222222222222, "episode_reward_min": 760.1288888888886, "episode_reward_mean": 811.7425222222219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 760.1288888888886}, "policy_reward_max": {"default_policy": 843.222222222222}, "policy_reward_mean": {"default_policy": 811.7425222222219}, "custom_metrics": {"num_consolidated_mean": 2.7397000000000005, "num_consolidated_min": 2.54, "num_consolidated_max": 2.87, "num_overloaded_mean": 0.015000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.05, "num_moves_mean": 2.7577000000000003, "num_moves_min": 2.19, "num_moves_max": 3.76, "mean_accuracy_mean": 40.40149666666666, "mean_accuracy_min": 40.225999999999985, "mean_accuracy_max": 40.54266666666666, "num_model_switches_mean": 2.0585999999999998, "num_model_switches_min": 1.47, "num_model_switches_max": 2.63, "num_slav_mean": 0.0008915000000000003, "num_slav_min": 0.00018333333333333334, "num_slav_max": 0.0031333333333333335, "mean_cluster_cpu_util_mean": 0.4827841390121849, "mean_cluster_cpu_util_min": 0.46728333032064534, "mean_cluster_cpu_util_max": 0.4934100709636887, "mean_cluster_mem_util_mean": 0.3170852210776716, "mean_cluster_mem_util_min": 0.3075617481486265, "mean_cluster_mem_util_max": 0.32377439615086545, "reward_consolidation_mean_mean": 4.1936222222222215, "reward_consolidation_mean_min": 3.873333333333332, "reward_consolidation_mean_max": 4.4177777777777765, "reward_illegal_mean_mean": -0.024999999999999994, "reward_illegal_mean_min": -0.08333333333333331, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.9781196666666663, "reward_accuracy_mean_min": 3.824066666666667, "reward_accuracy_mean_max": 4.048566666666667, "reward_sla_mean_mean": -0.029316666666666668, "reward_sla_mean_min": -0.10444444444444445, "reward_sla_mean_max": -0.006111111111111111, "reward_consolidation_sum_mean": 419.3622222222221, "reward_consolidation_sum_min": 387.3333333333332, "reward_consolidation_sum_max": 441.77777777777766, "reward_illegal_sum_mean": -2.4999999999999996, "reward_illegal_sum_min": -8.333333333333332, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 397.8119666666667, "reward_accuracy_sum_min": 382.4066666666667, "reward_accuracy_sum_max": 404.8566666666667, "reward_sla_sum_mean": -2.9316666666666666, "reward_sla_sum_min": -10.444444444444445, "reward_sla_sum_max": -0.6111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2238.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886, 778.1655555555552, 806.5666666666665, 813.4233333333334, 830.62, 829.6199999999994, 821.0966666666666, 785.2111111111108, 815.6055555555553, 772.4844444444444, 811.1699999999998, 814.3299999999997, 807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775, 826.1077777777778, 786.8544444444444, 831.4677777777775, 811.5488888888887, 830.6588888888882, 815.6766666666662, 810.6522222222221, 842.2733333333334, 801.0044444444443, 825.674444444444, 811.7977777777775, 788.5433333333334, 817.0266666666663, 812.932222222222, 794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664, 837.9688888888885, 788.2355555555553, 805.702222222222, 803.5899999999997, 843.222222222222, 805.7877777777778, 829.9288888888887, 810.9166666666665, 837.8177777777772, 805.9155555555552, 830.2711111111108, 831.2644444444442, 813.5844444444442, 835.5266666666664, 828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [797.7344444444441, 789.0355555555556, 789.3722222222223, 801.0222222222221, 775.7588888888888, 782.2122222222221, 796.865555555555, 768.8711111111106, 811.1611111111109, 797.268888888889, 778.5277777777777, 806.1788888888889, 800.1144444444437, 809.6155555555553, 812.9855555555549, 760.1288888888886, 778.1655555555552, 806.5666666666665, 813.4233333333334, 830.62, 829.6199999999994, 821.0966666666666, 785.2111111111108, 815.6055555555553, 772.4844444444444, 811.1699999999998, 814.3299999999997, 807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775, 826.1077777777778, 786.8544444444444, 831.4677777777775, 811.5488888888887, 830.6588888888882, 815.6766666666662, 810.6522222222221, 842.2733333333334, 801.0044444444443, 825.674444444444, 811.7977777777775, 788.5433333333334, 817.0266666666663, 812.932222222222, 794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664, 837.9688888888885, 788.2355555555553, 805.702222222222, 803.5899999999997, 843.222222222222, 805.7877777777778, 829.9288888888887, 810.9166666666665, 837.8177777777772, 805.9155555555552, 830.2711111111108, 831.2644444444442, 813.5844444444442, 835.5266666666664, 828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19238161550565025, "mean_inference_ms": 1.7623741105432875, "mean_action_processing_ms": 0.0724969948370607, "mean_env_wait_ms": 1.194084963167161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004506587982177734, "StateBufferConnector_ms": 0.0029754638671875, "ViewRequirementAgentConnector_ms": 0.07081222534179688}, "num_episodes": 27, "episode_return_max": 843.222222222222, "episode_return_min": 760.1288888888886, "episode_return_mean": 811.7425222222219, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196500, "num_agent_steps_trained": 196200, "num_env_steps_sampled": 196500, "num_env_steps_trained": 196200, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 267.99132251721215, "num_env_steps_trained_throughput_per_sec": 267.99132251721215, "timesteps_total": 196500, "num_env_steps_sampled_lifetime": 196500, "num_agent_steps_sampled_lifetime": 196500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 196500, "timers": {"training_iteration_time_ms": 10205.194, "restore_workers_time_ms": 0.014, "training_step_time_ms": 570.553, "sample_time_ms": 554.757, "synch_weights_time_ms": 14.147}, "counters": {"num_env_steps_sampled": 196500, "num_env_steps_trained": 196200, "num_agent_steps_sampled": 196500, "num_agent_steps_trained": 196200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1310, "num_samples_added_to_queue": 196500}, "done": false, "training_iteration": 65, "trial_id": "38f59_00000", "date": "2024-10-10_22-22-39", "timestamp": 1728595359, "time_this_iter_s": 10.084068059921265, "time_total_s": 664.4353952407837, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc4a00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 664.4353952407837, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 14.864285714285714, "ram_util_percent": 62.93571428571426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 132934.359375, "policy_loss": 123683.015625, "entropy": 9.324990272521973, "entropy_coeff": 0.01, "var_gnorm": 16.651987075805664, "vf_loss": 927932.25, "vf_explained_var": 0.19683927297592163}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 664.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 199350, "num_env_steps_trained": 199200, "num_agent_steps_sampled": 199350, "num_agent_steps_trained": 199200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1329, "num_samples_added_to_queue": 199200, "learner_queue": {"size_count": 664, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.045, "learner_load_time_ms": 0.304, "learner_load_wait_time_ms": 1024.706, "learner_dequeue_time_ms": 8515.834}}, "env_runners": {"episode_reward_max": 849.2744444444443, "episode_reward_min": 780.863333333333, "episode_reward_mean": 821.491522222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 780.863333333333}, "policy_reward_max": {"default_policy": 849.2744444444443}, "policy_reward_mean": {"default_policy": 821.491522222222}, "custom_metrics": {"num_consolidated_mean": 2.7859, "num_consolidated_min": 2.64, "num_consolidated_max": 2.89, "num_overloaded_mean": 0.0131, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.5179, "num_moves_min": 1.99, "num_moves_max": 3.31, "mean_accuracy_mean": 40.43265666666666, "mean_accuracy_min": 40.23233333333333, "mean_accuracy_max": 40.599666666666664, "num_model_switches_mean": 1.8889999999999998, "num_model_switches_min": 1.42, "num_model_switches_max": 2.63, "num_slav_mean": 0.0007991666666666667, "num_slav_min": 0.0001, "num_slav_max": 0.0030666666666666663, "mean_cluster_cpu_util_mean": 0.4856845385477902, "mean_cluster_cpu_util_min": 0.4732023443506025, "mean_cluster_cpu_util_max": 0.4934100709636887, "mean_cluster_mem_util_mean": 0.31878383958351264, "mean_cluster_mem_util_min": 0.3123415730216137, "mean_cluster_mem_util_max": 0.32450562946697664, "reward_consolidation_mean_mean": 4.274044444444444, "reward_consolidation_mean_min": 3.982222222222221, "reward_consolidation_mean_max": 4.448888888888888, "reward_illegal_mean_mean": -0.02183333333333333, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 3.989076333333334, "reward_accuracy_mean_min": 3.8740333333333337, "reward_accuracy_mean_max": 4.059966666666667, "reward_sla_mean_mean": -0.026372222222222224, "reward_sla_mean_min": -0.09999999999999998, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 427.4044444444443, "reward_consolidation_sum_min": 398.2222222222221, "reward_consolidation_sum_max": 444.8888888888888, "reward_illegal_sum_mean": -2.1833333333333327, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 398.9076333333333, "reward_accuracy_sum_min": 387.40333333333336, "reward_accuracy_sum_max": 405.9966666666667, "reward_sla_sum_mean": -2.6372222222222224, "reward_sla_sum_min": -9.999999999999998, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2361.0, "global_timestep_min": 400, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775, 826.1077777777778, 786.8544444444444, 831.4677777777775, 811.5488888888887, 830.6588888888882, 815.6766666666662, 810.6522222222221, 842.2733333333334, 801.0044444444443, 825.674444444444, 811.7977777777775, 788.5433333333334, 817.0266666666663, 812.932222222222, 794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664, 837.9688888888885, 788.2355555555553, 805.702222222222, 803.5899999999997, 843.222222222222, 805.7877777777778, 829.9288888888887, 810.9166666666665, 837.8177777777772, 805.9155555555552, 830.2711111111108, 831.2644444444442, 813.5844444444442, 835.5266666666664, 828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555, 839.2555555555554, 834.7411111111106, 838.0566666666667, 828.7388888888889, 838.2866666666664, 831.9288888888888, 828.9522222222218, 845.823333333333, 828.692222222222, 840.4933333333336, 810.1377777777774, 835.0933333333334, 838.5222222222218, 835.4455555555551, 849.2744444444443, 837.2955555555556, 843.6888888888885, 829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [807.7888888888888, 821.2811111111106, 816.7422222222222, 817.5055555555552, 808.3477777777777, 829.5822222222218, 809.0199999999999, 780.863333333333, 792.5000000000001, 816.6566666666661, 781.1255555555554, 820.1622222222217, 794.3211111111109, 808.2633333333335, 798.9655555555552, 802.5677777777775, 826.1077777777778, 786.8544444444444, 831.4677777777775, 811.5488888888887, 830.6588888888882, 815.6766666666662, 810.6522222222221, 842.2733333333334, 801.0044444444443, 825.674444444444, 811.7977777777775, 788.5433333333334, 817.0266666666663, 812.932222222222, 794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664, 837.9688888888885, 788.2355555555553, 805.702222222222, 803.5899999999997, 843.222222222222, 805.7877777777778, 829.9288888888887, 810.9166666666665, 837.8177777777772, 805.9155555555552, 830.2711111111108, 831.2644444444442, 813.5844444444442, 835.5266666666664, 828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555, 839.2555555555554, 834.7411111111106, 838.0566666666667, 828.7388888888889, 838.2866666666664, 831.9288888888888, 828.9522222222218, 845.823333333333, 828.692222222222, 840.4933333333336, 810.1377777777774, 835.0933333333334, 838.5222222222218, 835.4455555555551, 849.2744444444443, 837.2955555555556, 843.6888888888885, 829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19260606660763901, "mean_inference_ms": 1.7646070866968966, "mean_action_processing_ms": 0.07258350578841183, "mean_env_wait_ms": 1.1952695510700304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004401445388793945, "StateBufferConnector_ms": 0.0029370784759521484, "ViewRequirementAgentConnector_ms": 0.07018017768859863}, "num_episodes": 27, "episode_return_max": 849.2744444444443, "episode_return_min": 780.863333333333, "episode_return_mean": 821.491522222222, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199350, "num_agent_steps_trained": 199200, "num_env_steps_sampled": 199350, "num_env_steps_trained": 199200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 275.84646123772654, "num_env_steps_trained_throughput_per_sec": 290.36469603971216, "timesteps_total": 199350, "num_env_steps_sampled_lifetime": 199350, "num_agent_steps_sampled_lifetime": 199350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 199350, "timers": {"training_iteration_time_ms": 10213.121, "restore_workers_time_ms": 0.013, "training_step_time_ms": 545.983, "sample_time_ms": 531.667, "synch_weights_time_ms": 12.952}, "counters": {"num_env_steps_sampled": 199350, "num_env_steps_trained": 199200, "num_agent_steps_sampled": 199350, "num_agent_steps_trained": 199200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1329, "num_samples_added_to_queue": 199200}, "done": false, "training_iteration": 66, "trial_id": "38f59_00000", "date": "2024-10-10_22-22-49", "timestamp": 1728595369, "time_this_iter_s": 10.341003656387329, "time_total_s": 674.776398897171, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2da50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 674.776398897171, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 15.259999999999998, "ram_util_percent": 63.43333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 121806.125, "policy_loss": 111077.0078125, "entropy": 8.743123054504395, "entropy_coeff": 0.01, "var_gnorm": 16.679536819458008, "vf_loss": 1075534.375, "vf_explained_var": 0.20013582706451416}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 674.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1349, "num_samples_added_to_queue": 202200, "learner_queue": {"size_count": 674, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.694, "learner_load_time_ms": 0.306, "learner_load_wait_time_ms": 962.369, "learner_dequeue_time_ms": 8472.39}}, "env_runners": {"episode_reward_max": 854.9266666666667, "episode_reward_min": 788.2355555555553, "episode_reward_mean": 830.7885555555553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 788.2355555555553}, "policy_reward_max": {"default_policy": 854.9266666666667}, "policy_reward_mean": {"default_policy": 830.7885555555553}, "custom_metrics": {"num_consolidated_mean": 2.8221, "num_consolidated_min": 2.7, "num_consolidated_max": 2.9, "num_overloaded_mean": 0.0102, "num_overloaded_min": 0.0, "num_overloaded_max": 0.04, "num_moves_mean": 2.2945, "num_moves_min": 1.65, "num_moves_max": 2.97, "mean_accuracy_mean": 40.47426666666666, "mean_accuracy_min": 40.24499999999999, "mean_accuracy_max": 40.599666666666664, "num_model_switches_mean": 1.7343000000000004, "num_model_switches_min": 1.32, "num_model_switches_max": 2.32, "num_slav_mean": 0.0007175, "num_slav_min": 0.0001, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.4885221095947149, "mean_cluster_cpu_util_min": 0.48042187796207964, "mean_cluster_cpu_util_max": 0.49560271790606036, "mean_cluster_mem_util_mean": 0.3203143480330951, "mean_cluster_mem_util_min": 0.3153265359941445, "mean_cluster_mem_util_max": 0.32450562946697664, "reward_consolidation_mean_mean": 4.343422222222221, "reward_consolidation_mean_min": 4.059999999999999, "reward_consolidation_mean_max": 4.511111111111111, "reward_illegal_mean_mean": -0.017, "reward_illegal_mean_min": -0.06666666666666667, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.005213333333334, "reward_accuracy_mean_min": 3.8784666666666667, "reward_accuracy_mean_max": 4.059966666666667, "reward_sla_mean_mean": -0.023750000000000004, "reward_sla_mean_min": -0.08666666666666668, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 434.3422222222221, "reward_consolidation_sum_min": 405.9999999999999, "reward_consolidation_sum_max": 451.1111111111111, "reward_illegal_sum_mean": -1.7, "reward_illegal_sum_min": -6.666666666666666, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 400.52133333333336, "reward_accuracy_sum_min": 387.8466666666667, "reward_accuracy_sum_max": 405.9966666666667, "reward_sla_sum_mean": -2.3749999999999996, "reward_sla_sum_min": -8.666666666666668, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3358.0, "global_timestep_min": 1300, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664, 837.9688888888885, 788.2355555555553, 805.702222222222, 803.5899999999997, 843.222222222222, 805.7877777777778, 829.9288888888887, 810.9166666666665, 837.8177777777772, 805.9155555555552, 830.2711111111108, 831.2644444444442, 813.5844444444442, 835.5266666666664, 828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555, 839.2555555555554, 834.7411111111106, 838.0566666666667, 828.7388888888889, 838.2866666666664, 831.9288888888888, 828.9522222222218, 845.823333333333, 828.692222222222, 840.4933333333336, 810.1377777777774, 835.0933333333334, 838.5222222222218, 835.4455555555551, 849.2744444444443, 837.2955555555556, 843.6888888888885, 829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889, 839.452222222222, 831.8655555555555, 833.1188888888886, 831.0788888888885, 848.1488888888885, 848.1244444444444, 847.3777777777774, 822.5311111111115, 846.5133333333328, 853.9744444444443, 838.981111111111, 843.1577777777775, 852.1111111111105, 841.2077777777774, 835.3, 854.9266666666667, 840.7544444444441, 845.9100000000001, 854.7911111111107, 849.1666666666662, 838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [794.3222222222221, 811.2355555555554, 827.5277777777773, 819.8411111111108, 816.2488888888887, 825.4311111111109, 830.8733333333332, 812.5922222222216, 802.8633333333332, 832.1877777777778, 824.0977777777779, 788.7488888888887, 805.5766666666666, 816.5588888888891, 833.3588888888887, 814.7066666666664, 837.9688888888885, 788.2355555555553, 805.702222222222, 803.5899999999997, 843.222222222222, 805.7877777777778, 829.9288888888887, 810.9166666666665, 837.8177777777772, 805.9155555555552, 830.2711111111108, 831.2644444444442, 813.5844444444442, 835.5266666666664, 828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555, 839.2555555555554, 834.7411111111106, 838.0566666666667, 828.7388888888889, 838.2866666666664, 831.9288888888888, 828.9522222222218, 845.823333333333, 828.692222222222, 840.4933333333336, 810.1377777777774, 835.0933333333334, 838.5222222222218, 835.4455555555551, 849.2744444444443, 837.2955555555556, 843.6888888888885, 829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889, 839.452222222222, 831.8655555555555, 833.1188888888886, 831.0788888888885, 848.1488888888885, 848.1244444444444, 847.3777777777774, 822.5311111111115, 846.5133333333328, 853.9744444444443, 838.981111111111, 843.1577777777775, 852.1111111111105, 841.2077777777774, 835.3, 854.9266666666667, 840.7544444444441, 845.9100000000001, 854.7911111111107, 849.1666666666662, 838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19278204810309774, "mean_inference_ms": 1.7660883079192673, "mean_action_processing_ms": 0.072655315667425, "mean_env_wait_ms": 1.1961658311423438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004319667816162109, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.06870055198669434}, "num_episodes": 30, "episode_return_max": 854.9266666666667, "episode_return_min": 788.2355555555553, "episode_return_mean": 830.7885555555553, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 296.7796925701275, "num_env_steps_trained_throughput_per_sec": 296.7796925701275, "timesteps_total": 202350, "num_env_steps_sampled_lifetime": 202350, "num_agent_steps_sampled_lifetime": 202350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 202350, "timers": {"training_iteration_time_ms": 10218.714, "restore_workers_time_ms": 0.012, "training_step_time_ms": 515.058, "sample_time_ms": 501.06, "synch_weights_time_ms": 12.614}, "counters": {"num_env_steps_sampled": 202350, "num_env_steps_trained": 202200, "num_agent_steps_sampled": 202350, "num_agent_steps_trained": 202200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1349, "num_samples_added_to_queue": 202200}, "done": false, "training_iteration": 67, "trial_id": "38f59_00000", "date": "2024-10-10_22-22-59", "timestamp": 1728595379, "time_this_iter_s": 10.119641542434692, "time_total_s": 684.8960404396057, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2f9d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 684.8960404396057, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 11.600000000000003, "ram_util_percent": 63.521428571428565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 100769.46875, "policy_loss": 90170.796875, "entropy": 8.077764511108398, "entropy_coeff": 0.01, "var_gnorm": 16.71058464050293, "vf_loss": 1062290.875, "vf_explained_var": 0.21459680795669556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 683.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 205200, "num_env_steps_trained": 204900, "num_agent_steps_sampled": 205200, "num_agent_steps_trained": 204900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1368, "num_samples_added_to_queue": 205200, "learner_queue": {"size_count": 683, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.226, "learner_load_time_ms": 0.284, "learner_load_wait_time_ms": 1011.541, "learner_dequeue_time_ms": 8539.658}}, "env_runners": {"episode_reward_max": 863.0455555555554, "episode_reward_min": 810.1377777777774, "episode_reward_mean": 840.7181111111108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 810.1377777777774}, "policy_reward_max": {"default_policy": 863.0455555555554}, "policy_reward_mean": {"default_policy": 840.7181111111108}, "custom_metrics": {"num_consolidated_mean": 2.8526000000000007, "num_consolidated_min": 2.75, "num_consolidated_max": 2.97, "num_overloaded_mean": 0.0058000000000000005, "num_overloaded_min": 0.0, "num_overloaded_max": 0.03, "num_moves_mean": 2.019, "num_moves_min": 1.42, "num_moves_max": 2.85, "mean_accuracy_mean": 40.51593999999999, "mean_accuracy_min": 40.24499999999999, "mean_accuracy_max": 40.68833333333333, "num_model_switches_mean": 1.5636, "num_model_switches_min": 0.97, "num_model_switches_max": 2.17, "num_slav_mean": 0.0006476666666666668, "num_slav_min": 0.0001, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.49097262402427005, "mean_cluster_cpu_util_min": 0.48165163202849404, "mean_cluster_cpu_util_max": 0.500513582460011, "mean_cluster_mem_util_mean": 0.3214921243398204, "mean_cluster_mem_util_min": 0.3169774229311978, "mean_cluster_mem_util_max": 0.3262584388185654, "reward_consolidation_mean_mean": 4.410777777777777, "reward_consolidation_mean_min": 4.215555555555555, "reward_consolidation_mean_max": 4.619999999999999, "reward_illegal_mean_mean": -0.009666666666666665, "reward_illegal_mean_min": -0.05, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0275533333333335, "reward_accuracy_mean_min": 3.925266666666667, "reward_accuracy_mean_max": 4.068833333333334, "reward_sla_mean_mean": -0.02148333333333334, "reward_sla_mean_min": -0.08666666666666668, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 441.07777777777767, "reward_consolidation_sum_min": 421.5555555555555, "reward_consolidation_sum_max": 461.9999999999999, "reward_illegal_sum_mean": -0.9666666666666666, "reward_illegal_sum_min": -5.0, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 402.7553333333333, "reward_accuracy_sum_min": 392.5266666666667, "reward_accuracy_sum_max": 406.8833333333334, "reward_sla_sum_mean": -2.1483333333333334, "reward_sla_sum_min": -8.666666666666668, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4363.0, "global_timestep_min": 2300, "global_timestep_max": 6000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555, 839.2555555555554, 834.7411111111106, 838.0566666666667, 828.7388888888889, 838.2866666666664, 831.9288888888888, 828.9522222222218, 845.823333333333, 828.692222222222, 840.4933333333336, 810.1377777777774, 835.0933333333334, 838.5222222222218, 835.4455555555551, 849.2744444444443, 837.2955555555556, 843.6888888888885, 829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889, 839.452222222222, 831.8655555555555, 833.1188888888886, 831.0788888888885, 848.1488888888885, 848.1244444444444, 847.3777777777774, 822.5311111111115, 846.5133333333328, 853.9744444444443, 838.981111111111, 843.1577777777775, 852.1111111111105, 841.2077777777774, 835.3, 854.9266666666667, 840.7544444444441, 845.9100000000001, 854.7911111111107, 849.1666666666662, 838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332, 859.9633333333328, 855.6888888888888, 851.1155555555556, 840.7522222222221, 850.1799999999998, 850.124444444444, 858.6611111111106, 856.7911111111111, 831.6577777777775, 857.752222222222, 847.7499999999998, 839.4833333333335, 844.7044444444441, 852.3633333333332, 856.593333333333, 853.9744444444441, 856.9244444444442, 842.2033333333331, 861.7844444444443, 856.1944444444445, 835.681111111111, 850.3955555555552, 843.3388888888885, 850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [828.1199999999998, 812.9566666666666, 827.0177777777775, 834.3055555555555, 835.5611111111106, 841.3566666666663, 829.3355555555552, 828.7633333333332, 822.6122222222218, 818.1766666666665, 831.104444444444, 826.9144444444444, 829.0655555555555, 839.2555555555554, 834.7411111111106, 838.0566666666667, 828.7388888888889, 838.2866666666664, 831.9288888888888, 828.9522222222218, 845.823333333333, 828.692222222222, 840.4933333333336, 810.1377777777774, 835.0933333333334, 838.5222222222218, 835.4455555555551, 849.2744444444443, 837.2955555555556, 843.6888888888885, 829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889, 839.452222222222, 831.8655555555555, 833.1188888888886, 831.0788888888885, 848.1488888888885, 848.1244444444444, 847.3777777777774, 822.5311111111115, 846.5133333333328, 853.9744444444443, 838.981111111111, 843.1577777777775, 852.1111111111105, 841.2077777777774, 835.3, 854.9266666666667, 840.7544444444441, 845.9100000000001, 854.7911111111107, 849.1666666666662, 838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332, 859.9633333333328, 855.6888888888888, 851.1155555555556, 840.7522222222221, 850.1799999999998, 850.124444444444, 858.6611111111106, 856.7911111111111, 831.6577777777775, 857.752222222222, 847.7499999999998, 839.4833333333335, 844.7044444444441, 852.3633333333332, 856.593333333333, 853.9744444444441, 856.9244444444442, 842.2033333333331, 861.7844444444443, 856.1944444444445, 835.681111111111, 850.3955555555552, 843.3388888888885, 850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19300512392373104, "mean_inference_ms": 1.7687625900790338, "mean_action_processing_ms": 0.07272801175651775, "mean_env_wait_ms": 1.1971956621240543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004317045211791992, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.06855916976928711}, "num_episodes": 30, "episode_return_max": 863.0455555555554, "episode_return_min": 810.1377777777774, "episode_return_mean": 840.7181111111108, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205200, "num_agent_steps_trained": 204900, "num_env_steps_sampled": 205200, "num_env_steps_trained": 204900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 282.1160400357719, "num_env_steps_trained_throughput_per_sec": 267.2678274023102, "timesteps_total": 205200, "num_env_steps_sampled_lifetime": 205200, "num_agent_steps_sampled_lifetime": 205200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 205200, "timers": {"training_iteration_time_ms": 10207.029, "restore_workers_time_ms": 0.013, "training_step_time_ms": 545.888, "sample_time_ms": 530.666, "synch_weights_time_ms": 13.786}, "counters": {"num_env_steps_sampled": 205200, "num_env_steps_trained": 204900, "num_agent_steps_sampled": 205200, "num_agent_steps_trained": 204900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1368, "num_samples_added_to_queue": 205200}, "done": false, "training_iteration": 68, "trial_id": "38f59_00000", "date": "2024-10-10_22-23-09", "timestamp": 1728595389, "time_this_iter_s": 10.11158561706543, "time_total_s": 695.0076260566711, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18640>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 695.0076260566711, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 12.360000000000001, "ram_util_percent": 63.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 85230.046875, "policy_loss": 75561.5703125, "entropy": 7.495218753814697, "entropy_coeff": 0.01, "var_gnorm": 16.747472763061523, "vf_loss": 969095.875, "vf_explained_var": 0.24097704887390137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 693.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 208200, "num_env_steps_trained": 207900, "num_agent_steps_sampled": 208200, "num_agent_steps_trained": 207900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1388, "num_samples_added_to_queue": 208200, "learner_queue": {"size_count": 693, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.459, "learner_load_time_ms": 0.27, "learner_load_wait_time_ms": 953.64, "learner_dequeue_time_ms": 8536.968}}, "env_runners": {"episode_reward_max": 865.8555555555554, "episode_reward_min": 817.8155555555555, "episode_reward_mean": 847.5991222222219, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 817.8155555555555}, "policy_reward_max": {"default_policy": 865.8555555555554}, "policy_reward_mean": {"default_policy": 847.5991222222219}, "custom_metrics": {"num_consolidated_mean": 2.8805000000000014, "num_consolidated_min": 2.75, "num_consolidated_max": 2.97, "num_overloaded_mean": 0.0036, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.7253999999999996, "num_moves_min": 1.19, "num_moves_max": 2.41, "mean_accuracy_mean": 40.54146333333333, "mean_accuracy_min": 40.37166666666666, "mean_accuracy_max": 40.68833333333333, "num_model_switches_mean": 1.3592, "num_model_switches_min": 0.92, "num_model_switches_max": 1.96, "num_slav_mean": 0.0006405, "num_slav_min": 0.00016666666666666666, "num_slav_max": 0.0026, "mean_cluster_cpu_util_mean": 0.49338972679608006, "mean_cluster_cpu_util_min": 0.4835919803732303, "mean_cluster_cpu_util_max": 0.500513582460011, "mean_cluster_mem_util_mean": 0.3225718177760556, "mean_cluster_mem_util_min": 0.31795422873790863, "mean_cluster_mem_util_max": 0.3262584388185654, "reward_consolidation_mean_mean": 4.464133333333333, "reward_consolidation_mean_min": 4.23111111111111, "reward_consolidation_mean_max": 4.619999999999999, "reward_illegal_mean_mean": -0.006, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0391856666666675, "reward_accuracy_mean_min": 3.9689000000000005, "reward_accuracy_mean_max": 4.068833333333334, "reward_sla_mean_mean": -0.021327777777777775, "reward_sla_mean_min": -0.08666666666666668, "reward_sla_mean_max": -0.005555555555555556, "reward_consolidation_sum_mean": 446.4133333333333, "reward_consolidation_sum_min": 423.11111111111103, "reward_consolidation_sum_max": 461.9999999999999, "reward_illegal_sum_mean": -0.5999999999999999, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 403.9185666666667, "reward_accuracy_sum_min": 396.89000000000004, "reward_accuracy_sum_max": 406.8833333333334, "reward_sla_sum_mean": -2.1327777777777777, "reward_sla_sum_min": -8.666666666666668, "reward_sla_sum_max": -0.5555555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5359.0, "global_timestep_min": 3200, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889, 839.452222222222, 831.8655555555555, 833.1188888888886, 831.0788888888885, 848.1488888888885, 848.1244444444444, 847.3777777777774, 822.5311111111115, 846.5133333333328, 853.9744444444443, 838.981111111111, 843.1577777777775, 852.1111111111105, 841.2077777777774, 835.3, 854.9266666666667, 840.7544444444441, 845.9100000000001, 854.7911111111107, 849.1666666666662, 838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332, 859.9633333333328, 855.6888888888888, 851.1155555555556, 840.7522222222221, 850.1799999999998, 850.124444444444, 858.6611111111106, 856.7911111111111, 831.6577777777775, 857.752222222222, 847.7499999999998, 839.4833333333335, 844.7044444444441, 852.3633333333332, 856.593333333333, 853.9744444444441, 856.9244444444442, 842.2033333333331, 861.7844444444443, 856.1944444444445, 835.681111111111, 850.3955555555552, 843.3388888888885, 850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554, 856.0144444444442, 857.0211111111108, 831.2988888888888, 854.4844444444444, 852.8244444444442, 859.2277777777778, 847.3444444444442, 850.521111111111, 852.1411111111111, 856.3000000000002, 857.902222222222, 853.9033333333331, 861.8777777777777, 860.8244444444443, 856.3877777777775, 860.15, 863.6811111111108, 853.4433333333332, 847.5077777777774, 849.8877777777772, 857.703333333333, 854.2033333333329, 846.2044444444443, 863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [829.098888888889, 831.7855555555552, 829.121111111111, 833.0422222222219, 830.3122222222217, 845.0466666666665, 831.612222222222, 846.5066666666664, 817.8155555555555, 831.2788888888889, 839.452222222222, 831.8655555555555, 833.1188888888886, 831.0788888888885, 848.1488888888885, 848.1244444444444, 847.3777777777774, 822.5311111111115, 846.5133333333328, 853.9744444444443, 838.981111111111, 843.1577777777775, 852.1111111111105, 841.2077777777774, 835.3, 854.9266666666667, 840.7544444444441, 845.9100000000001, 854.7911111111107, 849.1666666666662, 838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332, 859.9633333333328, 855.6888888888888, 851.1155555555556, 840.7522222222221, 850.1799999999998, 850.124444444444, 858.6611111111106, 856.7911111111111, 831.6577777777775, 857.752222222222, 847.7499999999998, 839.4833333333335, 844.7044444444441, 852.3633333333332, 856.593333333333, 853.9744444444441, 856.9244444444442, 842.2033333333331, 861.7844444444443, 856.1944444444445, 835.681111111111, 850.3955555555552, 843.3388888888885, 850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554, 856.0144444444442, 857.0211111111108, 831.2988888888888, 854.4844444444444, 852.8244444444442, 859.2277777777778, 847.3444444444442, 850.521111111111, 852.1411111111111, 856.3000000000002, 857.902222222222, 853.9033333333331, 861.8777777777777, 860.8244444444443, 856.3877777777775, 860.15, 863.6811111111108, 853.4433333333332, 847.5077777777774, 849.8877777777772, 857.703333333333, 854.2033333333329, 846.2044444444443, 863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19311095840135212, "mean_inference_ms": 1.7702601170428625, "mean_action_processing_ms": 0.07276394174521328, "mean_env_wait_ms": 1.1976983706210815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004010438919067383, "StateBufferConnector_ms": 0.002759218215942383, "ViewRequirementAgentConnector_ms": 0.06503438949584961}, "num_episodes": 30, "episode_return_max": 865.8555555555554, "episode_return_min": 817.8155555555555, "episode_return_mean": 847.5991222222219, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208200, "num_agent_steps_trained": 207900, "num_env_steps_sampled": 208200, "num_env_steps_trained": 207900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.26666430257904, "num_env_steps_trained_throughput_per_sec": 299.26666430257904, "timesteps_total": 208200, "num_env_steps_sampled_lifetime": 208200, "num_agent_steps_sampled_lifetime": 208200, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 208200, "timers": {"training_iteration_time_ms": 10163.089, "restore_workers_time_ms": 0.013, "training_step_time_ms": 489.594, "sample_time_ms": 476.117, "synch_weights_time_ms": 12.178}, "counters": {"num_env_steps_sampled": 208200, "num_env_steps_trained": 207900, "num_agent_steps_sampled": 208200, "num_agent_steps_trained": 207900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1388, "num_samples_added_to_queue": 208200}, "done": false, "training_iteration": 69, "trial_id": "38f59_00000", "date": "2024-10-10_22-23-19", "timestamp": 1728595399, "time_this_iter_s": 10.037068128585815, "time_total_s": 705.044694185257, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe201b0a60>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 705.044694185257, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 11.278571428571428, "ram_util_percent": 63.7357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 69188.546875, "policy_loss": 60522.24609375, "entropy": 6.872097969055176, "entropy_coeff": 0.01, "var_gnorm": 16.791175842285156, "vf_loss": 868692.0, "vf_explained_var": 0.28311699628829956}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 704.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 211350, "num_env_steps_trained": 211200, "num_agent_steps_sampled": 211350, "num_agent_steps_trained": 211200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1409, "num_samples_added_to_queue": 211200, "learner_queue": {"size_count": 704, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.559, "learner_load_time_ms": 0.257, "learner_load_wait_time_ms": 940.349, "learner_dequeue_time_ms": 8466.912}}, "env_runners": {"episode_reward_max": 866.7111111111108, "episode_reward_min": 821.3977777777773, "episode_reward_mean": 851.9800444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 821.3977777777773}, "policy_reward_max": {"default_policy": 866.7111111111108}, "policy_reward_mean": {"default_policy": 851.9800444444444}, "custom_metrics": {"num_consolidated_mean": 2.9018, "num_consolidated_min": 2.82, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0028000000000000004, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.5057000000000003, "num_moves_min": 1.05, "num_moves_max": 2.21, "mean_accuracy_mean": 40.55159666666666, "mean_accuracy_min": 40.453999999999986, "mean_accuracy_max": 40.68833333333333, "num_model_switches_mean": 1.1592, "num_model_switches_min": 0.69, "num_model_switches_max": 1.78, "num_slav_mean": 0.0006018333333333333, "num_slav_min": 0.00015, "num_slav_max": 0.0018166666666666665, "mean_cluster_cpu_util_mean": 0.49518407495523237, "mean_cluster_cpu_util_min": 0.48609505705411976, "mean_cluster_cpu_util_max": 0.5022907703621989, "mean_cluster_mem_util_mean": 0.3234719873363902, "mean_cluster_mem_util_min": 0.31979729882459307, "mean_cluster_mem_util_max": 0.32673589135021097, "reward_consolidation_mean_mean": 4.5009999999999994, "reward_consolidation_mean_min": 4.293333333333332, "reward_consolidation_mean_max": 4.619999999999999, "reward_illegal_mean_mean": -0.004666666666666667, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.043506, "reward_accuracy_mean_min": 3.9689000000000005, "reward_accuracy_mean_max": 4.068833333333334, "reward_sla_mean_mean": -0.02003888888888889, "reward_sla_mean_min": -0.06055555555555556, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 450.09999999999985, "reward_consolidation_sum_min": 429.3333333333332, "reward_consolidation_sum_max": 461.9999999999999, "reward_illegal_sum_mean": -0.46666666666666656, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.3506, "reward_accuracy_sum_min": 396.89000000000004, "reward_accuracy_sum_max": 406.8833333333334, "reward_sla_sum_mean": -2.0038888888888886, "reward_sla_sum_min": -6.055555555555555, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5882.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332, 859.9633333333328, 855.6888888888888, 851.1155555555556, 840.7522222222221, 850.1799999999998, 850.124444444444, 858.6611111111106, 856.7911111111111, 831.6577777777775, 857.752222222222, 847.7499999999998, 839.4833333333335, 844.7044444444441, 852.3633333333332, 856.593333333333, 853.9744444444441, 856.9244444444442, 842.2033333333331, 861.7844444444443, 856.1944444444445, 835.681111111111, 850.3955555555552, 843.3388888888885, 850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554, 856.0144444444442, 857.0211111111108, 831.2988888888888, 854.4844444444444, 852.8244444444442, 859.2277777777778, 847.3444444444442, 850.521111111111, 852.1411111111111, 856.3000000000002, 857.902222222222, 853.9033333333331, 861.8777777777777, 860.8244444444443, 856.3877777777775, 860.15, 863.6811111111108, 853.4433333333332, 847.5077777777774, 849.8877777777772, 857.703333333333, 854.2033333333329, 846.2044444444443, 863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556, 857.9977777777774, 853.2288888888891, 857.1066666666666, 849.0555555555552, 862.141111111111, 854.7433333333331, 850.8311111111112, 852.9266666666667, 845.9522222222221, 854.2033333333333, 853.9733333333328, 850.6900000000003, 848.9822222222219, 863.6155555555554, 856.9355555555557, 850.0611111111107, 857.3744444444444, 856.1411111111113, 853.2688888888883, 834.4988888888888, 859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [838.6022222222223, 831.3188888888885, 821.3977777777773, 839.2522222222224, 847.4411111111108, 847.4344444444444, 842.8255555555554, 831.6677777777772, 838.93, 850.2533333333332, 859.9633333333328, 855.6888888888888, 851.1155555555556, 840.7522222222221, 850.1799999999998, 850.124444444444, 858.6611111111106, 856.7911111111111, 831.6577777777775, 857.752222222222, 847.7499999999998, 839.4833333333335, 844.7044444444441, 852.3633333333332, 856.593333333333, 853.9744444444441, 856.9244444444442, 842.2033333333331, 861.7844444444443, 856.1944444444445, 835.681111111111, 850.3955555555552, 843.3388888888885, 850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554, 856.0144444444442, 857.0211111111108, 831.2988888888888, 854.4844444444444, 852.8244444444442, 859.2277777777778, 847.3444444444442, 850.521111111111, 852.1411111111111, 856.3000000000002, 857.902222222222, 853.9033333333331, 861.8777777777777, 860.8244444444443, 856.3877777777775, 860.15, 863.6811111111108, 853.4433333333332, 847.5077777777774, 849.8877777777772, 857.703333333333, 854.2033333333329, 846.2044444444443, 863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556, 857.9977777777774, 853.2288888888891, 857.1066666666666, 849.0555555555552, 862.141111111111, 854.7433333333331, 850.8311111111112, 852.9266666666667, 845.9522222222221, 854.2033333333333, 853.9733333333328, 850.6900000000003, 848.9822222222219, 863.6155555555554, 856.9355555555557, 850.0611111111107, 857.3744444444444, 856.1411111111113, 853.2688888888883, 834.4988888888888, 859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19311708405050385, "mean_inference_ms": 1.7701784747974734, "mean_action_processing_ms": 0.07276418348358392, "mean_env_wait_ms": 1.197691910402324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040073394775390625, "StateBufferConnector_ms": 0.002723217010498047, "ViewRequirementAgentConnector_ms": 0.06339454650878906}, "num_episodes": 30, "episode_return_max": 866.7111111111108, "episode_return_min": 821.3977777777773, "episode_return_mean": 851.9800444444444, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211350, "num_agent_steps_trained": 211200, "num_env_steps_sampled": 211350, "num_env_steps_trained": 211200, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3300, "num_env_steps_sampled_throughput_per_sec": 302.37691663034207, "num_env_steps_trained_throughput_per_sec": 316.7758174222631, "timesteps_total": 211350, "num_env_steps_sampled_lifetime": 211350, "num_agent_steps_sampled_lifetime": 211350, "num_steps_trained_this_iter": 3300, "agent_timesteps_total": 211350, "timers": {"training_iteration_time_ms": 10190.44, "restore_workers_time_ms": 0.013, "training_step_time_ms": 501.843, "sample_time_ms": 487.658, "synch_weights_time_ms": 12.847}, "counters": {"num_env_steps_sampled": 211350, "num_env_steps_trained": 211200, "num_agent_steps_sampled": 211350, "num_agent_steps_trained": 211200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1409, "num_samples_added_to_queue": 211200}, "done": false, "training_iteration": 70, "trial_id": "38f59_00000", "date": "2024-10-10_22-23-30", "timestamp": 1728595410, "time_this_iter_s": 10.42639946937561, "time_total_s": 715.4710936546326, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2dde0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 715.4710936546326, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 10.72, "ram_util_percent": 63.786666666666655}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 58080.69140625, "policy_loss": 50223.359375, "entropy": 6.584864139556885, "entropy_coeff": 0.01, "var_gnorm": 16.8371524810791, "vf_loss": 787708.5625, "vf_explained_var": 0.31340909004211426}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 714.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 214500, "num_env_steps_trained": 214200, "num_agent_steps_sampled": 214500, "num_agent_steps_trained": 214200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1430, "num_samples_added_to_queue": 214500, "learner_queue": {"size_count": 714, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.238, "learner_load_time_ms": 0.226, "learner_load_wait_time_ms": 932.335, "learner_dequeue_time_ms": 8374.077}}, "env_runners": {"episode_reward_max": 867.8233333333335, "episode_reward_min": 831.2988888888888, "episode_reward_mean": 855.9509666666665, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 831.2988888888888}, "policy_reward_max": {"default_policy": 867.8233333333335}, "policy_reward_mean": {"default_policy": 855.9509666666665}, "custom_metrics": {"num_consolidated_mean": 2.9234000000000004, "num_consolidated_min": 2.83, "num_consolidated_max": 2.99, "num_overloaded_mean": 0.0023, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.3343000000000003, "num_moves_min": 0.89, "num_moves_max": 2.02, "mean_accuracy_mean": 40.55672666666666, "mean_accuracy_min": 40.453999999999986, "mean_accuracy_max": 40.67566666666666, "num_model_switches_mean": 0.9511999999999999, "num_model_switches_min": 0.56, "num_model_switches_max": 1.55, "num_slav_mean": 0.0005871666666666667, "num_slav_min": 0.00015, "num_slav_max": 0.0014500000000000001, "mean_cluster_cpu_util_mean": 0.49720231648425023, "mean_cluster_cpu_util_min": 0.4906265972605259, "mean_cluster_cpu_util_max": 0.5035788812531734, "mean_cluster_mem_util_mean": 0.324334717089684, "mean_cluster_mem_util_min": 0.3199336761603376, "mean_cluster_mem_util_max": 0.3275378266813054, "reward_consolidation_mean_mean": 4.536777777777776, "reward_consolidation_mean_min": 4.355555555555555, "reward_consolidation_mean_max": 4.6355555555555545, "reward_illegal_mean_mean": -0.0038333333333333336, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.046093000000001, "reward_accuracy_mean_min": 3.977766666666667, "reward_accuracy_mean_max": 4.067566666666667, "reward_sla_mean_mean": -0.019527777777777776, "reward_sla_mean_min": -0.04833333333333334, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 453.6777777777776, "reward_consolidation_sum_min": 435.55555555555554, "reward_consolidation_sum_max": 463.55555555555543, "reward_illegal_sum_mean": -0.3833333333333333, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.6093, "reward_accuracy_sum_min": 397.7766666666667, "reward_accuracy_sum_max": 406.7566666666667, "reward_sla_sum_mean": -1.9527777777777775, "reward_sla_sum_min": -4.833333333333334, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4425.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554, 856.0144444444442, 857.0211111111108, 831.2988888888888, 854.4844444444444, 852.8244444444442, 859.2277777777778, 847.3444444444442, 850.521111111111, 852.1411111111111, 856.3000000000002, 857.902222222222, 853.9033333333331, 861.8777777777777, 860.8244444444443, 856.3877777777775, 860.15, 863.6811111111108, 853.4433333333332, 847.5077777777774, 849.8877777777772, 857.703333333333, 854.2033333333329, 846.2044444444443, 863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556, 857.9977777777774, 853.2288888888891, 857.1066666666666, 849.0555555555552, 862.141111111111, 854.7433333333331, 850.8311111111112, 852.9266666666667, 845.9522222222221, 854.2033333333333, 853.9733333333328, 850.6900000000003, 848.9822222222219, 863.6155555555554, 856.9355555555557, 850.0611111111107, 857.3744444444444, 856.1411111111113, 853.2688888888883, 834.4988888888888, 859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667, 864.5444444444444, 862.5922222222222, 857.7111111111105, 864.9899999999999, 845.1344444444444, 861.306666666667, 853.3466666666664, 861.8455555555554, 852.443333333333, 861.4788888888884, 867.8233333333335, 859.2499999999995, 852.0544444444446, 862.5444444444444, 865.1555555555552, 847.4344444444444, 863.5133333333332, 843.7277777777778, 859.6000000000001, 860.0766666666666, 859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [850.1977777777777, 849.958888888889, 859.3466666666662, 863.0455555555554, 850.6666666666663, 854.0299999999997, 847.5355555555554, 856.0144444444442, 857.0211111111108, 831.2988888888888, 854.4844444444444, 852.8244444444442, 859.2277777777778, 847.3444444444442, 850.521111111111, 852.1411111111111, 856.3000000000002, 857.902222222222, 853.9033333333331, 861.8777777777777, 860.8244444444443, 856.3877777777775, 860.15, 863.6811111111108, 853.4433333333332, 847.5077777777774, 849.8877777777772, 857.703333333333, 854.2033333333329, 846.2044444444443, 863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556, 857.9977777777774, 853.2288888888891, 857.1066666666666, 849.0555555555552, 862.141111111111, 854.7433333333331, 850.8311111111112, 852.9266666666667, 845.9522222222221, 854.2033333333333, 853.9733333333328, 850.6900000000003, 848.9822222222219, 863.6155555555554, 856.9355555555557, 850.0611111111107, 857.3744444444444, 856.1411111111113, 853.2688888888883, 834.4988888888888, 859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667, 864.5444444444444, 862.5922222222222, 857.7111111111105, 864.9899999999999, 845.1344444444444, 861.306666666667, 853.3466666666664, 861.8455555555554, 852.443333333333, 861.4788888888884, 867.8233333333335, 859.2499999999995, 852.0544444444446, 862.5444444444444, 865.1555555555552, 847.4344444444444, 863.5133333333332, 843.7277777777778, 859.6000000000001, 860.0766666666666, 859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1931129874146803, "mean_inference_ms": 1.7713188657830046, "mean_action_processing_ms": 0.07275459607412912, "mean_env_wait_ms": 1.1978218879568245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004108428955078125, "StateBufferConnector_ms": 0.0026662349700927734, "ViewRequirementAgentConnector_ms": 0.06170916557312012}, "num_episodes": 33, "episode_return_max": 867.8233333333335, "episode_return_min": 831.2988888888888, "episode_return_mean": 855.9509666666665, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214500, "num_agent_steps_trained": 214200, "num_env_steps_sampled": 214500, "num_env_steps_trained": 214200, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 303.24082745825916, "num_env_steps_trained_throughput_per_sec": 288.80078805548493, "timesteps_total": 214500, "num_env_steps_sampled_lifetime": 214500, "num_agent_steps_sampled_lifetime": 214500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 214500, "timers": {"training_iteration_time_ms": 10203.786, "restore_workers_time_ms": 0.012, "training_step_time_ms": 480.546, "sample_time_ms": 466.703, "synch_weights_time_ms": 12.493}, "counters": {"num_env_steps_sampled": 214500, "num_env_steps_trained": 214200, "num_agent_steps_sampled": 214500, "num_agent_steps_trained": 214200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1430, "num_samples_added_to_queue": 214500}, "done": false, "training_iteration": 71, "trial_id": "38f59_00000", "date": "2024-10-10_22-23-40", "timestamp": 1728595420, "time_this_iter_s": 10.402127504348755, "time_total_s": 725.8732211589813, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1a680>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 725.8732211589813, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.653333333333334, "ram_util_percent": 63.859999999999985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 50691.41796875, "policy_loss": 42108.203125, "entropy": 6.314329624176025, "entropy_coeff": 0.01, "var_gnorm": 16.884380340576172, "vf_loss": 860215.5625, "vf_explained_var": 0.32903045415878296}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 724.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 217500, "num_env_steps_trained": 217200, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1450, "num_samples_added_to_queue": 217500, "learner_queue": {"size_count": 724, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.009, "learner_load_time_ms": 0.227, "learner_load_wait_time_ms": 1017.955, "learner_dequeue_time_ms": 8299.167}}, "env_runners": {"episode_reward_max": 869.9900000000001, "episode_reward_min": 834.4988888888888, "episode_reward_mean": 858.8258222222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 834.4988888888888}, "policy_reward_max": {"default_policy": 869.9900000000001}, "policy_reward_mean": {"default_policy": 858.8258222222222}, "custom_metrics": {"num_consolidated_mean": 2.9402000000000004, "num_consolidated_min": 2.87, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0022, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.2172999999999998, "num_moves_min": 0.89, "num_moves_max": 1.68, "mean_accuracy_mean": 40.56838, "mean_accuracy_min": 40.453999999999986, "mean_accuracy_max": 40.67566666666666, "num_model_switches_mean": 0.7903, "num_model_switches_min": 0.5, "num_model_switches_max": 1.31, "num_slav_mean": 0.0005750000000000001, "num_slav_min": 0.00015, "num_slav_max": 0.0014500000000000001, "mean_cluster_cpu_util_mean": 0.49874847299643144, "mean_cluster_cpu_util_min": 0.4917711378470307, "mean_cluster_cpu_util_max": 0.5043121121759515, "mean_cluster_mem_util_mean": 0.32506759749311115, "mean_cluster_mem_util_min": 0.32139069092827, "mean_cluster_mem_util_max": 0.32765928270042194, "reward_consolidation_mean_mean": 4.563377777777776, "reward_consolidation_mean_min": 4.433333333333333, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0036666666666666666, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.047669333333333, "reward_accuracy_mean_min": 3.977766666666667, "reward_accuracy_mean_max": 4.067566666666667, "reward_sla_mean_mean": -0.019122222222222224, "reward_sla_mean_min": -0.04833333333333334, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 456.33777777777766, "reward_consolidation_sum_min": 443.33333333333326, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.36666666666666664, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.7669333333334, "reward_accuracy_sum_min": 397.7766666666667, "reward_accuracy_sum_max": 406.7566666666667, "reward_sla_sum_mean": -1.912222222222222, "reward_sla_sum_min": -4.833333333333334, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3085.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556, 857.9977777777774, 853.2288888888891, 857.1066666666666, 849.0555555555552, 862.141111111111, 854.7433333333331, 850.8311111111112, 852.9266666666667, 845.9522222222221, 854.2033333333333, 853.9733333333328, 850.6900000000003, 848.9822222222219, 863.6155555555554, 856.9355555555557, 850.0611111111107, 857.3744444444444, 856.1411111111113, 853.2688888888883, 834.4988888888888, 859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667, 864.5444444444444, 862.5922222222222, 857.7111111111105, 864.9899999999999, 845.1344444444444, 861.306666666667, 853.3466666666664, 861.8455555555554, 852.443333333333, 861.4788888888884, 867.8233333333335, 859.2499999999995, 852.0544444444446, 862.5444444444444, 865.1555555555552, 847.4344444444444, 863.5133333333332, 843.7277777777778, 859.6000000000001, 860.0766666666666, 859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443, 860.4577777777779, 863.9077777777774, 867.2655555555555, 866.275555555556, 860.9811111111113, 867.7277777777779, 861.3311111111112, 861.3622222222223, 869.1633333333334, 863.853333333333, 860.1944444444446, 854.6344444444446, 859.4966666666667, 861.3622222222219, 849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [863.8144444444447, 855.4977777777777, 853.5699999999998, 859.65, 865.8555555555554, 859.79, 858.7855555555556, 857.9977777777774, 853.2288888888891, 857.1066666666666, 849.0555555555552, 862.141111111111, 854.7433333333331, 850.8311111111112, 852.9266666666667, 845.9522222222221, 854.2033333333333, 853.9733333333328, 850.6900000000003, 848.9822222222219, 863.6155555555554, 856.9355555555557, 850.0611111111107, 857.3744444444444, 856.1411111111113, 853.2688888888883, 834.4988888888888, 859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667, 864.5444444444444, 862.5922222222222, 857.7111111111105, 864.9899999999999, 845.1344444444444, 861.306666666667, 853.3466666666664, 861.8455555555554, 852.443333333333, 861.4788888888884, 867.8233333333335, 859.2499999999995, 852.0544444444446, 862.5444444444444, 865.1555555555552, 847.4344444444444, 863.5133333333332, 843.7277777777778, 859.6000000000001, 860.0766666666666, 859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443, 860.4577777777779, 863.9077777777774, 867.2655555555555, 866.275555555556, 860.9811111111113, 867.7277777777779, 861.3311111111112, 861.3622222222223, 869.1633333333334, 863.853333333333, 860.1944444444446, 854.6344444444446, 859.4966666666667, 861.3622222222219, 849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19308739894686247, "mean_inference_ms": 1.7713307306473933, "mean_action_processing_ms": 0.07274702927675915, "mean_env_wait_ms": 1.1977826949660577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004240751266479492, "StateBufferConnector_ms": 0.0027289390563964844, "ViewRequirementAgentConnector_ms": 0.06339025497436523}, "num_episodes": 30, "episode_return_max": 869.9900000000001, "episode_return_min": 834.4988888888888, "episode_return_mean": 858.8258222222222, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217200, "num_env_steps_sampled": 217500, "num_env_steps_trained": 217200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.84410413976656, "num_env_steps_trained_throughput_per_sec": 280.84410413976656, "timesteps_total": 217500, "num_env_steps_sampled_lifetime": 217500, "num_agent_steps_sampled_lifetime": 217500, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 217500, "timers": {"training_iteration_time_ms": 10233.985, "restore_workers_time_ms": 0.013, "training_step_time_ms": 571.313, "sample_time_ms": 556.409, "synch_weights_time_ms": 13.541}, "counters": {"num_env_steps_sampled": 217500, "num_env_steps_trained": 217200, "num_agent_steps_sampled": 217500, "num_agent_steps_trained": 217200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1450, "num_samples_added_to_queue": 217500}, "done": false, "training_iteration": 72, "trial_id": "38f59_00000", "date": "2024-10-10_22-23-51", "timestamp": 1728595431, "time_this_iter_s": 10.702745914459229, "time_total_s": 736.5759670734406, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc5b40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 736.5759670734406, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 12.986666666666666, "ram_util_percent": 64.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 51902.59765625, "policy_loss": 43322.34375, "entropy": 6.228242874145508, "entropy_coeff": 0.01, "var_gnorm": 16.93608856201172, "vf_loss": 859893.75, "vf_explained_var": 0.34521806240081787}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 734.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 220350, "num_env_steps_trained": 220200, "num_agent_steps_sampled": 220350, "num_agent_steps_trained": 220200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1469, "num_samples_added_to_queue": 220200, "learner_queue": {"size_count": 734, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.907, "learner_load_time_ms": 0.227, "learner_load_wait_time_ms": 1040.337, "learner_dequeue_time_ms": 8333.982}}, "env_runners": {"episode_reward_max": 870.7599999999999, "episode_reward_min": 842.5788888888883, "episode_reward_mean": 861.577711111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 842.5788888888883}, "policy_reward_max": {"default_policy": 870.7599999999999}, "policy_reward_mean": {"default_policy": 861.577711111111}, "custom_metrics": {"num_consolidated_mean": 2.9533000000000005, "num_consolidated_min": 2.89, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0016000000000000003, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 1.1208999999999998, "num_moves_min": 0.82, "num_moves_max": 1.45, "mean_accuracy_mean": 40.56913999999999, "mean_accuracy_min": 40.46666666666666, "mean_accuracy_max": 40.67566666666666, "num_model_switches_mean": 0.689, "num_model_switches_min": 0.43, "num_model_switches_max": 1.07, "num_slav_mean": 0.0005515, "num_slav_min": 0.00015, "num_slav_max": 0.0014500000000000001, "mean_cluster_cpu_util_mean": 0.5000017524900224, "mean_cluster_cpu_util_min": 0.4924198094778452, "mean_cluster_cpu_util_max": 0.5043121121759515, "mean_cluster_mem_util_mean": 0.32563052699560835, "mean_cluster_mem_util_min": 0.3224404008438818, "mean_cluster_mem_util_max": 0.3279992438431068, "reward_consolidation_mean_mean": 4.586555555555554, "reward_consolidation_mean_min": 4.448888888888887, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0026666666666666666, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.050249333333333, "reward_accuracy_mean_min": 3.981566666666667, "reward_accuracy_mean_max": 4.067566666666667, "reward_sla_mean_mean": -0.01836111111111111, "reward_sla_mean_min": -0.04833333333333334, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 458.65555555555557, "reward_consolidation_sum_min": 444.88888888888874, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.26666666666666666, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 405.02493333333337, "reward_accuracy_sum_min": 398.1566666666667, "reward_accuracy_sum_max": 406.7566666666667, "reward_sla_sum_mean": -1.8361111111111115, "reward_sla_sum_min": -4.833333333333334, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2174.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667, 864.5444444444444, 862.5922222222222, 857.7111111111105, 864.9899999999999, 845.1344444444444, 861.306666666667, 853.3466666666664, 861.8455555555554, 852.443333333333, 861.4788888888884, 867.8233333333335, 859.2499999999995, 852.0544444444446, 862.5444444444444, 865.1555555555552, 847.4344444444444, 863.5133333333332, 843.7277777777778, 859.6000000000001, 860.0766666666666, 859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443, 860.4577777777779, 863.9077777777774, 867.2655555555555, 866.275555555556, 860.9811111111113, 867.7277777777779, 861.3311111111112, 861.3622222222223, 869.1633333333334, 863.853333333333, 860.1944444444446, 854.6344444444446, 859.4966666666667, 861.3622222222219, 849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889, 866.1644444444441, 868.8466666666666, 865.8377777777777, 857.784444444445, 862.863333333333, 853.0944444444449, 868.085555555556, 867.8633333333333, 866.3166666666665, 864.4422222222217, 869.1711111111113, 861.1800000000004, 864.9588888888891, 868.7666666666667, 867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [859.0544444444442, 866.2911111111113, 858.5788888888887, 842.5788888888883, 853.8333333333334, 846.2377777777778, 854.8477777777775, 856.4966666666668, 866.7111111111108, 853.8466666666667, 864.5444444444444, 862.5922222222222, 857.7111111111105, 864.9899999999999, 845.1344444444444, 861.306666666667, 853.3466666666664, 861.8455555555554, 852.443333333333, 861.4788888888884, 867.8233333333335, 859.2499999999995, 852.0544444444446, 862.5444444444444, 865.1555555555552, 847.4344444444444, 863.5133333333332, 843.7277777777778, 859.6000000000001, 860.0766666666666, 859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443, 860.4577777777779, 863.9077777777774, 867.2655555555555, 866.275555555556, 860.9811111111113, 867.7277777777779, 861.3311111111112, 861.3622222222223, 869.1633333333334, 863.853333333333, 860.1944444444446, 854.6344444444446, 859.4966666666667, 861.3622222222219, 849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889, 866.1644444444441, 868.8466666666666, 865.8377777777777, 857.784444444445, 862.863333333333, 853.0944444444449, 868.085555555556, 867.8633333333333, 866.3166666666665, 864.4422222222217, 869.1711111111113, 861.1800000000004, 864.9588888888891, 868.7666666666667, 867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19307451507575846, "mean_inference_ms": 1.7704149230452484, "mean_action_processing_ms": 0.07274833813864688, "mean_env_wait_ms": 1.197689359983119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042171478271484375, "StateBufferConnector_ms": 0.002780914306640625, "ViewRequirementAgentConnector_ms": 0.06464600563049316}, "num_episodes": 27, "episode_return_max": 870.7599999999999, "episode_return_min": 842.5788888888883, "episode_return_mean": 861.577711111111, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220350, "num_agent_steps_trained": 220200, "num_env_steps_sampled": 220350, "num_env_steps_trained": 220200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.38568072492114, "num_env_steps_trained_throughput_per_sec": 294.0901902367591, "timesteps_total": 220350, "num_env_steps_sampled_lifetime": 220350, "num_agent_steps_sampled_lifetime": 220350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 220350, "timers": {"training_iteration_time_ms": 10239.735, "restore_workers_time_ms": 0.012, "training_step_time_ms": 554.425, "sample_time_ms": 540.791, "synch_weights_time_ms": 12.322}, "counters": {"num_env_steps_sampled": 220350, "num_env_steps_trained": 220200, "num_agent_steps_sampled": 220350, "num_agent_steps_trained": 220200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1469, "num_samples_added_to_queue": 220200}, "done": false, "training_iteration": 73, "trial_id": "38f59_00000", "date": "2024-10-10_22-24-01", "timestamp": 1728595441, "time_this_iter_s": 10.211558103561401, "time_total_s": 746.787525177002, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb5db0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 746.787525177002, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 14.213333333333335, "ram_util_percent": 64.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 47401.3828125, "policy_loss": 39931.453125, "entropy": 6.3307929039001465, "entropy_coeff": 0.01, "var_gnorm": 16.984817504882812, "vf_loss": 748892.0, "vf_explained_var": 0.38603949546813965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 744.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 223350, "num_env_steps_trained": 223200, "num_agent_steps_sampled": 223350, "num_agent_steps_trained": 223200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1489, "num_samples_added_to_queue": 223200, "learner_queue": {"size_count": 744, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.917, "learner_load_time_ms": 0.209, "learner_load_wait_time_ms": 950.537, "learner_dequeue_time_ms": 8323.731}}, "env_runners": {"episode_reward_max": 870.7599999999999, "episode_reward_min": 849.0533333333333, "episode_reward_mean": 863.9397888888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 849.0533333333333}, "policy_reward_max": {"default_policy": 870.7599999999999}, "policy_reward_mean": {"default_policy": 863.9397888888889}, "custom_metrics": {"num_consolidated_mean": 2.9650000000000007, "num_consolidated_min": 2.91, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 1.0504, "num_moves_min": 0.78, "num_moves_max": 1.37, "mean_accuracy_mean": 40.559323333333325, "mean_accuracy_min": 40.48566666666666, "mean_accuracy_max": 40.66299999999999, "num_model_switches_mean": 0.6448, "num_model_switches_min": 0.43, "num_model_switches_max": 0.97, "num_slav_mean": 0.0005488333333333334, "num_slav_min": 0.0002, "num_slav_max": 0.0014500000000000001, "mean_cluster_cpu_util_mean": 0.500748908355458, "mean_cluster_cpu_util_min": 0.49689922894833605, "mean_cluster_cpu_util_max": 0.5043121121759515, "mean_cluster_mem_util_mean": 0.32612494464716263, "mean_cluster_mem_util_min": 0.32382885021097046, "mean_cluster_mem_util_max": 0.3279992438431068, "reward_consolidation_mean_mean": 4.607555555555553, "reward_consolidation_mean_min": 4.51111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0016666666666666668, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0517590000000006, "reward_accuracy_mean_min": 4.008733333333334, "reward_accuracy_mean_max": 4.066300000000001, "reward_sla_mean_mean": -0.01825, "reward_sla_mean_min": -0.04833333333333334, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 460.7555555555554, "reward_consolidation_sum_min": 451.11111111111103, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.16666666666666669, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 405.17589999999996, "reward_accuracy_sum_min": 400.8733333333334, "reward_accuracy_sum_max": 406.63000000000005, "reward_sla_sum_mean": -1.825, "reward_sla_sum_min": -4.833333333333334, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2549.0, "global_timestep_min": 300, "global_timestep_max": 4200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443, 860.4577777777779, 863.9077777777774, 867.2655555555555, 866.275555555556, 860.9811111111113, 867.7277777777779, 861.3311111111112, 861.3622222222223, 869.1633333333334, 863.853333333333, 860.1944444444446, 854.6344444444446, 859.4966666666667, 861.3622222222219, 849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889, 866.1644444444441, 868.8466666666666, 865.8377777777777, 857.784444444445, 862.863333333333, 853.0944444444449, 868.085555555556, 867.8633333333333, 866.3166666666665, 864.4422222222217, 869.1711111111113, 861.1800000000004, 864.9588888888891, 868.7666666666667, 867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891, 865.1466666666664, 863.6244444444444, 853.27, 870.2533333333334, 866.9422222222219, 868.9588888888889, 865.5699999999997, 861.2188888888888, 867.07, 865.2611111111114, 870.3322222222222, 864.3466666666668, 869.101111111111, 867.5622222222224, 867.5055555555555, 865.3955555555557, 867.4755555555556, 866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [859.642222222222, 859.8622222222225, 861.3311111111109, 863.0522222222222, 865.998888888889, 861.2588888888886, 849.5544444444446, 863.2122222222224, 856.8633333333332, 861.3711111111112, 862.8688888888886, 856.8000000000003, 851.9044444444443, 860.4577777777779, 863.9077777777774, 867.2655555555555, 866.275555555556, 860.9811111111113, 867.7277777777779, 861.3311111111112, 861.3622222222223, 869.1633333333334, 863.853333333333, 860.1944444444446, 854.6344444444446, 859.4966666666667, 861.3622222222219, 849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889, 866.1644444444441, 868.8466666666666, 865.8377777777777, 857.784444444445, 862.863333333333, 853.0944444444449, 868.085555555556, 867.8633333333333, 866.3166666666665, 864.4422222222217, 869.1711111111113, 861.1800000000004, 864.9588888888891, 868.7666666666667, 867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891, 865.1466666666664, 863.6244444444444, 853.27, 870.2533333333334, 866.9422222222219, 868.9588888888889, 865.5699999999997, 861.2188888888888, 867.07, 865.2611111111114, 870.3322222222222, 864.3466666666668, 869.101111111111, 867.5622222222224, 867.5055555555555, 865.3955555555557, 867.4755555555556, 866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1931314157902675, "mean_inference_ms": 1.769919396173032, "mean_action_processing_ms": 0.07276482648929146, "mean_env_wait_ms": 1.197832424485879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004202604293823242, "StateBufferConnector_ms": 0.0028612613677978516, "ViewRequirementAgentConnector_ms": 0.06683802604675293}, "num_episodes": 30, "episode_return_max": 870.7599999999999, "episode_return_min": 849.0533333333333, "episode_return_mean": 863.9397888888889, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223350, "num_agent_steps_trained": 223200, "num_env_steps_sampled": 223350, "num_env_steps_trained": 223200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 298.05529816006714, "num_env_steps_trained_throughput_per_sec": 298.05529816006714, "timesteps_total": 223350, "num_env_steps_sampled_lifetime": 223350, "num_agent_steps_sampled_lifetime": 223350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 223350, "timers": {"training_iteration_time_ms": 10239.564, "restore_workers_time_ms": 0.012, "training_step_time_ms": 497.794, "sample_time_ms": 483.254, "synch_weights_time_ms": 13.189}, "counters": {"num_env_steps_sampled": 223350, "num_env_steps_trained": 223200, "num_agent_steps_sampled": 223350, "num_agent_steps_trained": 223200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1489, "num_samples_added_to_queue": 223200}, "done": false, "training_iteration": 74, "trial_id": "38f59_00000", "date": "2024-10-10_22-24-11", "timestamp": 1728595451, "time_this_iter_s": 10.077548027038574, "time_total_s": 756.8650732040405, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2f520>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 756.8650732040405, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 11.864285714285716, "ram_util_percent": 64.67142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 37127.12890625, "policy_loss": 31638.32421875, "entropy": 6.1643266677856445, "entropy_coeff": 0.01, "var_gnorm": 17.033981323242188, "vf_loss": 550729.5625, "vf_explained_var": 0.43714892864227295}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 753.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 226050, "num_env_steps_trained": 225900, "num_agent_steps_sampled": 226050, "num_agent_steps_trained": 225900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1507, "num_samples_added_to_queue": 225900, "learner_queue": {"size_count": 753, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.665, "learner_load_time_ms": 0.157, "learner_load_wait_time_ms": 1077.213, "learner_dequeue_time_ms": 8374.798}}, "env_runners": {"episode_reward_max": 870.7599999999999, "episode_reward_min": 849.0533333333333, "episode_reward_mean": 864.7954555555556, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 849.0533333333333}, "policy_reward_max": {"default_policy": 870.7599999999999}, "policy_reward_mean": {"default_policy": 864.7954555555556}, "custom_metrics": {"num_consolidated_mean": 2.9746000000000006, "num_consolidated_min": 2.92, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0014000000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.9812000000000001, "num_moves_min": 0.73, "num_moves_max": 1.33, "mean_accuracy_mean": 40.53468666666666, "mean_accuracy_min": 40.40966666666666, "mean_accuracy_max": 40.637666666666654, "num_model_switches_mean": 0.6307, "num_model_switches_min": 0.43, "num_model_switches_max": 0.88, "num_slav_mean": 0.0005403333333333333, "num_slav_min": 0.0001, "num_slav_max": 0.00125, "mean_cluster_cpu_util_mean": 0.501020057807887, "mean_cluster_cpu_util_min": 0.49689922894833605, "mean_cluster_cpu_util_max": 0.5043121121759515, "mean_cluster_mem_util_mean": 0.3264493239795918, "mean_cluster_mem_util_min": 0.32382885021097046, "mean_cluster_mem_util_max": 0.3279992438431068, "reward_consolidation_mean_mean": 4.62062222222222, "reward_consolidation_mean_min": 4.51111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0023333333333333335, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0476323333333335, "reward_accuracy_mean_min": 4.004933333333334, "reward_accuracy_mean_max": 4.063766666666667, "reward_sla_mean_mean": -0.017966666666666666, "reward_sla_mean_min": -0.04166666666666667, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 462.0622222222221, "reward_consolidation_sum_min": 451.11111111111103, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.2333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.76323333333335, "reward_accuracy_sum_min": 400.4933333333334, "reward_accuracy_sum_max": 406.3766666666667, "reward_sla_sum_mean": -1.7966666666666666, "reward_sla_sum_min": -4.166666666666667, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3458.0, "global_timestep_min": 1400, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889, 866.1644444444441, 868.8466666666666, 865.8377777777777, 857.784444444445, 862.863333333333, 853.0944444444449, 868.085555555556, 867.8633333333333, 866.3166666666665, 864.4422222222217, 869.1711111111113, 861.1800000000004, 864.9588888888891, 868.7666666666667, 867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891, 865.1466666666664, 863.6244444444444, 853.27, 870.2533333333334, 866.9422222222219, 868.9588888888889, 865.5699999999997, 861.2188888888888, 867.07, 865.2611111111114, 870.3322222222222, 864.3466666666668, 869.101111111111, 867.5622222222224, 867.5055555555555, 865.3955555555557, 867.4755555555556, 866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003, 856.1755555555559, 869.0955555555556, 869.4766666666666, 869.6511111111113, 854.9444444444447, 865.0544444444445, 867.9044444444442, 867.7544444444442, 865.2222222222226, 856.2466666666668, 860.7611111111112, 869.6344444444447, 868.3722222222226, 857.237777777778, 864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [849.0533333333333, 869.6388888888887, 866.1633333333335, 861.6877777777779, 865.085555555556, 865.4655555555554, 861.6311111111114, 862.4877777777778, 865.0055555555556, 864.3633333333332, 867.568888888889, 869.9900000000001, 857.0144444444444, 869.64, 866.3933333333332, 863.918888888889, 866.1644444444441, 868.8466666666666, 865.8377777777777, 857.784444444445, 862.863333333333, 853.0944444444449, 868.085555555556, 867.8633333333333, 866.3166666666665, 864.4422222222217, 869.1711111111113, 861.1800000000004, 864.9588888888891, 868.7666666666667, 867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891, 865.1466666666664, 863.6244444444444, 853.27, 870.2533333333334, 866.9422222222219, 868.9588888888889, 865.5699999999997, 861.2188888888888, 867.07, 865.2611111111114, 870.3322222222222, 864.3466666666668, 869.101111111111, 867.5622222222224, 867.5055555555555, 865.3955555555557, 867.4755555555556, 866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003, 856.1755555555559, 869.0955555555556, 869.4766666666666, 869.6511111111113, 854.9444444444447, 865.0544444444445, 867.9044444444442, 867.7544444444442, 865.2222222222226, 856.2466666666668, 860.7611111111112, 869.6344444444447, 868.3722222222226, 857.237777777778, 864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19329890243932796, "mean_inference_ms": 1.7702955805779852, "mean_action_processing_ms": 0.07281276970908537, "mean_env_wait_ms": 1.1984064119080762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044825077056884766, "StateBufferConnector_ms": 0.002988576889038086, "ViewRequirementAgentConnector_ms": 0.07107090950012207}, "num_episodes": 27, "episode_return_max": 870.7599999999999, "episode_return_min": 849.0533333333333, "episode_return_mean": 864.7954555555556, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226050, "num_agent_steps_trained": 225900, "num_env_steps_sampled": 226050, "num_env_steps_trained": 225900, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 261.20980610525305, "num_env_steps_trained_throughput_per_sec": 261.20980610525305, "timesteps_total": 226050, "num_env_steps_sampled_lifetime": 226050, "num_agent_steps_sampled_lifetime": 226050, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 226050, "timers": {"training_iteration_time_ms": 10265.721, "restore_workers_time_ms": 0.013, "training_step_time_ms": 564.793, "sample_time_ms": 549.294, "synch_weights_time_ms": 14.043}, "counters": {"num_env_steps_sampled": 226050, "num_env_steps_trained": 225900, "num_agent_steps_sampled": 226050, "num_agent_steps_trained": 225900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1507, "num_samples_added_to_queue": 225900}, "done": false, "training_iteration": 75, "trial_id": "38f59_00000", "date": "2024-10-10_22-24-22", "timestamp": 1728595462, "time_this_iter_s": 10.354094982147217, "time_total_s": 767.2191681861877, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2cb80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 767.2191681861877, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 15.113333333333333, "ram_util_percent": 65.19333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 33356.40234375, "policy_loss": 27388.009765625, "entropy": 5.924731254577637, "entropy_coeff": 0.01, "var_gnorm": 17.089683532714844, "vf_loss": 598616.5, "vf_explained_var": 0.4492373466491699}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 762.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 228900, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228900, "num_agent_steps_trained": 228600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1526, "num_samples_added_to_queue": 228900, "learner_queue": {"size_count": 762, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 47.333, "learner_load_time_ms": 0.184, "learner_load_wait_time_ms": 1029.117, "learner_dequeue_time_ms": 8388.366}}, "env_runners": {"episode_reward_max": 870.7599999999999, "episode_reward_min": 850.2622222222224, "episode_reward_mean": 865.8599666666668, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 850.2622222222224}, "policy_reward_max": {"default_policy": 870.7599999999999}, "policy_reward_mean": {"default_policy": 865.8599666666668}, "custom_metrics": {"num_consolidated_mean": 2.9821000000000004, "num_consolidated_min": 2.94, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0013, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.9111999999999999, "num_moves_min": 0.65, "num_moves_max": 1.33, "mean_accuracy_mean": 40.50612333333333, "mean_accuracy_min": 40.40966666666666, "mean_accuracy_max": 40.63133333333332, "num_model_switches_mean": 0.6225, "num_model_switches_min": 0.37, "num_model_switches_max": 0.88, "num_slav_mean": 0.000517, "num_slav_min": 0.0001, "num_slav_max": 0.0009166666666666668, "mean_cluster_cpu_util_mean": 0.5010136297324209, "mean_cluster_cpu_util_min": 0.49755696417080353, "mean_cluster_cpu_util_max": 0.504038184868542, "mean_cluster_mem_util_mean": 0.32666365802333586, "mean_cluster_mem_util_min": 0.3244882647679325, "mean_cluster_mem_util_max": 0.3278937855205374, "reward_consolidation_mean_mean": 4.632755555555555, "reward_consolidation_mean_min": 4.5266666666666655, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0021666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.045199666666667, "reward_accuracy_mean_min": 4.004933333333334, "reward_accuracy_mean_max": 4.063133333333334, "reward_sla_mean_mean": -0.017188888888888885, "reward_sla_mean_min": -0.030555555555555558, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 463.27555555555546, "reward_consolidation_sum_min": 452.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.21666666666666665, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.5199666666667, "reward_accuracy_sum_min": 400.4933333333334, "reward_accuracy_sum_max": 406.3133333333334, "reward_sla_sum_mean": -1.718888888888889, "reward_sla_sum_min": -3.055555555555556, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4463.0, "global_timestep_min": 2400, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891, 865.1466666666664, 863.6244444444444, 853.27, 870.2533333333334, 866.9422222222219, 868.9588888888889, 865.5699999999997, 861.2188888888888, 867.07, 865.2611111111114, 870.3322222222222, 864.3466666666668, 869.101111111111, 867.5622222222224, 867.5055555555555, 865.3955555555557, 867.4755555555556, 866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003, 856.1755555555559, 869.0955555555556, 869.4766666666666, 869.6511111111113, 854.9444444444447, 865.0544444444445, 867.9044444444442, 867.7544444444442, 865.2222222222226, 856.2466666666668, 860.7611111111112, 869.6344444444447, 868.3722222222226, 857.237777777778, 864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224, 868.4677777777779, 867.5722222222221, 867.5711111111112, 870.04, 869.2622222222225, 865.1511111111115, 868.8955555555557, 870.1900000000002, 868.8577777777775, 869.3244444444448, 857.9922222222223, 867.1100000000001, 866.111111111111, 868.5388888888884, 865.4044444444447, 870.7544444444447, 856.1122222222223, 869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [867.8322222222222, 867.9022222222221, 870.7599999999999, 862.4666666666667, 865.5533333333339, 868.4577777777777, 863.7822222222226, 864.6322222222223, 863.4266666666667, 863.361111111111, 855.8877777777778, 867.5233333333333, 868.9188888888891, 865.1466666666664, 863.6244444444444, 853.27, 870.2533333333334, 866.9422222222219, 868.9588888888889, 865.5699999999997, 861.2188888888888, 867.07, 865.2611111111114, 870.3322222222222, 864.3466666666668, 869.101111111111, 867.5622222222224, 867.5055555555555, 865.3955555555557, 867.4755555555556, 866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003, 856.1755555555559, 869.0955555555556, 869.4766666666666, 869.6511111111113, 854.9444444444447, 865.0544444444445, 867.9044444444442, 867.7544444444442, 865.2222222222226, 856.2466666666668, 860.7611111111112, 869.6344444444447, 868.3722222222226, 857.237777777778, 864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224, 868.4677777777779, 867.5722222222221, 867.5711111111112, 870.04, 869.2622222222225, 865.1511111111115, 868.8955555555557, 870.1900000000002, 868.8577777777775, 869.3244444444448, 857.9922222222223, 867.1100000000001, 866.111111111111, 868.5388888888884, 865.4044444444447, 870.7544444444447, 856.1122222222223, 869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1935122869631826, "mean_inference_ms": 1.7728973130459733, "mean_action_processing_ms": 0.07289382138770482, "mean_env_wait_ms": 1.1994365472190067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004339933395385742, "StateBufferConnector_ms": 0.002909421920776367, "ViewRequirementAgentConnector_ms": 0.06909537315368652}, "num_episodes": 30, "episode_return_max": 870.7599999999999, "episode_return_min": 850.2622222222224, "episode_return_mean": 865.8599666666668, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228900, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228900, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.6859418962261, "num_env_steps_trained_throughput_per_sec": 264.0182607437931, "timesteps_total": 228900, "num_env_steps_sampled_lifetime": 228900, "num_agent_steps_sampled_lifetime": 228900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 228900, "timers": {"training_iteration_time_ms": 10255.195, "restore_workers_time_ms": 0.012, "training_step_time_ms": 514.298, "sample_time_ms": 499.659, "synch_weights_time_ms": 13.221}, "counters": {"num_env_steps_sampled": 228900, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228900, "num_agent_steps_trained": 228600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1526, "num_samples_added_to_queue": 228900}, "done": false, "training_iteration": 76, "trial_id": "38f59_00000", "date": "2024-10-10_22-24-32", "timestamp": 1728595472, "time_this_iter_s": 10.235348463058472, "time_total_s": 777.4545166492462, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6ec0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 777.4545166492462, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 14.626666666666665, "ram_util_percent": 65.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 28800.052734375, "policy_loss": 23497.9609375, "entropy": 5.804150581359863, "entropy_coeff": 0.01, "var_gnorm": 17.151899337768555, "vf_loss": 531950.375, "vf_explained_var": 0.4840555787086487}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 772.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 231900, "num_env_steps_trained": 231600, "num_agent_steps_sampled": 231900, "num_agent_steps_trained": 231600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1546, "num_samples_added_to_queue": 231900, "learner_queue": {"size_count": 772, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.87, "learner_load_time_ms": 0.206, "learner_load_wait_time_ms": 994.453, "learner_dequeue_time_ms": 8370.176}}, "env_runners": {"episode_reward_max": 870.7544444444447, "episode_reward_min": 849.3033333333333, "episode_reward_mean": 866.3635555555558, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 849.3033333333333}, "policy_reward_max": {"default_policy": 870.7544444444447}, "policy_reward_mean": {"default_policy": 866.3635555555558}, "custom_metrics": {"num_consolidated_mean": 2.9886, "num_consolidated_min": 2.94, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0015000000000000002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 0.8351999999999999, "num_moves_min": 0.58, "num_moves_max": 1.33, "mean_accuracy_mean": 40.48110666666666, "mean_accuracy_min": 40.39699999999999, "mean_accuracy_max": 40.59966666666666, "num_model_switches_mean": 0.5716, "num_model_switches_min": 0.33, "num_model_switches_max": 0.88, "num_slav_mean": 0.0005318333333333334, "num_slav_min": 0.0001, "num_slav_max": 0.0009166666666666668, "mean_cluster_cpu_util_mean": 0.501074069042326, "mean_cluster_cpu_util_min": 0.49755696417080353, "mean_cluster_cpu_util_max": 0.5040486532450817, "mean_cluster_mem_util_mean": 0.3268273836702403, "mean_cluster_mem_util_min": 0.3244882647679325, "mean_cluster_mem_util_max": 0.3275806962025317, "reward_consolidation_mean_mean": 4.641933333333332, "reward_consolidation_mean_min": 4.5266666666666655, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0025, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.041863333333334, "reward_accuracy_mean_min": 3.966366666666667, "reward_accuracy_mean_max": 4.059966666666667, "reward_sla_mean_mean": -0.017661111111111114, "reward_sla_mean_min": -0.030555555555555558, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 464.1933333333332, "reward_consolidation_sum_min": 452.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.24999999999999997, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.1863333333334, "reward_accuracy_sum_min": 396.6366666666667, "reward_accuracy_sum_max": 405.9966666666667, "reward_sla_sum_mean": -1.7661111111111105, "reward_sla_sum_min": -3.055555555555556, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5457.0, "global_timestep_min": 3300, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003, 856.1755555555559, 869.0955555555556, 869.4766666666666, 869.6511111111113, 854.9444444444447, 865.0544444444445, 867.9044444444442, 867.7544444444442, 865.2222222222226, 856.2466666666668, 860.7611111111112, 869.6344444444447, 868.3722222222226, 857.237777777778, 864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224, 868.4677777777779, 867.5722222222221, 867.5711111111112, 870.04, 869.2622222222225, 865.1511111111115, 868.8955555555557, 870.1900000000002, 868.8577777777775, 869.3244444444448, 857.9922222222223, 867.1100000000001, 866.111111111111, 868.5388888888884, 865.4044444444447, 870.7544444444447, 856.1122222222223, 869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334, 869.5000000000003, 867.7222222222224, 868.9677777777779, 869.9844444444446, 868.1266666666668, 867.9122222222223, 869.3733333333336, 866.802222222222, 869.4844444444449, 868.6588888888891, 866.7466666666668, 866.0244444444446, 869.0800000000002, 866.6922222222221, 870.3333333333334, 858.4444444444443, 868.008888888889, 870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [866.5055555555555, 850.2622222222224, 870.0522222222223, 862.9822222222223, 867.0844444444444, 864.4822222222223, 865.417777777778, 868.3166666666665, 867.2444444444444, 867.1566666666668, 868.8233333333336, 857.7455555555556, 866.1500000000003, 856.1755555555559, 869.0955555555556, 869.4766666666666, 869.6511111111113, 854.9444444444447, 865.0544444444445, 867.9044444444442, 867.7544444444442, 865.2222222222226, 856.2466666666668, 860.7611111111112, 869.6344444444447, 868.3722222222226, 857.237777777778, 864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224, 868.4677777777779, 867.5722222222221, 867.5711111111112, 870.04, 869.2622222222225, 865.1511111111115, 868.8955555555557, 870.1900000000002, 868.8577777777775, 869.3244444444448, 857.9922222222223, 867.1100000000001, 866.111111111111, 868.5388888888884, 865.4044444444447, 870.7544444444447, 856.1122222222223, 869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334, 869.5000000000003, 867.7222222222224, 868.9677777777779, 869.9844444444446, 868.1266666666668, 867.9122222222223, 869.3733333333336, 866.802222222222, 869.4844444444449, 868.6588888888891, 866.7466666666668, 866.0244444444446, 869.0800000000002, 866.6922222222221, 870.3333333333334, 858.4444444444443, 868.008888888889, 870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19369172456668957, "mean_inference_ms": 1.774035828125221, "mean_action_processing_ms": 0.07296436240290177, "mean_env_wait_ms": 1.2002488348830365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004339694976806641, "StateBufferConnector_ms": 0.0029447078704833984, "ViewRequirementAgentConnector_ms": 0.06953215599060059}, "num_episodes": 30, "episode_return_max": 870.7544444444447, "episode_return_min": 849.3033333333333, "episode_return_mean": 866.3635555555558, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231900, "num_agent_steps_trained": 231600, "num_env_steps_sampled": 231900, "num_env_steps_trained": 231600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 287.63518925581445, "num_env_steps_trained_throughput_per_sec": 287.63518925581445, "timesteps_total": 231900, "num_env_steps_sampled_lifetime": 231900, "num_agent_steps_sampled_lifetime": 231900, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 231900, "timers": {"training_iteration_time_ms": 10287.332, "restore_workers_time_ms": 0.011, "training_step_time_ms": 539.304, "sample_time_ms": 525.29, "synch_weights_time_ms": 12.632}, "counters": {"num_env_steps_sampled": 231900, "num_env_steps_trained": 231600, "num_agent_steps_sampled": 231900, "num_agent_steps_trained": 231600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1546, "num_samples_added_to_queue": 231900}, "done": false, "training_iteration": 77, "trial_id": "38f59_00000", "date": "2024-10-10_22-24-43", "timestamp": 1728595483, "time_this_iter_s": 10.450867891311646, "time_total_s": 787.9053845405579, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2cb20>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 787.9053845405579, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 12.200000000000001, "ram_util_percent": 65.14000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 24328.0546875, "policy_loss": 19860.9296875, "entropy": 5.7739386558532715, "entropy_coeff": 0.01, "var_gnorm": 17.209917068481445, "vf_loss": 448444.75, "vf_explained_var": 0.518172025680542}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 782.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 234750, "num_env_steps_trained": 234600, "num_agent_steps_sampled": 234750, "num_agent_steps_trained": 234600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1565, "num_samples_added_to_queue": 234600, "learner_queue": {"size_count": 782, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.254, "learner_load_time_ms": 0.218, "learner_load_wait_time_ms": 1005.873, "learner_dequeue_time_ms": 8475.291}}, "env_runners": {"episode_reward_max": 870.7544444444447, "episode_reward_min": 849.3033333333333, "episode_reward_mean": 867.2871888888887, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 849.3033333333333}, "policy_reward_max": {"default_policy": 870.7544444444447}, "policy_reward_mean": {"default_policy": 867.2871888888887}, "custom_metrics": {"num_consolidated_mean": 2.9927000000000006, "num_consolidated_min": 2.97, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 0.7620999999999999, "num_moves_min": 0.51, "num_moves_max": 1.0, "mean_accuracy_mean": 40.45399999999999, "mean_accuracy_min": 40.35266666666666, "mean_accuracy_max": 40.536333333333324, "num_model_switches_mean": 0.525, "num_model_switches_min": 0.33, "num_model_switches_max": 0.76, "num_slav_mean": 0.0005208333333333333, "num_slav_min": 0.00011666666666666667, "num_slav_max": 0.0009166666666666668, "mean_cluster_cpu_util_mean": 0.5009332658156299, "mean_cluster_cpu_util_min": 0.498408772292701, "mean_cluster_cpu_util_max": 0.5040486532450817, "mean_cluster_mem_util_mean": 0.3268998375204512, "mean_cluster_mem_util_min": 0.3256240770042194, "mean_cluster_mem_util_max": 0.3275806962025317, "reward_consolidation_mean_mean": 4.650644444444444, "reward_consolidation_mean_min": 4.573333333333332, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0016666666666666668, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.041233, "reward_accuracy_mean_min": 3.966366666666667, "reward_accuracy_mean_max": 4.053633333333334, "reward_sla_mean_mean": -0.01733888888888889, "reward_sla_mean_min": -0.030555555555555558, "reward_sla_mean_max": -0.0038888888888888888, "reward_consolidation_sum_mean": 465.0644444444443, "reward_consolidation_sum_min": 457.3333333333332, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.16666666666666663, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 404.1233000000001, "reward_accuracy_sum_min": 396.6366666666667, "reward_accuracy_sum_max": 405.3633333333334, "reward_sla_sum_mean": -1.7338888888888888, "reward_sla_sum_min": -3.055555555555556, "reward_sla_sum_max": -0.3888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5895.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224, 868.4677777777779, 867.5722222222221, 867.5711111111112, 870.04, 869.2622222222225, 865.1511111111115, 868.8955555555557, 870.1900000000002, 868.8577777777775, 869.3244444444448, 857.9922222222223, 867.1100000000001, 866.111111111111, 868.5388888888884, 865.4044444444447, 870.7544444444447, 856.1122222222223, 869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334, 869.5000000000003, 867.7222222222224, 868.9677777777779, 869.9844444444446, 868.1266666666668, 867.9122222222223, 869.3733333333336, 866.802222222222, 869.4844444444449, 868.6588888888891, 866.7466666666668, 866.0244444444446, 869.0800000000002, 866.6922222222221, 870.3333333333334, 858.4444444444443, 868.008888888889, 870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114, 867.9533333333336, 856.986666666667, 867.3977777777777, 867.0888888888891, 869.1755555555555, 868.97, 869.4933333333336, 865.588888888889, 869.5966666666668, 866.6988888888894, 870.056666666667, 868.9377777777778, 869.1833333333334, 867.5644444444445, 869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [864.818888888889, 870.0633333333332, 867.118888888889, 864.7233333333331, 865.2933333333333, 866.2444444444446, 867.8633333333335, 866.5144444444445, 868.0077777777778, 857.8266666666666, 856.3422222222221, 866.3399999999999, 858.6122222222224, 868.4677777777779, 867.5722222222221, 867.5711111111112, 870.04, 869.2622222222225, 865.1511111111115, 868.8955555555557, 870.1900000000002, 868.8577777777775, 869.3244444444448, 857.9922222222223, 867.1100000000001, 866.111111111111, 868.5388888888884, 865.4044444444447, 870.7544444444447, 856.1122222222223, 869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334, 869.5000000000003, 867.7222222222224, 868.9677777777779, 869.9844444444446, 868.1266666666668, 867.9122222222223, 869.3733333333336, 866.802222222222, 869.4844444444449, 868.6588888888891, 866.7466666666668, 866.0244444444446, 869.0800000000002, 866.6922222222221, 870.3333333333334, 858.4444444444443, 868.008888888889, 870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114, 867.9533333333336, 856.986666666667, 867.3977777777777, 867.0888888888891, 869.1755555555555, 868.97, 869.4933333333336, 865.588888888889, 869.5966666666668, 866.6988888888894, 870.056666666667, 868.9377777777778, 869.1833333333334, 867.5644444444445, 869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19383838458269279, "mean_inference_ms": 1.7752969711719202, "mean_action_processing_ms": 0.07301542946792468, "mean_env_wait_ms": 1.2009960524561019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004194736480712891, "StateBufferConnector_ms": 0.0029327869415283203, "ViewRequirementAgentConnector_ms": 0.06784343719482422}, "num_episodes": 27, "episode_return_max": 870.7544444444447, "episode_return_min": 849.3033333333333, "episode_return_mean": 867.2871888888887, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234750, "num_agent_steps_trained": 234600, "num_env_steps_sampled": 234750, "num_env_steps_trained": 234600, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 282.5106179297258, "num_env_steps_trained_throughput_per_sec": 297.379597820764, "timesteps_total": 234750, "num_env_steps_sampled_lifetime": 234750, "num_agent_steps_sampled_lifetime": 234750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 234750, "timers": {"training_iteration_time_ms": 10285.922, "restore_workers_time_ms": 0.012, "training_step_time_ms": 500.204, "sample_time_ms": 486.207, "synch_weights_time_ms": 12.664}, "counters": {"num_env_steps_sampled": 234750, "num_env_steps_trained": 234600, "num_agent_steps_sampled": 234750, "num_agent_steps_trained": 234600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1565, "num_samples_added_to_queue": 234600}, "done": false, "training_iteration": 78, "trial_id": "38f59_00000", "date": "2024-10-10_22-24-53", "timestamp": 1728595493, "time_this_iter_s": 10.105259895324707, "time_total_s": 798.0106444358826, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6b90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 798.0106444358826, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 14.271428571428572, "ram_util_percent": 65.93571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 22190.388671875, "policy_loss": 19102.90625, "entropy": 6.004032135009766, "entropy_coeff": 0.01, "var_gnorm": 17.27964210510254, "vf_loss": 310549.34375, "vf_explained_var": 0.573656439781189}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 792.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 237750, "num_env_steps_trained": 237600, "num_agent_steps_sampled": 237750, "num_agent_steps_trained": 237600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1585, "num_samples_added_to_queue": 237600, "learner_queue": {"size_count": 792, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.465, "learner_load_time_ms": 0.204, "learner_load_wait_time_ms": 977.773, "learner_dequeue_time_ms": 8492.352}}, "env_runners": {"episode_reward_max": 870.4522222222229, "episode_reward_min": 849.3033333333333, "episode_reward_mean": 867.9068444444446, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 849.3033333333333}, "policy_reward_max": {"default_policy": 870.4522222222229}, "policy_reward_mean": {"default_policy": 867.9068444444446}, "custom_metrics": {"num_consolidated_mean": 2.9961, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0006, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 0.7204999999999999, "num_moves_min": 0.48, "num_moves_max": 0.96, "mean_accuracy_mean": 40.421446666666654, "mean_accuracy_min": 40.24499999999999, "mean_accuracy_max": 40.52366666666666, "num_model_switches_mean": 0.5158999999999999, "num_model_switches_min": 0.33, "num_model_switches_max": 0.79, "num_slav_mean": 0.0005218333333333334, "num_slav_min": 0.00015, "num_slav_max": 0.0008833333333333333, "mean_cluster_cpu_util_mean": 0.5006697968089263, "mean_cluster_cpu_util_min": 0.4968564447738556, "mean_cluster_cpu_util_max": 0.5040486532450817, "mean_cluster_mem_util_mean": 0.32691008175105485, "mean_cluster_mem_util_min": 0.32544976265822784, "mean_cluster_mem_util_max": 0.3275806962025317, "reward_consolidation_mean_mean": 4.657799999999998, "reward_consolidation_mean_min": 4.573333333333332, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.039640666666667, "reward_accuracy_mean_min": 3.966366666666667, "reward_accuracy_mean_max": 4.052366666666667, "reward_sla_mean_mean": -0.017372222222222223, "reward_sla_mean_min": -0.029444444444444443, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 465.7799999999999, "reward_consolidation_sum_min": 457.3333333333332, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.1, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 403.96406666666667, "reward_accuracy_sum_min": 396.6366666666667, "reward_accuracy_sum_max": 405.2366666666667, "reward_sla_sum_mean": -1.737222222222222, "reward_sla_sum_min": -2.944444444444444, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4549.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334, 869.5000000000003, 867.7222222222224, 868.9677777777779, 869.9844444444446, 868.1266666666668, 867.9122222222223, 869.3733333333336, 866.802222222222, 869.4844444444449, 868.6588888888891, 866.7466666666668, 866.0244444444446, 869.0800000000002, 866.6922222222221, 870.3333333333334, 858.4444444444443, 868.008888888889, 870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114, 867.9533333333336, 856.986666666667, 867.3977777777777, 867.0888888888891, 869.1755555555555, 868.97, 869.4933333333336, 865.588888888889, 869.5966666666668, 866.6988888888894, 870.056666666667, 868.9377777777778, 869.1833333333334, 867.5644444444445, 869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334, 866.8677777777779, 868.1611111111113, 868.2977777777776, 869.6833333333334, 868.5344444444445, 858.3277777777778, 868.3277777777777, 868.4866666666667, 868.0833333333331, 868.2188888888888, 868.581111111111, 869.1444444444445, 869.1511111111112, 867.0177777777776, 868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.7855555555558, 869.0633333333333, 868.0477777777778, 869.3577777777774, 869.6266666666667, 869.3255555555558, 870.444444444445, 869.5877777777778, 868.2922222222222, 869.4522222222223, 868.7055555555555, 867.5566666666664, 870.3333333333334, 869.5000000000003, 867.7222222222224, 868.9677777777779, 869.9844444444446, 868.1266666666668, 867.9122222222223, 869.3733333333336, 866.802222222222, 869.4844444444449, 868.6588888888891, 866.7466666666668, 866.0244444444446, 869.0800000000002, 866.6922222222221, 870.3333333333334, 858.4444444444443, 868.008888888889, 870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114, 867.9533333333336, 856.986666666667, 867.3977777777777, 867.0888888888891, 869.1755555555555, 868.97, 869.4933333333336, 865.588888888889, 869.5966666666668, 866.6988888888894, 870.056666666667, 868.9377777777778, 869.1833333333334, 867.5644444444445, 869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334, 866.8677777777779, 868.1611111111113, 868.2977777777776, 869.6833333333334, 868.5344444444445, 858.3277777777778, 868.3277777777777, 868.4866666666667, 868.0833333333331, 868.2188888888888, 868.581111111111, 869.1444444444445, 869.1511111111112, 867.0177777777776, 868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19392784895415816, "mean_inference_ms": 1.7757883203681402, "mean_action_processing_ms": 0.07304726126347828, "mean_env_wait_ms": 1.2014328378035328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004069089889526367, "StateBufferConnector_ms": 0.0028994083404541016, "ViewRequirementAgentConnector_ms": 0.06653118133544922}, "num_episodes": 30, "episode_return_max": 870.4522222222229, "episode_return_min": 849.3033333333333, "episode_return_mean": 867.9068444444446, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237750, "num_agent_steps_trained": 237600, "num_env_steps_sampled": 237750, "num_env_steps_trained": 237600, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.7178588746804, "num_env_steps_trained_throughput_per_sec": 290.7178588746804, "timesteps_total": 237750, "num_env_steps_sampled_lifetime": 237750, "num_agent_steps_sampled_lifetime": 237750, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 237750, "timers": {"training_iteration_time_ms": 10315.4, "restore_workers_time_ms": 0.013, "training_step_time_ms": 518.925, "sample_time_ms": 504.23, "synch_weights_time_ms": 13.296}, "counters": {"num_env_steps_sampled": 237750, "num_env_steps_trained": 237600, "num_agent_steps_sampled": 237750, "num_agent_steps_trained": 237600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1585, "num_samples_added_to_queue": 237600}, "done": false, "training_iteration": 79, "trial_id": "38f59_00000", "date": "2024-10-10_22-25-03", "timestamp": 1728595503, "time_this_iter_s": 10.339815378189087, "time_total_s": 808.3504598140717, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2fc40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 808.3504598140717, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 12.053333333333333, "ram_util_percent": 65.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 19020.6796875, "policy_loss": 15840.8251953125, "entropy": 5.771908283233643, "entropy_coeff": 0.01, "var_gnorm": 17.346019744873047, "vf_loss": 319717.09375, "vf_explained_var": 0.5859401822090149}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 801.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240300, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1604, "num_samples_added_to_queue": 240600, "learner_queue": {"size_count": 801, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.656, "learner_load_time_ms": 0.224, "learner_load_wait_time_ms": 1062.61, "learner_dequeue_time_ms": 8596.203}}, "env_runners": {"episode_reward_max": 870.4522222222229, "episode_reward_min": 849.3033333333333, "episode_reward_mean": 867.0843888888886, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 849.3033333333333}, "policy_reward_max": {"default_policy": 870.4522222222229}, "policy_reward_mean": {"default_policy": 867.0843888888886}, "custom_metrics": {"num_consolidated_mean": 2.9973, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0006, "num_overloaded_min": 0.0, "num_overloaded_max": 0.02, "num_moves_mean": 0.7068000000000001, "num_moves_min": 0.48, "num_moves_max": 0.9, "mean_accuracy_mean": 40.32619333333333, "mean_accuracy_min": 39.99166666666666, "mean_accuracy_max": 40.50466666666666, "num_model_switches_mean": 0.5786, "num_model_switches_min": 0.33, "num_model_switches_max": 0.84, "num_slav_mean": 0.0005383333333333333, "num_slav_min": 0.00015, "num_slav_max": 0.0008833333333333333, "mean_cluster_cpu_util_mean": 0.4992671835930318, "mean_cluster_cpu_util_min": 0.4941333310351166, "mean_cluster_cpu_util_max": 0.5040486532450817, "mean_cluster_mem_util_mean": 0.3265638765822785, "mean_cluster_mem_util_min": 0.3250139767932489, "mean_cluster_mem_util_max": 0.3275806962025317, "reward_consolidation_mean_mean": 4.6596666666666655, "reward_consolidation_mean_min": 4.573333333333332, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.001, "reward_illegal_mean_min": -0.03333333333333333, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.030121666666667, "reward_accuracy_mean_min": 3.966366666666667, "reward_accuracy_mean_max": 4.050466666666668, "reward_sla_mean_mean": -0.017944444444444443, "reward_sla_mean_min": -0.029444444444444443, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 465.9666666666666, "reward_consolidation_sum_min": 457.3333333333332, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.1, "reward_illegal_sum_min": -3.333333333333333, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 403.01216666666664, "reward_accuracy_sum_min": 396.6366666666667, "reward_accuracy_sum_max": 405.04666666666674, "reward_sla_sum_mean": -1.7944444444444445, "reward_sla_sum_min": -2.944444444444444, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3209.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114, 867.9533333333336, 856.986666666667, 867.3977777777777, 867.0888888888891, 869.1755555555555, 868.97, 869.4933333333336, 865.588888888889, 869.5966666666668, 866.6988888888894, 870.056666666667, 868.9377777777778, 869.1833333333334, 867.5644444444445, 869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334, 866.8677777777779, 868.1611111111113, 868.2977777777776, 869.6833333333334, 868.5344444444445, 858.3277777777778, 868.3277777777777, 868.4866666666667, 868.0833333333331, 868.2188888888888, 868.581111111111, 869.1444444444445, 869.1511111111112, 867.0177777777776, 868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995, 867.0777777777777, 866.8711111111107, 867.3711111111111, 865.9444444444438, 864.1422222222216, 864.5655555555549, 865.3822222222217, 863.3988888888882, 866.2799999999993, 865.707777777777, 865.0377777777777, 867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.4522222222229, 869.7222222222223, 870.3566666666669, 849.3033333333333, 869.1344444444444, 858.5411111111114, 869.7466666666671, 866.8333333333334, 869.6577777777777, 867.445555555556, 868.0333333333331, 869.2777777777778, 869.5311111111114, 867.9533333333336, 856.986666666667, 867.3977777777777, 867.0888888888891, 869.1755555555555, 868.97, 869.4933333333336, 865.588888888889, 869.5966666666668, 866.6988888888894, 870.056666666667, 868.9377777777778, 869.1833333333334, 867.5644444444445, 869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334, 866.8677777777779, 868.1611111111113, 868.2977777777776, 869.6833333333334, 868.5344444444445, 858.3277777777778, 868.3277777777777, 868.4866666666667, 868.0833333333331, 868.2188888888888, 868.581111111111, 869.1444444444445, 869.1511111111112, 867.0177777777776, 868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995, 867.0777777777777, 866.8711111111107, 867.3711111111111, 865.9444444444438, 864.1422222222216, 864.5655555555549, 865.3822222222217, 863.3988888888882, 866.2799999999993, 865.707777777777, 865.0377777777777, 867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19410348925111356, "mean_inference_ms": 1.7768500786419543, "mean_action_processing_ms": 0.07309781766629891, "mean_env_wait_ms": 1.2021071719885115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004431962966918945, "StateBufferConnector_ms": 0.002971649169921875, "ViewRequirementAgentConnector_ms": 0.06892156600952148}, "num_episodes": 30, "episode_return_max": 870.4522222222229, "episode_return_min": 849.3033333333333, "episode_return_mean": 867.0843888888886, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240300, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 268.2750738186061, "num_env_steps_trained_throughput_per_sec": 254.155333091311, "timesteps_total": 240600, "num_env_steps_sampled_lifetime": 240600, "num_agent_steps_sampled_lifetime": 240600, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 240600, "timers": {"training_iteration_time_ms": 10335.995, "restore_workers_time_ms": 0.013, "training_step_time_ms": 580.18, "sample_time_ms": 564.921, "synch_weights_time_ms": 13.809}, "counters": {"num_env_steps_sampled": 240600, "num_env_steps_trained": 240300, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1604, "num_samples_added_to_queue": 240600}, "done": false, "training_iteration": 80, "trial_id": "38f59_00000", "date": "2024-10-10_22-25-14", "timestamp": 1728595514, "time_this_iter_s": 10.64702320098877, "time_total_s": 818.9974830150604, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2d840>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 818.9974830150604, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 15.213333333333335, "ram_util_percent": 66.48666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 18349.615234375, "policy_loss": 15289.6953125, "entropy": 5.734675407409668, "entropy_coeff": 0.01, "var_gnorm": 17.42452049255371, "vf_loss": 307712.375, "vf_explained_var": 0.5941025018692017}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 811.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 243450, "num_env_steps_trained": 243300, "num_agent_steps_sampled": 243450, "num_agent_steps_trained": 243300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1623, "num_samples_added_to_queue": 243300, "learner_queue": {"size_count": 811, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.407, "learner_load_time_ms": 0.249, "learner_load_wait_time_ms": 1075.045, "learner_dequeue_time_ms": 8640.777}}, "env_runners": {"episode_reward_max": 870.39, "episode_reward_min": 855.5577777777772, "episode_reward_mean": 866.5442111111108, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 855.5577777777772}, "policy_reward_max": {"default_policy": 870.39}, "policy_reward_mean": {"default_policy": 866.5442111111108}, "custom_metrics": {"num_consolidated_mean": 2.9982000000000006, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0002, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.7091999999999998, "num_moves_min": 0.48, "num_moves_max": 0.9, "mean_accuracy_mean": 40.214093333333324, "mean_accuracy_min": 39.940999999999995, "mean_accuracy_max": 40.45399999999999, "num_model_switches_mean": 0.5932999999999999, "num_model_switches_min": 0.32, "num_model_switches_max": 0.84, "num_slav_mean": 0.0005321666666666667, "num_slav_min": 0.00015, "num_slav_max": 0.0008333333333333334, "mean_cluster_cpu_util_mean": 0.4976069658944659, "mean_cluster_cpu_util_min": 0.4927341078323221, "mean_cluster_cpu_util_max": 0.5025767259606545, "mean_cluster_mem_util_mean": 0.3261248259493671, "mean_cluster_mem_util_min": 0.3246959388185654, "mean_cluster_mem_util_max": 0.32732805907172996, "reward_consolidation_mean_mean": 4.662933333333333, "reward_consolidation_mean_min": 4.619999999999999, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.0003333333333333333, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.020581, "reward_accuracy_mean_min": 3.9694666666666665, "reward_accuracy_mean_max": 4.045400000000001, "reward_sla_mean_mean": -0.017738888888888887, "reward_sla_mean_min": -0.027777777777777776, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 466.29333333333324, "reward_consolidation_sum_min": 461.9999999999999, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.03333333333333333, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 402.0581, "reward_accuracy_sum_min": 396.94666666666666, "reward_accuracy_sum_max": 404.5400000000001, "reward_sla_sum_mean": -1.7738888888888882, "reward_sla_sum_min": -2.7777777777777777, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2165.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334, 866.8677777777779, 868.1611111111113, 868.2977777777776, 869.6833333333334, 868.5344444444445, 858.3277777777778, 868.3277777777777, 868.4866666666667, 868.0833333333331, 868.2188888888888, 868.581111111111, 869.1444444444445, 869.1511111111112, 867.0177777777776, 868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995, 867.0777777777777, 866.8711111111107, 867.3711111111111, 865.9444444444438, 864.1422222222216, 864.5655555555549, 865.3822222222217, 863.3988888888882, 866.2799999999993, 865.707777777777, 865.0377777777777, 867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882, 865.256666666666, 865.5577777777771, 865.438888888888, 864.6066666666659, 865.1455555555548, 865.177777777777, 865.256666666666, 865.5899999999995, 864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.6766666666665, 868.4544444444444, 866.9144444444441, 870.0800000000003, 867.9711111111112, 867.595555555556, 869.3577777777781, 865.5577777777778, 867.1755555555554, 867.7877777777777, 869.3666666666667, 868.4144444444444, 869.0733333333334, 866.8677777777779, 868.1611111111113, 868.2977777777776, 869.6833333333334, 868.5344444444445, 858.3277777777778, 868.3277777777777, 868.4866666666667, 868.0833333333331, 868.2188888888888, 868.581111111111, 869.1444444444445, 869.1511111111112, 867.0177777777776, 868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995, 867.0777777777777, 866.8711111111107, 867.3711111111111, 865.9444444444438, 864.1422222222216, 864.5655555555549, 865.3822222222217, 863.3988888888882, 866.2799999999993, 865.707777777777, 865.0377777777777, 867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882, 865.256666666666, 865.5577777777771, 865.438888888888, 864.6066666666659, 865.1455555555548, 865.177777777777, 865.256666666666, 865.5899999999995, 864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19433536465802334, "mean_inference_ms": 1.7782514046622873, "mean_action_processing_ms": 0.07316163726228504, "mean_env_wait_ms": 1.2029533245697275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004997730255126953, "StateBufferConnector_ms": 0.002964496612548828, "ViewRequirementAgentConnector_ms": 0.06986308097839355}, "num_episodes": 27, "episode_return_max": 870.39, "episode_return_min": 855.5577777777772, "episode_return_mean": 866.5442111111108, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243450, "num_agent_steps_trained": 243300, "num_env_steps_sampled": 243450, "num_env_steps_trained": 243300, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 270.7785029561395, "num_env_steps_trained_throughput_per_sec": 285.03000311172576, "timesteps_total": 243450, "num_env_steps_sampled_lifetime": 243450, "num_agent_steps_sampled_lifetime": 243450, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 243450, "timers": {"training_iteration_time_ms": 10349.738, "restore_workers_time_ms": 0.014, "training_step_time_ms": 528.58, "sample_time_ms": 513.004, "synch_weights_time_ms": 14.076}, "counters": {"num_env_steps_sampled": 243450, "num_env_steps_trained": 243300, "num_agent_steps_sampled": 243450, "num_agent_steps_trained": 243300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1623, "num_samples_added_to_queue": 243300}, "done": false, "training_iteration": 81, "trial_id": "38f59_00000", "date": "2024-10-10_22-25-24", "timestamp": 1728595524, "time_this_iter_s": 10.540812253952026, "time_total_s": 829.5382952690125, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2d6c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 829.5382952690125, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 15.266666666666664, "ram_util_percent": 66.79333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 15832.197265625, "policy_loss": 13026.671875, "entropy": 5.748995780944824, "entropy_coeff": 0.01, "var_gnorm": 17.48116683959961, "vf_loss": 282277.21875, "vf_explained_var": 0.6048909425735474}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 819.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 246000, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 246000, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1640, "num_samples_added_to_queue": 246000, "learner_queue": {"size_count": 819, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.783, "learner_load_time_ms": 0.268, "learner_load_wait_time_ms": 1131.757, "learner_dequeue_time_ms": 8649.296}}, "env_runners": {"episode_reward_max": 870.39, "episode_reward_min": 855.5577777777772, "episode_reward_mean": 865.8814111111105, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 855.5577777777772}, "policy_reward_max": {"default_policy": 870.39}, "policy_reward_mean": {"default_policy": 865.8814111111105}, "custom_metrics": {"num_consolidated_mean": 2.9989999999999997, "num_consolidated_min": 2.98, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.7005000000000001, "num_moves_min": 0.4, "num_moves_max": 0.91, "mean_accuracy_mean": 40.125806666666655, "mean_accuracy_min": 39.940999999999995, "mean_accuracy_max": 40.43499999999999, "num_model_switches_mean": 0.5957000000000001, "num_model_switches_min": 0.32, "num_model_switches_max": 0.84, "num_slav_mean": 0.0005350000000000001, "num_slav_min": 0.00015, "num_slav_max": 0.001, "mean_cluster_cpu_util_mean": 0.49619523464791326, "mean_cluster_cpu_util_min": 0.4927341078323221, "mean_cluster_cpu_util_max": 0.5025386904761905, "mean_cluster_mem_util_mean": 0.3257694686181435, "mean_cluster_mem_util_min": 0.3246959388185654, "mean_cluster_mem_util_max": 0.32717457805907174, "reward_consolidation_mean_mean": 4.664644444444443, "reward_consolidation_mean_min": 4.619999999999999, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.00016666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.012169666666667, "reward_accuracy_mean_min": 3.9694666666666665, "reward_accuracy_mean_max": 4.0435, "reward_sla_mean_mean": -0.017833333333333333, "reward_sla_mean_min": -0.03333333333333333, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 466.4644444444444, "reward_consolidation_sum_min": 461.9999999999999, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.016666666666666666, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 401.2169666666667, "reward_accuracy_sum_min": 396.94666666666666, "reward_accuracy_sum_max": 404.35, "reward_sla_sum_mean": -1.7833333333333332, "reward_sla_sum_min": -3.333333333333333, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2358.0, "global_timestep_min": 300, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995, 867.0777777777777, 866.8711111111107, 867.3711111111111, 865.9444444444438, 864.1422222222216, 864.5655555555549, 865.3822222222217, 863.3988888888882, 866.2799999999993, 865.707777777777, 865.0377777777777, 867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882, 865.256666666666, 865.5577777777771, 865.438888888888, 864.6066666666659, 865.1455555555548, 865.177777777777, 865.256666666666, 865.5899999999995, 864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213, 864.3999999999992, 864.8922222222216, 865.0433333333327, 865.5099999999993, 866.1533333333326, 865.1611111111102, 865.5477777777775, 867.0477777777772, 865.6211111111105, 865.2088888888882, 865.3677777777768, 866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.6844444444447, 869.4700000000001, 869.1522222222219, 866.3522222222223, 868.891111111111, 864.4577777777774, 870.39, 869.1133333333335, 869.778888888889, 869.127777777778, 868.7477777777779, 868.525555555556, 866.7399999999999, 867.2344444444441, 867.5911111111105, 867.9499999999995, 867.0777777777777, 866.8711111111107, 867.3711111111111, 865.9444444444438, 864.1422222222216, 864.5655555555549, 865.3822222222217, 863.3988888888882, 866.2799999999993, 865.707777777777, 865.0377777777777, 867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882, 865.256666666666, 865.5577777777771, 865.438888888888, 864.6066666666659, 865.1455555555548, 865.177777777777, 865.256666666666, 865.5899999999995, 864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213, 864.3999999999992, 864.8922222222216, 865.0433333333327, 865.5099999999993, 866.1533333333326, 865.1611111111102, 865.5477777777775, 867.0477777777772, 865.6211111111105, 865.2088888888882, 865.3677777777768, 866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19458286952532164, "mean_inference_ms": 1.7789879027915716, "mean_action_processing_ms": 0.07323889671734062, "mean_env_wait_ms": 1.2038921388913986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005278348922729492, "StateBufferConnector_ms": 0.0030274391174316406, "ViewRequirementAgentConnector_ms": 0.07266116142272949}, "num_episodes": 27, "episode_return_max": 870.39, "episode_return_min": 855.5577777777772, "episode_return_mean": 865.8814111111105, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246000, "num_agent_steps_trained": 245700, "num_env_steps_sampled": 246000, "num_env_steps_trained": 245700, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 249.6008710508339, "num_env_steps_trained_throughput_per_sec": 234.91846687137308, "timesteps_total": 246000, "num_env_steps_sampled_lifetime": 246000, "num_agent_steps_sampled_lifetime": 246000, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 246000, "timers": {"training_iteration_time_ms": 10303.161, "restore_workers_time_ms": 0.012, "training_step_time_ms": 637.53, "sample_time_ms": 622.029, "synch_weights_time_ms": 14.017}, "counters": {"num_env_steps_sampled": 246000, "num_env_steps_trained": 245700, "num_agent_steps_sampled": 246000, "num_agent_steps_trained": 245700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1640, "num_samples_added_to_queue": 246000}, "done": false, "training_iteration": 82, "trial_id": "38f59_00000", "date": "2024-10-10_22-25-35", "timestamp": 1728595535, "time_this_iter_s": 10.226696014404297, "time_total_s": 839.7649912834167, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7190>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 839.7649912834167, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.606666666666666, "ram_util_percent": 66.68666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 7850.28759765625, "policy_loss": 5743.0556640625, "entropy": 5.37740421295166, "entropy_coeff": 0.01, "var_gnorm": 17.533397674560547, "vf_loss": 212336.4375, "vf_explained_var": 0.6364094018936157}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 828.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 248700, "num_env_steps_trained": 248400, "num_agent_steps_sampled": 248700, "num_agent_steps_trained": 248400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1658, "num_samples_added_to_queue": 248700, "learner_queue": {"size_count": 828, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.208, "learner_load_time_ms": 0.301, "learner_load_wait_time_ms": 1134.601, "learner_dequeue_time_ms": 8802.923}}, "env_runners": {"episode_reward_max": 869.6700000000003, "episode_reward_min": 855.5577777777772, "episode_reward_mean": 865.9138111111106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 855.5577777777772}, "policy_reward_max": {"default_policy": 869.6700000000003}, "policy_reward_mean": {"default_policy": 865.9138111111106}, "custom_metrics": {"num_consolidated_mean": 2.9995000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0001, "num_overloaded_min": 0.0, "num_overloaded_max": 0.01, "num_moves_mean": 0.6229, "num_moves_min": 0.22, "num_moves_max": 0.91, "mean_accuracy_mean": 40.11554666666667, "mean_accuracy_min": 39.940999999999995, "mean_accuracy_max": 40.377999999999986, "num_model_switches_mean": 0.5724, "num_model_switches_min": 0.32, "num_model_switches_max": 0.84, "num_slav_mean": 0.0005178333333333334, "num_slav_min": 0.0001, "num_slav_max": 0.001, "mean_cluster_cpu_util_mean": 0.4961148972984464, "mean_cluster_cpu_util_min": 0.4927341078323221, "mean_cluster_cpu_util_max": 0.5015080437580437, "mean_cluster_mem_util_mean": 0.325751815664557, "mean_cluster_mem_util_min": 0.3246959388185654, "mean_cluster_mem_util_max": 0.3269477848101265, "reward_consolidation_mean_mean": 4.6654222222222215, "reward_consolidation_mean_min": 4.619999999999999, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": -0.00016666666666666666, "reward_illegal_mean_min": -0.016666666666666666, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0111436666666656, "reward_accuracy_mean_min": 3.9694666666666665, "reward_accuracy_mean_max": 4.0378, "reward_sla_mean_mean": -0.017261111111111112, "reward_sla_mean_min": -0.03333333333333333, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 466.54222222222216, "reward_consolidation_sum_min": 461.9999999999999, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": -0.016666666666666666, "reward_illegal_sum_min": -1.6666666666666665, "reward_illegal_sum_max": 0.0, "reward_accuracy_sum_mean": 401.1143666666667, "reward_accuracy_sum_min": 396.94666666666666, "reward_accuracy_sum_max": 403.78, "reward_sla_sum_mean": -1.7261111111111112, "reward_sla_sum_min": -3.333333333333333, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3253.0, "global_timestep_min": 1300, "global_timestep_max": 4900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882, 865.256666666666, 865.5577777777771, 865.438888888888, 864.6066666666659, 865.1455555555548, 865.177777777777, 865.256666666666, 865.5899999999995, 864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213, 864.3999999999992, 864.8922222222216, 865.0433333333327, 865.5099999999993, 866.1533333333326, 865.1611111111102, 865.5477777777775, 867.0477777777772, 865.6211111111105, 865.2088888888882, 865.3677777777768, 866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991, 866.7377777777774, 866.5711111111107, 865.7633333333329, 867.3799999999995, 866.7133333333328, 867.877777777778, 867.9966666666667, 867.6377777777778, 868.5977777777779, 865.596666666666, 866.6666666666665, 867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [867.2122222222216, 867.1888888888884, 866.3477777777773, 865.2866666666658, 865.9855555555548, 866.9355555555552, 863.9311111111105, 864.5277777777767, 865.939999999999, 867.7666666666665, 867.1244444444438, 866.7999999999996, 866.895555555555, 865.8088888888882, 855.5577777777772, 866.5077777777769, 866.7311111111103, 865.9699999999991, 864.8988888888882, 865.256666666666, 865.5577777777771, 865.438888888888, 864.6066666666659, 865.1455555555548, 865.177777777777, 865.256666666666, 865.5899999999995, 864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213, 864.3999999999992, 864.8922222222216, 865.0433333333327, 865.5099999999993, 866.1533333333326, 865.1611111111102, 865.5477777777775, 867.0477777777772, 865.6211111111105, 865.2088888888882, 865.3677777777768, 866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991, 866.7377777777774, 866.5711111111107, 865.7633333333329, 867.3799999999995, 866.7133333333328, 867.877777777778, 867.9966666666667, 867.6377777777778, 868.5977777777779, 865.596666666666, 866.6666666666665, 867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.194888030979916, "mean_inference_ms": 1.780214126826964, "mean_action_processing_ms": 0.07332608748175233, "mean_env_wait_ms": 1.2050561167799636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053882598876953125, "StateBufferConnector_ms": 0.0031023025512695312, "ViewRequirementAgentConnector_ms": 0.07486200332641602}, "num_episodes": 27, "episode_return_max": 869.6700000000003, "episode_return_min": 855.5577777777772, "episode_return_mean": 865.9138111111106, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248700, "num_agent_steps_trained": 248400, "num_env_steps_sampled": 248700, "num_env_steps_trained": 248400, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 267.3125500327891, "num_env_steps_trained_throughput_per_sec": 267.3125500327891, "timesteps_total": 248700, "num_env_steps_sampled_lifetime": 248700, "num_agent_steps_sampled_lifetime": 248700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 248700, "timers": {"training_iteration_time_ms": 10293.12, "restore_workers_time_ms": 0.012, "training_step_time_ms": 592.0, "sample_time_ms": 577.344, "synch_weights_time_ms": 13.256}, "counters": {"num_env_steps_sampled": 248700, "num_env_steps_trained": 248400, "num_agent_steps_sampled": 248700, "num_agent_steps_trained": 248400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1658, "num_samples_added_to_queue": 248700}, "done": false, "training_iteration": 83, "trial_id": "38f59_00000", "date": "2024-10-10_22-25-45", "timestamp": 1728595545, "time_this_iter_s": 10.110180377960205, "time_total_s": 849.875171661377, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2c880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 849.875171661377, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 16.97142857142857, "ram_util_percent": 67.45714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 7835.58251953125, "policy_loss": 5138.38671875, "entropy": 5.130276679992676, "entropy_coeff": 0.01, "var_gnorm": 17.590280532836914, "vf_loss": 271258.65625, "vf_explained_var": 0.60882568359375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 838.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 251550, "num_env_steps_trained": 251400, "num_agent_steps_sampled": 251550, "num_agent_steps_trained": 251400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1677, "num_samples_added_to_queue": 251400, "learner_queue": {"size_count": 838, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.831, "learner_load_time_ms": 0.303, "learner_load_wait_time_ms": 1003.4, "learner_dequeue_time_ms": 8802.663}}, "env_runners": {"episode_reward_max": 871.0233333333335, "episode_reward_min": 863.2333333333324, "episode_reward_mean": 866.948855555555, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 863.2333333333324}, "policy_reward_max": {"default_policy": 871.0233333333335}, "policy_reward_mean": {"default_policy": 866.948855555555}, "custom_metrics": {"num_consolidated_mean": 2.9995000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.5119, "num_moves_min": 0.14, "num_moves_max": 0.91, "mean_accuracy_mean": 40.205163333333324, "mean_accuracy_min": 39.940999999999995, "mean_accuracy_max": 40.51099999999999, "num_model_switches_mean": 0.49900000000000005, "num_model_switches_min": 0.22, "num_model_switches_max": 0.73, "num_slav_mean": 0.0005074999999999999, "num_slav_min": 0.0001, "num_slav_max": 0.001, "mean_cluster_cpu_util_mean": 0.4976651442992738, "mean_cluster_cpu_util_min": 0.4927341078323221, "mean_cluster_cpu_util_max": 0.5034782014157014, "mean_cluster_mem_util_mean": 0.3261458122362869, "mean_cluster_mem_util_min": 0.3246959388185654, "mean_cluster_mem_util_max": 0.3275263713080169, "reward_consolidation_mean_mean": 4.665888888888888, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.020516333333334, "reward_accuracy_mean_min": 3.9941000000000004, "reward_accuracy_mean_max": 4.051100000000001, "reward_sla_mean_mean": -0.016916666666666667, "reward_sla_mean_min": -0.03333333333333333, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 466.58888888888873, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 402.0516333333333, "reward_accuracy_sum_min": 399.41, "reward_accuracy_sum_max": 405.11000000000007, "reward_sla_sum_mean": -1.6916666666666667, "reward_sla_sum_min": -3.333333333333333, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4162.0, "global_timestep_min": 2300, "global_timestep_max": 5800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213, 864.3999999999992, 864.8922222222216, 865.0433333333327, 865.5099999999993, 866.1533333333326, 865.1611111111102, 865.5477777777775, 867.0477777777772, 865.6211111111105, 865.2088888888882, 865.3677777777768, 866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991, 866.7377777777774, 866.5711111111107, 865.7633333333329, 867.3799999999995, 866.7133333333328, 867.877777777778, 867.9966666666667, 867.6377777777778, 868.5977777777779, 865.596666666666, 866.6666666666665, 867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52, 869.1844444444444, 869.7544444444447, 869.7622222222228, 869.5, 869.7633333333334, 869.7144444444446, 870.0077777777783, 870.2300000000002, 868.8500000000003, 867.3255555555558, 869.8033333333335, 869.4377777777783, 869.8333333333336, 868.8811111111113, 869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [864.2744444444435, 865.6466666666656, 866.716666666666, 865.597777777777, 864.8533333333324, 864.9233333333323, 863.2333333333324, 865.5111111111102, 864.5444444444437, 865.209999999999, 865.1611111111106, 865.3355555555548, 865.9699999999989, 863.8844444444436, 864.1322222222212, 864.5266666666658, 866.0499999999992, 865.2966666666662, 865.8122222222213, 864.3999999999992, 864.8922222222216, 865.0433333333327, 865.5099999999993, 866.1533333333326, 865.1611111111102, 865.5477777777775, 867.0477777777772, 865.6211111111105, 865.2088888888882, 865.3677777777768, 866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991, 866.7377777777774, 866.5711111111107, 865.7633333333329, 867.3799999999995, 866.7133333333328, 867.877777777778, 867.9966666666667, 867.6377777777778, 868.5977777777779, 865.596666666666, 866.6666666666665, 867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52, 869.1844444444444, 869.7544444444447, 869.7622222222228, 869.5, 869.7633333333334, 869.7144444444446, 870.0077777777783, 870.2300000000002, 868.8500000000003, 867.3255555555558, 869.8033333333335, 869.4377777777783, 869.8333333333336, 868.8811111111113, 869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19520548101143448, "mean_inference_ms": 1.7837942331521994, "mean_action_processing_ms": 0.0734259092843524, "mean_env_wait_ms": 1.2065357550625802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005035877227783203, "StateBufferConnector_ms": 0.003065347671508789, "ViewRequirementAgentConnector_ms": 0.07410454750061035}, "num_episodes": 27, "episode_return_max": 871.0233333333335, "episode_return_min": 863.2333333333324, "episode_return_mean": 866.948855555555, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251550, "num_agent_steps_trained": 251400, "num_env_steps_sampled": 251550, "num_env_steps_trained": 251400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 279.6517708287324, "num_env_steps_trained_throughput_per_sec": 294.37028508287625, "timesteps_total": 251550, "num_env_steps_sampled_lifetime": 251550, "num_agent_steps_sampled_lifetime": 251550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 251550, "timers": {"training_iteration_time_ms": 10305.719, "restore_workers_time_ms": 0.012, "training_step_time_ms": 516.677, "sample_time_ms": 502.632, "synch_weights_time_ms": 12.637}, "counters": {"num_env_steps_sampled": 251550, "num_env_steps_trained": 251400, "num_agent_steps_sampled": 251550, "num_agent_steps_trained": 251400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1677, "num_samples_added_to_queue": 251400}, "done": false, "training_iteration": 84, "trial_id": "38f59_00000", "date": "2024-10-10_22-25-55", "timestamp": 1728595555, "time_this_iter_s": 10.201217651367188, "time_total_s": 860.0763893127441, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7490>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 860.0763893127441, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 12.806666666666668, "ram_util_percent": 67.61333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6613.39599609375, "policy_loss": 4728.67138671875, "entropy": 5.252272605895996, "entropy_coeff": 0.01, "var_gnorm": 17.64704132080078, "vf_loss": 190048.15625, "vf_explained_var": 0.6472736597061157}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 848.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 254550, "num_env_steps_trained": 254400, "num_agent_steps_sampled": 254550, "num_agent_steps_trained": 254400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1697, "num_samples_added_to_queue": 254400, "learner_queue": {"size_count": 848, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.645, "learner_load_time_ms": 0.276, "learner_load_wait_time_ms": 961.774, "learner_dequeue_time_ms": 8742.817}}, "env_runners": {"episode_reward_max": 871.0233333333335, "episode_reward_min": 864.7066666666661, "episode_reward_mean": 868.0421444444444, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 864.7066666666661}, "policy_reward_max": {"default_policy": 871.0233333333335}, "policy_reward_mean": {"default_policy": 868.0421444444444}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.375, "num_moves_min": 0.1, "num_moves_max": 0.91, "mean_accuracy_mean": 40.31143666666666, "mean_accuracy_min": 39.99166666666666, "mean_accuracy_max": 40.536333333333324, "num_model_switches_mean": 0.4743, "num_model_switches_min": 0.22, "num_model_switches_max": 0.73, "num_slav_mean": 0.0005076666666666666, "num_slav_min": 0.0001, "num_slav_max": 0.001, "mean_cluster_cpu_util_mean": 0.49944913854224127, "mean_cluster_cpu_util_min": 0.49371753769075205, "mean_cluster_cpu_util_max": 0.5038226810994668, "mean_cluster_mem_util_mean": 0.32661552215189865, "mean_cluster_mem_util_min": 0.3252373417721519, "mean_cluster_mem_util_max": 0.3276983122362869, "reward_consolidation_mean_mean": 4.666199999999999, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.031143666666666, "reward_accuracy_mean_min": 3.999166666666667, "reward_accuracy_mean_max": 4.053633333333334, "reward_sla_mean_mean": -0.01692222222222222, "reward_sla_mean_min": -0.03333333333333333, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 466.61999999999995, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.1143666666667, "reward_accuracy_sum_min": 399.9166666666667, "reward_accuracy_sum_max": 405.3633333333334, "reward_sla_sum_mean": -1.692222222222222, "reward_sla_sum_min": -3.333333333333333, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5161.0, "global_timestep_min": 3200, "global_timestep_max": 6800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991, 866.7377777777774, 866.5711111111107, 865.7633333333329, 867.3799999999995, 866.7133333333328, 867.877777777778, 867.9966666666667, 867.6377777777778, 868.5977777777779, 865.596666666666, 866.6666666666665, 867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52, 869.1844444444444, 869.7544444444447, 869.7622222222228, 869.5, 869.7633333333334, 869.7144444444446, 870.0077777777783, 870.2300000000002, 868.8500000000003, 867.3255555555558, 869.8033333333335, 869.4377777777783, 869.8333333333336, 868.8811111111113, 869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003, 869.8888888888893, 870.967777777778, 868.2388888888892, 869.5166666666667, 869.3811111111112, 869.4544444444447, 868.1933333333333, 868.5677777777776, 867.7900000000001, 868.0599999999997, 870.0855555555556, 870.0788888888891, 870.007777777778, 869.7455555555558, 870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [866.239999999999, 865.1066666666658, 865.7166666666661, 866.033333333333, 864.7066666666661, 865.9233333333326, 866.5333333333325, 864.916666666666, 865.4155555555549, 865.3366666666657, 865.1611111111104, 864.9311111111106, 865.0266666666661, 865.0099999999996, 866.047777777777, 865.9699999999991, 866.7377777777774, 866.5711111111107, 865.7633333333329, 867.3799999999995, 866.7133333333328, 867.877777777778, 867.9966666666667, 867.6377777777778, 868.5977777777779, 865.596666666666, 866.6666666666665, 867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52, 869.1844444444444, 869.7544444444447, 869.7622222222228, 869.5, 869.7633333333334, 869.7144444444446, 870.0077777777783, 870.2300000000002, 868.8500000000003, 867.3255555555558, 869.8033333333335, 869.4377777777783, 869.8333333333336, 868.8811111111113, 869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003, 869.8888888888893, 870.967777777778, 868.2388888888892, 869.5166666666667, 869.3811111111112, 869.4544444444447, 868.1933333333333, 868.5677777777776, 867.7900000000001, 868.0599999999997, 870.0855555555556, 870.0788888888891, 870.007777777778, 869.7455555555558, 870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19539182033228836, "mean_inference_ms": 1.7851331436125781, "mean_action_processing_ms": 0.07348707511971578, "mean_env_wait_ms": 1.2073445126816555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004480600357055664, "StateBufferConnector_ms": 0.0029723644256591797, "ViewRequirementAgentConnector_ms": 0.07153177261352539}, "num_episodes": 30, "episode_return_max": 871.0233333333335, "episode_return_min": 864.7066666666661, "episode_return_mean": 868.0421444444444, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254550, "num_agent_steps_trained": 254400, "num_env_steps_sampled": 254550, "num_env_steps_trained": 254400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.0215024015878, "num_env_steps_trained_throughput_per_sec": 297.0215024015878, "timesteps_total": 254550, "num_env_steps_sampled_lifetime": 254550, "num_agent_steps_sampled_lifetime": 254550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 254550, "timers": {"training_iteration_time_ms": 10282.095, "restore_workers_time_ms": 0.013, "training_step_time_ms": 504.967, "sample_time_ms": 490.236, "synch_weights_time_ms": 13.355}, "counters": {"num_env_steps_sampled": 254550, "num_env_steps_trained": 254400, "num_agent_steps_sampled": 254550, "num_agent_steps_trained": 254400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1697, "num_samples_added_to_queue": 254400}, "done": false, "training_iteration": 85, "trial_id": "38f59_00000", "date": "2024-10-10_22-26-05", "timestamp": 1728595565, "time_this_iter_s": 10.110202312469482, "time_total_s": 870.1865916252136, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb5de0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 870.1865916252136, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.957142857142857, "ram_util_percent": 67.45714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 6402.7763671875, "policy_loss": 4367.33984375, "entropy": 5.4373779296875, "entropy_coeff": 0.01, "var_gnorm": 17.69810676574707, "vf_loss": 205174.875, "vf_explained_var": 0.6368993520736694}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 857.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 257250, "num_env_steps_trained": 257100, "num_agent_steps_sampled": 257250, "num_agent_steps_trained": 257100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1715, "num_samples_added_to_queue": 257100, "learner_queue": {"size_count": 857, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.736, "learner_load_time_ms": 0.288, "learner_load_wait_time_ms": 1082.845, "learner_dequeue_time_ms": 8776.144}}, "env_runners": {"episode_reward_max": 871.0233333333335, "episode_reward_min": 866.0477777777774, "episode_reward_mean": 868.4463000000001, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.0477777777774}, "policy_reward_max": {"default_policy": 871.0233333333335}, "policy_reward_mean": {"default_policy": 868.4463000000001}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.28800000000000003, "num_moves_min": 0.06, "num_moves_max": 0.66, "mean_accuracy_mean": 40.35146333333333, "mean_accuracy_min": 40.124666666666656, "mean_accuracy_max": 40.536333333333324, "num_model_switches_mean": 0.5024, "num_model_switches_min": 0.22, "num_model_switches_max": 0.85, "num_slav_mean": 0.0005065, "num_slav_min": 0.0001, "num_slav_max": 0.0009333333333333335, "mean_cluster_cpu_util_mean": 0.5001929600167769, "mean_cluster_cpu_util_min": 0.494669769259055, "mean_cluster_cpu_util_max": 0.5038226810994668, "mean_cluster_mem_util_mean": 0.326797246835443, "mean_cluster_mem_util_min": 0.3257093881856541, "mean_cluster_mem_util_max": 0.3276983122362869, "reward_consolidation_mean_mean": 4.666199999999999, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0351463333333335, "reward_accuracy_mean_min": 4.012466666666667, "reward_accuracy_mean_max": 4.053633333333334, "reward_sla_mean_mean": -0.016883333333333327, "reward_sla_mean_min": -0.031111111111111107, "reward_sla_mean_max": -0.003333333333333333, "reward_consolidation_sum_mean": 466.61999999999995, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.51463333333334, "reward_accuracy_sum_min": 401.24666666666667, "reward_accuracy_sum_max": 405.3633333333334, "reward_sla_sum_mean": -1.6883333333333335, "reward_sla_sum_min": -3.1111111111111107, "reward_sla_sum_max": -0.3333333333333333, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 6061.0, "global_timestep_min": 4100, "global_timestep_max": 7700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52, 869.1844444444444, 869.7544444444447, 869.7622222222228, 869.5, 869.7633333333334, 869.7144444444446, 870.0077777777783, 870.2300000000002, 868.8500000000003, 867.3255555555558, 869.8033333333335, 869.4377777777783, 869.8333333333336, 868.8811111111113, 869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003, 869.8888888888893, 870.967777777778, 868.2388888888892, 869.5166666666667, 869.3811111111112, 869.4544444444447, 868.1933333333333, 868.5677777777776, 867.7900000000001, 868.0599999999997, 870.0855555555556, 870.0788888888891, 870.007777777778, 869.7455555555558, 870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554, 867.2433333333335, 866.6499999999996, 866.7688888888886, 867.1333333333329, 867.6633333333332, 867.5766666666665, 868.2499999999998, 868.1077777777775, 869.0499999999998, 867.8144444444442, 867.0133333333333, 868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [867.246666666666, 867.3711111111107, 867.4499999999994, 866.6388888888889, 867.5433333333334, 867.9566666666666, 866.7244444444445, 866.1433333333329, 866.7777777777774, 866.0477777777774, 867.7122222222221, 866.3377777777775, 868.3533333333337, 869.6700000000003, 869.1933333333334, 868.52, 869.1844444444444, 869.7544444444447, 869.7622222222228, 869.5, 869.7633333333334, 869.7144444444446, 870.0077777777783, 870.2300000000002, 868.8500000000003, 867.3255555555558, 869.8033333333335, 869.4377777777783, 869.8333333333336, 868.8811111111113, 869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003, 869.8888888888893, 870.967777777778, 868.2388888888892, 869.5166666666667, 869.3811111111112, 869.4544444444447, 868.1933333333333, 868.5677777777776, 867.7900000000001, 868.0599999999997, 870.0855555555556, 870.0788888888891, 870.007777777778, 869.7455555555558, 870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554, 867.2433333333335, 866.6499999999996, 866.7688888888886, 867.1333333333329, 867.6633333333332, 867.5766666666665, 868.2499999999998, 868.1077777777775, 869.0499999999998, 867.8144444444442, 867.0133333333333, 868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1955600131946467, "mean_inference_ms": 1.7862061726828085, "mean_action_processing_ms": 0.07353724886158763, "mean_env_wait_ms": 1.2079666772045417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004467964172363281, "StateBufferConnector_ms": 0.0029578208923339844, "ViewRequirementAgentConnector_ms": 0.07162880897521973}, "num_episodes": 27, "episode_return_max": 871.0233333333335, "episode_return_min": 866.0477777777774, "episode_return_mean": 868.4463000000001, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257250, "num_agent_steps_trained": 257100, "num_env_steps_sampled": 257250, "num_env_steps_trained": 257100, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 261.40212624338096, "num_env_steps_trained_throughput_per_sec": 261.40212624338096, "timesteps_total": 257250, "num_env_steps_sampled_lifetime": 257250, "num_agent_steps_sampled_lifetime": 257250, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 257250, "timers": {"training_iteration_time_ms": 10292.329, "restore_workers_time_ms": 0.015, "training_step_time_ms": 558.377, "sample_time_ms": 540.557, "synch_weights_time_ms": 16.257}, "counters": {"num_env_steps_sampled": 257250, "num_env_steps_trained": 257100, "num_agent_steps_sampled": 257250, "num_agent_steps_trained": 257100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1715, "num_samples_added_to_queue": 257100}, "done": false, "training_iteration": 86, "trial_id": "38f59_00000", "date": "2024-10-10_22-26-16", "timestamp": 1728595576, "time_this_iter_s": 10.339131593704224, "time_total_s": 880.5257232189178, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb61a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 880.5257232189178, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 16.03333333333333, "ram_util_percent": 67.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2045.4844970703125, "policy_loss": 444.906982421875, "entropy": 5.603507995605469, "entropy_coeff": 0.01, "var_gnorm": 17.734956741333008, "vf_loss": 161738.8125, "vf_explained_var": 0.6485872268676758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 866.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 260100, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 260100, "num_agent_steps_trained": 259800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1734, "num_samples_added_to_queue": 260100, "learner_queue": {"size_count": 866, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.342, "learner_load_time_ms": 0.308, "learner_load_wait_time_ms": 1039.434, "learner_dequeue_time_ms": 8849.494}}, "env_runners": {"episode_reward_max": 871.9566666666659, "episode_reward_min": 866.5366666666663, "episode_reward_mean": 868.6351444444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.5366666666663}, "policy_reward_max": {"default_policy": 871.9566666666659}, "policy_reward_mean": {"default_policy": 868.6351444444443}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3105, "num_moves_min": 0.06, "num_moves_max": 0.59, "mean_accuracy_mean": 40.37540333333333, "mean_accuracy_min": 40.18166666666666, "mean_accuracy_max": 40.66933333333333, "num_model_switches_mean": 0.6286, "num_model_switches_min": 0.22, "num_model_switches_max": 1.11, "num_slav_mean": 0.0005356666666666666, "num_slav_min": 0.00015, "num_slav_max": 0.0009833333333333335, "mean_cluster_cpu_util_mean": 0.5006320637984925, "mean_cluster_cpu_util_min": 0.49649062327633753, "mean_cluster_cpu_util_max": 0.5083799986210701, "mean_cluster_mem_util_mean": 0.3269381962025317, "mean_cluster_mem_util_min": 0.325845464135021, "mean_cluster_mem_util_max": 0.32864715189873417, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.037540333333334, "reward_accuracy_mean_min": 4.018166666666667, "reward_accuracy_mean_max": 4.066933333333334, "reward_sla_mean_mean": -0.017855555555555555, "reward_sla_mean_min": -0.03277777777777778, "reward_sla_mean_max": -0.005, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.75403333333344, "reward_accuracy_sum_min": 401.81666666666666, "reward_accuracy_sum_max": 406.6933333333334, "reward_sla_sum_mean": -1.7855555555555558, "reward_sla_sum_min": -3.277777777777778, "reward_sla_sum_max": -0.5, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4957.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003, 869.8888888888893, 870.967777777778, 868.2388888888892, 869.5166666666667, 869.3811111111112, 869.4544444444447, 868.1933333333333, 868.5677777777776, 867.7900000000001, 868.0599999999997, 870.0855555555556, 870.0788888888891, 870.007777777778, 869.7455555555558, 870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554, 867.2433333333335, 866.6499999999996, 866.7688888888886, 867.1333333333329, 867.6633333333332, 867.5766666666665, 868.2499999999998, 868.1077777777775, 869.0499999999998, 867.8144444444442, 867.0133333333333, 868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551, 868.21, 868.1466666666665, 867.1466666666665, 868.5033333333334, 868.8199999999997, 869.0711111111107, 869.9688888888883, 871.094444444444, 871.3377777777772, 871.1933333333329, 867.0599999999998, 866.5366666666663, 867.1155555555549, 868.5677777777776, 867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.4211111111117, 869.2633333333337, 868.7155555555557, 869.2611111111112, 867.3277777777779, 868.5177777777778, 868.9688888888892, 870.586666666667, 869.9766666666663, 869.0000000000003, 871.0233333333335, 869.2211111111108, 869.6200000000003, 869.8888888888893, 870.967777777778, 868.2388888888892, 869.5166666666667, 869.3811111111112, 869.4544444444447, 868.1933333333333, 868.5677777777776, 867.7900000000001, 868.0599999999997, 870.0855555555556, 870.0788888888891, 870.007777777778, 869.7455555555558, 870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554, 867.2433333333335, 866.6499999999996, 866.7688888888886, 867.1333333333329, 867.6633333333332, 867.5766666666665, 868.2499999999998, 868.1077777777775, 869.0499999999998, 867.8144444444442, 867.0133333333333, 868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551, 868.21, 868.1466666666665, 867.1466666666665, 868.5033333333334, 868.8199999999997, 869.0711111111107, 869.9688888888883, 871.094444444444, 871.3377777777772, 871.1933333333329, 867.0599999999998, 866.5366666666663, 867.1155555555549, 868.5677777777776, 867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19576355756879915, "mean_inference_ms": 1.7882174848517054, "mean_action_processing_ms": 0.0736023686839931, "mean_env_wait_ms": 1.20880257746184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004511833190917969, "StateBufferConnector_ms": 0.0029904842376708984, "ViewRequirementAgentConnector_ms": 0.07234621047973633}, "num_episodes": 30, "episode_return_max": 871.9566666666659, "episode_return_min": 866.5366666666663, "episode_return_mean": 868.6351444444443, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260100, "num_agent_steps_trained": 259800, "num_env_steps_sampled": 260100, "num_env_steps_trained": 259800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.9327084060939, "num_env_steps_trained_throughput_per_sec": 261.4099342794574, "timesteps_total": 260100, "num_env_steps_sampled_lifetime": 260100, "num_agent_steps_sampled_lifetime": 260100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 260100, "timers": {"training_iteration_time_ms": 10282.202, "restore_workers_time_ms": 0.013, "training_step_time_ms": 508.789, "sample_time_ms": 493.893, "synch_weights_time_ms": 13.564}, "counters": {"num_env_steps_sampled": 260100, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 260100, "num_agent_steps_trained": 259800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1734, "num_samples_added_to_queue": 260100}, "done": false, "training_iteration": 87, "trial_id": "38f59_00000", "date": "2024-10-10_22-26-26", "timestamp": 1728595586, "time_this_iter_s": 10.339189052581787, "time_total_s": 890.8649122714996, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb74f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 890.8649122714996, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 14.346666666666668, "ram_util_percent": 67.42666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2795.2021484375, "policy_loss": 1086.4532470703125, "entropy": 4.955224990844727, "entropy_coeff": 0.01, "var_gnorm": 17.756559371948242, "vf_loss": 172361.46875, "vf_explained_var": 0.6568737030029297}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 876.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 262950, "num_env_steps_trained": 262800, "num_agent_steps_sampled": 262950, "num_agent_steps_trained": 262800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1753, "num_samples_added_to_queue": 262800, "learner_queue": {"size_count": 876, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.81, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 1030.866, "learner_dequeue_time_ms": 8861.81}}, "env_runners": {"episode_reward_max": 875.1133333333322, "episode_reward_min": 866.5366666666663, "episode_reward_mean": 869.6356666666662, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.5366666666663}, "policy_reward_max": {"default_policy": 875.1133333333322}, "policy_reward_mean": {"default_policy": 869.6356666666662}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3032, "num_moves_min": 0.06, "num_moves_max": 0.59, "mean_accuracy_mean": 40.48756666666666, "mean_accuracy_min": 40.18166666666666, "mean_accuracy_max": 41.02400000000001, "num_model_switches_mean": 0.6871999999999998, "num_model_switches_min": 0.26, "num_model_switches_max": 1.11, "num_slav_mean": 0.000572, "num_slav_min": 0.00016666666666666666, "num_slav_max": 0.0013166666666666667, "mean_cluster_cpu_util_mean": 0.5028816128883986, "mean_cluster_cpu_util_min": 0.49649062327633753, "mean_cluster_cpu_util_max": 0.5132288793895936, "mean_cluster_mem_util_mean": 0.327509973628692, "mean_cluster_mem_util_min": 0.325845464135021, "mean_cluster_mem_util_max": 0.3301202531645569, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.048756666666666, "reward_accuracy_mean_min": 4.018166666666667, "reward_accuracy_mean_max": 4.1024, "reward_sla_mean_mean": -0.019066666666666666, "reward_sla_mean_min": -0.043888888888888894, "reward_sla_mean_max": -0.005555555555555556, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.87566666666675, "reward_accuracy_sum_min": 401.81666666666666, "reward_accuracy_sum_max": 410.24, "reward_sla_sum_mean": -1.9066666666666665, "reward_sla_sum_min": -4.388888888888889, "reward_sla_sum_max": -0.5555555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3746.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554, 867.2433333333335, 866.6499999999996, 866.7688888888886, 867.1333333333329, 867.6633333333332, 867.5766666666665, 868.2499999999998, 868.1077777777775, 869.0499999999998, 867.8144444444442, 867.0133333333333, 868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551, 868.21, 868.1466666666665, 867.1466666666665, 868.5033333333334, 868.8199999999997, 869.0711111111107, 869.9688888888883, 871.094444444444, 871.3377777777772, 871.1933333333329, 867.0599999999998, 866.5366666666663, 867.1155555555549, 868.5677777777776, 867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659, 871.3055555555551, 871.0666666666663, 872.3966666666659, 872.8977777777772, 873.5377777777771, 874.1166666666659, 872.4644444444438, 875.0022222222211, 874.0177777777767, 871.8755555555549, 873.0644444444445, 872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.1511111111113, 869.4711111111114, 868.1366666666668, 867.5366666666665, 866.5699999999997, 867.1566666666661, 869.4844444444449, 869.6033333333336, 869.4600000000003, 869.11, 869.6588888888895, 868.0899999999999, 868.123333333333, 867.6944444444439, 867.8933333333334, 867.8455555555554, 867.2433333333335, 866.6499999999996, 866.7688888888886, 867.1333333333329, 867.6633333333332, 867.5766666666665, 868.2499999999998, 868.1077777777775, 869.0499999999998, 867.8144444444442, 867.0133333333333, 868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551, 868.21, 868.1466666666665, 867.1466666666665, 868.5033333333334, 868.8199999999997, 869.0711111111107, 869.9688888888883, 871.094444444444, 871.3377777777772, 871.1933333333329, 867.0599999999998, 866.5366666666663, 867.1155555555549, 868.5677777777776, 867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659, 871.3055555555551, 871.0666666666663, 872.3966666666659, 872.8977777777772, 873.5377777777771, 874.1166666666659, 872.4644444444438, 875.0022222222211, 874.0177777777767, 871.8755555555549, 873.0644444444445, 872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1959666328473579, "mean_inference_ms": 1.7882284352940263, "mean_action_processing_ms": 0.07365506702842055, "mean_env_wait_ms": 1.2093555002520864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004668235778808594, "StateBufferConnector_ms": 0.0030488967895507812, "ViewRequirementAgentConnector_ms": 0.0737612247467041}, "num_episodes": 27, "episode_return_max": 875.1133333333322, "episode_return_min": 866.5366666666663, "episode_return_mean": 869.6356666666662, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262950, "num_agent_steps_trained": 262800, "num_env_steps_sampled": 262950, "num_env_steps_trained": 262800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 273.50771159697877, "num_env_steps_trained_throughput_per_sec": 287.90285431260924, "timesteps_total": 262950, "num_env_steps_sampled_lifetime": 262950, "num_agent_steps_sampled_lifetime": 262950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 262950, "timers": {"training_iteration_time_ms": 10315.408, "restore_workers_time_ms": 0.013, "training_step_time_ms": 565.429, "sample_time_ms": 550.021, "synch_weights_time_ms": 14.071}, "counters": {"num_env_steps_sampled": 262950, "num_env_steps_trained": 262800, "num_agent_steps_sampled": 262950, "num_agent_steps_trained": 262800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1753, "num_samples_added_to_queue": 262800}, "done": false, "training_iteration": 88, "trial_id": "38f59_00000", "date": "2024-10-10_22-26-36", "timestamp": 1728595596, "time_this_iter_s": 10.430377960205078, "time_total_s": 901.2952902317047, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb5fc0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 901.2952902317047, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 13.493333333333334, "ram_util_percent": 67.45333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2940.939697265625, "policy_loss": 1251.1163330078125, "entropy": 4.890207290649414, "entropy_coeff": 0.01, "var_gnorm": 17.776519775390625, "vf_loss": 170449.40625, "vf_explained_var": 0.6604845523834229}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 885.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 265650, "num_env_steps_trained": 265500, "num_agent_steps_sampled": 265650, "num_agent_steps_trained": 265500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1771, "num_samples_added_to_queue": 265500, "learner_queue": {"size_count": 885, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.172, "learner_load_time_ms": 0.298, "learner_load_wait_time_ms": 1109.518, "learner_dequeue_time_ms": 8947.62}}, "env_runners": {"episode_reward_max": 875.5733333333322, "episode_reward_min": 866.5366666666663, "episode_reward_mean": 871.3611444444437, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.5366666666663}, "policy_reward_max": {"default_policy": 875.5733333333322}, "policy_reward_mean": {"default_policy": 871.3611444444437}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.26890000000000003, "num_moves_min": 0.04, "num_moves_max": 0.59, "mean_accuracy_mean": 40.67433666666666, "mean_accuracy_min": 40.22599999999999, "mean_accuracy_max": 41.043, "num_model_switches_mean": 0.6176999999999999, "num_model_switches_min": 0.16, "num_model_switches_max": 1.11, "num_slav_mean": 0.0006146666666666668, "num_slav_min": 0.00016666666666666666, "num_slav_max": 0.0013166666666666667, "mean_cluster_cpu_util_mean": 0.5064805632928848, "mean_cluster_cpu_util_min": 0.49649062327633753, "mean_cluster_cpu_util_max": 0.5142510227063799, "mean_cluster_mem_util_mean": 0.32842880274261604, "mean_cluster_mem_util_min": 0.3260775316455697, "mean_cluster_mem_util_max": 0.33032964135021103, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.067433666666667, "reward_accuracy_mean_min": 4.0226, "reward_accuracy_mean_max": 4.1043, "reward_sla_mean_mean": -0.02048888888888889, "reward_sla_mean_min": -0.043888888888888894, "reward_sla_mean_max": -0.005555555555555556, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.7433666666667, "reward_accuracy_sum_min": 402.26, "reward_accuracy_sum_max": 410.43000000000006, "reward_sla_sum_mean": -2.048888888888889, "reward_sla_sum_min": -4.388888888888889, "reward_sla_sum_max": -0.5555555555555556, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2543.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551, 868.21, 868.1466666666665, 867.1466666666665, 868.5033333333334, 868.8199999999997, 869.0711111111107, 869.9688888888883, 871.094444444444, 871.3377777777772, 871.1933333333329, 867.0599999999998, 866.5366666666663, 867.1155555555549, 868.5677777777776, 867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659, 871.3055555555551, 871.0666666666663, 872.3966666666659, 872.8977777777772, 873.5377777777771, 874.1166666666659, 872.4644444444438, 875.0022222222211, 874.0177777777767, 871.8755555555549, 873.0644444444445, 872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322, 874.7166666666653, 874.1366666666657, 873.7333333333326, 874.2077777777765, 874.557777777777, 874.81111111111, 875.2166666666657, 874.8122222222214, 874.272222222221, 874.8744444444433, 875.5733333333322, 874.3666666666657, 874.6844444444434, 874.9866666666658, 874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.37, 867.204444444444, 867.8466666666662, 867.4177777777778, 867.5766666666668, 868.0122222222219, 868.5599999999996, 867.4177777777776, 867.2755555555552, 867.9955555555554, 867.2666666666662, 867.3155555555552, 867.1477777777776, 867.2744444444444, 867.7422222222222, 868.3355555555551, 868.21, 868.1466666666665, 867.1466666666665, 868.5033333333334, 868.8199999999997, 869.0711111111107, 869.9688888888883, 871.094444444444, 871.3377777777772, 871.1933333333329, 867.0599999999998, 866.5366666666663, 867.1155555555549, 868.5677777777776, 867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659, 871.3055555555551, 871.0666666666663, 872.3966666666659, 872.8977777777772, 873.5377777777771, 874.1166666666659, 872.4644444444438, 875.0022222222211, 874.0177777777767, 871.8755555555549, 873.0644444444445, 872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322, 874.7166666666653, 874.1366666666657, 873.7333333333326, 874.2077777777765, 874.557777777777, 874.81111111111, 875.2166666666657, 874.8122222222214, 874.272222222221, 874.8744444444433, 875.5733333333322, 874.3666666666657, 874.6844444444434, 874.9866666666658, 874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19625463868373305, "mean_inference_ms": 1.7899680442671257, "mean_action_processing_ms": 0.0737383661811712, "mean_env_wait_ms": 1.2103768617378754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00484013557434082, "StateBufferConnector_ms": 0.0031082630157470703, "ViewRequirementAgentConnector_ms": 0.07582306861877441}, "num_episodes": 27, "episode_return_max": 875.5733333333322, "episode_return_min": 866.5366666666663, "episode_return_mean": 871.3611444444437, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265650, "num_agent_steps_trained": 265500, "num_env_steps_sampled": 265650, "num_env_steps_trained": 265500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 259.25300492878785, "num_env_steps_trained_throughput_per_sec": 259.25300492878785, "timesteps_total": 265650, "num_env_steps_sampled_lifetime": 265650, "num_agent_steps_sampled_lifetime": 265650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 265650, "timers": {"training_iteration_time_ms": 10324.933, "restore_workers_time_ms": 0.013, "training_step_time_ms": 547.571, "sample_time_ms": 530.519, "synch_weights_time_ms": 15.268}, "counters": {"num_env_steps_sampled": 265650, "num_env_steps_trained": 265500, "num_agent_steps_sampled": 265650, "num_agent_steps_trained": 265500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1771, "num_samples_added_to_queue": 265500}, "done": false, "training_iteration": 89, "trial_id": "38f59_00000", "date": "2024-10-10_22-26-47", "timestamp": 1728595607, "time_this_iter_s": 10.422926664352417, "time_total_s": 911.7182168960571, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb5de0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 911.7182168960571, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 15.653333333333334, "ram_util_percent": 68.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3166.0146484375, "policy_loss": 1233.375244140625, "entropy": 4.993414402008057, "entropy_coeff": 0.01, "var_gnorm": 17.795860290527344, "vf_loss": 194761.953125, "vf_explained_var": 0.640752911567688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 894.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 268500, "num_env_steps_trained": 268200, "num_agent_steps_sampled": 268500, "num_agent_steps_trained": 268200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1790, "num_samples_added_to_queue": 268500, "learner_queue": {"size_count": 894, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.523, "learner_load_time_ms": 0.31, "learner_load_wait_time_ms": 1055.451, "learner_dequeue_time_ms": 8915.638}}, "env_runners": {"episode_reward_max": 875.5733333333322, "episode_reward_min": 867.353333333333, "episode_reward_mean": 872.9664888888883, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.353333333333}, "policy_reward_max": {"default_policy": 875.5733333333322}, "policy_reward_mean": {"default_policy": 872.9664888888883}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.18950000000000003, "num_moves_min": 0.0, "num_moves_max": 0.59, "mean_accuracy_mean": 40.84742666666668, "mean_accuracy_min": 40.30199999999999, "mean_accuracy_max": 41.043, "num_model_switches_mean": 0.5243, "num_model_switches_min": 0.16, "num_model_switches_max": 1.11, "num_slav_mean": 0.0006523333333333333, "num_slav_min": 0.00023333333333333333, "num_slav_max": 0.0013166666666666667, "mean_cluster_cpu_util_mean": 0.5098260066188637, "mean_cluster_cpu_util_min": 0.49929805570877, "mean_cluster_cpu_util_max": 0.5142510227063799, "mean_cluster_mem_util_mean": 0.3292791613924051, "mean_cluster_mem_util_min": 0.32652426160337555, "mean_cluster_mem_util_max": 0.33032964135021103, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.084742666666666, "reward_accuracy_mean_min": 4.0302, "reward_accuracy_mean_max": 4.1043, "reward_sla_mean_mean": -0.02174444444444445, "reward_sla_mean_min": -0.043888888888888894, "reward_sla_mean_max": -0.0077777777777777776, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.4742666666667, "reward_accuracy_sum_min": 403.02, "reward_accuracy_sum_max": 410.43000000000006, "reward_sla_sum_mean": -2.1744444444444446, "reward_sla_sum_min": -4.388888888888889, "reward_sla_sum_max": -0.7777777777777778, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2136.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659, 871.3055555555551, 871.0666666666663, 872.3966666666659, 872.8977777777772, 873.5377777777771, 874.1166666666659, 872.4644444444438, 875.0022222222211, 874.0177777777767, 871.8755555555549, 873.0644444444445, 872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322, 874.7166666666653, 874.1366666666657, 873.7333333333326, 874.2077777777765, 874.557777777777, 874.81111111111, 875.2166666666657, 874.8122222222214, 874.272222222221, 874.8744444444433, 875.5733333333322, 874.3666666666657, 874.6844444444434, 874.9866666666658, 874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546, 873.3211111111103, 873.5444444444437, 872.8066666666662, 873.5122222222215, 872.1799999999996, 871.5066666666667, 873.8933333333324, 873.1011111111106, 874.4011111111103, 873.7977777777774, 873.987777777777, 872.9088888888882, 872.9411111111103, 873.3855555555548, 873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [867.6622222222219, 868.0088888888886, 869.594444444444, 869.6966666666663, 869.7199999999995, 870.6222222222217, 868.6544444444442, 867.353333333333, 868.3844444444443, 868.2411111111109, 869.6688888888883, 869.985555555555, 870.412222222222, 867.928888888889, 869.9566666666665, 871.9566666666659, 871.3055555555551, 871.0666666666663, 872.3966666666659, 872.8977777777772, 873.5377777777771, 874.1166666666659, 872.4644444444438, 875.0022222222211, 874.0177777777767, 871.8755555555549, 873.0644444444445, 872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322, 874.7166666666653, 874.1366666666657, 873.7333333333326, 874.2077777777765, 874.557777777777, 874.81111111111, 875.2166666666657, 874.8122222222214, 874.272222222221, 874.8744444444433, 875.5733333333322, 874.3666666666657, 874.6844444444434, 874.9866666666658, 874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546, 873.3211111111103, 873.5444444444437, 872.8066666666662, 873.5122222222215, 872.1799999999996, 871.5066666666667, 873.8933333333324, 873.1011111111106, 874.4011111111103, 873.7977777777774, 873.987777777777, 872.9088888888882, 872.9411111111103, 873.3855555555548, 873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19651097961989414, "mean_inference_ms": 1.7915865753982165, "mean_action_processing_ms": 0.07382780112287984, "mean_env_wait_ms": 1.2113465416779783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004746675491333008, "StateBufferConnector_ms": 0.0030450820922851562, "ViewRequirementAgentConnector_ms": 0.07291197776794434}, "num_episodes": 30, "episode_return_max": 875.5733333333322, "episode_return_min": 867.353333333333, "episode_return_mean": 872.9664888888883, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268500, "num_agent_steps_trained": 268200, "num_env_steps_sampled": 268500, "num_env_steps_trained": 268200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 269.5698452565785, "num_env_steps_trained_throughput_per_sec": 255.381958664127, "timesteps_total": 268500, "num_env_steps_sampled_lifetime": 268500, "num_agent_steps_sampled_lifetime": 268500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 268500, "timers": {"training_iteration_time_ms": 10319.831, "restore_workers_time_ms": 0.014, "training_step_time_ms": 547.804, "sample_time_ms": 532.943, "synch_weights_time_ms": 13.495}, "counters": {"num_env_steps_sampled": 268500, "num_env_steps_trained": 268200, "num_agent_steps_sampled": 268500, "num_agent_steps_trained": 268200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1790, "num_samples_added_to_queue": 268500}, "done": false, "training_iteration": 90, "trial_id": "38f59_00000", "date": "2024-10-10_22-26-57", "timestamp": 1728595617, "time_this_iter_s": 10.583090782165527, "time_total_s": 922.3013076782227, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2e860>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 922.3013076782227, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 14.180000000000001, "ram_util_percent": 68.32}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1545.7039794921875, "policy_loss": -406.95831298828125, "entropy": 4.8749284744262695, "entropy_coeff": 0.01, "var_gnorm": 17.818458557128906, "vf_loss": 196728.71875, "vf_explained_var": 0.639685332775116}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 904.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 271350, "num_env_steps_trained": 271200, "num_agent_steps_sampled": 271350, "num_agent_steps_trained": 271200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1809, "num_samples_added_to_queue": 271200, "learner_queue": {"size_count": 904, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.648, "learner_load_time_ms": 0.305, "learner_load_wait_time_ms": 1033.469, "learner_dequeue_time_ms": 8940.805}}, "env_runners": {"episode_reward_max": 876.0177777777765, "episode_reward_min": 870.7444444444437, "episode_reward_mean": 873.8916111111103, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 870.7444444444437}, "policy_reward_max": {"default_policy": 876.0177777777765}, "policy_reward_mean": {"default_policy": 873.8916111111103}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.09369999999999999, "num_moves_min": 0.0, "num_moves_max": 0.46, "mean_accuracy_mean": 40.94705, "mean_accuracy_min": 40.72633333333333, "mean_accuracy_max": 41.043, "num_model_switches_mean": 0.39220000000000005, "num_model_switches_min": 0.16, "num_model_switches_max": 0.91, "num_slav_mean": 0.0006736666666666668, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "mean_cluster_cpu_util_mean": 0.5116134608843538, "mean_cluster_cpu_util_min": 0.5074318463872035, "mean_cluster_cpu_util_max": 0.5142510227063799, "mean_cluster_mem_util_mean": 0.32975445147679316, "mean_cluster_mem_util_min": 0.32868934599156113, "mean_cluster_mem_util_max": 0.33032964135021103, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.094704999999999, "reward_accuracy_mean_min": 4.072633333333333, "reward_accuracy_mean_max": 4.1043, "reward_sla_mean_mean": -0.02245555555555556, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.4705, "reward_accuracy_sum_min": 407.2633333333333, "reward_accuracy_sum_max": 410.43000000000006, "reward_sla_sum_mean": -2.245555555555556, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2961.0, "global_timestep_min": 1000, "global_timestep_max": 4600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322, 874.7166666666653, 874.1366666666657, 873.7333333333326, 874.2077777777765, 874.557777777777, 874.81111111111, 875.2166666666657, 874.8122222222214, 874.272222222221, 874.8744444444433, 875.5733333333322, 874.3666666666657, 874.6844444444434, 874.9866666666658, 874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546, 873.3211111111103, 873.5444444444437, 872.8066666666662, 873.5122222222215, 872.1799999999996, 871.5066666666667, 873.8933333333324, 873.1011111111106, 874.4011111111103, 873.7977777777774, 873.987777777777, 872.9088888888882, 872.9411111111103, 873.3855555555548, 873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215, 872.9411111111104, 873.1311111111104, 874.3066666666656, 874.1777777777769, 874.4233333333323, 873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [872.2699999999993, 872.6655555555546, 870.7444444444437, 873.2188888888882, 874.5188888888881, 874.7899999999989, 874.4233333333322, 872.2633333333331, 872.5555555555547, 872.2711111111106, 873.4111111111105, 872.9355555555551, 872.1088888888883, 872.7822222222217, 873.1144444444436, 875.1133333333322, 874.7166666666653, 874.1366666666657, 873.7333333333326, 874.2077777777765, 874.557777777777, 874.81111111111, 875.2166666666657, 874.8122222222214, 874.272222222221, 874.8744444444433, 875.5733333333322, 874.3666666666657, 874.6844444444434, 874.9866666666658, 874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546, 873.3211111111103, 873.5444444444437, 872.8066666666662, 873.5122222222215, 872.1799999999996, 871.5066666666667, 873.8933333333324, 873.1011111111106, 874.4011111111103, 873.7977777777774, 873.987777777777, 872.9088888888882, 872.9411111111103, 873.3855555555548, 873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215, 872.9411111111104, 873.1311111111104, 874.3066666666656, 874.1777777777769, 874.4233333333323, 873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19675107908931738, "mean_inference_ms": 1.7933027727533493, "mean_action_processing_ms": 0.07390795240706112, "mean_env_wait_ms": 1.2122967787751011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004996061325073242, "StateBufferConnector_ms": 0.003072500228881836, "ViewRequirementAgentConnector_ms": 0.07367300987243652}, "num_episodes": 27, "episode_return_max": 876.0177777777765, "episode_return_min": 870.7444444444437, "episode_return_mean": 873.8916111111103, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271350, "num_agent_steps_trained": 271200, "num_env_steps_sampled": 271350, "num_env_steps_trained": 271200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 276.70067646929334, "num_env_steps_trained_throughput_per_sec": 291.2638699676772, "timesteps_total": 271350, "num_env_steps_sampled_lifetime": 271350, "num_agent_steps_sampled_lifetime": 271350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 271350, "timers": {"training_iteration_time_ms": 10297.303, "restore_workers_time_ms": 0.014, "training_step_time_ms": 512.57, "sample_time_ms": 497.355, "synch_weights_time_ms": 13.867}, "counters": {"num_env_steps_sampled": 271350, "num_env_steps_trained": 271200, "num_agent_steps_sampled": 271350, "num_agent_steps_trained": 271200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1809, "num_samples_added_to_queue": 271200}, "done": false, "training_iteration": 91, "trial_id": "38f59_00000", "date": "2024-10-10_22-27-08", "timestamp": 1728595628, "time_this_iter_s": 10.308412551879883, "time_total_s": 932.6097202301025, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb57e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 932.6097202301025, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 15.666666666666666, "ram_util_percent": 68.51333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": -46.306640625, "policy_loss": -2060.9755859375, "entropy": 4.676123142242432, "entropy_coeff": 0.01, "var_gnorm": 17.8398380279541, "vf_loss": 202869.734375, "vf_explained_var": 0.6355926990509033}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 913.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 274200, "num_env_steps_trained": 273900, "num_agent_steps_sampled": 274200, "num_agent_steps_trained": 273900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1828, "num_samples_added_to_queue": 274200, "learner_queue": {"size_count": 913, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.329, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 1018.437, "learner_dequeue_time_ms": 8766.635}}, "env_runners": {"episode_reward_max": 876.0477777777764, "episode_reward_min": 871.5066666666667, "episode_reward_mean": 874.1554444444434, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.5066666666667}, "policy_reward_max": {"default_policy": 876.0477777777764}, "policy_reward_mean": {"default_policy": 874.1554444444434}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.06659999999999999, "num_moves_min": 0.0, "num_moves_max": 0.18, "mean_accuracy_mean": 40.97143333333334, "mean_accuracy_min": 40.833999999999996, "mean_accuracy_max": 41.09366666666667, "num_model_switches_mean": 0.3318000000000001, "num_model_switches_min": 0.02, "num_model_switches_max": 0.62, "num_slav_mean": 0.0006676666666666666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "mean_cluster_cpu_util_mean": 0.5120773814120243, "mean_cluster_cpu_util_min": 0.5093238876631734, "mean_cluster_cpu_util_max": 0.5143083976833975, "mean_cluster_mem_util_mean": 0.3298695464135021, "mean_cluster_mem_util_min": 0.32923523206751054, "mean_cluster_mem_util_max": 0.3303876582278481, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.097143333333334, "reward_accuracy_mean_min": 4.0834, "reward_accuracy_mean_max": 4.109366666666667, "reward_sla_mean_mean": -0.022255555555555563, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.7143333333334, "reward_accuracy_sum_min": 408.34000000000003, "reward_accuracy_sum_max": 410.9366666666667, "reward_sla_sum_mean": -2.2255555555555553, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3963.0, "global_timestep_min": 1900, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546, 873.3211111111103, 873.5444444444437, 872.8066666666662, 873.5122222222215, 872.1799999999996, 871.5066666666667, 873.8933333333324, 873.1011111111106, 874.4011111111103, 873.7977777777774, 873.987777777777, 872.9088888888882, 872.9411111111103, 873.3855555555548, 873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215, 872.9411111111104, 873.1311111111104, 874.3066666666656, 874.1777777777769, 874.4233333333323, 873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765, 873.8288888888883, 873.1933333333327, 874.3366666666658, 875.1288888888878, 874.8433333333323, 874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.0111111111099, 874.7166666666656, 875.3833333333322, 874.0822222222215, 874.2722222222212, 874.5888888888879, 873.4777777777769, 874.9299999999987, 874.0411111111102, 873.628888888888, 874.7166666666657, 874.589999999999, 874.4155555555546, 873.3211111111103, 873.5444444444437, 872.8066666666662, 873.5122222222215, 872.1799999999996, 871.5066666666667, 873.8933333333324, 873.1011111111106, 874.4011111111103, 873.7977777777774, 873.987777777777, 872.9088888888882, 872.9411111111103, 873.3855555555548, 873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215, 872.9411111111104, 873.1311111111104, 874.3066666666656, 874.1777777777769, 874.4233333333323, 873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765, 873.8288888888883, 873.1933333333327, 874.3366666666658, 875.1288888888878, 874.8433333333323, 874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19695680929988874, "mean_inference_ms": 1.7958147371583204, "mean_action_processing_ms": 0.07398849527220822, "mean_env_wait_ms": 1.2132492880426289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005065441131591797, "StateBufferConnector_ms": 0.002991199493408203, "ViewRequirementAgentConnector_ms": 0.07134413719177246}, "num_episodes": 30, "episode_return_max": 876.0477777777764, "episode_return_min": 871.5066666666667, "episode_return_mean": 874.1554444444434, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274200, "num_agent_steps_trained": 273900, "num_env_steps_sampled": 274200, "num_env_steps_trained": 273900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 279.7977336970572, "num_env_steps_trained_throughput_per_sec": 265.07153718668576, "timesteps_total": 274200, "num_env_steps_sampled_lifetime": 274200, "num_agent_steps_sampled_lifetime": 274200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 274200, "timers": {"training_iteration_time_ms": 10294.265, "restore_workers_time_ms": 0.012, "training_step_time_ms": 519.557, "sample_time_ms": 505.167, "synch_weights_time_ms": 13.011}, "counters": {"num_env_steps_sampled": 274200, "num_env_steps_trained": 273900, "num_agent_steps_sampled": 274200, "num_agent_steps_trained": 273900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1828, "num_samples_added_to_queue": 274200}, "done": false, "training_iteration": 92, "trial_id": "38f59_00000", "date": "2024-10-10_22-27-18", "timestamp": 1728595638, "time_this_iter_s": 10.196760654449463, "time_total_s": 942.806480884552, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2eb30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 942.806480884552, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 12.72857142857143, "ram_util_percent": 68.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2535.26513671875, "policy_loss": 484.4869384765625, "entropy": 4.766242027282715, "entropy_coeff": 0.01, "var_gnorm": 17.862834930419922, "vf_loss": 206507.6875, "vf_explained_var": 0.6330826282501221}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 277050, "num_env_steps_trained": 276900, "num_agent_steps_sampled": 277050, "num_agent_steps_trained": 276900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1847, "num_samples_added_to_queue": 276900, "learner_queue": {"size_count": 923, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.547, "learner_load_time_ms": 0.319, "learner_load_wait_time_ms": 992.089, "learner_dequeue_time_ms": 8803.507}}, "env_runners": {"episode_reward_max": 876.0477777777764, "episode_reward_min": 871.8277777777769, "episode_reward_mean": 874.404888888888, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.8277777777769}, "policy_reward_max": {"default_policy": 876.0477777777764}, "policy_reward_mean": {"default_policy": 874.404888888888}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.09480000000000001, "num_moves_min": 0.0, "num_moves_max": 0.28, "mean_accuracy_mean": 40.99043333333333, "mean_accuracy_min": 40.84033333333333, "mean_accuracy_max": 41.09366666666667, "num_model_switches_mean": 0.28500000000000003, "num_model_switches_min": 0.02, "num_model_switches_max": 0.62, "num_slav_mean": 0.0006498333333333332, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "mean_cluster_cpu_util_mean": 0.5125300821612429, "mean_cluster_cpu_util_min": 0.5093749770178342, "mean_cluster_cpu_util_max": 0.5150464469571614, "mean_cluster_mem_util_mean": 0.32995239451476793, "mean_cluster_mem_util_min": 0.32923523206751054, "mean_cluster_mem_util_max": 0.33055959915611816, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.099043333333334, "reward_accuracy_mean_min": 4.084033333333334, "reward_accuracy_mean_max": 4.109366666666667, "reward_sla_mean_mean": -0.021661111111111117, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.9043333333334, "reward_accuracy_sum_min": 408.40333333333336, "reward_accuracy_sum_max": 410.9366666666667, "reward_sla_sum_mean": -2.1661111111111113, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4858.0, "global_timestep_min": 2800, "global_timestep_max": 6500}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215, 872.9411111111104, 873.1311111111104, 874.3066666666656, 874.1777777777769, 874.4233333333323, 873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765, 873.8288888888883, 873.1933333333327, 874.3366666666658, 875.1288888888878, 874.8433333333323, 874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322, 874.5255555555543, 874.5488888888879, 874.5255555555547, 874.5822222222212, 874.2077777777771, 874.9855555555544, 874.7077777777769, 873.796666666666, 874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.1966666666664, 873.7666666666662, 872.1811111111105, 873.4822222222216, 874.2755555555549, 875.3844444444436, 873.669999999999, 874.9399999999995, 874.367777777777, 873.385555555555, 873.4811111111104, 874.1477777777772, 873.2911111111104, 873.5144444444437, 873.8311111111103, 873.8622222222215, 872.9411111111104, 873.1311111111104, 874.3066666666656, 874.1777777777769, 874.4233333333323, 873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765, 873.8288888888883, 873.1933333333327, 874.3366666666658, 875.1288888888878, 874.8433333333323, 874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322, 874.5255555555543, 874.5488888888879, 874.5255555555547, 874.5822222222212, 874.2077777777771, 874.9855555555544, 874.7077777777769, 873.796666666666, 874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19703498280581358, "mean_inference_ms": 1.7954478395785063, "mean_action_processing_ms": 0.07401526450561499, "mean_env_wait_ms": 1.2134939699935372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004879951477050781, "StateBufferConnector_ms": 0.0029282569885253906, "ViewRequirementAgentConnector_ms": 0.06962776184082031}, "num_episodes": 27, "episode_return_max": 876.0477777777764, "episode_return_min": 871.8277777777769, "episode_return_mean": 874.404888888888, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277050, "num_agent_steps_trained": 276900, "num_env_steps_sampled": 277050, "num_env_steps_trained": 276900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.97497647194035, "num_env_steps_trained_throughput_per_sec": 299.97365944414776, "timesteps_total": 277050, "num_env_steps_sampled_lifetime": 277050, "num_agent_steps_sampled_lifetime": 277050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 277050, "timers": {"training_iteration_time_ms": 10284.299, "restore_workers_time_ms": 0.014, "training_step_time_ms": 525.0, "sample_time_ms": 510.42, "synch_weights_time_ms": 13.261}, "counters": {"num_env_steps_sampled": 277050, "num_env_steps_trained": 276900, "num_agent_steps_sampled": 277050, "num_agent_steps_trained": 276900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1847, "num_samples_added_to_queue": 276900}, "done": false, "training_iteration": 93, "trial_id": "38f59_00000", "date": "2024-10-10_22-27-28", "timestamp": 1728595648, "time_this_iter_s": 10.010664463043213, "time_total_s": 952.8171453475952, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcee30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 952.8171453475952, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 12.020000000000001, "ram_util_percent": 68.24666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2477.139404296875, "policy_loss": 426.3944091796875, "entropy": 4.811057090759277, "entropy_coeff": 0.01, "var_gnorm": 17.871347427368164, "vf_loss": 206517.828125, "vf_explained_var": 0.6339158415794373}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 929.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 279000, "num_env_steps_trained": 278700, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 278700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1860, "num_samples_added_to_queue": 279000, "learner_queue": {"size_count": 929, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.882, "learner_load_time_ms": 0.317, "learner_load_wait_time_ms": 1350.612, "learner_dequeue_time_ms": 9182.463}}, "env_runners": {"episode_reward_max": 876.0477777777764, "episode_reward_min": 871.8277777777769, "episode_reward_mean": 874.531799999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.8277777777769}, "policy_reward_max": {"default_policy": 876.0477777777764}, "policy_reward_mean": {"default_policy": 874.531799999999}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1507, "num_moves_min": 0.0, "num_moves_max": 0.42, "mean_accuracy_mean": 41.00284666666666, "mean_accuracy_min": 40.91, "mean_accuracy_max": 41.09366666666667, "num_model_switches_mean": 0.26030000000000003, "num_model_switches_min": 0.02, "num_model_switches_max": 0.47, "num_slav_mean": 0.000649, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0014666666666666667, "mean_cluster_cpu_util_mean": 0.5126701442130905, "mean_cluster_cpu_util_min": 0.5100109969663541, "mean_cluster_cpu_util_max": 0.5150464469571614, "mean_cluster_mem_util_mean": 0.32999240506329114, "mean_cluster_mem_util_min": 0.32949947257383966, "mean_cluster_mem_util_max": 0.33055959915611816, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.100284666666667, "reward_accuracy_mean_min": 4.091, "reward_accuracy_mean_max": 4.109366666666667, "reward_sla_mean_mean": -0.021633333333333334, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.0284666666667, "reward_accuracy_sum_min": 409.1, "reward_accuracy_sum_max": 410.9366666666667, "reward_sla_sum_mean": -2.1633333333333336, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5575.0, "global_timestep_min": 3800, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765, 873.8288888888883, 873.1933333333327, 874.3366666666658, 875.1288888888878, 874.8433333333323, 874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322, 874.5255555555543, 874.5488888888879, 874.5255555555547, 874.5822222222212, 874.2077777777771, 874.9855555555544, 874.7077777777769, 873.796666666666, 874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324, 873.3677777777771, 874.9944444444435, 873.367777777777, 874.8933333333324, 874.7566666666656, 875.058888888888, 873.9233333333327, 874.4877777777766, 874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.4799999999991, 874.9066666666657, 873.797777777777, 873.827777777777, 873.638888888888, 874.7811111111099, 873.2577777777766, 874.5833333333322, 873.0988888888884, 874.8044444444436, 874.5899999999988, 874.938888888888, 875.2244444444434, 874.178888888888, 874.4333333333326, 874.5577777777764, 873.1299999999992, 874.5899999999989, 875.0666666666656, 874.3922222222211, 871.8277777777769, 876.0177777777765, 873.8288888888883, 873.1933333333327, 874.3366666666658, 875.1288888888878, 874.8433333333323, 874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322, 874.5255555555543, 874.5488888888879, 874.5255555555547, 874.5822222222212, 874.2077777777771, 874.9855555555544, 874.7077777777769, 873.796666666666, 874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324, 873.3677777777771, 874.9944444444435, 873.367777777777, 874.8933333333324, 874.7566666666656, 875.058888888888, 873.9233333333327, 874.4877777777766, 874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19734728282260902, "mean_inference_ms": 1.800617864276636, "mean_action_processing_ms": 0.0741168152891543, "mean_env_wait_ms": 1.215208195630332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005242586135864258, "StateBufferConnector_ms": 0.0031914710998535156, "ViewRequirementAgentConnector_ms": 0.07731199264526367}, "num_episodes": 21, "episode_return_max": 876.0477777777764, "episode_return_min": 871.8277777777769, "episode_return_mean": 874.531799999999, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 278700, "num_env_steps_sampled": 279000, "num_env_steps_trained": 278700, "num_env_steps_sampled_this_iter": 1950, "num_env_steps_trained_this_iter": 1800, "num_env_steps_sampled_throughput_per_sec": 184.61690564512355, "num_env_steps_trained_throughput_per_sec": 170.41560521088329, "timesteps_total": 279000, "num_env_steps_sampled_lifetime": 279000, "num_agent_steps_sampled_lifetime": 279000, "num_steps_trained_this_iter": 1800, "agent_timesteps_total": 279000, "timers": {"training_iteration_time_ms": 10321.416, "restore_workers_time_ms": 0.016, "training_step_time_ms": 789.415, "sample_time_ms": 770.811, "synch_weights_time_ms": 16.639}, "counters": {"num_env_steps_sampled": 279000, "num_env_steps_trained": 278700, "num_agent_steps_sampled": 279000, "num_agent_steps_trained": 278700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1860, "num_samples_added_to_queue": 279000}, "done": false, "training_iteration": 94, "trial_id": "38f59_00000", "date": "2024-10-10_22-27-39", "timestamp": 1728595659, "time_this_iter_s": 10.571390628814697, "time_total_s": 963.3885359764099, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdcf1f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 963.3885359764099, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 34.266666666666666, "ram_util_percent": 70.75333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1090.619140625, "policy_loss": -821.5762939453125, "entropy": 4.83519172668457, "entropy_coeff": 0.01, "var_gnorm": 17.878772735595703, "vf_loss": 192670.109375, "vf_explained_var": 0.6648062467575073}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 939.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 281850, "num_env_steps_trained": 281700, "num_agent_steps_sampled": 281850, "num_agent_steps_trained": 281700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1879, "num_samples_added_to_queue": 281700, "learner_queue": {"size_count": 939, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.177, "learner_load_time_ms": 0.308, "learner_load_wait_time_ms": 1015.003, "learner_dequeue_time_ms": 9125.223}}, "env_runners": {"episode_reward_max": 876.0477777777764, "episode_reward_min": 872.5444444444441, "episode_reward_mean": 874.5147444444433, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 872.5444444444441}, "policy_reward_max": {"default_policy": 876.0477777777764}, "policy_reward_mean": {"default_policy": 874.5147444444433}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2302, "num_moves_min": 0.02, "num_moves_max": 0.51, "mean_accuracy_mean": 40.99936333333333, "mean_accuracy_min": 40.91, "mean_accuracy_max": 41.09366666666667, "num_model_switches_mean": 0.2663, "num_model_switches_min": 0.02, "num_model_switches_max": 0.49, "num_slav_mean": 0.0006436666666666668, "num_slav_min": 0.00030000000000000003, "num_slav_max": 0.0010666666666666667, "mean_cluster_cpu_util_mean": 0.5126112297756942, "mean_cluster_cpu_util_min": 0.5100109969663541, "mean_cluster_cpu_util_max": 0.5150464469571614, "mean_cluster_mem_util_mean": 0.32995777953586497, "mean_cluster_mem_util_min": 0.32949947257383966, "mean_cluster_mem_util_max": 0.33055959915611816, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.099936333333333, "reward_accuracy_mean_min": 4.091, "reward_accuracy_mean_max": 4.109366666666667, "reward_sla_mean_mean": -0.021455555555555558, "reward_sla_mean_min": -0.035555555555555556, "reward_sla_mean_max": -0.01, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.99363333333343, "reward_accuracy_sum_min": 409.1, "reward_accuracy_sum_max": 410.9366666666667, "reward_sla_sum_mean": -2.1455555555555557, "reward_sla_sum_min": -3.555555555555556, "reward_sla_sum_max": -1.0, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5773.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322, 874.5255555555543, 874.5488888888879, 874.5255555555547, 874.5822222222212, 874.2077777777771, 874.9855555555544, 874.7077777777769, 873.796666666666, 874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324, 873.3677777777771, 874.9944444444435, 873.367777777777, 874.8933333333324, 874.7566666666656, 875.058888888888, 873.9233333333327, 874.4877777777766, 874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213, 874.549999999999, 874.6544444444435, 873.5033333333324, 874.1299999999992, 874.4555555555548, 875.1299999999986, 873.1466666666659, 873.8377777777771, 874.312222222221, 874.6855555555546, 875.3366666666656, 874.3133333333323, 874.0666666666658, 873.0033333333325, 874.8533333333322, 873.5355555555545, 874.3911111111101, 874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.9066666666657, 875.8266666666656, 874.3899999999988, 873.7555555555546, 875.3511111111101, 873.1777777777768, 874.4633333333322, 874.0511111111101, 874.5899999999987, 874.5811111111099, 874.3977777777768, 874.2077777777766, 875.159999999999, 875.5244444444432, 875.763333333332, 875.0977777777766, 874.5822222222212, 874.0822222222213, 875.1288888888876, 875.1599999999987, 875.1844444444433, 874.1688888888879, 874.5566666666655, 876.0477777777764, 875.0333333333322, 874.5255555555543, 874.5488888888879, 874.5255555555547, 874.5822222222212, 874.2077777777771, 874.9855555555544, 874.7077777777769, 873.796666666666, 874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324, 873.3677777777771, 874.9944444444435, 873.367777777777, 874.8933333333324, 874.7566666666656, 875.058888888888, 873.9233333333327, 874.4877777777766, 874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213, 874.549999999999, 874.6544444444435, 873.5033333333324, 874.1299999999992, 874.4555555555548, 875.1299999999986, 873.1466666666659, 873.8377777777771, 874.312222222221, 874.6855555555546, 875.3366666666656, 874.3133333333323, 874.0666666666658, 873.0033333333325, 874.8533333333322, 873.5355555555545, 874.3911111111101, 874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19760932127304365, "mean_inference_ms": 1.8033283964542768, "mean_action_processing_ms": 0.07420702099026709, "mean_env_wait_ms": 1.2165233324565998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004972696304321289, "StateBufferConnector_ms": 0.003196239471435547, "ViewRequirementAgentConnector_ms": 0.07754230499267578}, "num_episodes": 27, "episode_return_max": 876.0477777777764, "episode_return_min": 872.5444444444441, "episode_return_mean": 874.5147444444433, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281850, "num_agent_steps_trained": 281700, "num_env_steps_sampled": 281850, "num_env_steps_trained": 281700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 281.26090263173256, "num_env_steps_trained_throughput_per_sec": 296.0641080334027, "timesteps_total": 281850, "num_env_steps_sampled_lifetime": 281850, "num_agent_steps_sampled_lifetime": 281850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 281850, "timers": {"training_iteration_time_ms": 10324.682, "restore_workers_time_ms": 0.013, "training_step_time_ms": 553.918, "sample_time_ms": 538.268, "synch_weights_time_ms": 14.117}, "counters": {"num_env_steps_sampled": 281850, "num_env_steps_trained": 281700, "num_agent_steps_sampled": 281850, "num_agent_steps_trained": 281700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1879, "num_samples_added_to_queue": 281700}, "done": false, "training_iteration": 95, "trial_id": "38f59_00000", "date": "2024-10-10_22-27-49", "timestamp": 1728595669, "time_this_iter_s": 10.142005443572998, "time_total_s": 973.5305414199829, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7940>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 973.5305414199829, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 13.492857142857144, "ram_util_percent": 71.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2312.167724609375, "policy_loss": 284.0384521484375, "entropy": 4.472639083862305, "entropy_coeff": 0.01, "var_gnorm": 17.86710548400879, "vf_loss": 204154.71875, "vf_explained_var": 0.6461492776870728}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 949.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 285000, "num_env_steps_trained": 284700, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 284700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1900, "num_samples_added_to_queue": 285000, "learner_queue": {"size_count": 949, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 48.892, "learner_load_time_ms": 0.305, "learner_load_wait_time_ms": 936.142, "learner_dequeue_time_ms": 9034.106}}, "env_runners": {"episode_reward_max": 876.8099999999986, "episode_reward_min": 872.5444444444441, "episode_reward_mean": 874.55761111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 872.5444444444441}, "policy_reward_max": {"default_policy": 876.8099999999986}, "policy_reward_mean": {"default_policy": 874.55761111111}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2495, "num_moves_min": 0.0, "num_moves_max": 0.51, "mean_accuracy_mean": 41.00215, "mean_accuracy_min": 40.91, "mean_accuracy_max": 41.09366666666667, "num_model_switches_mean": 0.2568, "num_model_switches_min": 0.02, "num_model_switches_max": 0.49, "num_slav_mean": 0.0006391666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5126796781347673, "mean_cluster_cpu_util_min": 0.5100109969663541, "mean_cluster_cpu_util_max": 0.5170668551204265, "mean_cluster_mem_util_mean": 0.32995999472573834, "mean_cluster_mem_util_min": 0.32949947257383966, "mean_cluster_mem_util_max": 0.3306228902953587, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.100215, "reward_accuracy_mean_min": 4.091, "reward_accuracy_mean_max": 4.109366666666667, "reward_sla_mean_mean": -0.021305555555555557, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.0215000000002, "reward_accuracy_sum_min": 409.1, "reward_accuracy_sum_max": 410.9366666666667, "reward_sla_sum_mean": -2.1305555555555555, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4286.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324, 873.3677777777771, 874.9944444444435, 873.367777777777, 874.8933333333324, 874.7566666666656, 875.058888888888, 873.9233333333327, 874.4877777777766, 874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213, 874.549999999999, 874.6544444444435, 873.5033333333324, 874.1299999999992, 874.4555555555548, 875.1299999999986, 873.1466666666659, 873.8377777777771, 874.312222222221, 874.6855555555546, 875.3366666666656, 874.3133333333323, 874.0666666666658, 873.0033333333325, 874.8533333333322, 873.5355555555545, 874.3911111111101, 874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326, 874.4622222222214, 874.5833333333323, 874.9622222222208, 874.7955555555544, 873.4066666666655, 875.3033333333321, 874.3255555555546, 875.723333333332, 875.6911111111098, 874.8733333333322, 876.0477777777763, 873.2577777777769, 875.3677777777765, 874.0499999999994, 874.9388888888878, 874.6688888888877, 875.0644444444434, 874.7633333333321, 874.6522222222212, 876.8099999999986, 875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.3599999999991, 874.9377777777764, 874.6844444444433, 874.9299999999989, 875.1522222222211, 875.413333333332, 875.6522222222209, 874.4933333333322, 875.1766666666655, 874.6377777777767, 874.572222222221, 874.9055555555545, 875.7477777777766, 873.4777777777767, 875.0011111111099, 875.1288888888878, 874.5666666666658, 874.1055555555546, 874.2633333333324, 873.3677777777771, 874.9944444444435, 873.367777777777, 874.8933333333324, 874.7566666666656, 875.058888888888, 873.9233333333327, 874.4877777777766, 874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213, 874.549999999999, 874.6544444444435, 873.5033333333324, 874.1299999999992, 874.4555555555548, 875.1299999999986, 873.1466666666659, 873.8377777777771, 874.312222222221, 874.6855555555546, 875.3366666666656, 874.3133333333323, 874.0666666666658, 873.0033333333325, 874.8533333333322, 873.5355555555545, 874.3911111111101, 874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326, 874.4622222222214, 874.5833333333323, 874.9622222222208, 874.7955555555544, 873.4066666666655, 875.3033333333321, 874.3255555555546, 875.723333333332, 875.6911111111098, 874.8733333333322, 876.0477777777763, 873.2577777777769, 875.3677777777765, 874.0499999999994, 874.9388888888878, 874.6688888888877, 875.0644444444434, 874.7633333333321, 874.6522222222212, 876.8099999999986, 875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1977893939767482, "mean_inference_ms": 1.803229612571801, "mean_action_processing_ms": 0.07427111835369174, "mean_env_wait_ms": 1.2173255864767227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004720211029052734, "StateBufferConnector_ms": 0.003162384033203125, "ViewRequirementAgentConnector_ms": 0.07679486274719238}, "num_episodes": 33, "episode_return_max": 876.8099999999986, "episode_return_min": 872.5444444444441, "episode_return_mean": 874.55761111111, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 284700, "num_env_steps_sampled": 285000, "num_env_steps_trained": 284700, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 304.2432140783581, "num_env_steps_trained_throughput_per_sec": 289.7554419793887, "timesteps_total": 285000, "num_env_steps_sampled_lifetime": 285000, "num_agent_steps_sampled_lifetime": 285000, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 285000, "timers": {"training_iteration_time_ms": 10327.147, "restore_workers_time_ms": 0.012, "training_step_time_ms": 506.802, "sample_time_ms": 491.986, "synch_weights_time_ms": 13.447}, "counters": {"num_env_steps_sampled": 285000, "num_env_steps_trained": 284700, "num_agent_steps_sampled": 285000, "num_agent_steps_trained": 284700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1900, "num_samples_added_to_queue": 285000}, "done": false, "training_iteration": 96, "trial_id": "38f59_00000", "date": "2024-10-10_22-27-59", "timestamp": 1728595679, "time_this_iter_s": 10.36511778831482, "time_total_s": 983.8956592082977, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1a110>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 983.8956592082977, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 11.16, "ram_util_percent": 70.65333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1963.67431640625, "policy_loss": -54.06382751464844, "entropy": 4.481084823608398, "entropy_coeff": 0.01, "var_gnorm": 17.839929580688477, "vf_loss": 203118.140625, "vf_explained_var": 0.6375260353088379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 287850, "num_env_steps_trained": 287700, "num_agent_steps_sampled": 287850, "num_agent_steps_trained": 287700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1919, "num_samples_added_to_queue": 287700, "learner_queue": {"size_count": 959, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.583, "learner_load_time_ms": 0.307, "learner_load_wait_time_ms": 998.663, "learner_dequeue_time_ms": 9026.017}}, "env_runners": {"episode_reward_max": 876.8099999999986, "episode_reward_min": 872.5444444444441, "episode_reward_mean": 874.7427555555545, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 872.5444444444441}, "policy_reward_max": {"default_policy": 876.8099999999986}, "policy_reward_mean": {"default_policy": 874.7427555555545}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1989, "num_moves_min": 0.0, "num_moves_max": 0.51, "mean_accuracy_mean": 41.02172, "mean_accuracy_min": 40.91, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.20600000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.49, "num_slav_mean": 0.0006423333333333335, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.512980387479316, "mean_cluster_cpu_util_min": 0.5105499517374518, "mean_cluster_cpu_util_max": 0.5170668551204265, "mean_cluster_mem_util_mean": 0.3300489715189873, "mean_cluster_mem_util_min": 0.3295163502109704, "mean_cluster_mem_util_max": 0.3306228902953587, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.102172, "reward_accuracy_mean_min": 4.091, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021411111111111113, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.2172000000001, "reward_accuracy_sum_min": 409.1, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.141111111111111, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3087.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213, 874.549999999999, 874.6544444444435, 873.5033333333324, 874.1299999999992, 874.4555555555548, 875.1299999999986, 873.1466666666659, 873.8377777777771, 874.312222222221, 874.6855555555546, 875.3366666666656, 874.3133333333323, 874.0666666666658, 873.0033333333325, 874.8533333333322, 873.5355555555545, 874.3911111111101, 874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326, 874.4622222222214, 874.5833333333323, 874.9622222222208, 874.7955555555544, 873.4066666666655, 875.3033333333321, 874.3255555555546, 875.723333333332, 875.6911111111098, 874.8733333333322, 876.0477777777763, 873.2577777777769, 875.3677777777765, 874.0499999999994, 874.9388888888878, 874.6688888888877, 875.0644444444434, 874.7633333333321, 874.6522222222212, 876.8099999999986, 875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763, 874.4288888888877, 875.6033333333322, 873.9844444444434, 876.143333333332, 875.3177777777763, 874.6511111111097, 873.8255555555545, 875.9211111111097, 875.9766666666652, 875.6988888888877, 876.0477777777764, 876.1111111111097, 875.0955555555543, 875.762222222221, 875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.4866666666659, 874.4644444444435, 873.5666666666658, 875.042222222221, 874.8288888888882, 874.4633333333326, 872.5444444444441, 874.9088888888881, 875.2255555555546, 874.558888888888, 874.217777777777, 875.0188888888879, 874.2722222222213, 874.549999999999, 874.6544444444435, 873.5033333333324, 874.1299999999992, 874.4555555555548, 875.1299999999986, 873.1466666666659, 873.8377777777771, 874.312222222221, 874.6855555555546, 875.3366666666656, 874.3133333333323, 874.0666666666658, 873.0033333333325, 874.8533333333322, 873.5355555555545, 874.3911111111101, 874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326, 874.4622222222214, 874.5833333333323, 874.9622222222208, 874.7955555555544, 873.4066666666655, 875.3033333333321, 874.3255555555546, 875.723333333332, 875.6911111111098, 874.8733333333322, 876.0477777777763, 873.2577777777769, 875.3677777777765, 874.0499999999994, 874.9388888888878, 874.6688888888877, 875.0644444444434, 874.7633333333321, 874.6522222222212, 876.8099999999986, 875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763, 874.4288888888877, 875.6033333333322, 873.9844444444434, 876.143333333332, 875.3177777777763, 874.6511111111097, 873.8255555555545, 875.9211111111097, 875.9766666666652, 875.6988888888877, 876.0477777777764, 876.1111111111097, 875.0955555555543, 875.762222222221, 875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1979807187260448, "mean_inference_ms": 1.8060353208018547, "mean_action_processing_ms": 0.07433612283637248, "mean_env_wait_ms": 1.2183068543640336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004489898681640625, "StateBufferConnector_ms": 0.003031492233276367, "ViewRequirementAgentConnector_ms": 0.07340431213378906}, "num_episodes": 27, "episode_return_max": 876.8099999999986, "episode_return_min": 872.5444444444441, "episode_return_mean": 874.7427555555545, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287850, "num_agent_steps_trained": 287700, "num_env_steps_sampled": 287850, "num_env_steps_trained": 287700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.9286846797045, "num_env_steps_trained_throughput_per_sec": 299.9249312417942, "timesteps_total": 287850, "num_env_steps_sampled_lifetime": 287850, "num_agent_steps_sampled_lifetime": 287850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 287850, "timers": {"training_iteration_time_ms": 10294.536, "restore_workers_time_ms": 0.013, "training_step_time_ms": 515.911, "sample_time_ms": 501.66, "synch_weights_time_ms": 12.945}, "counters": {"num_env_steps_sampled": 287850, "num_env_steps_trained": 287700, "num_agent_steps_sampled": 287850, "num_agent_steps_trained": 287700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1919, "num_samples_added_to_queue": 287700}, "done": false, "training_iteration": 97, "trial_id": "38f59_00000", "date": "2024-10-10_22-28-09", "timestamp": 1728595689, "time_this_iter_s": 10.011645078659058, "time_total_s": 993.9073042869568, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 993.9073042869568, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 12.792857142857144, "ram_util_percent": 70.56428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2210.27001953125, "policy_loss": 396.5633239746094, "entropy": 4.7311882972717285, "entropy_coeff": 0.01, "var_gnorm": 17.851350784301758, "vf_loss": 182790.03125, "vf_explained_var": 0.6484383344650269}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 969.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 290850, "num_env_steps_trained": 290700, "num_agent_steps_sampled": 290850, "num_agent_steps_trained": 290700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1939, "num_samples_added_to_queue": 290700, "learner_queue": {"size_count": 969, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.344, "learner_load_time_ms": 0.289, "learner_load_wait_time_ms": 960.929, "learner_dequeue_time_ms": 8808.947}}, "env_runners": {"episode_reward_max": 876.9055555555542, "episode_reward_min": 873.169999999999, "episode_reward_mean": 875.0457999999987, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 873.169999999999}, "policy_reward_max": {"default_policy": 876.9055555555542}, "policy_reward_mean": {"default_policy": 875.0457999999987}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.10710000000000003, "num_moves_min": 0.0, "num_moves_max": 0.51, "mean_accuracy_mean": 41.05224666666667, "mean_accuracy_min": 40.929, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.1341, "num_model_switches_min": 0.0, "num_model_switches_max": 0.47, "num_slav_mean": 0.0006429999999999999, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5136138313568671, "mean_cluster_cpu_util_min": 0.5108553847214561, "mean_cluster_cpu_util_max": 0.5170668551204265, "mean_cluster_mem_util_mean": 0.3302074525316456, "mean_cluster_mem_util_min": 0.32953481012658226, "mean_cluster_mem_util_max": 0.3306635021097047, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.105224666666667, "reward_accuracy_mean_min": 4.0929, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021433333333333332, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.52246666666673, "reward_accuracy_sum_min": 409.29, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.1433333333333335, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2127.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326, 874.4622222222214, 874.5833333333323, 874.9622222222208, 874.7955555555544, 873.4066666666655, 875.3033333333321, 874.3255555555546, 875.723333333332, 875.6911111111098, 874.8733333333322, 876.0477777777763, 873.2577777777769, 875.3677777777765, 874.0499999999994, 874.9388888888878, 874.6688888888877, 875.0644444444434, 874.7633333333321, 874.6522222222212, 876.8099999999986, 875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763, 874.4288888888877, 875.6033333333322, 873.9844444444434, 876.143333333332, 875.3177777777763, 874.6511111111097, 873.8255555555545, 875.9211111111097, 875.9766666666652, 875.6988888888877, 876.0477777777764, 876.1111111111097, 875.0955555555543, 875.762222222221, 875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655, 875.603333333332, 875.5955555555543, 874.3655555555545, 874.1433333333323, 876.5244444444431, 876.9055555555542, 875.984444444443, 874.9055555555544, 875.3511111111102, 875.382222222221, 875.6988888888876, 874.3655555555542, 876.333333333332, 874.7699999999988, 875.1911111111099, 875.6355555555542, 875.5411111111099, 874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.7177777777769, 873.169999999999, 874.5911111111102, 874.4566666666659, 874.4877777777767, 873.589999999999, 874.7099999999992, 873.3455555555549, 873.8122222222214, 873.9633333333326, 874.4622222222214, 874.5833333333323, 874.9622222222208, 874.7955555555544, 873.4066666666655, 875.3033333333321, 874.3255555555546, 875.723333333332, 875.6911111111098, 874.8733333333322, 876.0477777777763, 873.2577777777769, 875.3677777777765, 874.0499999999994, 874.9388888888878, 874.6688888888877, 875.0644444444434, 874.7633333333321, 874.6522222222212, 876.8099999999986, 875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763, 874.4288888888877, 875.6033333333322, 873.9844444444434, 876.143333333332, 875.3177777777763, 874.6511111111097, 873.8255555555545, 875.9211111111097, 875.9766666666652, 875.6988888888877, 876.0477777777764, 876.1111111111097, 875.0955555555543, 875.762222222221, 875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655, 875.603333333332, 875.5955555555543, 874.3655555555545, 874.1433333333323, 876.5244444444431, 876.9055555555542, 875.984444444443, 874.9055555555544, 875.3511111111102, 875.382222222221, 875.6988888888876, 874.3655555555542, 876.333333333332, 874.7699999999988, 875.1911111111099, 875.6355555555542, 875.5411111111099, 874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.197956043508814, "mean_inference_ms": 1.8066627969989801, "mean_action_processing_ms": 0.0743439257900597, "mean_env_wait_ms": 1.2182636966406823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039825439453125, "StateBufferConnector_ms": 0.0027692317962646484, "ViewRequirementAgentConnector_ms": 0.06497788429260254}, "num_episodes": 30, "episode_return_max": 876.9055555555542, "episode_return_min": 873.169999999999, "episode_return_mean": 875.0457999999987, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290850, "num_agent_steps_trained": 290700, "num_env_steps_sampled": 290850, "num_env_steps_trained": 290700, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.7414744493767, "num_env_steps_trained_throughput_per_sec": 297.7414744493767, "timesteps_total": 290850, "num_env_steps_sampled_lifetime": 290850, "num_agent_steps_sampled_lifetime": 290850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 290850, "timers": {"training_iteration_time_ms": 10260.104, "restore_workers_time_ms": 0.012, "training_step_time_ms": 489.67, "sample_time_ms": 475.754, "synch_weights_time_ms": 12.571}, "counters": {"num_env_steps_sampled": 290850, "num_env_steps_trained": 290700, "num_agent_steps_sampled": 290850, "num_agent_steps_trained": 290700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1939, "num_samples_added_to_queue": 290700}, "done": false, "training_iteration": 98, "trial_id": "38f59_00000", "date": "2024-10-10_22-28-19", "timestamp": 1728595699, "time_this_iter_s": 10.095030307769775, "time_total_s": 1004.0023345947266, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7c10>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1004.0023345947266, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 11.840000000000002, "ram_util_percent": 70.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1171.638916015625, "policy_loss": -495.1593933105469, "entropy": 4.936075687408447, "entropy_coeff": 0.01, "var_gnorm": 17.850292205810547, "vf_loss": 168160.65625, "vf_explained_var": 0.6568170785903931}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 978.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 293700, "num_env_steps_trained": 293400, "num_agent_steps_sampled": 293700, "num_agent_steps_trained": 293400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1958, "num_samples_added_to_queue": 293700, "learner_queue": {"size_count": 978, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.88, "learner_load_time_ms": 0.273, "learner_load_wait_time_ms": 1021.544, "learner_dequeue_time_ms": 8785.001}}, "env_runners": {"episode_reward_max": 876.9055555555542, "episode_reward_min": 869.9644444444446, "episode_reward_mean": 874.4217333333323, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 869.9644444444446}, "policy_reward_max": {"default_policy": 876.9055555555542}, "policy_reward_mean": {"default_policy": 874.4217333333323}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.04570000000000001, "num_moves_min": 0.0, "num_moves_max": 0.4, "mean_accuracy_mean": 40.99284000000001, "mean_accuracy_min": 40.55533333333332, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.18059999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006519999999999999, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.512592265926641, "mean_cluster_cpu_util_min": 0.5055779095421953, "mean_cluster_cpu_util_max": 0.5162904371207943, "mean_cluster_mem_util_mean": 0.32996358649789037, "mean_cluster_mem_util_min": 0.3280748945147679, "mean_cluster_mem_util_max": 0.3306635021097047, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.099284000000001, "reward_accuracy_mean_min": 4.055533333333334, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021733333333333337, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.9284000000001, "reward_accuracy_sum_min": 405.5533333333334, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.1733333333333333, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2649.0, "global_timestep_min": 400, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763, 874.4288888888877, 875.6033333333322, 873.9844444444434, 876.143333333332, 875.3177777777763, 874.6511111111097, 873.8255555555545, 875.9211111111097, 875.9766666666652, 875.6988888888877, 876.0477777777764, 876.1111111111097, 875.0955555555543, 875.762222222221, 875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655, 875.603333333332, 875.5955555555543, 874.3655555555545, 874.1433333333323, 876.5244444444431, 876.9055555555542, 875.984444444443, 874.9055555555544, 875.3511111111102, 875.382222222221, 875.6988888888876, 874.3655555555542, 876.333333333332, 874.7699999999988, 875.1911111111099, 875.6355555555542, 875.5411111111099, 874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659, 874.9066666666655, 874.398888888888, 873.0044444444435, 872.3066666666659, 873.3866666666664, 870.7544444444446, 871.9299999999997, 871.7088888888889, 871.1388888888889, 870.5688888888894, 873.6055555555547, 874.5266666666661, 873.829999999999, 872.306666666666, 872.8155555555552, 872.1500000000001, 871.9933333333333, 871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.3811111111099, 874.4288888888876, 873.7811111111104, 874.0833333333323, 874.89111111111, 875.4466666666655, 874.9866666666657, 874.6688888888879, 875.9855555555542, 874.0088888888881, 874.7466666666655, 873.3811111111102, 875.8177777777763, 874.4288888888877, 875.6033333333322, 873.9844444444434, 876.143333333332, 875.3177777777763, 874.6511111111097, 873.8255555555545, 875.9211111111097, 875.9766666666652, 875.6988888888877, 876.0477777777764, 876.1111111111097, 875.0955555555543, 875.762222222221, 875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655, 875.603333333332, 875.5955555555543, 874.3655555555545, 874.1433333333323, 876.5244444444431, 876.9055555555542, 875.984444444443, 874.9055555555544, 875.3511111111102, 875.382222222221, 875.6988888888876, 874.3655555555542, 876.333333333332, 874.7699999999988, 875.1911111111099, 875.6355555555542, 875.5411111111099, 874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659, 874.9066666666655, 874.398888888888, 873.0044444444435, 872.3066666666659, 873.3866666666664, 870.7544444444446, 871.9299999999997, 871.7088888888889, 871.1388888888889, 870.5688888888894, 873.6055555555547, 874.5266666666661, 873.829999999999, 872.306666666666, 872.8155555555552, 872.1500000000001, 871.9933333333333, 871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1979349454254948, "mean_inference_ms": 1.8052793175659883, "mean_action_processing_ms": 0.07433684368374704, "mean_env_wait_ms": 1.2179887910807423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004117488861083984, "StateBufferConnector_ms": 0.0028238296508789062, "ViewRequirementAgentConnector_ms": 0.06664657592773438}, "num_episodes": 30, "episode_return_max": 876.9055555555542, "episode_return_min": 869.9644444444446, "episode_return_mean": 874.4217333333323, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293700, "num_agent_steps_trained": 293400, "num_env_steps_sampled": 293700, "num_env_steps_trained": 293400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 277.9052306045896, "num_env_steps_trained_throughput_per_sec": 263.2786395201375, "timesteps_total": 293700, "num_env_steps_sampled_lifetime": 293700, "num_agent_steps_sampled_lifetime": 293700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 293700, "timers": {"training_iteration_time_ms": 10244.179, "restore_workers_time_ms": 0.011, "training_step_time_ms": 532.264, "sample_time_ms": 517.263, "synch_weights_time_ms": 13.522}, "counters": {"num_env_steps_sampled": 293700, "num_env_steps_trained": 293400, "num_agent_steps_sampled": 293700, "num_agent_steps_trained": 293400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1958, "num_samples_added_to_queue": 293700}, "done": false, "training_iteration": 99, "trial_id": "38f59_00000", "date": "2024-10-10_22-28-30", "timestamp": 1728595710, "time_this_iter_s": 10.27097463607788, "time_total_s": 1014.2733092308044, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb79a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1014.2733092308044, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 13.346666666666668, "ram_util_percent": 70.95333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3023.866455078125, "policy_loss": 1092.491943359375, "entropy": 4.755506992340088, "entropy_coeff": 0.01, "var_gnorm": 17.84763526916504, "vf_loss": 194564.109375, "vf_explained_var": 0.639311671257019}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 988.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 296550, "num_env_steps_trained": 296400, "num_agent_steps_sampled": 296550, "num_agent_steps_trained": 296400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1977, "num_samples_added_to_queue": 296400, "learner_queue": {"size_count": 988, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.364, "learner_load_time_ms": 0.249, "learner_load_wait_time_ms": 1046.298, "learner_dequeue_time_ms": 8777.453}}, "env_runners": {"episode_reward_max": 876.9055555555542, "episode_reward_min": 868.95, "episode_reward_mean": 873.0742333333328, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.95}, "policy_reward_max": {"default_policy": 876.9055555555542}, "policy_reward_mean": {"default_policy": 873.0742333333328}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.03560000000000001, "num_moves_min": 0.0, "num_moves_max": 0.12, "mean_accuracy_mean": 40.85825666666667, "mean_accuracy_min": 40.510999999999996, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.2279, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006525, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0010666666666666665, "mean_cluster_cpu_util_mean": 0.5103665902509653, "mean_cluster_cpu_util_min": 0.5033726902923332, "mean_cluster_cpu_util_max": 0.5162904371207943, "mean_cluster_mem_util_mean": 0.32939337025316445, "mean_cluster_mem_util_min": 0.32782700421940925, "mean_cluster_mem_util_max": 0.3306635021097047, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.085825666666668, "reward_accuracy_mean_min": 4.0511, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021750000000000002, "reward_sla_mean_min": -0.035555555555555556, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.58256666666676, "reward_accuracy_sum_min": 405.11, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.1750000000000003, "reward_sla_sum_min": -3.555555555555556, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3563.0, "global_timestep_min": 1500, "global_timestep_max": 5200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655, 875.603333333332, 875.5955555555543, 874.3655555555545, 874.1433333333323, 876.5244444444431, 876.9055555555542, 875.984444444443, 874.9055555555544, 875.3511111111102, 875.382222222221, 875.6988888888876, 874.3655555555542, 876.333333333332, 874.7699999999988, 875.1911111111099, 875.6355555555542, 875.5411111111099, 874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659, 874.9066666666655, 874.398888888888, 873.0044444444435, 872.3066666666659, 873.3866666666664, 870.7544444444446, 871.9299999999997, 871.7088888888889, 871.1388888888889, 870.5688888888894, 873.6055555555547, 874.5266666666661, 873.829999999999, 872.306666666666, 872.8155555555552, 872.1500000000001, 871.9933333333333, 871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445, 870.6955555555555, 869.678888888889, 869.8711111111113, 869.266666666667, 870.505555555556, 870.7911111111113, 868.95, 869.9977777777782, 870.5055555555563, 870.6322222222228, 869.6488888888891, 870.1566666666668, 870.9500000000002, 869.3622222222227, 869.806666666667, 869.7755555555559, 870.9177777777778, 869.9988888888894, 869.5844444444447, 869.8700000000003, 870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.6988888888876, 875.032222222221, 875.4766666666654, 876.5555555555542, 875.2544444444433, 876.0399999999987, 874.9288888888876, 874.5555555555544, 874.6511111111101, 875.8888888888874, 874.6511111111099, 875.6033333333321, 875.6666666666655, 875.603333333332, 875.5955555555543, 874.3655555555545, 874.1433333333323, 876.5244444444431, 876.9055555555542, 875.984444444443, 874.9055555555544, 875.3511111111102, 875.382222222221, 875.6988888888876, 874.3655555555542, 876.333333333332, 874.7699999999988, 875.1911111111099, 875.6355555555542, 875.5411111111099, 874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659, 874.9066666666655, 874.398888888888, 873.0044444444435, 872.3066666666659, 873.3866666666664, 870.7544444444446, 871.9299999999997, 871.7088888888889, 871.1388888888889, 870.5688888888894, 873.6055555555547, 874.5266666666661, 873.829999999999, 872.306666666666, 872.8155555555552, 872.1500000000001, 871.9933333333333, 871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445, 870.6955555555555, 869.678888888889, 869.8711111111113, 869.266666666667, 870.505555555556, 870.7911111111113, 868.95, 869.9977777777782, 870.5055555555563, 870.6322222222228, 869.6488888888891, 870.1566666666668, 870.9500000000002, 869.3622222222227, 869.806666666667, 869.7755555555559, 870.9177777777778, 869.9988888888894, 869.5844444444447, 869.8700000000003, 870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19802308553631376, "mean_inference_ms": 1.8059565660385908, "mean_action_processing_ms": 0.07435494146726082, "mean_env_wait_ms": 1.2182563304124037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318714141845703, "StateBufferConnector_ms": 0.002882719039916992, "ViewRequirementAgentConnector_ms": 0.06907248497009277}, "num_episodes": 27, "episode_return_max": 876.9055555555542, "episode_return_min": 868.95, "episode_return_mean": 873.0742333333328, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296550, "num_agent_steps_trained": 296400, "num_env_steps_sampled": 296550, "num_env_steps_trained": 296400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 272.9382405455328, "num_env_steps_trained_throughput_per_sec": 287.3034111005608, "timesteps_total": 296550, "num_env_steps_sampled_lifetime": 296550, "num_agent_steps_sampled_lifetime": 296550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 296550, "timers": {"training_iteration_time_ms": 10231.132, "restore_workers_time_ms": 0.012, "training_step_time_ms": 561.884, "sample_time_ms": 546.432, "synch_weights_time_ms": 13.829}, "counters": {"num_env_steps_sampled": 296550, "num_env_steps_trained": 296400, "num_agent_steps_sampled": 296550, "num_agent_steps_trained": 296400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1977, "num_samples_added_to_queue": 296400}, "done": false, "training_iteration": 100, "trial_id": "38f59_00000", "date": "2024-10-10_22-28-40", "timestamp": 1728595720, "time_this_iter_s": 10.457526683807373, "time_total_s": 1024.7308359146118, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6170>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1024.7308359146118, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 15.007142857142858, "ram_util_percent": 70.93571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2293.97119140625, "policy_loss": 381.18060302734375, "entropy": 5.0988640785217285, "entropy_coeff": 0.01, "var_gnorm": 17.854238510131836, "vf_loss": 192808.734375, "vf_explained_var": 0.6406465768814087}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 998.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 299550, "num_env_steps_trained": 299400, "num_agent_steps_sampled": 299550, "num_agent_steps_trained": 299400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1997, "num_samples_added_to_queue": 299400, "learner_queue": {"size_count": 998, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 56.376, "learner_load_time_ms": 0.225, "learner_load_wait_time_ms": 988.371, "learner_dequeue_time_ms": 8810.491}}, "env_runners": {"episode_reward_max": 875.6666666666653, "episode_reward_min": 868.0622222222225, "episode_reward_mean": 871.3810444444445, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.0622222222225}, "policy_reward_max": {"default_policy": 875.6666666666653}, "policy_reward_mean": {"default_policy": 871.3810444444445}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0683, "num_moves_min": 0.0, "num_moves_max": 0.24, "mean_accuracy_mean": 40.70049333333333, "mean_accuracy_min": 40.48566666666666, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.2852, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006825, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5077861892121713, "mean_cluster_cpu_util_min": 0.5033726902923332, "mean_cluster_cpu_util_max": 0.5152358889501748, "mean_cluster_mem_util_mean": 0.3287067194092826, "mean_cluster_mem_util_min": 0.32738185654008434, "mean_cluster_mem_util_max": 0.33056540084388186, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.070049333333333, "reward_accuracy_mean_min": 4.048566666666667, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.022750000000000003, "reward_sla_mean_min": -0.03777777777777778, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 407.00493333333344, "reward_accuracy_sum_min": 404.8566666666667, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.2750000000000004, "reward_sla_sum_min": -3.777777777777778, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4557.0, "global_timestep_min": 2400, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659, 874.9066666666655, 874.398888888888, 873.0044444444435, 872.3066666666659, 873.3866666666664, 870.7544444444446, 871.9299999999997, 871.7088888888889, 871.1388888888889, 870.5688888888894, 873.6055555555547, 874.5266666666661, 873.829999999999, 872.306666666666, 872.8155555555552, 872.1500000000001, 871.9933333333333, 871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445, 870.6955555555555, 869.678888888889, 869.8711111111113, 869.266666666667, 870.505555555556, 870.7911111111113, 868.95, 869.9977777777782, 870.5055555555563, 870.6322222222228, 869.6488888888891, 870.1566666666668, 870.9500000000002, 869.3622222222227, 869.806666666667, 869.7755555555559, 870.9177777777778, 869.9988888888894, 869.5844444444447, 869.8700000000003, 870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338, 870.8233333333336, 869.3011111111115, 870.0933333333336, 869.4588888888892, 869.7755555555561, 870.378888888889, 869.8711111111116, 868.9177777777779, 870.0922222222226, 871.2344444444449, 868.3166666666673, 868.0622222222225, 869.9344444444447, 870.0300000000004, 869.8077777777781, 871.1411111111115, 869.2677777777781, 869.6477777777777, 869.7111111111113, 870.5677777777778, 869.5222222222225, 870.0622222222228, 869.3311111111116, 869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.81111111111, 874.9377777777765, 875.0011111111099, 875.3733333333319, 875.413333333332, 875.6666666666653, 875.4766666666656, 875.4455555555545, 875.3811111111098, 875.5088888888874, 875.0644444444434, 874.7155555555547, 874.7166666666659, 874.9066666666655, 874.398888888888, 873.0044444444435, 872.3066666666659, 873.3866666666664, 870.7544444444446, 871.9299999999997, 871.7088888888889, 871.1388888888889, 870.5688888888894, 873.6055555555547, 874.5266666666661, 873.829999999999, 872.306666666666, 872.8155555555552, 872.1500000000001, 871.9933333333333, 871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445, 870.6955555555555, 869.678888888889, 869.8711111111113, 869.266666666667, 870.505555555556, 870.7911111111113, 868.95, 869.9977777777782, 870.5055555555563, 870.6322222222228, 869.6488888888891, 870.1566666666668, 870.9500000000002, 869.3622222222227, 869.806666666667, 869.7755555555559, 870.9177777777778, 869.9988888888894, 869.5844444444447, 869.8700000000003, 870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338, 870.8233333333336, 869.3011111111115, 870.0933333333336, 869.4588888888892, 869.7755555555561, 870.378888888889, 869.8711111111116, 868.9177777777779, 870.0922222222226, 871.2344444444449, 868.3166666666673, 868.0622222222225, 869.9344444444447, 870.0300000000004, 869.8077777777781, 871.1411111111115, 869.2677777777781, 869.6477777777777, 869.7111111111113, 870.5677777777778, 869.5222222222225, 870.0622222222228, 869.3311111111116, 869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19808407582209775, "mean_inference_ms": 1.8064119783106367, "mean_action_processing_ms": 0.0743786185459124, "mean_env_wait_ms": 1.218450407635563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004475831985473633, "StateBufferConnector_ms": 0.0029523372650146484, "ViewRequirementAgentConnector_ms": 0.07137393951416016}, "num_episodes": 30, "episode_return_max": 875.6666666666653, "episode_return_min": 868.0622222222225, "episode_return_mean": 871.3810444444445, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299550, "num_agent_steps_trained": 299400, "num_env_steps_sampled": 299550, "num_env_steps_trained": 299400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 289.66715300916275, "num_env_steps_trained_throughput_per_sec": 289.66715300916275, "timesteps_total": 299550, "num_env_steps_sampled_lifetime": 299550, "num_agent_steps_sampled_lifetime": 299550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 299550, "timers": {"training_iteration_time_ms": 10236.81, "restore_workers_time_ms": 0.013, "training_step_time_ms": 504.849, "sample_time_ms": 490.037, "synch_weights_time_ms": 13.494}, "counters": {"num_env_steps_sampled": 299550, "num_env_steps_trained": 299400, "num_agent_steps_sampled": 299550, "num_agent_steps_trained": 299400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 1997, "num_samples_added_to_queue": 299400}, "done": false, "training_iteration": 101, "trial_id": "38f59_00000", "date": "2024-10-10_22-28-51", "timestamp": 1728595731, "time_this_iter_s": 10.370752096176147, "time_total_s": 1035.101588010788, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2e0e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1035.101588010788, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 13.020000000000001, "ram_util_percent": 70.66000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3155.56298828125, "policy_loss": 1174.482177734375, "entropy": 5.108785629272461, "entropy_coeff": 0.01, "var_gnorm": 17.86101722717285, "vf_loss": 199640.71875, "vf_explained_var": 0.6366128921508789}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1008.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 302550, "num_env_steps_trained": 302400, "num_agent_steps_sampled": 302550, "num_agent_steps_trained": 302400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2017, "num_samples_added_to_queue": 302400, "learner_queue": {"size_count": 1008, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.086, "learner_load_time_ms": 0.23, "learner_load_wait_time_ms": 996.966, "learner_dequeue_time_ms": 8777.625}}, "env_runners": {"episode_reward_max": 874.3355555555547, "episode_reward_min": 868.0622222222225, "episode_reward_mean": 870.3791111111112, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.0622222222225}, "policy_reward_max": {"default_policy": 874.3355555555547}, "policy_reward_mean": {"default_policy": 870.3791111111112}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11239999999999999, "num_moves_min": 0.0, "num_moves_max": 0.28, "mean_accuracy_mean": 40.60346666666666, "mean_accuracy_min": 40.48566666666666, "mean_accuracy_max": 41.01133333333334, "num_model_switches_mean": 0.3098, "num_model_switches_min": 0.06, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006919999999999998, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5061783447095054, "mean_cluster_cpu_util_min": 0.5033726902923332, "mean_cluster_cpu_util_max": 0.51411240577312, "mean_cluster_mem_util_mean": 0.3282801529535865, "mean_cluster_mem_util_min": 0.32738185654008434, "mean_cluster_mem_util_max": 0.3301402953586498, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.060346666666667, "reward_accuracy_mean_min": 4.048566666666667, "reward_accuracy_mean_max": 4.101133333333333, "reward_sla_mean_mean": -0.023066666666666676, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.03466666666674, "reward_accuracy_sum_min": 404.8566666666667, "reward_accuracy_sum_max": 410.11333333333334, "reward_sla_sum_mean": -2.3066666666666666, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5557.0, "global_timestep_min": 3400, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445, 870.6955555555555, 869.678888888889, 869.8711111111113, 869.266666666667, 870.505555555556, 870.7911111111113, 868.95, 869.9977777777782, 870.5055555555563, 870.6322222222228, 869.6488888888891, 870.1566666666668, 870.9500000000002, 869.3622222222227, 869.806666666667, 869.7755555555559, 870.9177777777778, 869.9988888888894, 869.5844444444447, 869.8700000000003, 870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338, 870.8233333333336, 869.3011111111115, 870.0933333333336, 869.4588888888892, 869.7755555555561, 870.378888888889, 869.8711111111116, 868.9177777777779, 870.0922222222226, 871.2344444444449, 868.3166666666673, 868.0622222222225, 869.9344444444447, 870.0300000000004, 869.8077777777781, 871.1411111111115, 869.2677777777781, 869.6477777777777, 869.7111111111113, 870.5677777777778, 869.5222222222225, 870.0622222222228, 869.3311111111116, 869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335, 870.6622222222223, 869.2988888888891, 870.6000000000003, 870.5044444444447, 870.6322222222223, 869.8377777777779, 869.3288888888891, 871.011111111111, 871.6788888888889, 870.6622222222221, 869.2033333333335, 871.8366666666667, 870.0288888888891, 870.283333333334, 869.5211111111116, 869.0133333333333, 871.2655555555555, 870.377777777778, 869.9644444444444, 870.7577777777781, 869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [871.613333333333, 870.6944444444449, 871.1711111111113, 874.3355555555547, 873.5755555555548, 874.147777777777, 873.8933333333325, 873.7677777777774, 873.0077777777774, 871.8966666666664, 872.121111111111, 869.9644444444446, 870.664444444445, 870.6955555555555, 869.678888888889, 869.8711111111113, 869.266666666667, 870.505555555556, 870.7911111111113, 868.95, 869.9977777777782, 870.5055555555563, 870.6322222222228, 869.6488888888891, 870.1566666666668, 870.9500000000002, 869.3622222222227, 869.806666666667, 869.7755555555559, 870.9177777777778, 869.9988888888894, 869.5844444444447, 869.8700000000003, 870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338, 870.8233333333336, 869.3011111111115, 870.0933333333336, 869.4588888888892, 869.7755555555561, 870.378888888889, 869.8711111111116, 868.9177777777779, 870.0922222222226, 871.2344444444449, 868.3166666666673, 868.0622222222225, 869.9344444444447, 870.0300000000004, 869.8077777777781, 871.1411111111115, 869.2677777777781, 869.6477777777777, 869.7111111111113, 870.5677777777778, 869.5222222222225, 870.0622222222228, 869.3311111111116, 869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335, 870.6622222222223, 869.2988888888891, 870.6000000000003, 870.5044444444447, 870.6322222222223, 869.8377777777779, 869.3288888888891, 871.011111111111, 871.6788888888889, 870.6622222222221, 869.2033333333335, 871.8366666666667, 870.0288888888891, 870.283333333334, 869.5211111111116, 869.0133333333333, 871.2655555555555, 870.377777777778, 869.9644444444444, 870.7577777777781, 869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19817539686956637, "mean_inference_ms": 1.806949826783083, "mean_action_processing_ms": 0.07440472780024075, "mean_env_wait_ms": 1.2186949187978968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048067569732666016, "StateBufferConnector_ms": 0.0029358863830566406, "ViewRequirementAgentConnector_ms": 0.07048726081848145}, "num_episodes": 30, "episode_return_max": 874.3355555555547, "episode_return_min": 868.0622222222225, "episode_return_mean": 870.3791111111112, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302550, "num_agent_steps_trained": 302400, "num_env_steps_sampled": 302550, "num_env_steps_trained": 302400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 285.7093487509228, "num_env_steps_trained_throughput_per_sec": 285.7093487509228, "timesteps_total": 302550, "num_env_steps_sampled_lifetime": 302550, "num_agent_steps_sampled_lifetime": 302550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 302550, "timers": {"training_iteration_time_ms": 10268.235, "restore_workers_time_ms": 0.014, "training_step_time_ms": 518.173, "sample_time_ms": 504.045, "synch_weights_time_ms": 12.824}, "counters": {"num_env_steps_sampled": 302550, "num_env_steps_trained": 302400, "num_agent_steps_sampled": 302550, "num_agent_steps_trained": 302400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2017, "num_samples_added_to_queue": 302400}, "done": false, "training_iteration": 102, "trial_id": "38f59_00000", "date": "2024-10-10_22-29-01", "timestamp": 1728595741, "time_this_iter_s": 10.51133394241333, "time_total_s": 1045.6129219532013, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc6200>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1045.6129219532013, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 12.886666666666668, "ram_util_percent": 70.80666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 121.0703125, "policy_loss": -1722.16845703125, "entropy": 5.306653022766113, "entropy_coeff": 0.01, "var_gnorm": 17.860671997070312, "vf_loss": 185915.875, "vf_explained_var": 0.647965669631958}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1018.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 305700, "num_env_steps_trained": 305400, "num_agent_steps_sampled": 305700, "num_agent_steps_trained": 305400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2038, "num_samples_added_to_queue": 305700, "learner_queue": {"size_count": 1018, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 50.602, "learner_load_time_ms": 0.243, "learner_load_wait_time_ms": 926.036, "learner_dequeue_time_ms": 8344.361}}, "env_runners": {"episode_reward_max": 874.3699999999991, "episode_reward_min": 868.0622222222225, "episode_reward_mean": 870.6995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.0622222222225}, "policy_reward_max": {"default_policy": 874.3699999999991}, "policy_reward_mean": {"default_policy": 870.6995}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.1805, "num_moves_min": 0.0, "num_moves_max": 0.44, "mean_accuracy_mean": 40.63861666666666, "mean_accuracy_min": 40.48566666666666, "mean_accuracy_max": 40.97333333333333, "num_model_switches_mean": 0.3486000000000001, "num_model_switches_min": 0.06, "num_model_switches_max": 0.63, "num_slav_mean": 0.000692, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5066844109670895, "mean_cluster_cpu_util_min": 0.5033726902923332, "mean_cluster_cpu_util_max": 0.5129486808236808, "mean_cluster_mem_util_mean": 0.3284129799578059, "mean_cluster_mem_util_min": 0.32738185654008434, "mean_cluster_mem_util_max": 0.32981698312236285, "reward_consolidation_mean_mean": 4.666199999999999, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.063861666666667, "reward_accuracy_mean_min": 4.048566666666667, "reward_accuracy_mean_max": 4.097333333333333, "reward_sla_mean_mean": -0.023066666666666666, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.61999999999995, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.38616666666667, "reward_accuracy_sum_min": 404.8566666666667, "reward_accuracy_sum_max": 409.73333333333335, "reward_sla_sum_mean": -2.306666666666667, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5497.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338, 870.8233333333336, 869.3011111111115, 870.0933333333336, 869.4588888888892, 869.7755555555561, 870.378888888889, 869.8711111111116, 868.9177777777779, 870.0922222222226, 871.2344444444449, 868.3166666666673, 868.0622222222225, 869.9344444444447, 870.0300000000004, 869.8077777777781, 871.1411111111115, 869.2677777777781, 869.6477777777777, 869.7111111111113, 870.5677777777778, 869.5222222222225, 870.0622222222228, 869.3311111111116, 869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335, 870.6622222222223, 869.2988888888891, 870.6000000000003, 870.5044444444447, 870.6322222222223, 869.8377777777779, 869.3288888888891, 871.011111111111, 871.6788888888889, 870.6622222222221, 869.2033333333335, 871.8366666666667, 870.0288888888891, 870.283333333334, 869.5211111111116, 869.0133333333333, 871.2655555555555, 870.377777777778, 869.9644444444444, 870.7577777777781, 869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888, 872.248888888889, 871.6766666666663, 871.7411111111111, 871.7411111111109, 870.4711111111112, 871.993333333333, 872.7222222222218, 873.0066666666661, 874.0844444444435, 874.3699999999991, 872.2433333333324, 871.5177777777778, 872.0577777777779, 870.567777777778, 871.168888888889, 871.962222222222, 869.7722222222222, 871.6755555555558, 872.6277777777775, 873.6733333333328, 873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.2511111111114, 871.2666666666669, 869.8388888888891, 869.298888888889, 869.3311111111113, 870.0300000000004, 870.4433333333338, 870.8233333333336, 869.3011111111115, 870.0933333333336, 869.4588888888892, 869.7755555555561, 870.378888888889, 869.8711111111116, 868.9177777777779, 870.0922222222226, 871.2344444444449, 868.3166666666673, 868.0622222222225, 869.9344444444447, 870.0300000000004, 869.8077777777781, 871.1411111111115, 869.2677777777781, 869.6477777777777, 869.7111111111113, 870.5677777777778, 869.5222222222225, 870.0622222222228, 869.3311111111116, 869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335, 870.6622222222223, 869.2988888888891, 870.6000000000003, 870.5044444444447, 870.6322222222223, 869.8377777777779, 869.3288888888891, 871.011111111111, 871.6788888888889, 870.6622222222221, 869.2033333333335, 871.8366666666667, 870.0288888888891, 870.283333333334, 869.5211111111116, 869.0133333333333, 871.2655555555555, 870.377777777778, 869.9644444444444, 870.7577777777781, 869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888, 872.248888888889, 871.6766666666663, 871.7411111111111, 871.7411111111109, 870.4711111111112, 871.993333333333, 872.7222222222218, 873.0066666666661, 874.0844444444435, 874.3699999999991, 872.2433333333324, 871.5177777777778, 872.0577777777779, 870.567777777778, 871.168888888889, 871.962222222222, 869.7722222222222, 871.6755555555558, 872.6277777777775, 873.6733333333328, 873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19827499961845518, "mean_inference_ms": 1.8094530221443619, "mean_action_processing_ms": 0.07443522086150223, "mean_env_wait_ms": 1.2191324014541012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004601001739501953, "StateBufferConnector_ms": 0.002850770950317383, "ViewRequirementAgentConnector_ms": 0.06731915473937988}, "num_episodes": 33, "episode_return_max": 874.3699999999991, "episode_return_min": 868.0622222222225, "episode_return_mean": 870.6995, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305700, "num_agent_steps_trained": 305400, "num_env_steps_sampled": 305700, "num_env_steps_trained": 305400, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 306.80189515060755, "num_env_steps_trained_throughput_per_sec": 292.1922810958167, "timesteps_total": 305700, "num_env_steps_sampled_lifetime": 305700, "num_agent_steps_sampled_lifetime": 305700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 305700, "timers": {"training_iteration_time_ms": 10294.868, "restore_workers_time_ms": 0.012, "training_step_time_ms": 478.06, "sample_time_ms": 465.207, "synch_weights_time_ms": 11.547}, "counters": {"num_env_steps_sampled": 305700, "num_env_steps_trained": 305400, "num_agent_steps_sampled": 305700, "num_agent_steps_trained": 305400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2038, "num_samples_added_to_queue": 305700}, "done": false, "training_iteration": 103, "trial_id": "38f59_00000", "date": "2024-10-10_22-29-12", "timestamp": 1728595752, "time_this_iter_s": 10.277460098266602, "time_total_s": 1055.890382051468, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1a7a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1055.890382051468, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 11.079999999999997, "ram_util_percent": 70.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 235.8563232421875, "policy_loss": -1701.33251953125, "entropy": 5.334089279174805, "entropy_coeff": 0.01, "var_gnorm": 17.848472595214844, "vf_loss": 195319.125, "vf_explained_var": 0.6439542770385742}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1028.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 308700, "num_env_steps_trained": 308400, "num_agent_steps_sampled": 308700, "num_agent_steps_trained": 308400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2058, "num_samples_added_to_queue": 308700, "learner_queue": {"size_count": 1028, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.539, "learner_load_time_ms": 0.223, "learner_load_wait_time_ms": 971.935, "learner_dequeue_time_ms": 8337.31}}, "env_runners": {"episode_reward_max": 875.8599999999989, "episode_reward_min": 868.7277777777784, "episode_reward_mean": 872.0989999999995, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.7277777777784}, "policy_reward_max": {"default_policy": 875.8599999999989}, "policy_reward_mean": {"default_policy": 872.0989999999995}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.26709999999999995, "num_moves_min": 0.04, "num_moves_max": 0.53, "mean_accuracy_mean": 40.77256666666667, "mean_accuracy_min": 40.55533333333333, "mean_accuracy_max": 41.04933333333334, "num_model_switches_mean": 0.3563, "num_model_switches_min": 0.15, "num_model_switches_max": 0.63, "num_slav_mean": 0.0006786666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.508881811799044, "mean_cluster_cpu_util_min": 0.5041787897591469, "mean_cluster_cpu_util_max": 0.514074933351719, "mean_cluster_mem_util_mean": 0.3289976265822785, "mean_cluster_mem_util_min": 0.3279646624472574, "mean_cluster_mem_util_max": 0.3302716244725739, "reward_consolidation_mean_mean": 4.666355555555555, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.077256666666667, "reward_accuracy_mean_min": 4.055533333333334, "reward_accuracy_mean_max": 4.104933333333333, "reward_sla_mean_mean": -0.022622222222222224, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.63555555555547, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 407.72566666666665, "reward_accuracy_sum_min": 405.5533333333334, "reward_accuracy_sum_max": 410.49333333333334, "reward_sla_sum_mean": -2.2622222222222224, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4157.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335, 870.6622222222223, 869.2988888888891, 870.6000000000003, 870.5044444444447, 870.6322222222223, 869.8377777777779, 869.3288888888891, 871.011111111111, 871.6788888888889, 870.6622222222221, 869.2033333333335, 871.8366666666667, 870.0288888888891, 870.283333333334, 869.5211111111116, 869.0133333333333, 871.2655555555555, 870.377777777778, 869.9644444444444, 870.7577777777781, 869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888, 872.248888888889, 871.6766666666663, 871.7411111111111, 871.7411111111109, 870.4711111111112, 871.993333333333, 872.7222222222218, 873.0066666666661, 874.0844444444435, 874.3699999999991, 872.2433333333324, 871.5177777777778, 872.0577777777779, 870.567777777778, 871.168888888889, 871.962222222222, 869.7722222222222, 871.6755555555558, 872.6277777777775, 873.6733333333328, 873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769, 874.4944444444434, 874.4944444444434, 874.3988888888878, 874.0511111111103, 874.7166666666657, 875.0344444444431, 874.62111111111, 874.1455555555547, 875.8599999999989, 873.2255555555547, 875.5099999999989, 875.1611111111101, 875.573333333332, 874.3677777777768, 874.3677777777765, 874.3044444444434, 874.3355555555544, 874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.3944444444448, 870.5055555555558, 868.7277777777784, 869.8388888888891, 869.5211111111113, 869.7111111111114, 869.9333333333335, 870.6622222222223, 869.2988888888891, 870.6000000000003, 870.5044444444447, 870.6322222222223, 869.8377777777779, 869.3288888888891, 871.011111111111, 871.6788888888889, 870.6622222222221, 869.2033333333335, 871.8366666666667, 870.0288888888891, 870.283333333334, 869.5211111111116, 869.0133333333333, 871.2655555555555, 870.377777777778, 869.9644444444444, 870.7577777777781, 869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888, 872.248888888889, 871.6766666666663, 871.7411111111111, 871.7411111111109, 870.4711111111112, 871.993333333333, 872.7222222222218, 873.0066666666661, 874.0844444444435, 874.3699999999991, 872.2433333333324, 871.5177777777778, 872.0577777777779, 870.567777777778, 871.168888888889, 871.962222222222, 869.7722222222222, 871.6755555555558, 872.6277777777775, 873.6733333333328, 873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769, 874.4944444444434, 874.4944444444434, 874.3988888888878, 874.0511111111103, 874.7166666666657, 875.0344444444431, 874.62111111111, 874.1455555555547, 875.8599999999989, 873.2255555555547, 875.5099999999989, 875.1611111111101, 875.573333333332, 874.3677777777768, 874.3677777777765, 874.3044444444434, 874.3355555555544, 874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19826214747320137, "mean_inference_ms": 1.809085764805692, "mean_action_processing_ms": 0.07442918511168974, "mean_env_wait_ms": 1.218945490752403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044214725494384766, "StateBufferConnector_ms": 0.0027611255645751953, "ViewRequirementAgentConnector_ms": 0.06499195098876953}, "num_episodes": 30, "episode_return_max": 875.8599999999989, "episode_return_min": 868.7277777777784, "episode_return_mean": 872.0989999999995, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308700, "num_agent_steps_trained": 308400, "num_env_steps_sampled": 308700, "num_env_steps_trained": 308400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 293.56060522107595, "num_env_steps_trained_throughput_per_sec": 293.56060522107595, "timesteps_total": 308700, "num_env_steps_sampled_lifetime": 308700, "num_agent_steps_sampled_lifetime": 308700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 308700, "timers": {"training_iteration_time_ms": 10260.562, "restore_workers_time_ms": 0.01, "training_step_time_ms": 523.843, "sample_time_ms": 509.487, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 308700, "num_env_steps_trained": 308400, "num_agent_steps_sampled": 308700, "num_agent_steps_trained": 308400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2058, "num_samples_added_to_queue": 308700}, "done": false, "training_iteration": 104, "trial_id": "38f59_00000", "date": "2024-10-10_22-29-22", "timestamp": 1728595762, "time_this_iter_s": 10.230329990386963, "time_total_s": 1066.1207120418549, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb69b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1066.1207120418549, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 11.533333333333331, "ram_util_percent": 71.27333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2520.077392578125, "policy_loss": 694.91162109375, "entropy": 5.481086730957031, "entropy_coeff": 0.01, "var_gnorm": 17.834394454956055, "vf_loss": 184160.90625, "vf_explained_var": 0.6454485654830933}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1038.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 311550, "num_env_steps_trained": 311400, "num_agent_steps_sampled": 311550, "num_agent_steps_trained": 311400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2077, "num_samples_added_to_queue": 311400, "learner_queue": {"size_count": 1038, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.635, "learner_load_time_ms": 0.222, "learner_load_wait_time_ms": 1033.436, "learner_dequeue_time_ms": 8369.43}}, "env_runners": {"episode_reward_max": 875.8599999999989, "episode_reward_min": 869.5511111111114, "episode_reward_mean": 873.112866666666, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 869.5511111111114}, "policy_reward_max": {"default_policy": 875.8599999999989}, "policy_reward_mean": {"default_policy": 873.112866666666}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.35080000000000006, "num_moves_min": 0.04, "num_moves_max": 0.6, "mean_accuracy_mean": 40.86528666666666, "mean_accuracy_min": 40.55533333333333, "mean_accuracy_max": 41.04933333333334, "num_model_switches_mean": 0.36639999999999995, "num_model_switches_min": 0.15, "num_model_switches_max": 0.63, "num_slav_mean": 0.0006526666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.0013999999999999996, "mean_cluster_cpu_util_mean": 0.5103928801250229, "mean_cluster_cpu_util_min": 0.5047371644603786, "mean_cluster_cpu_util_max": 0.514074933351719, "mean_cluster_mem_util_mean": 0.32940347573839657, "mean_cluster_mem_util_min": 0.3279646624472574, "mean_cluster_mem_util_max": 0.3302716244725739, "reward_consolidation_mean_mean": 4.666355555555555, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.086528666666667, "reward_accuracy_mean_min": 4.055533333333334, "reward_accuracy_mean_max": 4.104933333333333, "reward_sla_mean_mean": -0.02175555555555556, "reward_sla_mean_min": -0.04666666666666667, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.63555555555547, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.65286666666674, "reward_accuracy_sum_min": 405.5533333333334, "reward_accuracy_sum_max": 410.49333333333334, "reward_sla_sum_mean": -2.175555555555556, "reward_sla_sum_min": -4.666666666666667, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2934.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888, 872.248888888889, 871.6766666666663, 871.7411111111111, 871.7411111111109, 870.4711111111112, 871.993333333333, 872.7222222222218, 873.0066666666661, 874.0844444444435, 874.3699999999991, 872.2433333333324, 871.5177777777778, 872.0577777777779, 870.567777777778, 871.168888888889, 871.962222222222, 869.7722222222222, 871.6755555555558, 872.6277777777775, 873.6733333333328, 873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769, 874.4944444444434, 874.4944444444434, 874.3988888888878, 874.0511111111103, 874.7166666666657, 875.0344444444431, 874.62111111111, 874.1455555555547, 875.8599999999989, 873.2255555555547, 875.5099999999989, 875.1611111111101, 875.573333333332, 874.3677777777768, 874.3677777777765, 874.3044444444434, 874.3355555555544, 874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323, 874.177777777777, 874.8122222222215, 874.78111111111, 875.0355555555547, 874.4644444444436, 874.3055555555549, 873.5111111111102, 873.418888888888, 873.7677777777773, 875.5099999999989, 873.987777777777, 874.78111111111, 875.0033333333325, 873.4799999999991, 873.7022222222215, 874.7177777777767, 873.1311111111105, 871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.9011111111114, 871.5511111111111, 870.5366666666669, 870.7266666666668, 869.9977777777783, 871.0433333333333, 870.6311111111112, 869.5511111111114, 871.8044444444447, 870.4388888888888, 872.248888888889, 871.6766666666663, 871.7411111111111, 871.7411111111109, 870.4711111111112, 871.993333333333, 872.7222222222218, 873.0066666666661, 874.0844444444435, 874.3699999999991, 872.2433333333324, 871.5177777777778, 872.0577777777779, 870.567777777778, 871.168888888889, 871.962222222222, 869.7722222222222, 871.6755555555558, 872.6277777777775, 873.6733333333328, 873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769, 874.4944444444434, 874.4944444444434, 874.3988888888878, 874.0511111111103, 874.7166666666657, 875.0344444444431, 874.62111111111, 874.1455555555547, 875.8599999999989, 873.2255555555547, 875.5099999999989, 875.1611111111101, 875.573333333332, 874.3677777777768, 874.3677777777765, 874.3044444444434, 874.3355555555544, 874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323, 874.177777777777, 874.8122222222215, 874.78111111111, 875.0355555555547, 874.4644444444436, 874.3055555555549, 873.5111111111102, 873.418888888888, 873.7677777777773, 875.5099999999989, 873.987777777777, 874.78111111111, 875.0033333333325, 873.4799999999991, 873.7022222222215, 874.7177777777767, 873.1311111111105, 871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1982389799822931, "mean_inference_ms": 1.8073883788131808, "mean_action_processing_ms": 0.07441834599280515, "mean_env_wait_ms": 1.218539454256433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220724105834961, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.06546258926391602}, "num_episodes": 27, "episode_return_max": 875.8599999999989, "episode_return_min": 869.5511111111114, "episode_return_mean": 873.112866666666, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311550, "num_agent_steps_trained": 311400, "num_env_steps_sampled": 311550, "num_env_steps_trained": 311400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 277.1953616430136, "num_env_steps_trained_throughput_per_sec": 291.78459120317217, "timesteps_total": 311550, "num_env_steps_sampled_lifetime": 311550, "num_agent_steps_sampled_lifetime": 311550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 311550, "timers": {"training_iteration_time_ms": 10275.424, "restore_workers_time_ms": 0.013, "training_step_time_ms": 540.778, "sample_time_ms": 527.103, "synch_weights_time_ms": 12.305}, "counters": {"num_env_steps_sampled": 311550, "num_env_steps_trained": 311400, "num_agent_steps_sampled": 311550, "num_agent_steps_trained": 311400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2077, "num_samples_added_to_queue": 311400}, "done": false, "training_iteration": 105, "trial_id": "38f59_00000", "date": "2024-10-10_22-29-32", "timestamp": 1728595772, "time_this_iter_s": 10.292053699493408, "time_total_s": 1076.4127657413483, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6e30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1076.4127657413483, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 71.87857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2414.276611328125, "policy_loss": 626.4622802734375, "entropy": 5.537559986114502, "entropy_coeff": 0.01, "var_gnorm": 17.828990936279297, "vf_loss": 180442.703125, "vf_explained_var": 0.6487666964530945}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1048.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 314550, "num_env_steps_trained": 314400, "num_agent_steps_sampled": 314550, "num_agent_steps_trained": 314400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2097, "num_samples_added_to_queue": 314400, "learner_queue": {"size_count": 1048, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.19, "learner_load_time_ms": 0.222, "learner_load_wait_time_ms": 986.875, "learner_dequeue_time_ms": 8374.705}}, "env_runners": {"episode_reward_max": 875.8599999999989, "episode_reward_min": 869.9599999999999, "episode_reward_mean": 873.3939111111105, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 869.9599999999999}, "policy_reward_max": {"default_policy": 875.8599999999989}, "policy_reward_mean": {"default_policy": 873.3939111111105}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.43629999999999997, "num_moves_min": 0.14, "num_moves_max": 0.62, "mean_accuracy_mean": 40.899613333333335, "mean_accuracy_min": 40.62499999999999, "mean_accuracy_max": 41.04933333333334, "num_model_switches_mean": 0.38470000000000004, "num_model_switches_min": 0.15, "num_model_switches_max": 0.64, "num_slav_mean": 0.0006760000000000001, "num_slav_min": 0.0002, "num_slav_max": 0.0013999999999999996, "mean_cluster_cpu_util_mean": 0.5110967311890973, "mean_cluster_cpu_util_min": 0.5047371644603786, "mean_cluster_cpu_util_max": 0.514074933351719, "mean_cluster_mem_util_mean": 0.3295697943037975, "mean_cluster_mem_util_min": 0.3281845991561182, "mean_cluster_mem_util_max": 0.3302716244725739, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.089961333333334, "reward_accuracy_mean_min": 4.062500000000001, "reward_accuracy_mean_max": 4.104933333333333, "reward_sla_mean_mean": -0.022533333333333336, "reward_sla_mean_min": -0.04666666666666667, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.99613333333343, "reward_accuracy_sum_min": 406.25000000000006, "reward_accuracy_sum_max": 410.49333333333334, "reward_sla_sum_mean": -2.2533333333333334, "reward_sla_sum_min": -4.666666666666667, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2217.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769, 874.4944444444434, 874.4944444444434, 874.3988888888878, 874.0511111111103, 874.7166666666657, 875.0344444444431, 874.62111111111, 874.1455555555547, 875.8599999999989, 873.2255555555547, 875.5099999999989, 875.1611111111101, 875.573333333332, 874.3677777777768, 874.3677777777765, 874.3044444444434, 874.3355555555544, 874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323, 874.177777777777, 874.8122222222215, 874.78111111111, 875.0355555555547, 874.4644444444436, 874.3055555555549, 873.5111111111102, 873.418888888888, 873.7677777777773, 875.5099999999989, 873.987777777777, 874.78111111111, 875.0033333333325, 873.4799999999991, 873.7022222222215, 874.7177777777767, 873.1311111111105, 871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995, 873.2277777777771, 873.957777777777, 872.5933333333329, 869.9599999999999, 870.7855555555557, 871.9277777777777, 873.0077777777775, 872.6266666666661, 872.9111111111109, 871.5155555555549, 872.9111111111107, 873.2911111111104, 872.9744444444442, 873.7377777777773, 872.7233333333335, 871.198888888889, 872.2133333333329, 873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.1622222222215, 871.6399999999992, 870.5988888888888, 870.6944444444445, 870.8844444444447, 871.0433333333335, 870.3744444444442, 871.2333333333332, 870.5322222222219, 871.2633333333331, 872.9433333333325, 873.987777777777, 874.1777777777769, 874.4944444444434, 874.4944444444434, 874.3988888888878, 874.0511111111103, 874.7166666666657, 875.0344444444431, 874.62111111111, 874.1455555555547, 875.8599999999989, 873.2255555555547, 875.5099999999989, 875.1611111111101, 875.573333333332, 874.3677777777768, 874.3677777777765, 874.3044444444434, 874.3355555555544, 874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323, 874.177777777777, 874.8122222222215, 874.78111111111, 875.0355555555547, 874.4644444444436, 874.3055555555549, 873.5111111111102, 873.418888888888, 873.7677777777773, 875.5099999999989, 873.987777777777, 874.78111111111, 875.0033333333325, 873.4799999999991, 873.7022222222215, 874.7177777777767, 873.1311111111105, 871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995, 873.2277777777771, 873.957777777777, 872.5933333333329, 869.9599999999999, 870.7855555555557, 871.9277777777777, 873.0077777777775, 872.6266666666661, 872.9111111111109, 871.5155555555549, 872.9111111111107, 873.2911111111104, 872.9744444444442, 873.7377777777773, 872.7233333333335, 871.198888888889, 872.2133333333329, 873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19824374652466445, "mean_inference_ms": 1.8062251123946333, "mean_action_processing_ms": 0.07440918153939982, "mean_env_wait_ms": 1.2182906609490805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004064321517944336, "StateBufferConnector_ms": 0.0027914047241210938, "ViewRequirementAgentConnector_ms": 0.0656435489654541}, "num_episodes": 30, "episode_return_max": 875.8599999999989, "episode_return_min": 869.9599999999999, "episode_return_mean": 873.3939111111105, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314550, "num_agent_steps_trained": 314400, "num_env_steps_sampled": 314550, "num_env_steps_trained": 314400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 290.55055917577, "num_env_steps_trained_throughput_per_sec": 290.55055917577, "timesteps_total": 314550, "num_env_steps_sampled_lifetime": 314550, "num_agent_steps_sampled_lifetime": 314550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 314550, "timers": {"training_iteration_time_ms": 10272.591, "restore_workers_time_ms": 0.013, "training_step_time_ms": 507.617, "sample_time_ms": 492.99, "synch_weights_time_ms": 13.277}, "counters": {"num_env_steps_sampled": 314550, "num_env_steps_trained": 314400, "num_agent_steps_sampled": 314550, "num_agent_steps_trained": 314400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2097, "num_samples_added_to_queue": 314400}, "done": false, "training_iteration": 106, "trial_id": "38f59_00000", "date": "2024-10-10_22-29-43", "timestamp": 1728595783, "time_this_iter_s": 10.338396310806274, "time_total_s": 1086.7511620521545, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb65f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1086.7511620521545, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 11.339999999999998, "ram_util_percent": 71.89333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3612.961181640625, "policy_loss": 1576.6083984375, "entropy": 5.436995029449463, "entropy_coeff": 0.01, "var_gnorm": 17.831640243530273, "vf_loss": 205266.375, "vf_explained_var": 0.6337910294532776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 317550, "num_env_steps_trained": 317400, "num_agent_steps_sampled": 317550, "num_agent_steps_trained": 317400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2117, "num_samples_added_to_queue": 317400, "learner_queue": {"size_count": 1058, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.132, "learner_load_time_ms": 0.233, "learner_load_wait_time_ms": 972.535, "learner_dequeue_time_ms": 8359.488}}, "env_runners": {"episode_reward_max": 875.5099999999989, "episode_reward_min": 869.9599999999999, "episode_reward_mean": 873.4021999999993, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 869.9599999999999}, "policy_reward_max": {"default_policy": 875.5099999999989}, "policy_reward_mean": {"default_policy": 873.4021999999993}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.48180000000000006, "num_moves_min": 0.33, "num_moves_max": 0.62, "mean_accuracy_mean": 40.898219999999995, "mean_accuracy_min": 40.739, "mean_accuracy_max": 41.04933333333334, "num_model_switches_mean": 0.41759999999999997, "num_model_switches_min": 0.15, "num_model_switches_max": 0.64, "num_slav_mean": 0.000674, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0013999999999999996, "mean_cluster_cpu_util_mean": 0.5111203561086597, "mean_cluster_cpu_util_min": 0.508096835355764, "mean_cluster_cpu_util_max": 0.514074933351719, "mean_cluster_mem_util_mean": 0.329569841772152, "mean_cluster_mem_util_min": 0.32883808016877636, "mean_cluster_mem_util_max": 0.3301845991561181, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.089822000000001, "reward_accuracy_mean_min": 4.0739, "reward_accuracy_mean_max": 4.104933333333333, "reward_sla_mean_mean": -0.02246666666666667, "reward_sla_mean_min": -0.04666666666666667, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.98220000000003, "reward_accuracy_sum_min": 407.39000000000004, "reward_accuracy_sum_max": 410.49333333333334, "reward_sla_sum_mean": -2.246666666666667, "reward_sla_sum_min": -4.666666666666667, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2757.0, "global_timestep_min": 600, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323, 874.177777777777, 874.8122222222215, 874.78111111111, 875.0355555555547, 874.4644444444436, 874.3055555555549, 873.5111111111102, 873.418888888888, 873.7677777777773, 875.5099999999989, 873.987777777777, 874.78111111111, 875.0033333333325, 873.4799999999991, 873.7022222222215, 874.7177777777767, 873.1311111111105, 871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995, 873.2277777777771, 873.957777777777, 872.5933333333329, 869.9599999999999, 870.7855555555557, 871.9277777777777, 873.0077777777775, 872.6266666666661, 872.9111111111109, 871.5155555555549, 872.9111111111107, 873.2911111111104, 872.9744444444442, 873.7377777777773, 872.7233333333335, 871.198888888889, 872.2133333333329, 873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773, 872.5622222222216, 872.9744444444437, 871.8944444444439, 873.5444444444437, 873.9244444444438, 872.6866666666659, 873.9255555555549, 872.8155555555547, 871.9888888888881, 873.8611111111101, 872.3399999999995, 873.2288888888886, 874.0211111111104, 873.0377777777771, 872.6566666666658, 874.8766666666658, 873.6388888888877, 875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.62111111111, 873.9877777777768, 874.717777777777, 874.5911111111102, 873.1622222222213, 874.9066666666655, 873.7011111111101, 875.2877777777768, 873.6377777777768, 874.0177777777768, 874.429999999999, 875.3822222222208, 874.6533333333323, 874.177777777777, 874.8122222222215, 874.78111111111, 875.0355555555547, 874.4644444444436, 874.3055555555549, 873.5111111111102, 873.418888888888, 873.7677777777773, 875.5099999999989, 873.987777777777, 874.78111111111, 875.0033333333325, 873.4799999999991, 873.7022222222215, 874.7177777777767, 873.1311111111105, 871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995, 873.2277777777771, 873.957777777777, 872.5933333333329, 869.9599999999999, 870.7855555555557, 871.9277777777777, 873.0077777777775, 872.6266666666661, 872.9111111111109, 871.5155555555549, 872.9111111111107, 873.2911111111104, 872.9744444444442, 873.7377777777773, 872.7233333333335, 871.198888888889, 872.2133333333329, 873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773, 872.5622222222216, 872.9744444444437, 871.8944444444439, 873.5444444444437, 873.9244444444438, 872.6866666666659, 873.9255555555549, 872.8155555555547, 871.9888888888881, 873.8611111111101, 872.3399999999995, 873.2288888888886, 874.0211111111104, 873.0377777777771, 872.6566666666658, 874.8766666666658, 873.6388888888877, 875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19829096654210684, "mean_inference_ms": 1.8065494292579394, "mean_action_processing_ms": 0.07441447043821692, "mean_env_wait_ms": 1.2183387340275054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004076719284057617, "StateBufferConnector_ms": 0.0028252601623535156, "ViewRequirementAgentConnector_ms": 0.06632494926452637}, "num_episodes": 30, "episode_return_max": 875.5099999999989, "episode_return_min": 869.9599999999999, "episode_return_mean": 873.4021999999993, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317550, "num_agent_steps_trained": 317400, "num_env_steps_sampled": 317550, "num_env_steps_trained": 317400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 294.01253984051993, "num_env_steps_trained_throughput_per_sec": 294.01253984051993, "timesteps_total": 317550, "num_env_steps_sampled_lifetime": 317550, "num_agent_steps_sampled_lifetime": 317550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 317550, "timers": {"training_iteration_time_ms": 10292.706, "restore_workers_time_ms": 0.013, "training_step_time_ms": 507.432, "sample_time_ms": 492.807, "synch_weights_time_ms": 13.317}, "counters": {"num_env_steps_sampled": 317550, "num_env_steps_trained": 317400, "num_agent_steps_sampled": 317550, "num_agent_steps_trained": 317400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2117, "num_samples_added_to_queue": 317400}, "done": false, "training_iteration": 107, "trial_id": "38f59_00000", "date": "2024-10-10_22-29-53", "timestamp": 1728595793, "time_this_iter_s": 10.212365865707397, "time_total_s": 1096.963527917862, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde5120>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1096.963527917862, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 11.386666666666665, "ram_util_percent": 72.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 593.87939453125, "policy_loss": -1143.900390625, "entropy": 5.198077201843262, "entropy_coeff": 0.01, "var_gnorm": 17.84232521057129, "vf_loss": 175337.40625, "vf_explained_var": 0.6528810262680054}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 320400, "num_env_steps_trained": 320100, "num_agent_steps_sampled": 320400, "num_agent_steps_trained": 320100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2136, "num_samples_added_to_queue": 320400, "learner_queue": {"size_count": 1067, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.878, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 1008.579, "learner_dequeue_time_ms": 8361.02}}, "env_runners": {"episode_reward_max": 875.0677777777769, "episode_reward_min": 869.9599999999999, "episode_reward_mean": 873.2652666666659, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 869.9599999999999}, "policy_reward_max": {"default_policy": 875.0677777777769}, "policy_reward_mean": {"default_policy": 873.2652666666659}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.47580000000000006, "num_moves_min": 0.26, "num_moves_max": 0.62, "mean_accuracy_mean": 40.88986, "mean_accuracy_min": 40.739, "mean_accuracy_max": 41.01133333333333, "num_model_switches_mean": 0.43259999999999993, "num_model_switches_min": 0.23, "num_model_switches_max": 0.64, "num_slav_mean": 0.00069, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0013999999999999996, "mean_cluster_cpu_util_mean": 0.5109628731154625, "mean_cluster_cpu_util_min": 0.508096835355764, "mean_cluster_cpu_util_max": 0.5138826645523074, "mean_cluster_mem_util_mean": 0.32952667721518986, "mean_cluster_mem_util_min": 0.32883808016877636, "mean_cluster_mem_util_max": 0.3300743670886075, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.088986, "reward_accuracy_mean_min": 4.0739, "reward_accuracy_mean_max": 4.101133333333333, "reward_sla_mean_mean": -0.023000000000000007, "reward_sla_mean_min": -0.04666666666666667, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.8986, "reward_accuracy_sum_min": 407.39000000000004, "reward_accuracy_sum_max": 410.11333333333334, "reward_sla_sum_mean": -2.3, "reward_sla_sum_min": -4.666666666666667, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3759.0, "global_timestep_min": 1600, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995, 873.2277777777771, 873.957777777777, 872.5933333333329, 869.9599999999999, 870.7855555555557, 871.9277777777777, 873.0077777777775, 872.6266666666661, 872.9111111111109, 871.5155555555549, 872.9111111111107, 873.2911111111104, 872.9744444444442, 873.7377777777773, 872.7233333333335, 871.198888888889, 872.2133333333329, 873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773, 872.5622222222216, 872.9744444444437, 871.8944444444439, 873.5444444444437, 873.9244444444438, 872.6866666666659, 873.9255555555549, 872.8155555555547, 871.9888888888881, 873.8611111111101, 872.3399999999995, 873.2288888888886, 874.0211111111104, 873.0377777777771, 872.6566666666658, 874.8766666666658, 873.6388888888877, 875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217, 873.7977777777768, 873.5133333333328, 873.2588888888882, 874.1477777777772, 872.0844444444438, 874.0844444444438, 873.256666666666, 874.2411111111103, 874.5266666666657, 874.5277777777768, 874.9411111111107, 874.8122222222214, 873.8633333333328, 873.7022222222214, 874.5277777777769, 873.5111111111105, 872.4955555555549, 874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [871.6722222222218, 871.5433333333328, 873.7644444444436, 873.8611111111104, 873.8611111111104, 874.939999999999, 873.987777777777, 872.3055555555549, 874.4644444444436, 872.4999999999995, 873.2277777777771, 873.957777777777, 872.5933333333329, 869.9599999999999, 870.7855555555557, 871.9277777777777, 873.0077777777775, 872.6266666666661, 872.9111111111109, 871.5155555555549, 872.9111111111107, 873.2911111111104, 872.9744444444442, 873.7377777777773, 872.7233333333335, 871.198888888889, 872.2133333333329, 873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773, 872.5622222222216, 872.9744444444437, 871.8944444444439, 873.5444444444437, 873.9244444444438, 872.6866666666659, 873.9255555555549, 872.8155555555547, 871.9888888888881, 873.8611111111101, 872.3399999999995, 873.2288888888886, 874.0211111111104, 873.0377777777771, 872.6566666666658, 874.8766666666658, 873.6388888888877, 875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217, 873.7977777777768, 873.5133333333328, 873.2588888888882, 874.1477777777772, 872.0844444444438, 874.0844444444438, 873.256666666666, 874.2411111111103, 874.5266666666657, 874.5277777777768, 874.9411111111107, 874.8122222222214, 873.8633333333328, 873.7022222222214, 874.5277777777769, 873.5111111111105, 872.4955555555549, 874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19834058114950529, "mean_inference_ms": 1.8079874416776205, "mean_action_processing_ms": 0.0744288915912829, "mean_env_wait_ms": 1.2185333206817142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004081010818481445, "StateBufferConnector_ms": 0.002851724624633789, "ViewRequirementAgentConnector_ms": 0.06617975234985352}, "num_episodes": 30, "episode_return_max": 875.0677777777769, "episode_return_min": 869.9599999999999, "episode_return_mean": 873.2652666666659, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320400, "num_agent_steps_trained": 320100, "num_env_steps_sampled": 320400, "num_env_steps_trained": 320100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 283.24020904834384, "num_env_steps_trained_throughput_per_sec": 268.33282962474675, "timesteps_total": 320400, "num_env_steps_sampled_lifetime": 320400, "num_agent_steps_sampled_lifetime": 320400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 320400, "timers": {"training_iteration_time_ms": 10291.333, "restore_workers_time_ms": 0.012, "training_step_time_ms": 501.889, "sample_time_ms": 487.668, "synch_weights_time_ms": 12.914}, "counters": {"num_env_steps_sampled": 320400, "num_env_steps_trained": 320100, "num_agent_steps_sampled": 320400, "num_agent_steps_trained": 320100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2136, "num_samples_added_to_queue": 320400}, "done": false, "training_iteration": 108, "trial_id": "38f59_00000", "date": "2024-10-10_22-30-03", "timestamp": 1728595803, "time_this_iter_s": 10.071539640426636, "time_total_s": 1107.0350675582886, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2ccd90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1107.0350675582886, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 14.271428571428572, "ram_util_percent": 72.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2575.59765625, "policy_loss": 584.9511108398438, "entropy": 4.882841110229492, "entropy_coeff": 0.01, "var_gnorm": 17.849817276000977, "vf_loss": 200529.5, "vf_explained_var": 0.6372326016426086}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1077.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 323250, "num_env_steps_trained": 323100, "num_agent_steps_sampled": 323250, "num_agent_steps_trained": 323100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2155, "num_samples_added_to_queue": 323100, "learner_queue": {"size_count": 1077, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.36, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1035.475, "learner_dequeue_time_ms": 8353.394}}, "env_runners": {"episode_reward_max": 875.9866666666653, "episode_reward_min": 871.2944444444446, "episode_reward_mean": 873.6241555555548, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.2944444444446}, "policy_reward_max": {"default_policy": 875.9866666666653}, "policy_reward_mean": {"default_policy": 873.6241555555548}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.36980000000000013, "num_moves_min": 0.0, "num_moves_max": 0.61, "mean_accuracy_mean": 40.92152666666668, "mean_accuracy_min": 40.75166666666666, "mean_accuracy_max": 41.01133333333333, "num_model_switches_mean": 0.3940000000000001, "num_model_switches_min": 0.19, "num_model_switches_max": 0.64, "num_slav_mean": 0.0006773333333333334, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5114459871989337, "mean_cluster_cpu_util_min": 0.5084568969479684, "mean_cluster_cpu_util_max": 0.5141725501011215, "mean_cluster_mem_util_mean": 0.32965583333333337, "mean_cluster_mem_util_min": 0.32887394514767926, "mean_cluster_mem_util_max": 0.3301787974683544, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.092152666666667, "reward_accuracy_mean_min": 4.075166666666667, "reward_accuracy_mean_max": 4.101133333333333, "reward_sla_mean_mean": -0.022577777777777776, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.21526666666665, "reward_accuracy_sum_min": 407.5166666666667, "reward_accuracy_sum_max": 410.11333333333334, "reward_sla_sum_mean": -2.257777777777778, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4657.0, "global_timestep_min": 2500, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773, 872.5622222222216, 872.9744444444437, 871.8944444444439, 873.5444444444437, 873.9244444444438, 872.6866666666659, 873.9255555555549, 872.8155555555547, 871.9888888888881, 873.8611111111101, 872.3399999999995, 873.2288888888886, 874.0211111111104, 873.0377777777771, 872.6566666666658, 874.8766666666658, 873.6388888888877, 875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217, 873.7977777777768, 873.5133333333328, 873.2588888888882, 874.1477777777772, 872.0844444444438, 874.0844444444438, 873.256666666666, 874.2411111111103, 874.5266666666657, 874.5277777777768, 874.9411111111107, 874.8122222222214, 873.8633333333328, 873.7022222222214, 874.5277777777769, 873.5111111111105, 872.4955555555549, 874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214, 874.7166666666656, 874.4633333333326, 873.319999999999, 873.0666666666658, 873.7655555555551, 873.606666666666, 874.6544444444431, 874.4633333333323, 873.7644444444436, 875.9866666666653, 873.89111111111, 873.3533333333326, 875.0666666666657, 873.7966666666658, 873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.5466666666662, 872.4677777777773, 872.435555555555, 873.5133333333325, 872.4666666666662, 871.9588888888883, 873.1344444444441, 871.2944444444446, 872.4988888888885, 871.8644444444438, 872.1833333333328, 873.1033333333331, 873.5777777777773, 872.5622222222216, 872.9744444444437, 871.8944444444439, 873.5444444444437, 873.9244444444438, 872.6866666666659, 873.9255555555549, 872.8155555555547, 871.9888888888881, 873.8611111111101, 872.3399999999995, 873.2288888888886, 874.0211111111104, 873.0377777777771, 872.6566666666658, 874.8766666666658, 873.6388888888877, 875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217, 873.7977777777768, 873.5133333333328, 873.2588888888882, 874.1477777777772, 872.0844444444438, 874.0844444444438, 873.256666666666, 874.2411111111103, 874.5266666666657, 874.5277777777768, 874.9411111111107, 874.8122222222214, 873.8633333333328, 873.7022222222214, 874.5277777777769, 873.5111111111105, 872.4955555555549, 874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214, 874.7166666666656, 874.4633333333326, 873.319999999999, 873.0666666666658, 873.7655555555551, 873.606666666666, 874.6544444444431, 874.4633333333323, 873.7644444444436, 875.9866666666653, 873.89111111111, 873.3533333333326, 875.0666666666657, 873.7966666666658, 873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19834689761058794, "mean_inference_ms": 1.807084162931745, "mean_action_processing_ms": 0.0744255772602851, "mean_env_wait_ms": 1.2183748018410234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004143714904785156, "StateBufferConnector_ms": 0.0028815269470214844, "ViewRequirementAgentConnector_ms": 0.06717228889465332}, "num_episodes": 27, "episode_return_max": 875.9866666666653, "episode_return_min": 871.2944444444446, "episode_return_mean": 873.6241555555548, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323250, "num_agent_steps_trained": 323100, "num_env_steps_sampled": 323250, "num_env_steps_trained": 323100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 274.0782945604553, "num_env_steps_trained_throughput_per_sec": 288.50346795837396, "timesteps_total": 323250, "num_env_steps_sampled_lifetime": 323250, "num_agent_steps_sampled_lifetime": 323250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 323250, "timers": {"training_iteration_time_ms": 10305.652, "restore_workers_time_ms": 0.013, "training_step_time_ms": 519.861, "sample_time_ms": 504.749, "synch_weights_time_ms": 13.674}, "counters": {"num_env_steps_sampled": 323250, "num_env_steps_trained": 323100, "num_agent_steps_sampled": 323250, "num_agent_steps_trained": 323100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2155, "num_samples_added_to_queue": 323100}, "done": false, "training_iteration": 109, "trial_id": "38f59_00000", "date": "2024-10-10_22-30-13", "timestamp": 1728595813, "time_this_iter_s": 10.407472133636475, "time_total_s": 1117.442539691925, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18640>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1117.442539691925, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 15.173333333333336, "ram_util_percent": 72.68}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1014.0968627929688, "policy_loss": -886.673828125, "entropy": 4.820898532867432, "entropy_coeff": 0.01, "var_gnorm": 17.86781120300293, "vf_loss": 191523.34375, "vf_explained_var": 0.6426929235458374}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1087.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 326250, "num_env_steps_trained": 326100, "num_agent_steps_sampled": 326250, "num_agent_steps_trained": 326100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2175, "num_samples_added_to_queue": 326100, "learner_queue": {"size_count": 1087, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 66.514, "learner_load_time_ms": 0.287, "learner_load_wait_time_ms": 979.045, "learner_dequeue_time_ms": 8396.945}}, "env_runners": {"episode_reward_max": 875.9866666666653, "episode_reward_min": 871.7655555555547, "episode_reward_mean": 873.9243555555546, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.7655555555547}, "policy_reward_max": {"default_policy": 875.9866666666653}, "policy_reward_mean": {"default_policy": 873.9243555555546}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2275, "num_moves_min": 0.0, "num_moves_max": 0.61, "mean_accuracy_mean": 40.951546666666665, "mean_accuracy_min": 40.827666666666666, "mean_accuracy_max": 41.01133333333333, "num_model_switches_mean": 0.3602, "num_model_switches_min": 0.19, "num_model_switches_max": 0.52, "num_slav_mean": 0.0006726666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5119354083930869, "mean_cluster_cpu_util_min": 0.5094585631549917, "mean_cluster_cpu_util_max": 0.5141725501011215, "mean_cluster_mem_util_mean": 0.3297829984177216, "mean_cluster_mem_util_min": 0.32920094936708866, "mean_cluster_mem_util_max": 0.3301787974683544, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.095154666666666, "reward_accuracy_mean_min": 4.082766666666667, "reward_accuracy_mean_max": 4.101133333333333, "reward_sla_mean_mean": -0.02242222222222222, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.51546666666667, "reward_accuracy_sum_min": 408.2766666666667, "reward_accuracy_sum_max": 410.11333333333334, "reward_sla_sum_mean": -2.242222222222223, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5657.0, "global_timestep_min": 3500, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217, 873.7977777777768, 873.5133333333328, 873.2588888888882, 874.1477777777772, 872.0844444444438, 874.0844444444438, 873.256666666666, 874.2411111111103, 874.5266666666657, 874.5277777777768, 874.9411111111107, 874.8122222222214, 873.8633333333328, 873.7022222222214, 874.5277777777769, 873.5111111111105, 872.4955555555549, 874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214, 874.7166666666656, 874.4633333333326, 873.319999999999, 873.0666666666658, 873.7655555555551, 873.606666666666, 874.6544444444431, 874.4633333333323, 873.7644444444436, 875.9866666666653, 873.89111111111, 873.3533333333326, 875.0666666666657, 873.7966666666658, 873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777, 875.0977777777766, 873.2577777777768, 873.2577777777767, 874.97111111111, 874.6222222222211, 875.3844444444436, 872.4322222222216, 873.9877777777771, 874.6544444444436, 871.988888888888, 873.8599999999991, 873.1933333333325, 875.3199999999987, 873.9555555555548, 873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.0677777777769, 873.5444444444437, 872.212222222222, 873.3877777777772, 873.5133333333325, 873.5455555555549, 873.5133333333328, 874.0833333333327, 873.67111111111, 874.1788888888881, 874.0522222222212, 874.3366666666659, 872.9422222222217, 873.7977777777768, 873.5133333333328, 873.2588888888882, 874.1477777777772, 872.0844444444438, 874.0844444444438, 873.256666666666, 874.2411111111103, 874.5266666666657, 874.5277777777768, 874.9411111111107, 874.8122222222214, 873.8633333333328, 873.7022222222214, 874.5277777777769, 873.5111111111105, 872.4955555555549, 874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214, 874.7166666666656, 874.4633333333326, 873.319999999999, 873.0666666666658, 873.7655555555551, 873.606666666666, 874.6544444444431, 874.4633333333323, 873.7644444444436, 875.9866666666653, 873.89111111111, 873.3533333333326, 875.0666666666657, 873.7966666666658, 873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777, 875.0977777777766, 873.2577777777768, 873.2577777777767, 874.97111111111, 874.6222222222211, 875.3844444444436, 872.4322222222216, 873.9877777777771, 874.6544444444436, 871.988888888888, 873.8599999999991, 873.1933333333325, 875.3199999999987, 873.9555555555548, 873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1984075915582521, "mean_inference_ms": 1.8075140904057378, "mean_action_processing_ms": 0.0744423778280209, "mean_env_wait_ms": 1.2185117457083905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042455196380615234, "StateBufferConnector_ms": 0.0029129981994628906, "ViewRequirementAgentConnector_ms": 0.06855392456054688}, "num_episodes": 30, "episode_return_max": 875.9866666666653, "episode_return_min": 871.7655555555547, "episode_return_mean": 873.9243555555546, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326250, "num_agent_steps_trained": 326100, "num_env_steps_sampled": 326250, "num_env_steps_trained": 326100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 289.4407268148317, "num_env_steps_trained_throughput_per_sec": 289.4407268148317, "timesteps_total": 326250, "num_env_steps_sampled_lifetime": 326250, "num_agent_steps_sampled_lifetime": 326250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 326250, "timers": {"training_iteration_time_ms": 10297.942, "restore_workers_time_ms": 0.013, "training_step_time_ms": 485.57, "sample_time_ms": 470.59, "synch_weights_time_ms": 13.646}, "counters": {"num_env_steps_sampled": 326250, "num_env_steps_trained": 326100, "num_agent_steps_sampled": 326250, "num_agent_steps_trained": 326100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2175, "num_samples_added_to_queue": 326100}, "done": false, "training_iteration": 110, "trial_id": "38f59_00000", "date": "2024-10-10_22-30-24", "timestamp": 1728595824, "time_this_iter_s": 10.373489618301392, "time_total_s": 1127.8160293102264, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdd90f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1127.8160293102264, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 13.34, "ram_util_percent": 72.53999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1710.563232421875, "policy_loss": -403.52471923828125, "entropy": 4.681600093841553, "entropy_coeff": 0.01, "var_gnorm": 17.881040573120117, "vf_loss": 212813.296875, "vf_explained_var": 0.6285858750343323}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1096.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 329100, "num_env_steps_trained": 328800, "num_agent_steps_sampled": 329100, "num_agent_steps_trained": 328800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2194, "num_samples_added_to_queue": 329100, "learner_queue": {"size_count": 1096, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.727, "learner_load_time_ms": 0.268, "learner_load_wait_time_ms": 1001.417, "learner_dequeue_time_ms": 8420.814}}, "env_runners": {"episode_reward_max": 876.3033333333321, "episode_reward_min": 871.7655555555547, "episode_reward_mean": 874.1649777777768, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.7655555555547}, "policy_reward_max": {"default_policy": 876.3033333333321}, "policy_reward_mean": {"default_policy": 874.1649777777768}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0922, "num_moves_min": 0.0, "num_moves_max": 0.54, "mean_accuracy_mean": 40.97738666666667, "mean_accuracy_min": 40.903666666666666, "mean_accuracy_max": 41.055666666666674, "num_model_switches_mean": 0.31909999999999994, "num_model_switches_min": 0.14, "num_model_switches_max": 0.52, "num_slav_mean": 0.000678, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5123651616795367, "mean_cluster_cpu_util_min": 0.5104540701415702, "mean_cluster_cpu_util_max": 0.5149942199852914, "mean_cluster_mem_util_mean": 0.3299018064345992, "mean_cluster_mem_util_min": 0.32925342827004217, "mean_cluster_mem_util_max": 0.3302837552742615, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.097738666666666, "reward_accuracy_mean_min": 4.090366666666667, "reward_accuracy_mean_max": 4.105566666666666, "reward_sla_mean_mean": -0.022600000000000002, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.77386666666666, "reward_accuracy_sum_min": 409.0366666666667, "reward_accuracy_sum_max": 410.5566666666667, "reward_sla_sum_mean": -2.2600000000000002, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5487.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214, 874.7166666666656, 874.4633333333326, 873.319999999999, 873.0666666666658, 873.7655555555551, 873.606666666666, 874.6544444444431, 874.4633333333323, 873.7644444444436, 875.9866666666653, 873.89111111111, 873.3533333333326, 875.0666666666657, 873.7966666666658, 873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777, 875.0977777777766, 873.2577777777768, 873.2577777777767, 874.97111111111, 874.6222222222211, 875.3844444444436, 872.4322222222216, 873.9877777777771, 874.6544444444436, 871.988888888888, 873.8599999999991, 873.1933333333325, 875.3199999999987, 873.9555555555548, 873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326, 873.4788888888878, 875.129999999999, 873.8288888888881, 874.4955555555546, 874.779999999999, 874.6844444444431, 874.81111111111, 875.6366666666654, 874.5566666666656, 874.0177777777769, 874.8755555555549, 873.7966666666659, 873.6377777777768, 875.35111111111, 873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.1133333333322, 873.7966666666658, 874.2099999999989, 874.9722222222214, 872.0833333333326, 873.2588888888882, 873.0999999999993, 873.9877777777767, 874.655555555555, 873.606666666666, 873.51111111111, 874.9711111111101, 874.4322222222214, 874.7166666666656, 874.4633333333326, 873.319999999999, 873.0666666666658, 873.7655555555551, 873.606666666666, 874.6544444444431, 874.4633333333323, 873.7644444444436, 875.9866666666653, 873.89111111111, 873.3533333333326, 875.0666666666657, 873.7966666666658, 873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777, 875.0977777777766, 873.2577777777768, 873.2577777777767, 874.97111111111, 874.6222222222211, 875.3844444444436, 872.4322222222216, 873.9877777777771, 874.6544444444436, 871.988888888888, 873.8599999999991, 873.1933333333325, 875.3199999999987, 873.9555555555548, 873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326, 873.4788888888878, 875.129999999999, 873.8288888888881, 874.4955555555546, 874.779999999999, 874.6844444444431, 874.81111111111, 875.6366666666654, 874.5566666666656, 874.0177777777769, 874.8755555555549, 873.7966666666659, 873.6377777777768, 875.35111111111, 873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19848740570817655, "mean_inference_ms": 1.8080112438490088, "mean_action_processing_ms": 0.07446215998879638, "mean_env_wait_ms": 1.2186869959470281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042514801025390625, "StateBufferConnector_ms": 0.002909421920776367, "ViewRequirementAgentConnector_ms": 0.06832194328308105}, "num_episodes": 30, "episode_return_max": 876.3033333333321, "episode_return_min": 871.7655555555547, "episode_return_mean": 874.1649777777768, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329100, "num_agent_steps_trained": 328800, "num_env_steps_sampled": 329100, "num_env_steps_trained": 328800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 282.3629121232077, "num_env_steps_trained_throughput_per_sec": 267.50170622198624, "timesteps_total": 329100, "num_env_steps_sampled_lifetime": 329100, "num_agent_steps_sampled_lifetime": 329100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 329100, "timers": {"training_iteration_time_ms": 10271.61, "restore_workers_time_ms": 0.012, "training_step_time_ms": 503.766, "sample_time_ms": 489.561, "synch_weights_time_ms": 12.909}, "counters": {"num_env_steps_sampled": 329100, "num_env_steps_trained": 328800, "num_agent_steps_sampled": 329100, "num_agent_steps_trained": 328800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2194, "num_samples_added_to_queue": 329100}, "done": false, "training_iteration": 111, "trial_id": "38f59_00000", "date": "2024-10-10_22-30-34", "timestamp": 1728595834, "time_this_iter_s": 10.102765560150146, "time_total_s": 1137.9187948703766, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc4f70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1137.9187948703766, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 13.814285714285713, "ram_util_percent": 72.58571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1131.980712890625, "policy_loss": -987.642333984375, "entropy": 4.670474052429199, "entropy_coeff": 0.01, "var_gnorm": 17.849153518676758, "vf_loss": 213363.46875, "vf_explained_var": 0.6278085708618164}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1106.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 331950, "num_env_steps_trained": 331800, "num_agent_steps_sampled": 331950, "num_agent_steps_trained": 331800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2213, "num_samples_added_to_queue": 331800, "learner_queue": {"size_count": 1106, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.208, "learner_load_time_ms": 0.266, "learner_load_wait_time_ms": 1029.254, "learner_dequeue_time_ms": 8497.568}}, "env_runners": {"episode_reward_max": 876.3033333333321, "episode_reward_min": 871.7655555555547, "episode_reward_mean": 874.2593222222213, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.7655555555547}, "policy_reward_max": {"default_policy": 876.3033333333321}, "policy_reward_mean": {"default_policy": 874.2593222222213}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0233, "num_moves_min": 0.0, "num_moves_max": 0.26, "mean_accuracy_mean": 40.98771, "mean_accuracy_min": 40.903666666666666, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 0.297, "num_model_switches_min": 0.12, "num_model_switches_max": 0.45, "num_slav_mean": 0.0006806666666666667, "num_slav_min": 0.0002, "num_slav_max": 0.0011333333333333332, "mean_cluster_cpu_util_mean": 0.5125526398464791, "mean_cluster_cpu_util_min": 0.5108346203346203, "mean_cluster_cpu_util_max": 0.5149942199852914, "mean_cluster_mem_util_mean": 0.3299495385021098, "mean_cluster_mem_util_min": 0.32925342827004217, "mean_cluster_mem_util_max": 0.3303401898734178, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.098771, "reward_accuracy_mean_min": 4.090366666666667, "reward_accuracy_mean_max": 4.1062, "reward_sla_mean_mean": -0.022688888888888887, "reward_sla_mean_min": -0.03777777777777778, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.87710000000004, "reward_accuracy_sum_min": 409.0366666666667, "reward_accuracy_sum_max": 410.62000000000006, "reward_sla_sum_mean": -2.2688888888888896, "reward_sla_sum_min": -3.777777777777778, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4287.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777, 875.0977777777766, 873.2577777777768, 873.2577777777767, 874.97111111111, 874.6222222222211, 875.3844444444436, 872.4322222222216, 873.9877777777771, 874.6544444444436, 871.988888888888, 873.8599999999991, 873.1933333333325, 875.3199999999987, 873.9555555555548, 873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326, 873.4788888888878, 875.129999999999, 873.8288888888881, 874.4955555555546, 874.779999999999, 874.6844444444431, 874.81111111111, 875.6366666666654, 874.5566666666656, 874.0177777777769, 874.8755555555549, 873.7966666666659, 873.6377777777768, 875.35111111111, 873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768, 874.6533333333323, 874.748888888888, 874.6855555555549, 873.9544444444432, 874.3988888888879, 873.35111111111, 874.3355555555545, 875.0966666666654, 875.2866666666655, 873.9544444444435, 874.8122222222212, 874.1777777777768, 873.859999999999, 873.3522222222213, 873.5422222222217, 874.5577777777767, 875.6688888888876, 874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.7644444444435, 874.2411111111102, 874.7166666666657, 874.0511111111101, 874.9388888888876, 873.098888888888, 873.2888888888879, 873.4166666666657, 874.1466666666657, 873.0033333333325, 874.4311111111102, 875.1611111111101, 874.177777777777, 875.0977777777766, 873.2577777777768, 873.2577777777767, 874.97111111111, 874.6222222222211, 875.3844444444436, 872.4322222222216, 873.9877777777771, 874.6544444444436, 871.988888888888, 873.8599999999991, 873.1933333333325, 875.3199999999987, 873.9555555555548, 873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326, 873.4788888888878, 875.129999999999, 873.8288888888881, 874.4955555555546, 874.779999999999, 874.6844444444431, 874.81111111111, 875.6366666666654, 874.5566666666656, 874.0177777777769, 874.8755555555549, 873.7966666666659, 873.6377777777768, 875.35111111111, 873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768, 874.6533333333323, 874.748888888888, 874.6855555555549, 873.9544444444432, 874.3988888888879, 873.35111111111, 874.3355555555545, 875.0966666666654, 875.2866666666655, 873.9544444444435, 874.8122222222212, 874.1777777777768, 873.859999999999, 873.3522222222213, 873.5422222222217, 874.5577777777767, 875.6688888888876, 874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19857723372145963, "mean_inference_ms": 1.8085809187484383, "mean_action_processing_ms": 0.07448536428222961, "mean_env_wait_ms": 1.2189359654124365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004578113555908203, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.06862759590148926}, "num_episodes": 27, "episode_return_max": 876.3033333333321, "episode_return_min": 871.7655555555547, "episode_return_mean": 874.2593222222213, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 331950, "num_agent_steps_trained": 331800, "num_env_steps_sampled": 331950, "num_env_steps_trained": 331800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 273.97761595348237, "num_env_steps_trained_throughput_per_sec": 288.3974904773499, "timesteps_total": 331950, "num_env_steps_sampled_lifetime": 331950, "num_agent_steps_sampled_lifetime": 331950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 331950, "timers": {"training_iteration_time_ms": 10261.822, "restore_workers_time_ms": 0.012, "training_step_time_ms": 546.504, "sample_time_ms": 531.709, "synch_weights_time_ms": 13.42}, "counters": {"num_env_steps_sampled": 331950, "num_env_steps_trained": 331800, "num_agent_steps_sampled": 331950, "num_agent_steps_trained": 331800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2213, "num_samples_added_to_queue": 331800}, "done": false, "training_iteration": 112, "trial_id": "38f59_00000", "date": "2024-10-10_22-30-44", "timestamp": 1728595844, "time_this_iter_s": 10.418447017669678, "time_total_s": 1148.3372418880463, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde48b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1148.3372418880463, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 13.666666666666664, "ram_util_percent": 72.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1996.3721923828125, "policy_loss": 235.30294799804688, "entropy": 4.936217784881592, "entropy_coeff": 0.01, "var_gnorm": 17.823131561279297, "vf_loss": 177587.796875, "vf_explained_var": 0.6529157161712646}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1115.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 334650, "num_env_steps_trained": 334500, "num_agent_steps_sampled": 334650, "num_agent_steps_trained": 334500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2231, "num_samples_added_to_queue": 334500, "learner_queue": {"size_count": 1115, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.885, "learner_load_time_ms": 0.243, "learner_load_wait_time_ms": 1090.335, "learner_dequeue_time_ms": 8541.385}}, "env_runners": {"episode_reward_max": 876.3033333333321, "episode_reward_min": 871.7655555555547, "episode_reward_mean": 874.2930555555546, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.7655555555547}, "policy_reward_max": {"default_policy": 876.3033333333321}, "policy_reward_mean": {"default_policy": 874.2930555555546}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.008600000000000002, "num_moves_min": 0.0, "num_moves_max": 0.12, "mean_accuracy_mean": 40.98441666666667, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 0.2961, "num_model_switches_min": 0.12, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006606666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.0010666666666666665, "mean_cluster_cpu_util_mean": 0.5125419765811731, "mean_cluster_cpu_util_min": 0.5097545619599191, "mean_cluster_cpu_util_max": 0.5149942199852914, "mean_cluster_mem_util_mean": 0.32993721782700414, "mean_cluster_mem_util_min": 0.3292315400843881, "mean_cluster_mem_util_max": 0.3303401898734178, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.098441666666667, "reward_accuracy_mean_min": 4.0815, "reward_accuracy_mean_max": 4.1062, "reward_sla_mean_mean": -0.022022222222222228, "reward_sla_mean_min": -0.035555555555555556, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.84416666666664, "reward_accuracy_sum_min": 408.15000000000003, "reward_accuracy_sum_max": 410.62000000000006, "reward_sla_sum_mean": -2.2022222222222223, "reward_sla_sum_min": -3.555555555555556, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3076.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326, 873.4788888888878, 875.129999999999, 873.8288888888881, 874.4955555555546, 874.779999999999, 874.6844444444431, 874.81111111111, 875.6366666666654, 874.5566666666656, 874.0177777777769, 874.8755555555549, 873.7966666666659, 873.6377777777768, 875.35111111111, 873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768, 874.6533333333323, 874.748888888888, 874.6855555555549, 873.9544444444432, 874.3988888888879, 873.35111111111, 874.3355555555545, 875.0966666666654, 875.2866666666655, 873.9544444444435, 874.8122222222212, 874.1777777777768, 873.859999999999, 873.3522222222213, 873.5422222222217, 874.5577777777767, 875.6688888888876, 874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657, 875.7955555555543, 875.5733333333321, 874.1444444444435, 873.447777777777, 874.208888888888, 875.3844444444437, 873.354444444444, 874.8444444444436, 872.9744444444437, 874.2088888888877, 873.8277777777768, 875.6366666666656, 874.7177777777769, 873.3833333333323, 873.2899999999989, 874.7511111111103, 873.1311111111105, 872.8166666666664, 874.4622222222212, 874.1133333333327, 875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.9566666666659, 874.1477777777769, 874.1144444444436, 875.1611111111102, 873.7977777777771, 874.3055555555546, 873.0044444444438, 874.05111111111, 873.8933333333325, 873.4155555555546, 871.7655555555547, 873.8611111111101, 873.7666666666661, 874.4633333333323, 873.8922222222216, 874.4633333333326, 873.4788888888878, 875.129999999999, 873.8288888888881, 874.4955555555546, 874.779999999999, 874.6844444444431, 874.81111111111, 875.6366666666654, 874.5566666666656, 874.0177777777769, 874.8755555555549, 873.7966666666659, 873.6377777777768, 875.35111111111, 873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768, 874.6533333333323, 874.748888888888, 874.6855555555549, 873.9544444444432, 874.3988888888879, 873.35111111111, 874.3355555555545, 875.0966666666654, 875.2866666666655, 873.9544444444435, 874.8122222222212, 874.1777777777768, 873.859999999999, 873.3522222222213, 873.5422222222217, 874.5577777777767, 875.6688888888876, 874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657, 875.7955555555543, 875.5733333333321, 874.1444444444435, 873.447777777777, 874.208888888888, 875.3844444444437, 873.354444444444, 874.8444444444436, 872.9744444444437, 874.2088888888877, 873.8277777777768, 875.6366666666656, 874.7177777777769, 873.3833333333323, 873.2899999999989, 874.7511111111103, 873.1311111111105, 872.8166666666664, 874.4622222222212, 874.1133333333327, 875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19865362049690297, "mean_inference_ms": 1.8080703960051818, "mean_action_processing_ms": 0.07450771990406428, "mean_env_wait_ms": 1.219052084127394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004975318908691406, "StateBufferConnector_ms": 0.0029861927032470703, "ViewRequirementAgentConnector_ms": 0.07091403007507324}, "num_episodes": 27, "episode_return_max": 876.3033333333321, "episode_return_min": 871.7655555555547, "episode_return_mean": 874.2930555555546, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 334650, "num_agent_steps_trained": 334500, "num_env_steps_sampled": 334650, "num_env_steps_trained": 334500, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 264.594333398201, "num_env_steps_trained_throughput_per_sec": 264.594333398201, "timesteps_total": 334650, "num_env_steps_sampled_lifetime": 334650, "num_agent_steps_sampled_lifetime": 334650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 334650, "timers": {"training_iteration_time_ms": 10255.531, "restore_workers_time_ms": 0.013, "training_step_time_ms": 569.035, "sample_time_ms": 553.106, "synch_weights_time_ms": 14.55}, "counters": {"num_env_steps_sampled": 334650, "num_env_steps_trained": 334500, "num_agent_steps_sampled": 334650, "num_agent_steps_trained": 334500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2231, "num_samples_added_to_queue": 334500}, "done": false, "training_iteration": 113, "trial_id": "38f59_00000", "date": "2024-10-10_22-30-55", "timestamp": 1728595855, "time_this_iter_s": 10.219038963317871, "time_total_s": 1158.5562808513641, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2ccf70>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1158.5562808513641, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 15.340000000000002, "ram_util_percent": 73.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 945.9257202148438, "policy_loss": -705.0450439453125, "entropy": 4.954979419708252, "entropy_coeff": 0.01, "var_gnorm": 17.827747344970703, "vf_loss": 166583.578125, "vf_explained_var": 0.6580064296722412}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1125.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 337650, "num_env_steps_trained": 337500, "num_agent_steps_sampled": 337650, "num_agent_steps_trained": 337500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2251, "num_samples_added_to_queue": 337500, "learner_queue": {"size_count": 1125, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.4, "learner_load_time_ms": 0.239, "learner_load_wait_time_ms": 975.05, "learner_dequeue_time_ms": 8555.809}}, "env_runners": {"episode_reward_max": 876.3033333333321, "episode_reward_min": 870.2155555555553, "episode_reward_mean": 873.708199999999, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 870.2155555555553}, "policy_reward_max": {"default_policy": 876.3033333333321}, "policy_reward_mean": {"default_policy": 873.708199999999}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.004, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.92482, "mean_accuracy_min": 40.694666666666656, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 0.34309999999999996, "num_model_switches_min": 0.12, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006573333333333331, "num_slav_min": 0.0002, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5116338281722593, "mean_cluster_cpu_util_min": 0.5070563867438866, "mean_cluster_cpu_util_max": 0.5149942199852914, "mean_cluster_mem_util_mean": 0.3296929204609058, "mean_cluster_mem_util_min": 0.3286007383966244, "mean_cluster_mem_util_max": 0.3303401898734178, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.092482, "reward_accuracy_mean_min": 4.069466666666667, "reward_accuracy_mean_max": 4.1062, "reward_sla_mean_mean": -0.021911111111111107, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.2482, "reward_accuracy_sum_min": 406.9466666666667, "reward_accuracy_sum_max": 410.62000000000006, "reward_sla_sum_mean": -2.1911111111111112, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2126.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768, 874.6533333333323, 874.748888888888, 874.6855555555549, 873.9544444444432, 874.3988888888879, 873.35111111111, 874.3355555555545, 875.0966666666654, 875.2866666666655, 873.9544444444435, 874.8122222222212, 874.1777777777768, 873.859999999999, 873.3522222222213, 873.5422222222217, 874.5577777777767, 875.6688888888876, 874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657, 875.7955555555543, 875.5733333333321, 874.1444444444435, 873.447777777777, 874.208888888888, 875.3844444444437, 873.354444444444, 874.8444444444436, 872.9744444444437, 874.2088888888877, 873.8277777777768, 875.6366666666656, 874.7177777777769, 873.3833333333323, 873.2899999999989, 874.7511111111103, 873.1311111111105, 872.8166666666664, 874.4622222222212, 874.1133333333327, 875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545, 872.0866666666662, 873.7999999999994, 873.3566666666662, 871.8022222222221, 872.7544444444441, 870.6588888888884, 872.3099999999995, 873.0722222222222, 872.4999999999997, 872.4688888888886, 873.1011111111105, 872.9755555555549, 871.7066666666661, 873.0066666666664, 871.771111111111, 870.787777777778, 872.5966666666666, 870.7244444444448, 871.294444444444, 870.5333333333334, 873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.9544444444437, 875.4144444444431, 874.5577777777766, 874.3988888888877, 876.3033333333321, 874.08111111111, 873.6066666666657, 873.7655555555546, 873.4788888888878, 875.4144444444435, 874.3366666666653, 874.2399999999989, 874.6844444444432, 875.2877777777769, 874.779999999999, 876.0177777777768, 874.6533333333323, 874.748888888888, 874.6855555555549, 873.9544444444432, 874.3988888888879, 873.35111111111, 874.3355555555545, 875.0966666666654, 875.2866666666655, 873.9544444444435, 874.8122222222212, 874.1777777777768, 873.859999999999, 873.3522222222213, 873.5422222222217, 874.5577777777767, 875.6688888888876, 874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657, 875.7955555555543, 875.5733333333321, 874.1444444444435, 873.447777777777, 874.208888888888, 875.3844444444437, 873.354444444444, 874.8444444444436, 872.9744444444437, 874.2088888888877, 873.8277777777768, 875.6366666666656, 874.7177777777769, 873.3833333333323, 873.2899999999989, 874.7511111111103, 873.1311111111105, 872.8166666666664, 874.4622222222212, 874.1133333333327, 875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545, 872.0866666666662, 873.7999999999994, 873.3566666666662, 871.8022222222221, 872.7544444444441, 870.6588888888884, 872.3099999999995, 873.0722222222222, 872.4999999999997, 872.4688888888886, 873.1011111111105, 872.9755555555549, 871.7066666666661, 873.0066666666664, 871.771111111111, 870.787777777778, 872.5966666666666, 870.7244444444448, 871.294444444444, 870.5333333333334, 873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1987523985258145, "mean_inference_ms": 1.8087670197605425, "mean_action_processing_ms": 0.07454334387359338, "mean_env_wait_ms": 1.2193763333241205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050907135009765625, "StateBufferConnector_ms": 0.0029306411743164062, "ViewRequirementAgentConnector_ms": 0.06999754905700684}, "num_episodes": 30, "episode_return_max": 876.3033333333321, "episode_return_min": 870.2155555555553, "episode_return_mean": 873.708199999999, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 337650, "num_agent_steps_trained": 337500, "num_env_steps_sampled": 337650, "num_env_steps_trained": 337500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 292.10682061080024, "num_env_steps_trained_throughput_per_sec": 292.10682061080024, "timesteps_total": 337650, "num_env_steps_sampled_lifetime": 337650, "num_agent_steps_sampled_lifetime": 337650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 337650, "timers": {"training_iteration_time_ms": 10260.617, "restore_workers_time_ms": 0.012, "training_step_time_ms": 505.465, "sample_time_ms": 491.214, "synch_weights_time_ms": 12.961}, "counters": {"num_env_steps_sampled": 337650, "num_env_steps_trained": 337500, "num_agent_steps_sampled": 337650, "num_agent_steps_trained": 337500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2251, "num_samples_added_to_queue": 337500}, "done": false, "training_iteration": 114, "trial_id": "38f59_00000", "date": "2024-10-10_22-31-05", "timestamp": 1728595865, "time_this_iter_s": 10.280961036682129, "time_total_s": 1168.8372418880463, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cd5a0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1168.8372418880463, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 12.773333333333332, "ram_util_percent": 73.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1850.509521484375, "policy_loss": 74.12164306640625, "entropy": 4.652345180511475, "entropy_coeff": 0.01, "var_gnorm": 17.849044799804688, "vf_loss": 179034.5, "vf_explained_var": 0.6492354869842529}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1135.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 340800, "num_env_steps_trained": 340500, "num_agent_steps_sampled": 340800, "num_agent_steps_trained": 340500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2272, "num_samples_added_to_queue": 340800, "learner_queue": {"size_count": 1135, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.809, "learner_load_time_ms": 0.248, "learner_load_wait_time_ms": 941.6, "learner_dequeue_time_ms": 8529.019}}, "env_runners": {"episode_reward_max": 875.7955555555543, "episode_reward_min": 870.2155555555553, "episode_reward_mean": 873.4342222222215, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 870.2155555555553}, "policy_reward_max": {"default_policy": 875.7955555555543}, "policy_reward_mean": {"default_policy": 873.4342222222215}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0024, "num_moves_min": 0.0, "num_moves_max": 0.04, "mean_accuracy_mean": 40.89986666666667, "mean_accuracy_min": 40.694666666666656, "mean_accuracy_max": 41.049333333333344, "num_model_switches_mean": 0.3813, "num_model_switches_min": 0.14, "num_model_switches_max": 0.55, "num_slav_mean": 0.0006646666666666666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5112292209374734, "mean_cluster_cpu_util_min": 0.5070563867438866, "mean_cluster_cpu_util_max": 0.5152485291413863, "mean_cluster_mem_util_mean": 0.32957877489128573, "mean_cluster_mem_util_min": 0.3286007383966244, "mean_cluster_mem_util_max": 0.33039451476793247, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.089986666666666, "reward_accuracy_mean_min": 4.069466666666667, "reward_accuracy_mean_max": 4.104933333333333, "reward_sla_mean_mean": -0.022155555555555553, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.9986666666667, "reward_accuracy_sum_min": 406.9466666666667, "reward_accuracy_sum_max": 410.49333333333334, "reward_sla_sum_mean": -2.2155555555555555, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2759.0, "global_timestep_min": 600, "global_timestep_max": 4400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657, 875.7955555555543, 875.5733333333321, 874.1444444444435, 873.447777777777, 874.208888888888, 875.3844444444437, 873.354444444444, 874.8444444444436, 872.9744444444437, 874.2088888888877, 873.8277777777768, 875.6366666666656, 874.7177777777769, 873.3833333333323, 873.2899999999989, 874.7511111111103, 873.1311111111105, 872.8166666666664, 874.4622222222212, 874.1133333333327, 875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545, 872.0866666666662, 873.7999999999994, 873.3566666666662, 871.8022222222221, 872.7544444444441, 870.6588888888884, 872.3099999999995, 873.0722222222222, 872.4999999999997, 872.4688888888886, 873.1011111111105, 872.9755555555549, 871.7066666666661, 873.0066666666664, 871.771111111111, 870.787777777778, 872.5966666666666, 870.7244444444448, 871.294444444444, 870.5333333333334, 873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437, 872.0866666666662, 874.116666666666, 872.6266666666662, 873.7355555555546, 873.6399999999993, 872.6222222222214, 873.7966666666657, 873.5111111111102, 873.9866666666655, 874.5577777777768, 875.192222222221, 873.8944444444436, 872.5299999999995, 873.385555555555, 873.3866666666662, 872.6566666666661, 872.1799999999992, 873.4799999999992, 874.6855555555546, 873.7644444444435, 875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.2088888888879, 873.7011111111102, 874.9388888888876, 873.289999999999, 874.4955555555546, 874.9077777777767, 873.5099999999989, 874.7477777777768, 874.7155555555544, 875.0966666666657, 875.7955555555543, 875.5733333333321, 874.1444444444435, 873.447777777777, 874.208888888888, 875.3844444444437, 873.354444444444, 874.8444444444436, 872.9744444444437, 874.2088888888877, 873.8277777777768, 875.6366666666656, 874.7177777777769, 873.3833333333323, 873.2899999999989, 874.7511111111103, 873.1311111111105, 872.8166666666664, 874.4622222222212, 874.1133333333327, 875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545, 872.0866666666662, 873.7999999999994, 873.3566666666662, 871.8022222222221, 872.7544444444441, 870.6588888888884, 872.3099999999995, 873.0722222222222, 872.4999999999997, 872.4688888888886, 873.1011111111105, 872.9755555555549, 871.7066666666661, 873.0066666666664, 871.771111111111, 870.787777777778, 872.5966666666666, 870.7244444444448, 871.294444444444, 870.5333333333334, 873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437, 872.0866666666662, 874.116666666666, 872.6266666666662, 873.7355555555546, 873.6399999999993, 872.6222222222214, 873.7966666666657, 873.5111111111102, 873.9866666666655, 874.5577777777768, 875.192222222221, 873.8944444444436, 872.5299999999995, 873.385555555555, 873.3866666666662, 872.6566666666661, 872.1799999999992, 873.4799999999992, 874.6855555555546, 873.7644444444435, 875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19886790194959503, "mean_inference_ms": 1.8116020343081276, "mean_action_processing_ms": 0.07459316345299731, "mean_env_wait_ms": 1.2199452382773759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004835367202758789, "StateBufferConnector_ms": 0.0029022693634033203, "ViewRequirementAgentConnector_ms": 0.06933832168579102}, "num_episodes": 33, "episode_return_max": 875.7955555555543, "episode_return_min": 870.2155555555553, "episode_return_mean": 873.4342222222215, "episodes_this_iter": 33}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340800, "num_agent_steps_trained": 340500, "num_env_steps_sampled": 340800, "num_env_steps_trained": 340500, "num_env_steps_sampled_this_iter": 3150, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 299.25508639695863, "num_env_steps_trained_throughput_per_sec": 285.00484418757964, "timesteps_total": 340800, "num_env_steps_sampled_lifetime": 340800, "num_agent_steps_sampled_lifetime": 340800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 340800, "timers": {"training_iteration_time_ms": 10285.075, "restore_workers_time_ms": 0.014, "training_step_time_ms": 515.49, "sample_time_ms": 500.464, "synch_weights_time_ms": 13.652}, "counters": {"num_env_steps_sampled": 340800, "num_env_steps_trained": 340500, "num_agent_steps_sampled": 340800, "num_agent_steps_trained": 340500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2272, "num_samples_added_to_queue": 340800}, "done": false, "training_iteration": 115, "trial_id": "38f59_00000", "date": "2024-10-10_22-31-15", "timestamp": 1728595875, "time_this_iter_s": 10.542003631591797, "time_total_s": 1179.379245519638, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cc5e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1179.379245519638, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 11.273333333333333, "ram_util_percent": 73.23333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2734.135498046875, "policy_loss": 690.998046875, "entropy": 4.457010269165039, "entropy_coeff": 0.01, "var_gnorm": 17.86473274230957, "vf_loss": 205650.859375, "vf_explained_var": 0.6338030099868774}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1145.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 343800, "num_env_steps_trained": 343500, "num_agent_steps_sampled": 343800, "num_agent_steps_trained": 343500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2292, "num_samples_added_to_queue": 343800, "learner_queue": {"size_count": 1145, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.58, "learner_load_time_ms": 0.217, "learner_load_wait_time_ms": 956.561, "learner_dequeue_time_ms": 8484.483}}, "env_runners": {"episode_reward_max": 876.3655555555541, "episode_reward_min": 870.2155555555553, "episode_reward_mean": 873.7290666666659, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 870.2155555555553}, "policy_reward_max": {"default_policy": 876.3655555555541}, "policy_reward_mean": {"default_policy": 873.7290666666659}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.04, "mean_accuracy_mean": 40.92824000000001, "mean_accuracy_min": 40.694666666666656, "mean_accuracy_max": 41.09366666666667, "num_model_switches_mean": 0.31639999999999996, "num_model_switches_min": 0.02, "num_model_switches_max": 0.55, "num_slav_mean": 0.0006613333333333333, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5116506859356349, "mean_cluster_cpu_util_min": 0.5070563867438866, "mean_cluster_cpu_util_max": 0.5155117553778268, "mean_cluster_mem_util_mean": 0.3296979890263067, "mean_cluster_mem_util_min": 0.3286007383966244, "mean_cluster_mem_util_max": 0.3304941983122363, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.092823999999999, "reward_accuracy_mean_min": 4.069466666666667, "reward_accuracy_mean_max": 4.109366666666667, "reward_sla_mean_mean": -0.022044444444444443, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.011111111111111112, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.2824, "reward_accuracy_sum_min": 406.9466666666667, "reward_accuracy_sum_max": 410.9366666666667, "reward_sla_sum_mean": -2.2044444444444444, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -1.1111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3767.0, "global_timestep_min": 1700, "global_timestep_max": 5400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545, 872.0866666666662, 873.7999999999994, 873.3566666666662, 871.8022222222221, 872.7544444444441, 870.6588888888884, 872.3099999999995, 873.0722222222222, 872.4999999999997, 872.4688888888886, 873.1011111111105, 872.9755555555549, 871.7066666666661, 873.0066666666664, 871.771111111111, 870.787777777778, 872.5966666666666, 870.7244444444448, 871.294444444444, 870.5333333333334, 873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437, 872.0866666666662, 874.116666666666, 872.6266666666662, 873.7355555555546, 873.6399999999993, 872.6222222222214, 873.7966666666657, 873.5111111111102, 873.9866666666655, 874.5577777777768, 875.192222222221, 873.8944444444436, 872.5299999999995, 873.385555555555, 873.3866666666662, 872.6566666666661, 872.1799999999992, 873.4799999999992, 874.6855555555546, 873.7644444444435, 875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764, 875.7944444444431, 874.9377777777767, 875.2233333333319, 875.5088888888877, 873.7944444444432, 875.9211111111098, 875.762222222221, 875.7311111111098, 875.3177777777764, 874.4922222222209, 875.953333333332, 874.683333333332, 875.4455555555544, 875.5399999999988, 874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.0655555555545, 874.8755555555546, 873.5122222222216, 873.3211111111104, 874.2422222222215, 873.164444444444, 873.5455555555545, 872.0866666666662, 873.7999999999994, 873.3566666666662, 871.8022222222221, 872.7544444444441, 870.6588888888884, 872.3099999999995, 873.0722222222222, 872.4999999999997, 872.4688888888886, 873.1011111111105, 872.9755555555549, 871.7066666666661, 873.0066666666664, 871.771111111111, 870.787777777778, 872.5966666666666, 870.7244444444448, 871.294444444444, 870.5333333333334, 873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437, 872.0866666666662, 874.116666666666, 872.6266666666662, 873.7355555555546, 873.6399999999993, 872.6222222222214, 873.7966666666657, 873.5111111111102, 873.9866666666655, 874.5577777777768, 875.192222222221, 873.8944444444436, 872.5299999999995, 873.385555555555, 873.3866666666662, 872.6566666666661, 872.1799999999992, 873.4799999999992, 874.6855555555546, 873.7644444444435, 875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764, 875.7944444444431, 874.9377777777767, 875.2233333333319, 875.5088888888877, 873.7944444444432, 875.9211111111098, 875.762222222221, 875.7311111111098, 875.3177777777764, 874.4922222222209, 875.953333333332, 874.683333333332, 875.4455555555544, 875.5399999999988, 874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890637686309373, "mean_inference_ms": 1.812879012255495, "mean_action_processing_ms": 0.07460055974914388, "mean_env_wait_ms": 1.2200788128359654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004246234893798828, "StateBufferConnector_ms": 0.0027735233306884766, "ViewRequirementAgentConnector_ms": 0.06555843353271484}, "num_episodes": 30, "episode_return_max": 876.3655555555541, "episode_return_min": 870.2155555555553, "episode_return_mean": 873.7290666666659, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 343800, "num_agent_steps_trained": 343500, "num_env_steps_sampled": 343800, "num_env_steps_trained": 343500, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 295.94343454318357, "num_env_steps_trained_throughput_per_sec": 295.94343454318357, "timesteps_total": 343800, "num_env_steps_sampled_lifetime": 343800, "num_agent_steps_sampled_lifetime": 343800, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 343800, "timers": {"training_iteration_time_ms": 10266.26, "restore_workers_time_ms": 0.012, "training_step_time_ms": 499.573, "sample_time_ms": 485.36, "synch_weights_time_ms": 12.831}, "counters": {"num_env_steps_sampled": 343800, "num_env_steps_trained": 343500, "num_agent_steps_sampled": 343800, "num_agent_steps_trained": 343500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2292, "num_samples_added_to_queue": 343800}, "done": false, "training_iteration": 116, "trial_id": "38f59_00000", "date": "2024-10-10_22-31-26", "timestamp": 1728595886, "time_this_iter_s": 10.15099310874939, "time_total_s": 1189.5302386283875, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cfdf0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1189.5302386283875, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 11.507142857142856, "ram_util_percent": 73.42142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1926.026611328125, "policy_loss": -39.394874572753906, "entropy": 4.584227085113525, "entropy_coeff": 0.01, "var_gnorm": 17.88681411743164, "vf_loss": 197917.421875, "vf_explained_var": 0.638558030128479}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1155.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 346650, "num_env_steps_trained": 346500, "num_agent_steps_sampled": 346650, "num_agent_steps_trained": 346500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2311, "num_samples_added_to_queue": 346500, "learner_queue": {"size_count": 1155, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.076, "learner_load_time_ms": 0.191, "learner_load_wait_time_ms": 1005.821, "learner_dequeue_time_ms": 8478.306}}, "env_runners": {"episode_reward_max": 876.5877777777764, "episode_reward_min": 870.2155555555553, "episode_reward_mean": 874.3418777777769, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 870.2155555555553}, "policy_reward_max": {"default_policy": 876.5877777777764}, "policy_reward_mean": {"default_policy": 874.3418777777769}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0012, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.999743333333335, "mean_accuracy_min": 40.69466666666666, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.2119, "num_model_switches_min": 0.0, "num_model_switches_max": 0.55, "num_slav_mean": 0.000692, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0016666666666666666, "mean_cluster_cpu_util_mean": 0.5127153067298986, "mean_cluster_cpu_util_min": 0.5072602385548813, "mean_cluster_cpu_util_max": 0.515664184592756, "mean_cluster_mem_util_mean": 0.32999630653685535, "mean_cluster_mem_util_min": 0.3286091772151899, "mean_cluster_mem_util_max": 0.3305864978902954, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.099974333333334, "reward_accuracy_mean_min": 4.069466666666667, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.023066666666666666, "reward_sla_mean_min": -0.05555555555555556, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.9974333333334, "reward_accuracy_sum_min": 406.9466666666667, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.3066666666666666, "reward_sla_sum_min": -5.555555555555556, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4650.0, "global_timestep_min": 2400, "global_timestep_max": 6300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437, 872.0866666666662, 874.116666666666, 872.6266666666662, 873.7355555555546, 873.6399999999993, 872.6222222222214, 873.7966666666657, 873.5111111111102, 873.9866666666655, 874.5577777777768, 875.192222222221, 873.8944444444436, 872.5299999999995, 873.385555555555, 873.3866666666662, 872.6566666666661, 872.1799999999992, 873.4799999999992, 874.6855555555546, 873.7644444444435, 875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764, 875.7944444444431, 874.9377777777767, 875.2233333333319, 875.5088888888877, 873.7944444444432, 875.9211111111098, 875.762222222221, 875.7311111111098, 875.3177777777764, 874.4922222222209, 875.953333333332, 874.683333333332, 875.4455555555544, 875.5399999999988, 874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653, 873.539999999999, 875.4133333333322, 876.2388888888875, 874.269999999999, 875.2866666666653, 874.6511111111099, 874.4288888888879, 874.9688888888877, 875.3499999999988, 871.9211111111105, 873.2544444444434, 876.2066666666653, 874.9999999999987, 875.0955555555544, 875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.0377777777773, 872.7522222222217, 872.625555555555, 872.9755555555552, 870.2155555555553, 872.4377777777777, 871.3911111111113, 871.8977777777777, 873.6099999999992, 872.4044444444437, 872.0866666666662, 874.116666666666, 872.6266666666662, 873.7355555555546, 873.6399999999993, 872.6222222222214, 873.7966666666657, 873.5111111111102, 873.9866666666655, 874.5577777777768, 875.192222222221, 873.8944444444436, 872.5299999999995, 873.385555555555, 873.3866666666662, 872.6566666666661, 872.1799999999992, 873.4799999999992, 874.6855555555546, 873.7644444444435, 875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764, 875.7944444444431, 874.9377777777767, 875.2233333333319, 875.5088888888877, 873.7944444444432, 875.9211111111098, 875.762222222221, 875.7311111111098, 875.3177777777764, 874.4922222222209, 875.953333333332, 874.683333333332, 875.4455555555544, 875.5399999999988, 874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653, 873.539999999999, 875.4133333333322, 876.2388888888875, 874.269999999999, 875.2866666666653, 874.6511111111099, 874.4288888888879, 874.9688888888877, 875.3499999999988, 871.9211111111105, 873.2544444444434, 876.2066666666653, 874.9999999999987, 875.0955555555544, 875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1988488293015041, "mean_inference_ms": 1.811215064498789, "mean_action_processing_ms": 0.07457954113430085, "mean_env_wait_ms": 1.2195901287604394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004120349884033203, "StateBufferConnector_ms": 0.002744913101196289, "ViewRequirementAgentConnector_ms": 0.06469249725341797}, "num_episodes": 27, "episode_return_max": 876.5877777777764, "episode_return_min": 870.2155555555553, "episode_return_mean": 874.3418777777769, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 346650, "num_agent_steps_trained": 346500, "num_env_steps_sampled": 346650, "num_env_steps_trained": 346500, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.82878295203943, "num_env_steps_trained_throughput_per_sec": 295.6092452126731, "timesteps_total": 346650, "num_env_steps_sampled_lifetime": 346650, "num_agent_steps_sampled_lifetime": 346650, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 346650, "timers": {"training_iteration_time_ms": 10260.748, "restore_workers_time_ms": 0.015, "training_step_time_ms": 550.44, "sample_time_ms": 535.382, "synch_weights_time_ms": 13.634}, "counters": {"num_env_steps_sampled": 346650, "num_env_steps_trained": 346500, "num_agent_steps_sampled": 346650, "num_agent_steps_trained": 346500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2311, "num_samples_added_to_queue": 346500}, "done": false, "training_iteration": 117, "trial_id": "38f59_00000", "date": "2024-10-10_22-31-36", "timestamp": 1728595896, "time_this_iter_s": 10.163637638092041, "time_total_s": 1199.6938762664795, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cd9c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1199.6938762664795, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 15.006666666666664, "ram_util_percent": 73.55999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1641.00390625, "policy_loss": -237.36695861816406, "entropy": 4.866678714752197, "entropy_coeff": 0.01, "var_gnorm": 17.88091468811035, "vf_loss": 189297.09375, "vf_explained_var": 0.6444968581199646}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1164.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 349500, "num_env_steps_trained": 349200, "num_agent_steps_sampled": 349500, "num_agent_steps_trained": 349200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2330, "num_samples_added_to_queue": 349500, "learner_queue": {"size_count": 1164, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.099, "learner_load_time_ms": 0.184, "learner_load_wait_time_ms": 1039.981, "learner_dequeue_time_ms": 8465.143}}, "env_runners": {"episode_reward_max": 876.5877777777764, "episode_reward_min": 871.9211111111105, "episode_reward_mean": 874.6510111111102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.9211111111105}, "policy_reward_max": {"default_policy": 876.5877777777764}, "policy_reward_mean": {"default_policy": 874.6510111111102}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0012, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 41.02799, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.18469999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006886666666666667, "num_slav_min": 0.0002, "num_slav_max": 0.0016666666666666666, "mean_cluster_cpu_util_mean": 0.51317965078599, "mean_cluster_cpu_util_min": 0.5091262984923701, "mean_cluster_cpu_util_max": 0.515664184592756, "mean_cluster_mem_util_mean": 0.33011241561181437, "mean_cluster_mem_util_min": 0.32911867088607594, "mean_cluster_mem_util_max": 0.3305864978902954, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.102799, "reward_accuracy_mean_min": 4.0815, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.022955555555555555, "reward_sla_mean_min": -0.05555555555555556, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.27990000000005, "reward_accuracy_sum_min": 408.15000000000003, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.2955555555555556, "reward_sla_sum_min": -5.555555555555556, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5649.0, "global_timestep_min": 3400, "global_timestep_max": 7300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764, 875.7944444444431, 874.9377777777767, 875.2233333333319, 875.5088888888877, 873.7944444444432, 875.9211111111098, 875.762222222221, 875.7311111111098, 875.3177777777764, 874.4922222222209, 875.953333333332, 874.683333333332, 875.4455555555544, 875.5399999999988, 874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653, 873.539999999999, 875.4133333333322, 876.2388888888875, 874.269999999999, 875.2866666666653, 874.6511111111099, 874.4288888888879, 874.9688888888877, 875.3499999999988, 871.9211111111105, 873.2544444444434, 876.2066666666653, 874.9999999999987, 875.0955555555544, 875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543, 875.6044444444433, 873.9233333333324, 875.4466666666656, 875.6055555555546, 873.987777777777, 873.5122222222216, 872.9411111111102, 873.8288888888884, 874.0833333333326, 873.9566666666659, 875.7633333333321, 875.192222222221, 875.0655555555546, 873.859999999999, 873.7966666666656, 873.3222222222215, 873.448888888888, 872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.4466666666656, 874.5888888888879, 873.2611111111105, 872.5622222222215, 874.3699999999994, 872.8466666666662, 874.4655555555549, 873.7977777777769, 873.7655555555547, 874.6211111111099, 873.0655555555545, 873.9866666666658, 874.7477777777764, 875.7944444444431, 874.9377777777767, 875.2233333333319, 875.5088888888877, 873.7944444444432, 875.9211111111098, 875.762222222221, 875.7311111111098, 875.3177777777764, 874.4922222222209, 875.953333333332, 874.683333333332, 875.4455555555544, 875.5399999999988, 874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653, 873.539999999999, 875.4133333333322, 876.2388888888875, 874.269999999999, 875.2866666666653, 874.6511111111099, 874.4288888888879, 874.9688888888877, 875.3499999999988, 871.9211111111105, 873.2544444444434, 876.2066666666653, 874.9999999999987, 875.0955555555544, 875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543, 875.6044444444433, 873.9233333333324, 875.4466666666656, 875.6055555555546, 873.987777777777, 873.5122222222216, 872.9411111111102, 873.8288888888884, 874.0833333333326, 873.9566666666659, 875.7633333333321, 875.192222222221, 875.0655555555546, 873.859999999999, 873.7966666666656, 873.3222222222215, 873.448888888888, 872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19885891273022982, "mean_inference_ms": 1.8101622928023793, "mean_action_processing_ms": 0.07457298207421183, "mean_env_wait_ms": 1.2194169750613355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040400028228759766, "StateBufferConnector_ms": 0.0027837753295898438, "ViewRequirementAgentConnector_ms": 0.06572175025939941}, "num_episodes": 30, "episode_return_max": 876.5877777777764, "episode_return_min": 871.9211111111105, "episode_return_mean": 874.6510111111102, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 349500, "num_agent_steps_trained": 349200, "num_env_steps_sampled": 349500, "num_env_steps_trained": 349200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.41516232209625, "num_env_steps_trained_throughput_per_sec": 259.0248906209333, "timesteps_total": 349500, "num_env_steps_sampled_lifetime": 349500, "num_agent_steps_sampled_lifetime": 349500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 349500, "timers": {"training_iteration_time_ms": 10296.906, "restore_workers_time_ms": 0.013, "training_step_time_ms": 584.61, "sample_time_ms": 568.132, "synch_weights_time_ms": 15.073}, "counters": {"num_env_steps_sampled": 349500, "num_env_steps_trained": 349200, "num_agent_steps_sampled": 349500, "num_agent_steps_trained": 349200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2330, "num_samples_added_to_queue": 349500}, "done": false, "training_iteration": 118, "trial_id": "38f59_00000", "date": "2024-10-10_22-31-46", "timestamp": 1728595906, "time_this_iter_s": 10.434952020645142, "time_total_s": 1210.1288282871246, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc194e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1210.1288282871246, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 14.920000000000003, "ram_util_percent": 73.98000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1646.366455078125, "policy_loss": -320.3275146484375, "entropy": 4.771058082580566, "entropy_coeff": 0.01, "var_gnorm": 17.864070892333984, "vf_loss": 198100.71875, "vf_explained_var": 0.6367552280426025}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1174.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 352350, "num_env_steps_trained": 352200, "num_agent_steps_sampled": 352350, "num_agent_steps_trained": 352200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2349, "num_samples_added_to_queue": 352200, "learner_queue": {"size_count": 1174, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.847, "learner_load_time_ms": 0.183, "learner_load_wait_time_ms": 1040.214, "learner_dequeue_time_ms": 8540.647}}, "env_runners": {"episode_reward_max": 876.5877777777764, "episode_reward_min": 871.9211111111105, "episode_reward_mean": 874.3723444444436, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.9211111111105}, "policy_reward_max": {"default_policy": 876.5877777777764}, "policy_reward_mean": {"default_policy": 874.3723444444436}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0036, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 41.00012333333334, "mean_accuracy_min": 40.853, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.23850000000000002, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.0006886666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.0016666666666666666, "mean_cluster_cpu_util_mean": 0.5127817762915978, "mean_cluster_cpu_util_min": 0.5096043735061592, "mean_cluster_cpu_util_max": 0.515664184592756, "mean_cluster_mem_util_mean": 0.3300017405063291, "mean_cluster_mem_util_min": 0.32928217299578066, "mean_cluster_mem_util_max": 0.3305864978902954, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.100012333333333, "reward_accuracy_mean_min": 4.0853, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.02295555555555556, "reward_sla_mean_min": -0.05555555555555556, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.00123333333346, "reward_accuracy_sum_min": 408.53000000000003, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.2955555555555556, "reward_sla_sum_min": -5.555555555555556, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5622.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653, 873.539999999999, 875.4133333333322, 876.2388888888875, 874.269999999999, 875.2866666666653, 874.6511111111099, 874.4288888888879, 874.9688888888877, 875.3499999999988, 871.9211111111105, 873.2544444444434, 876.2066666666653, 874.9999999999987, 875.0955555555544, 875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543, 875.6044444444433, 873.9233333333324, 875.4466666666656, 875.6055555555546, 873.987777777777, 873.5122222222216, 872.9411111111102, 873.8288888888884, 874.0833333333326, 873.9566666666659, 875.7633333333321, 875.192222222221, 875.0655555555546, 873.859999999999, 873.7966666666656, 873.3222222222215, 873.448888888888, 872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771, 873.8622222222216, 874.5611111111104, 872.7522222222218, 873.3233333333326, 874.3066666666657, 873.447777777777, 872.8788888888884, 874.2422222222215, 874.4633333333326, 873.2599999999996, 872.7822222222217, 873.9266666666662, 872.6566666666661, 873.3233333333326, 873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [874.9688888888878, 875.0322222222209, 874.3655555555546, 875.5399999999989, 876.3655555555541, 874.9366666666654, 876.0166666666654, 873.6999999999989, 873.9222222222211, 875.3177777777764, 874.7466666666655, 875.8577777777765, 875.6355555555543, 875.6988888888877, 875.4766666666653, 875.4766666666653, 873.539999999999, 875.4133333333322, 876.2388888888875, 874.269999999999, 875.2866666666653, 874.6511111111099, 874.4288888888879, 874.9688888888877, 875.3499999999988, 871.9211111111105, 873.2544444444434, 876.2066666666653, 874.9999999999987, 875.0955555555544, 875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543, 875.6044444444433, 873.9233333333324, 875.4466666666656, 875.6055555555546, 873.987777777777, 873.5122222222216, 872.9411111111102, 873.8288888888884, 874.0833333333326, 873.9566666666659, 875.7633333333321, 875.192222222221, 875.0655555555546, 873.859999999999, 873.7966666666656, 873.3222222222215, 873.448888888888, 872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771, 873.8622222222216, 874.5611111111104, 872.7522222222218, 873.3233333333326, 874.3066666666657, 873.447777777777, 872.8788888888884, 874.2422222222215, 874.4633333333326, 873.2599999999996, 872.7822222222217, 873.9266666666662, 872.6566666666661, 873.3233333333326, 873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19890453401780867, "mean_inference_ms": 1.8095778148677562, "mean_action_processing_ms": 0.07457939407983609, "mean_env_wait_ms": 1.2195110265113445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282951354980469, "StateBufferConnector_ms": 0.0028755664825439453, "ViewRequirementAgentConnector_ms": 0.06827640533447266}, "num_episodes": 27, "episode_return_max": 876.5877777777764, "episode_return_min": 871.9211111111105, "episode_return_mean": 874.3723444444436, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352350, "num_agent_steps_trained": 352200, "num_env_steps_sampled": 352350, "num_env_steps_trained": 352200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 275.4196626110018, "num_env_steps_trained_throughput_per_sec": 289.9154343273703, "timesteps_total": 352350, "num_env_steps_sampled_lifetime": 352350, "num_agent_steps_sampled_lifetime": 352350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 352350, "timers": {"training_iteration_time_ms": 10291.842, "restore_workers_time_ms": 0.013, "training_step_time_ms": 561.029, "sample_time_ms": 546.077, "synch_weights_time_ms": 13.568}, "counters": {"num_env_steps_sampled": 352350, "num_env_steps_trained": 352200, "num_agent_steps_sampled": 352350, "num_agent_steps_trained": 352200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2349, "num_samples_added_to_queue": 352200}, "done": false, "training_iteration": 119, "trial_id": "38f59_00000", "date": "2024-10-10_22-31-57", "timestamp": 1728595917, "time_this_iter_s": 10.357999086380005, "time_total_s": 1220.4868273735046, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cf100>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1220.4868273735046, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 15.206666666666667, "ram_util_percent": 74.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1468.22509765625, "policy_loss": -659.8306274414062, "entropy": 4.530567169189453, "entropy_coeff": 0.01, "var_gnorm": 17.85041046142578, "vf_loss": 214164.75, "vf_explained_var": 0.6270493865013123}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1184.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 355350, "num_env_steps_trained": 355200, "num_agent_steps_sampled": 355350, "num_agent_steps_trained": 355200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2369, "num_samples_added_to_queue": 355200, "learner_queue": {"size_count": 1184, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.772, "learner_load_time_ms": 0.177, "learner_load_wait_time_ms": 976.47, "learner_dequeue_time_ms": 8552.48}}, "env_runners": {"episode_reward_max": 876.5877777777764, "episode_reward_min": 871.9888888888887, "episode_reward_mean": 874.3482111111102, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.9888888888887}, "policy_reward_max": {"default_policy": 876.5877777777764}, "policy_reward_mean": {"default_policy": 874.3482111111102}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0034000000000000002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.98771000000001, "mean_accuracy_min": 40.853, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.2716, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.0006586666666666667, "num_slav_min": 0.0002, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5127261003861003, "mean_cluster_cpu_util_min": 0.5096043735061592, "mean_cluster_cpu_util_max": 0.515664184592756, "mean_cluster_mem_util_mean": 0.3299735654008438, "mean_cluster_mem_util_min": 0.32928217299578066, "mean_cluster_mem_util_max": 0.3306181434599156, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.098771000000001, "reward_accuracy_mean_min": 4.0853, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021955555555555558, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.87710000000004, "reward_accuracy_sum_min": 408.53000000000003, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.195555555555556, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4287.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543, 875.6044444444433, 873.9233333333324, 875.4466666666656, 875.6055555555546, 873.987777777777, 873.5122222222216, 872.9411111111102, 873.8288888888884, 874.0833333333326, 873.9566666666659, 875.7633333333321, 875.192222222221, 875.0655555555546, 873.859999999999, 873.7966666666656, 873.3222222222215, 873.448888888888, 872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771, 873.8622222222216, 874.5611111111104, 872.7522222222218, 873.3233333333326, 874.3066666666657, 873.447777777777, 872.8788888888884, 874.2422222222215, 874.4633333333326, 873.2599999999996, 872.7822222222217, 873.9266666666662, 872.6566666666661, 873.3233333333326, 873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542, 874.4622222222212, 874.9066666666657, 874.1133333333323, 874.6533333333323, 874.3988888888879, 876.1755555555543, 874.5566666666656, 874.3977777777768, 874.3344444444433, 875.8266666666655, 874.9066666666655, 874.9711111111101, 875.6688888888879, 874.8755555555547, 874.4311111111102, 875.7944444444435, 874.3666666666655, 875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.1911111111101, 875.0955555555544, 875.3177777777765, 874.2388888888879, 876.3333333333319, 875.5722222222211, 876.5877777777764, 875.7622222222209, 873.508888888888, 875.4133333333323, 874.5566666666656, 874.2066666666655, 874.9055555555543, 875.6044444444433, 873.9233333333324, 875.4466666666656, 875.6055555555546, 873.987777777777, 873.5122222222216, 872.9411111111102, 873.8288888888884, 874.0833333333326, 873.9566666666659, 875.7633333333321, 875.192222222221, 875.0655555555546, 873.859999999999, 873.7966666666656, 873.3222222222215, 873.448888888888, 872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771, 873.8622222222216, 874.5611111111104, 872.7522222222218, 873.3233333333326, 874.3066666666657, 873.447777777777, 872.8788888888884, 874.2422222222215, 874.4633333333326, 873.2599999999996, 872.7822222222217, 873.9266666666662, 872.6566666666661, 873.3233333333326, 873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542, 874.4622222222212, 874.9066666666657, 874.1133333333323, 874.6533333333323, 874.3988888888879, 876.1755555555543, 874.5566666666656, 874.3977777777768, 874.3344444444433, 875.8266666666655, 874.9066666666655, 874.9711111111101, 875.6688888888879, 874.8755555555547, 874.4311111111102, 875.7944444444435, 874.3666666666655, 875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19900835148871995, "mean_inference_ms": 1.8114606049411666, "mean_action_processing_ms": 0.07461975385172032, "mean_env_wait_ms": 1.2200351089797865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043909549713134766, "StateBufferConnector_ms": 0.002901315689086914, "ViewRequirementAgentConnector_ms": 0.06960034370422363}, "num_episodes": 30, "episode_return_max": 876.5877777777764, "episode_return_min": 871.9888888888887, "episode_return_mean": 874.3482111111102, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 355350, "num_agent_steps_trained": 355200, "num_env_steps_sampled": 355350, "num_env_steps_trained": 355200, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 287.8005035206004, "num_env_steps_trained_throughput_per_sec": 287.8005035206004, "timesteps_total": 355350, "num_env_steps_sampled_lifetime": 355350, "num_agent_steps_sampled_lifetime": 355350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 355350, "timers": {"training_iteration_time_ms": 10297.749, "restore_workers_time_ms": 0.013, "training_step_time_ms": 526.312, "sample_time_ms": 511.171, "synch_weights_time_ms": 13.777}, "counters": {"num_env_steps_sampled": 355350, "num_env_steps_trained": 355200, "num_agent_steps_sampled": 355350, "num_agent_steps_trained": 355200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2369, "num_samples_added_to_queue": 355200}, "done": false, "training_iteration": 120, "trial_id": "38f59_00000", "date": "2024-10-10_22-32-07", "timestamp": 1728595927, "time_this_iter_s": 10.434317111968994, "time_total_s": 1230.9211444854736, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb48b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1230.9211444854736, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 13.193333333333332, "ram_util_percent": 74.85333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1962.5799560546875, "policy_loss": -70.1586685180664, "entropy": 4.49299430847168, "entropy_coeff": 0.01, "var_gnorm": 17.849695205688477, "vf_loss": 204621.765625, "vf_explained_var": 0.6361616849899292}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1193.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 358200, "num_env_steps_trained": 357900, "num_agent_steps_sampled": 358200, "num_agent_steps_trained": 357900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2388, "num_samples_added_to_queue": 358200, "learner_queue": {"size_count": 1193, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 64.104, "learner_load_time_ms": 0.196, "learner_load_wait_time_ms": 999.499, "learner_dequeue_time_ms": 8460.079}}, "env_runners": {"episode_reward_max": 876.9688888888875, "episode_reward_min": 871.9888888888887, "episode_reward_mean": 874.5833333333325, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.9888888888887}, "policy_reward_max": {"default_policy": 876.9688888888875}, "policy_reward_mean": {"default_policy": 874.5833333333325}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0032, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 41.00500000000001, "mean_accuracy_min": 40.853, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.22909999999999997, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.00064, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.513054524958632, "mean_cluster_cpu_util_min": 0.5096043735061592, "mean_cluster_cpu_util_max": 0.5154644236072808, "mean_cluster_mem_util_mean": 0.3300536603375528, "mean_cluster_mem_util_min": 0.32928217299578066, "mean_cluster_mem_util_max": 0.3306181434599156, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.1005, "reward_accuracy_mean_min": 4.0853, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021333333333333333, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.05, "reward_accuracy_sum_min": 408.53000000000003, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.133333333333334, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2941.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771, 873.8622222222216, 874.5611111111104, 872.7522222222218, 873.3233333333326, 874.3066666666657, 873.447777777777, 872.8788888888884, 874.2422222222215, 874.4633333333326, 873.2599999999996, 872.7822222222217, 873.9266666666662, 872.6566666666661, 873.3233333333326, 873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542, 874.4622222222212, 874.9066666666657, 874.1133333333323, 874.6533333333323, 874.3988888888879, 876.1755555555543, 874.5566666666656, 874.3977777777768, 874.3344444444433, 875.8266666666655, 874.9066666666655, 874.9711111111101, 875.6688888888879, 874.8755555555547, 874.4311111111102, 875.7944444444435, 874.3666666666655, 875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098, 875.2222222222209, 875.2866666666655, 875.6355555555543, 875.8899999999987, 874.619999999999, 875.6355555555542, 874.7777777777767, 875.3177777777767, 876.1433333333321, 876.8099999999985, 876.0166666666654, 874.683333333332, 875.0955555555544, 875.7622222222209, 876.9688888888875, 874.3655555555547, 876.2066666666653, 875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [872.3699999999991, 873.3222222222215, 872.2111111111108, 874.3666666666655, 875.2244444444433, 875.2877777777769, 876.1766666666655, 873.1622222222211, 873.0655555555544, 874.1455555555544, 875.0044444444437, 873.3533333333326, 873.0677777777771, 873.8622222222216, 874.5611111111104, 872.7522222222218, 873.3233333333326, 874.3066666666657, 873.447777777777, 872.8788888888884, 874.2422222222215, 874.4633333333326, 873.2599999999996, 872.7822222222217, 873.9266666666662, 872.6566666666661, 873.3233333333326, 873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542, 874.4622222222212, 874.9066666666657, 874.1133333333323, 874.6533333333323, 874.3988888888879, 876.1755555555543, 874.5566666666656, 874.3977777777768, 874.3344444444433, 875.8266666666655, 874.9066666666655, 874.9711111111101, 875.6688888888879, 874.8755555555547, 874.4311111111102, 875.7944444444435, 874.3666666666655, 875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098, 875.2222222222209, 875.2866666666655, 875.6355555555543, 875.8899999999987, 874.619999999999, 875.6355555555542, 874.7777777777767, 875.3177777777767, 876.1433333333321, 876.8099999999985, 876.0166666666654, 874.683333333332, 875.0955555555544, 875.7622222222209, 876.9688888888875, 874.3655555555547, 876.2066666666653, 875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19907889696188036, "mean_inference_ms": 1.811779255682027, "mean_action_processing_ms": 0.074643708345442, "mean_env_wait_ms": 1.2202159715056218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004460811614990234, "StateBufferConnector_ms": 0.0029637813568115234, "ViewRequirementAgentConnector_ms": 0.07090425491333008}, "num_episodes": 30, "episode_return_max": 876.9688888888875, "episode_return_min": 871.9888888888887, "episode_return_mean": 874.5833333333325, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 358200, "num_agent_steps_trained": 357900, "num_env_steps_sampled": 358200, "num_env_steps_trained": 357900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 284.17515230792577, "num_env_steps_trained_throughput_per_sec": 269.21856534435074, "timesteps_total": 358200, "num_env_steps_sampled_lifetime": 358200, "num_agent_steps_sampled_lifetime": 358200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 358200, "timers": {"training_iteration_time_ms": 10291.312, "restore_workers_time_ms": 0.013, "training_step_time_ms": 536.155, "sample_time_ms": 520.796, "synch_weights_time_ms": 14.043}, "counters": {"num_env_steps_sampled": 358200, "num_env_steps_trained": 357900, "num_agent_steps_sampled": 358200, "num_agent_steps_trained": 357900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2388, "num_samples_added_to_queue": 358200}, "done": false, "training_iteration": 121, "trial_id": "38f59_00000", "date": "2024-10-10_22-32-17", "timestamp": 1728595937, "time_this_iter_s": 10.039162158966064, "time_total_s": 1240.9603066444397, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cf0d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1240.9603066444397, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 13.078571428571431, "ram_util_percent": 74.95714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2397.8837890625, "policy_loss": 332.27581787109375, "entropy": 4.506937026977539, "entropy_coeff": 0.01, "var_gnorm": 17.891056060791016, "vf_loss": 207912.859375, "vf_explained_var": 0.632452130317688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1203.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 361050, "num_env_steps_trained": 360900, "num_agent_steps_sampled": 361050, "num_agent_steps_trained": 360900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2407, "num_samples_added_to_queue": 360900, "learner_queue": {"size_count": 1203, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.433, "learner_load_time_ms": 0.194, "learner_load_wait_time_ms": 995.036, "learner_dequeue_time_ms": 8435.995}}, "env_runners": {"episode_reward_max": 876.9688888888875, "episode_reward_min": 871.9888888888887, "episode_reward_mean": 875.0064777777766, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.9888888888887}, "policy_reward_max": {"default_policy": 876.9688888888875}, "policy_reward_mean": {"default_policy": 875.0064777777766}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0022, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 41.044203333333336, "mean_accuracy_min": 40.86566666666667, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.1458, "num_model_switches_min": 0.0, "num_model_switches_max": 0.49, "num_slav_mean": 0.0006306666666666666, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5135778356545321, "mean_cluster_cpu_util_min": 0.5106985429306858, "mean_cluster_cpu_util_max": 0.5154644236072808, "mean_cluster_mem_util_mean": 0.33020583860759495, "mean_cluster_mem_util_min": 0.3295358649789029, "mean_cluster_mem_util_max": 0.3306181434599156, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.104420333333334, "reward_accuracy_mean_min": 4.086566666666667, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021022222222222223, "reward_sla_mean_min": -0.037777777777777785, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.4420333333333, "reward_accuracy_sum_min": 408.6566666666667, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.102222222222222, "reward_sla_sum_min": -3.7777777777777786, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2053.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542, 874.4622222222212, 874.9066666666657, 874.1133333333323, 874.6533333333323, 874.3988888888879, 876.1755555555543, 874.5566666666656, 874.3977777777768, 874.3344444444433, 875.8266666666655, 874.9066666666655, 874.9711111111101, 875.6688888888879, 874.8755555555547, 874.4311111111102, 875.7944444444435, 874.3666666666655, 875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098, 875.2222222222209, 875.2866666666655, 875.6355555555543, 875.8899999999987, 874.619999999999, 875.6355555555542, 874.7777777777767, 875.3177777777767, 876.1433333333321, 876.8099999999985, 876.0166666666654, 874.683333333332, 875.0955555555544, 875.7622222222209, 876.9688888888875, 874.3655555555547, 876.2066666666653, 875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099, 874.7466666666655, 875.4133333333322, 875.3499999999989, 875.6355555555542, 874.9377777777765, 875.3499999999988, 874.8733333333323, 874.4611111111102, 876.1433333333322, 874.4611111111097, 875.413333333332, 875.38111111111, 874.2066666666657, 875.5399999999988, 876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.8611111111104, 873.385555555555, 874.6866666666658, 875.1933333333324, 871.9888888888887, 873.8622222222217, 872.8788888888885, 873.099999999999, 873.5122222222213, 873.7988888888881, 873.227777777777, 873.2266666666661, 875.2555555555542, 874.4622222222212, 874.9066666666657, 874.1133333333323, 874.6533333333323, 874.3988888888879, 876.1755555555543, 874.5566666666656, 874.3977777777768, 874.3344444444433, 875.8266666666655, 874.9066666666655, 874.9711111111101, 875.6688888888879, 874.8755555555547, 874.4311111111102, 875.7944444444435, 874.3666666666655, 875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098, 875.2222222222209, 875.2866666666655, 875.6355555555543, 875.8899999999987, 874.619999999999, 875.6355555555542, 874.7777777777767, 875.3177777777767, 876.1433333333321, 876.8099999999985, 876.0166666666654, 874.683333333332, 875.0955555555544, 875.7622222222209, 876.9688888888875, 874.3655555555547, 876.2066666666653, 875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099, 874.7466666666655, 875.4133333333322, 875.3499999999989, 875.6355555555542, 874.9377777777765, 875.3499999999988, 874.8733333333323, 874.4611111111102, 876.1433333333322, 874.4611111111097, 875.413333333332, 875.38111111111, 874.2066666666657, 875.5399999999988, 876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19914054893888178, "mean_inference_ms": 1.8120850492366665, "mean_action_processing_ms": 0.07465685739869138, "mean_env_wait_ms": 1.2203867700848763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004578828811645508, "StateBufferConnector_ms": 0.002936124801635742, "ViewRequirementAgentConnector_ms": 0.07025289535522461}, "num_episodes": 27, "episode_return_max": 876.9688888888875, "episode_return_min": 871.9888888888887, "episode_return_mean": 875.0064777777766, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 361050, "num_agent_steps_trained": 360900, "num_env_steps_sampled": 361050, "num_env_steps_trained": 360900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 284.15127307558924, "num_env_steps_trained_throughput_per_sec": 299.10660323746237, "timesteps_total": 361050, "num_env_steps_sampled_lifetime": 361050, "num_agent_steps_sampled_lifetime": 361050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 361050, "timers": {"training_iteration_time_ms": 10254.068, "restore_workers_time_ms": 0.011, "training_step_time_ms": 523.65, "sample_time_ms": 509.322, "synch_weights_time_ms": 12.998}, "counters": {"num_env_steps_sampled": 361050, "num_env_steps_trained": 360900, "num_agent_steps_sampled": 361050, "num_agent_steps_trained": 360900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2407, "num_samples_added_to_queue": 360900}, "done": false, "training_iteration": 122, "trial_id": "38f59_00000", "date": "2024-10-10_22-32-27", "timestamp": 1728595947, "time_this_iter_s": 10.038602113723755, "time_total_s": 1250.9989087581635, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2d390>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1250.9989087581635, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 12.564285714285715, "ram_util_percent": 75.07857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1943.507568359375, "policy_loss": -62.109432220458984, "entropy": 4.595017910003662, "entropy_coeff": 0.01, "var_gnorm": 17.90802574157715, "vf_loss": 201940.21875, "vf_explained_var": 0.6368699073791504}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1213.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 364050, "num_env_steps_trained": 363900, "num_agent_steps_sampled": 364050, "num_agent_steps_trained": 363900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2427, "num_samples_added_to_queue": 363900, "learner_queue": {"size_count": 1213, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.592, "learner_load_time_ms": 0.18, "learner_load_wait_time_ms": 988.569, "learner_dequeue_time_ms": 8465.216}}, "env_runners": {"episode_reward_max": 876.9688888888875, "episode_reward_min": 873.2555555555543, "episode_reward_mean": 875.2204888888876, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 873.2555555555543}, "policy_reward_max": {"default_policy": 876.9688888888875}, "policy_reward_mean": {"default_policy": 875.2204888888876}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 41.067826666666676, "mean_accuracy_min": 40.96066666666667, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.09450000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.35, "num_slav_mean": 0.0006373333333333334, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012, "mean_cluster_cpu_util_mean": 0.513912959528406, "mean_cluster_cpu_util_min": 0.5119492898510756, "mean_cluster_cpu_util_max": 0.5157822439786726, "mean_cluster_mem_util_mean": 0.3302979957805907, "mean_cluster_mem_util_min": 0.3299003164556962, "mean_cluster_mem_util_max": 0.3306181434599156, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.106782666666667, "reward_accuracy_mean_min": 4.096066666666667, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.021244444444444448, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.6782666666667, "reward_accuracy_sum_min": 409.6066666666667, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.1244444444444444, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2657.0, "global_timestep_min": 500, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098, 875.2222222222209, 875.2866666666655, 875.6355555555543, 875.8899999999987, 874.619999999999, 875.6355555555542, 874.7777777777767, 875.3177777777767, 876.1433333333321, 876.8099999999985, 876.0166666666654, 874.683333333332, 875.0955555555544, 875.7622222222209, 876.9688888888875, 874.3655555555547, 876.2066666666653, 875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099, 874.7466666666655, 875.4133333333322, 875.3499999999989, 875.6355555555542, 874.9377777777765, 875.3499999999988, 874.8733333333323, 874.4611111111102, 876.1433333333322, 874.4611111111097, 875.413333333332, 875.38111111111, 874.2066666666657, 875.5399999999988, 876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543, 875.1277777777767, 875.1277777777765, 875.6033333333321, 874.7155555555543, 873.7944444444436, 873.9533333333321, 874.8422222222209, 876.2066666666652, 873.2866666666657, 875.2555555555547, 874.5566666666655, 875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.4444444444432, 875.7944444444429, 873.7311111111101, 874.6533333333323, 873.2555555555543, 875.2877777777767, 874.1766666666657, 874.4955555555548, 876.1122222222209, 875.5088888888878, 874.3977777777767, 875.19111111111, 875.3811111111098, 875.2222222222209, 875.2866666666655, 875.6355555555543, 875.8899999999987, 874.619999999999, 875.6355555555542, 874.7777777777767, 875.3177777777767, 876.1433333333321, 876.8099999999985, 876.0166666666654, 874.683333333332, 875.0955555555544, 875.7622222222209, 876.9688888888875, 874.3655555555547, 876.2066666666653, 875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099, 874.7466666666655, 875.4133333333322, 875.3499999999989, 875.6355555555542, 874.9377777777765, 875.3499999999988, 874.8733333333323, 874.4611111111102, 876.1433333333322, 874.4611111111097, 875.413333333332, 875.38111111111, 874.2066666666657, 875.5399999999988, 876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543, 875.1277777777767, 875.1277777777765, 875.6033333333321, 874.7155555555543, 873.7944444444436, 873.9533333333321, 874.8422222222209, 876.2066666666652, 873.2866666666657, 875.2555555555547, 874.5566666666655, 875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19918552285182656, "mean_inference_ms": 1.81207201989187, "mean_action_processing_ms": 0.0746682818390044, "mean_env_wait_ms": 1.22042399493402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004907846450805664, "StateBufferConnector_ms": 0.0029850006103515625, "ViewRequirementAgentConnector_ms": 0.07040071487426758}, "num_episodes": 30, "episode_return_max": 876.9688888888875, "episode_return_min": 873.2555555555543, "episode_return_mean": 875.2204888888876, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364050, "num_agent_steps_trained": 363900, "num_env_steps_sampled": 364050, "num_env_steps_trained": 363900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 291.03999032620067, "num_env_steps_trained_throughput_per_sec": 291.03999032620067, "timesteps_total": 364050, "num_env_steps_sampled_lifetime": 364050, "num_agent_steps_sampled_lifetime": 364050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 364050, "timers": {"training_iteration_time_ms": 10264.424, "restore_workers_time_ms": 0.013, "training_step_time_ms": 514.014, "sample_time_ms": 498.988, "synch_weights_time_ms": 13.663}, "counters": {"num_env_steps_sampled": 364050, "num_env_steps_trained": 363900, "num_agent_steps_sampled": 364050, "num_agent_steps_trained": 363900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2427, "num_samples_added_to_queue": 363900}, "done": false, "training_iteration": 123, "trial_id": "38f59_00000", "date": "2024-10-10_22-32-38", "timestamp": 1728595958, "time_this_iter_s": 10.321002006530762, "time_total_s": 1261.3199107646942, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cf790>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1261.3199107646942, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 13.526666666666669, "ram_util_percent": 75.14000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1478.282470703125, "policy_loss": -432.81463623046875, "entropy": 4.945005416870117, "entropy_coeff": 0.01, "var_gnorm": 17.89358901977539, "vf_loss": 192593.21875, "vf_explained_var": 0.6418434977531433}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1223.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 367050, "num_env_steps_trained": 366900, "num_agent_steps_sampled": 367050, "num_agent_steps_trained": 366900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2447, "num_samples_added_to_queue": 366900, "learner_queue": {"size_count": 1223, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 53.179, "learner_load_time_ms": 0.175, "learner_load_wait_time_ms": 956.695, "learner_dequeue_time_ms": 8447.701}}, "env_runners": {"episode_reward_max": 876.2711111111097, "episode_reward_min": 871.0388888888884, "episode_reward_mean": 874.7477333333321, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 871.0388888888884}, "policy_reward_max": {"default_policy": 876.2711111111097}, "policy_reward_mean": {"default_policy": 874.7477333333321}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 41.03210666666667, "mean_accuracy_min": 40.815, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.1662, "num_model_switches_min": 0.0, "num_model_switches_max": 0.52, "num_slav_mean": 0.0006720000000000001, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5133192575611325, "mean_cluster_cpu_util_min": 0.509196072347858, "mean_cluster_cpu_util_max": 0.5157822439786726, "mean_cluster_mem_util_mean": 0.33015044831223633, "mean_cluster_mem_util_min": 0.329164029535865, "mean_cluster_mem_util_max": 0.33057489451476796, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.1032106666666674, "reward_accuracy_mean_min": 4.0815, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.022400000000000007, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 410.32106666666675, "reward_accuracy_sum_min": 408.15000000000003, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.24, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3657.0, "global_timestep_min": 1500, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099, 874.7466666666655, 875.4133333333322, 875.3499999999989, 875.6355555555542, 874.9377777777765, 875.3499999999988, 874.8733333333323, 874.4611111111102, 876.1433333333322, 874.4611111111097, 875.413333333332, 875.38111111111, 874.2066666666657, 875.5399999999988, 876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543, 875.1277777777767, 875.1277777777765, 875.6033333333321, 874.7155555555543, 873.7944444444436, 873.9533333333321, 874.8422222222209, 876.2066666666652, 873.2866666666657, 875.2555555555547, 874.5566666666655, 875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768, 874.4944444444435, 874.398888888888, 872.9699999999992, 874.8433333333325, 873.9233333333325, 873.0999999999995, 872.9399999999994, 873.7355555555549, 873.6733333333331, 872.974444444444, 873.477777777777, 873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.5088888888877, 874.7777777777766, 875.572222222221, 875.7944444444431, 875.3177777777764, 875.5722222222211, 874.8733333333321, 875.5722222222211, 874.0799999999989, 875.6988888888876, 874.9688888888877, 876.1755555555541, 875.1911111111099, 874.7466666666655, 875.4133333333322, 875.3499999999989, 875.6355555555542, 874.9377777777765, 875.3499999999988, 874.8733333333323, 874.4611111111102, 876.1433333333322, 874.4611111111097, 875.413333333332, 875.38111111111, 874.2066666666657, 875.5399999999988, 876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543, 875.1277777777767, 875.1277777777765, 875.6033333333321, 874.7155555555543, 873.7944444444436, 873.9533333333321, 874.8422222222209, 876.2066666666652, 873.2866666666657, 875.2555555555547, 874.5566666666655, 875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768, 874.4944444444435, 874.398888888888, 872.9699999999992, 874.8433333333325, 873.9233333333325, 873.0999999999995, 872.9399999999994, 873.7355555555549, 873.6733333333331, 872.974444444444, 873.477777777777, 873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19919565731949063, "mean_inference_ms": 1.8119261945520153, "mean_action_processing_ms": 0.07467246286569616, "mean_env_wait_ms": 1.2203796673824179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004712820053100586, "StateBufferConnector_ms": 0.002896547317504883, "ViewRequirementAgentConnector_ms": 0.06736040115356445}, "num_episodes": 30, "episode_return_max": 876.2711111111097, "episode_return_min": 871.0388888888884, "episode_return_mean": 874.7477333333321, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 367050, "num_agent_steps_trained": 366900, "num_env_steps_sampled": 367050, "num_env_steps_trained": 366900, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 297.4352782406761, "num_env_steps_trained_throughput_per_sec": 297.4352782406761, "timesteps_total": 367050, "num_env_steps_sampled_lifetime": 367050, "num_agent_steps_sampled_lifetime": 367050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 367050, "timers": {"training_iteration_time_ms": 10246.025, "restore_workers_time_ms": 0.012, "training_step_time_ms": 535.431, "sample_time_ms": 521.188, "synch_weights_time_ms": 12.897}, "counters": {"num_env_steps_sampled": 367050, "num_env_steps_trained": 366900, "num_agent_steps_sampled": 367050, "num_agent_steps_trained": 366900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2447, "num_samples_added_to_queue": 366900}, "done": false, "training_iteration": 124, "trial_id": "38f59_00000", "date": "2024-10-10_22-32-48", "timestamp": 1728595968, "time_this_iter_s": 10.100194931030273, "time_total_s": 1271.4201056957245, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb4880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1271.4201056957245, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 12.592857142857143, "ram_util_percent": 75.44285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1662.8966064453125, "policy_loss": -165.79331970214844, "entropy": 4.912510871887207, "entropy_coeff": 0.01, "var_gnorm": 17.88079833984375, "vf_loss": 184342.75, "vf_explained_var": 0.647041916847229}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1231.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 369600, "num_env_steps_trained": 369300, "num_agent_steps_sampled": 369600, "num_agent_steps_trained": 369300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2464, "num_samples_added_to_queue": 369600, "learner_queue": {"size_count": 1231, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.329, "learner_load_time_ms": 0.21, "learner_load_wait_time_ms": 1132.331, "learner_dequeue_time_ms": 8486.187}}, "env_runners": {"episode_reward_max": 876.2711111111097, "episode_reward_min": 870.502222222222, "episode_reward_mean": 873.7988999999991, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 870.502222222222}, "policy_reward_max": {"default_policy": 876.2711111111097}, "policy_reward_mean": {"default_policy": 873.7988999999991}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0, "num_moves_min": 0.0, "num_moves_max": 0.0, "mean_accuracy_mean": 40.94122333333334, "mean_accuracy_min": 40.65666666666666, "mean_accuracy_max": 41.10000000000001, "num_model_switches_mean": 0.27790000000000004, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006839999999999999, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5118277790034933, "mean_cluster_cpu_util_min": 0.5064029807869093, "mean_cluster_cpu_util_max": 0.5157822439786726, "mean_cluster_mem_util_mean": 0.3297616666666666, "mean_cluster_mem_util_min": 0.3284762658227847, "mean_cluster_mem_util_max": 0.33054324894514764, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.094122333333334, "reward_accuracy_mean_min": 4.065666666666667, "reward_accuracy_mean_max": 4.11, "reward_sla_mean_mean": -0.0228, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 409.4122333333334, "reward_accuracy_sum_min": 406.5666666666667, "reward_accuracy_sum_max": 411.00000000000006, "reward_sla_sum_mean": -2.28, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4563.0, "global_timestep_min": 2500, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543, 875.1277777777767, 875.1277777777765, 875.6033333333321, 874.7155555555543, 873.7944444444436, 873.9533333333321, 874.8422222222209, 876.2066666666652, 873.2866666666657, 875.2555555555547, 874.5566666666655, 875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768, 874.4944444444435, 874.398888888888, 872.9699999999992, 874.8433333333325, 873.9233333333325, 873.0999999999995, 872.9399999999994, 873.7355555555549, 873.6733333333331, 872.974444444444, 873.477777777777, 873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884, 871.1977777777774, 872.6577777777774, 872.4688888888887, 871.3255555555554, 870.9155555555559, 872.2466666666664, 871.2333333333333, 872.4055555555555, 871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [876.0166666666655, 875.73111111111, 874.7788888888879, 876.1755555555543, 873.9533333333322, 875.0955555555543, 875.0322222222211, 875.4444444444432, 875.6988888888877, 875.6044444444432, 876.0799999999986, 876.2388888888878, 875.0955555555543, 875.1277777777767, 875.1277777777765, 875.6033333333321, 874.7155555555543, 873.7944444444436, 873.9533333333321, 874.8422222222209, 876.2066666666652, 873.2866666666657, 875.2555555555547, 874.5566666666655, 875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768, 874.4944444444435, 874.398888888888, 872.9699999999992, 874.8433333333325, 873.9233333333325, 873.0999999999995, 872.9399999999994, 873.7355555555549, 873.6733333333331, 872.974444444444, 873.477777777777, 873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884, 871.1977777777774, 872.6577777777774, 872.4688888888887, 871.3255555555554, 870.9155555555559, 872.2466666666664, 871.2333333333333, 872.4055555555555, 871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19927098595808868, "mean_inference_ms": 1.812488870838623, "mean_action_processing_ms": 0.07469643490845967, "mean_env_wait_ms": 1.2206820388790072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004757881164550781, "StateBufferConnector_ms": 0.002946138381958008, "ViewRequirementAgentConnector_ms": 0.0689234733581543}, "num_episodes": 27, "episode_return_max": 876.2711111111097, "episode_return_min": 870.502222222222, "episode_return_mean": 873.7988999999991, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 369600, "num_agent_steps_trained": 369300, "num_env_steps_sampled": 369600, "num_env_steps_trained": 369300, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 246.79411953239173, "num_env_steps_trained_throughput_per_sec": 232.2768183834275, "timesteps_total": 369600, "num_env_steps_sampled_lifetime": 369600, "num_agent_steps_sampled_lifetime": 369600, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 369600, "timers": {"training_iteration_time_ms": 10226.662, "restore_workers_time_ms": 0.015, "training_step_time_ms": 656.847, "sample_time_ms": 639.667, "synch_weights_time_ms": 15.517}, "counters": {"num_env_steps_sampled": 369600, "num_env_steps_trained": 369300, "num_agent_steps_sampled": 369600, "num_agent_steps_trained": 369300, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2464, "num_samples_added_to_queue": 369600}, "done": false, "training_iteration": 125, "trial_id": "38f59_00000", "date": "2024-10-10_22-32-58", "timestamp": 1728595978, "time_this_iter_s": 10.350460290908813, "time_total_s": 1281.7705659866333, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb61d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1281.7705659866333, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 19.973333333333333, "ram_util_percent": 76.57333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2243.15283203125, "policy_loss": 330.564208984375, "entropy": 4.754194736480713, "entropy_coeff": 0.01, "var_gnorm": 17.872163772583008, "vf_loss": 192685.125, "vf_explained_var": 0.640889585018158}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1240.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 372150, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372150, "num_agent_steps_trained": 372000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2481, "num_samples_added_to_queue": 372000, "learner_queue": {"size_count": 1240, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.494, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 1161.033, "learner_dequeue_time_ms": 8583.526}}, "env_runners": {"episode_reward_max": 876.2711111111097, "episode_reward_min": 868.6944444444446, "episode_reward_mean": 872.6670111111106, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.6944444444446}, "policy_reward_max": {"default_policy": 876.2711111111097}, "policy_reward_mean": {"default_policy": 872.6670111111106}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.83292333333333, "mean_accuracy_min": 40.52366666666666, "mean_accuracy_max": 41.08733333333333, "num_model_switches_mean": 0.34, "num_model_switches_min": 0.05, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006986666666666666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5100722323726788, "mean_cluster_cpu_util_min": 0.5046883388490531, "mean_cluster_cpu_util_max": 0.5157822439786726, "mean_cluster_mem_util_mean": 0.3293041191983122, "mean_cluster_mem_util_min": 0.32802056962025317, "mean_cluster_mem_util_max": 0.33054324894514764, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0832923333333335, "reward_accuracy_mean_min": 4.052366666666668, "reward_accuracy_mean_max": 4.108733333333334, "reward_sla_mean_mean": -0.023288888888888894, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 408.3292333333334, "reward_accuracy_sum_min": 405.23666666666674, "reward_accuracy_sum_max": 410.8733333333334, "reward_sla_sum_mean": -2.328888888888889, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5353.0, "global_timestep_min": 3400, "global_timestep_max": 7000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768, 874.4944444444435, 874.398888888888, 872.9699999999992, 874.8433333333325, 873.9233333333325, 873.0999999999995, 872.9399999999994, 873.7355555555549, 873.6733333333331, 872.974444444444, 873.477777777777, 873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884, 871.1977777777774, 872.6577777777774, 872.4688888888887, 871.3255555555554, 870.9155555555559, 872.2466666666664, 871.2333333333333, 872.4055555555555, 871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222, 871.3288888888887, 870.7255555555558, 868.6944444444446, 870.3766666666669, 870.0922222222227, 870.0611111111116, 871.7111111111116, 871.4244444444446, 870.7244444444443, 871.1388888888891, 870.0911111111112, 870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [875.6988888888877, 873.5399999999992, 875.6677777777766, 875.4455555555544, 875.6677777777763, 874.6833333333321, 874.9066666666656, 874.9055555555545, 875.6999999999986, 876.2711111111097, 875.4133333333323, 874.7155555555546, 875.0322222222211, 875.8899999999987, 875.5722222222208, 874.3666666666658, 875.6355555555542, 875.6988888888876, 874.9377777777768, 874.4944444444435, 874.398888888888, 872.9699999999992, 874.8433333333325, 873.9233333333325, 873.0999999999995, 872.9399999999994, 873.7355555555549, 873.6733333333331, 872.974444444444, 873.477777777777, 873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884, 871.1977777777774, 872.6577777777774, 872.4688888888887, 871.3255555555554, 870.9155555555559, 872.2466666666664, 871.2333333333333, 872.4055555555555, 871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222, 871.3288888888887, 870.7255555555558, 868.6944444444446, 870.3766666666669, 870.0922222222227, 870.0611111111116, 871.7111111111116, 871.4244444444446, 870.7244444444443, 871.1388888888891, 870.0911111111112, 870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19932216698039554, "mean_inference_ms": 1.8107084873844213, "mean_action_processing_ms": 0.07470058256465993, "mean_env_wait_ms": 1.220741360900179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004586219787597656, "StateBufferConnector_ms": 0.0030698776245117188, "ViewRequirementAgentConnector_ms": 0.07102608680725098}, "num_episodes": 24, "episode_return_max": 876.2711111111097, "episode_return_min": 868.6944444444446, "episode_return_mean": 872.6670111111106, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372150, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372150, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 244.55597764516983, "num_env_steps_trained_throughput_per_sec": 258.9416233890033, "timesteps_total": 372150, "num_env_steps_sampled_lifetime": 372150, "num_agent_steps_sampled_lifetime": 372150, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 372150, "timers": {"training_iteration_time_ms": 10255.66, "restore_workers_time_ms": 0.013, "training_step_time_ms": 514.214, "sample_time_ms": 499.109, "synch_weights_time_ms": 13.567}, "counters": {"num_env_steps_sampled": 372150, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372150, "num_agent_steps_trained": 372000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2481, "num_samples_added_to_queue": 372000}, "done": false, "training_iteration": 126, "trial_id": "38f59_00000", "date": "2024-10-10_22-33-09", "timestamp": 1728595989, "time_this_iter_s": 10.444605827331543, "time_total_s": 1292.2151718139648, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb7340>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1292.2151718139648, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 12.819999999999999, "ram_util_percent": 75.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1657.2161865234375, "policy_loss": -405.38836669921875, "entropy": 4.769016742706299, "entropy_coeff": 0.01, "var_gnorm": 17.88084602355957, "vf_loss": 207691.15625, "vf_explained_var": 0.6288772821426392}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1249.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 375000, "num_env_steps_trained": 374700, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 374700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2500, "num_samples_added_to_queue": 375000, "learner_queue": {"size_count": 1249, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.328, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 1009.842, "learner_dequeue_time_ms": 8731.034}}, "env_runners": {"episode_reward_max": 875.7633333333324, "episode_reward_min": 868.6944444444446, "episode_reward_mean": 871.3290777777777, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.6944444444446}, "policy_reward_max": {"default_policy": 875.7633333333324}, "policy_reward_mean": {"default_policy": 871.3290777777777}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0032000000000000006, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.69979666666666, "mean_accuracy_min": 40.51099999999999, "mean_accuracy_max": 41.062000000000005, "num_model_switches_mean": 0.3753, "num_model_switches_min": 0.12, "num_model_switches_max": 0.54, "num_slav_mean": 0.0007006666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5077929288472146, "mean_cluster_cpu_util_min": 0.5038736210700496, "mean_cluster_cpu_util_max": 0.5147713619231475, "mean_cluster_mem_util_mean": 0.3287083491561181, "mean_cluster_mem_util_min": 0.32784071729957803, "mean_cluster_mem_util_max": 0.33042774261603375, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.069979666666666, "reward_accuracy_mean_min": 4.0511, "reward_accuracy_mean_max": 4.1062, "reward_sla_mean_mean": -0.023355555555555556, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.9979666666667, "reward_accuracy_sum_min": 405.11, "reward_accuracy_sum_max": 410.62, "reward_sla_sum_mean": -2.3355555555555556, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5885.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884, 871.1977777777774, 872.6577777777774, 872.4688888888887, 871.3255555555554, 870.9155555555559, 872.2466666666664, 871.2333333333333, 872.4055555555555, 871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222, 871.3288888888887, 870.7255555555558, 868.6944444444446, 870.3766666666669, 870.0922222222227, 870.0611111111116, 871.7111111111116, 871.4244444444446, 870.7244444444443, 871.1388888888891, 870.0911111111112, 870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999, 870.2511111111113, 869.9977777777782, 870.2511111111113, 871.4566666666669, 871.1077777777779, 869.6800000000002, 870.0300000000008, 869.6488888888894, 869.1400000000003, 870.187777777778, 870.1555555555557, 870.6011111111117, 869.488888888889, 869.0444444444444, 870.4100000000005, 870.6633333333335, 868.9811111111112, 869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [873.6688888888879, 875.7633333333324, 873.5099999999991, 873.225555555555, 873.8622222222217, 873.8922222222213, 871.7688888888886, 873.3233333333328, 872.3711111111105, 875.5088888888877, 874.5255555555544, 873.7955555555546, 874.6222222222212, 873.6066666666658, 874.337777777777, 874.0533333333327, 874.0211111111105, 873.1655555555553, 871.0388888888884, 871.1977777777774, 872.6577777777774, 872.4688888888887, 871.3255555555554, 870.9155555555559, 872.2466666666664, 871.2333333333333, 872.4055555555555, 871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222, 871.3288888888887, 870.7255555555558, 868.6944444444446, 870.3766666666669, 870.0922222222227, 870.0611111111116, 871.7111111111116, 871.4244444444446, 870.7244444444443, 871.1388888888891, 870.0911111111112, 870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999, 870.2511111111113, 869.9977777777782, 870.2511111111113, 871.4566666666669, 871.1077777777779, 869.6800000000002, 870.0300000000008, 869.6488888888894, 869.1400000000003, 870.187777777778, 870.1555555555557, 870.6011111111117, 869.488888888889, 869.0444444444444, 870.4100000000005, 870.6633333333335, 868.9811111111112, 869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1994697698081557, "mean_inference_ms": 1.8121750044304912, "mean_action_processing_ms": 0.07474835540972259, "mean_env_wait_ms": 1.221539043030536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004300355911254883, "StateBufferConnector_ms": 0.0030379295349121094, "ViewRequirementAgentConnector_ms": 0.07069993019104004}, "num_episodes": 30, "episode_return_max": 875.7633333333324, "episode_return_min": 868.6944444444446, "episode_return_mean": 871.3290777777777, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 374700, "num_env_steps_sampled": 375000, "num_env_steps_trained": 374700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 280.54823491485143, "num_env_steps_trained_throughput_per_sec": 265.7825383403856, "timesteps_total": 375000, "num_env_steps_sampled_lifetime": 375000, "num_agent_steps_sampled_lifetime": 375000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 375000, "timers": {"training_iteration_time_ms": 10256.676, "restore_workers_time_ms": 0.013, "training_step_time_ms": 529.817, "sample_time_ms": 515.703, "synch_weights_time_ms": 12.788}, "counters": {"num_env_steps_sampled": 375000, "num_env_steps_trained": 374700, "num_agent_steps_sampled": 375000, "num_agent_steps_trained": 374700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2500, "num_samples_added_to_queue": 375000}, "done": false, "training_iteration": 127, "trial_id": "38f59_00000", "date": "2024-10-10_22-33-19", "timestamp": 1728595999, "time_this_iter_s": 10.171313047409058, "time_total_s": 1302.386484861374, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1b040>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1302.386484861374, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 10.5, "ram_util_percent": 74.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1591.3126220703125, "policy_loss": -580.703857421875, "entropy": 4.847528457641602, "entropy_coeff": 0.01, "var_gnorm": 17.86366844177246, "vf_loss": 218655.90625, "vf_explained_var": 0.6022561192512512}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1259.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 377850, "num_env_steps_trained": 377700, "num_agent_steps_sampled": 377850, "num_agent_steps_trained": 377700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2519, "num_samples_added_to_queue": 377700, "learner_queue": {"size_count": 1259, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.225, "learner_load_time_ms": 0.287, "learner_load_wait_time_ms": 997.298, "learner_dequeue_time_ms": 8701.714}}, "env_runners": {"episode_reward_max": 873.2933333333327, "episode_reward_min": 868.6944444444446, "episode_reward_mean": 870.6468333333337, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.6944444444446}, "policy_reward_max": {"default_policy": 873.2933333333327}, "policy_reward_mean": {"default_policy": 870.6468333333337}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0032000000000000006, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.62468333333332, "mean_accuracy_min": 40.51099999999999, "mean_accuracy_max": 40.815, "num_model_switches_mean": 0.36359999999999987, "num_model_switches_min": 0.16, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006799999999999999, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5065188342296377, "mean_cluster_cpu_util_min": 0.5038736210700496, "mean_cluster_cpu_util_max": 0.5112856453392167, "mean_cluster_mem_util_mean": 0.3283826318565401, "mean_cluster_mem_util_min": 0.32784071729957803, "mean_cluster_mem_util_max": 0.3292283755274261, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.062468333333334, "reward_accuracy_mean_min": 4.0511, "reward_accuracy_mean_max": 4.0815, "reward_sla_mean_mean": -0.022666666666666665, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.2468333333334, "reward_accuracy_sum_min": 405.11, "reward_accuracy_sum_max": 408.15000000000003, "reward_sla_sum_mean": -2.266666666666667, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4688.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222, 871.3288888888887, 870.7255555555558, 868.6944444444446, 870.3766666666669, 870.0922222222227, 870.0611111111116, 871.7111111111116, 871.4244444444446, 870.7244444444443, 871.1388888888891, 870.0911111111112, 870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999, 870.2511111111113, 869.9977777777782, 870.2511111111113, 871.4566666666669, 871.1077777777779, 869.6800000000002, 870.0300000000008, 869.6488888888894, 869.1400000000003, 870.187777777778, 870.1555555555557, 870.6011111111117, 869.488888888889, 869.0444444444444, 870.4100000000005, 870.6633333333335, 868.9811111111112, 869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337, 869.014444444445, 870.187777777778, 869.8700000000002, 870.9177777777782, 870.662222222222, 869.4577777777781, 871.487777777778, 871.3922222222224, 870.9488888888891, 871.0133333333338, 868.9188888888891, 870.5055555555559, 871.5522222222223, 870.5055555555558, 871.3288888888887, 871.9633333333335, 871.361111111111, 870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [871.9299999999996, 871.4833333333327, 873.2933333333327, 872.1822222222219, 871.7077777777778, 872.311111111111, 871.2322222222223, 870.7244444444442, 872.0899999999999, 871.2644444444446, 872.2455555555551, 872.6588888888884, 870.848888888888, 870.5966666666666, 870.502222222222, 871.1366666666664, 871.0099999999998, 872.5022222222221, 871.962222222222, 871.3288888888887, 870.7255555555558, 868.6944444444446, 870.3766666666669, 870.0922222222227, 870.0611111111116, 871.7111111111116, 871.4244444444446, 870.7244444444443, 871.1388888888891, 870.0911111111112, 870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999, 870.2511111111113, 869.9977777777782, 870.2511111111113, 871.4566666666669, 871.1077777777779, 869.6800000000002, 870.0300000000008, 869.6488888888894, 869.1400000000003, 870.187777777778, 870.1555555555557, 870.6011111111117, 869.488888888889, 869.0444444444444, 870.4100000000005, 870.6633333333335, 868.9811111111112, 869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337, 869.014444444445, 870.187777777778, 869.8700000000002, 870.9177777777782, 870.662222222222, 869.4577777777781, 871.487777777778, 871.3922222222224, 870.9488888888891, 871.0133333333338, 868.9188888888891, 870.5055555555559, 871.5522222222223, 870.5055555555558, 871.3288888888887, 871.9633333333335, 871.361111111111, 870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19962204587195978, "mean_inference_ms": 1.8149391238938068, "mean_action_processing_ms": 0.07479989248845444, "mean_env_wait_ms": 1.2225368600694184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004129886627197266, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.06937885284423828}, "num_episodes": 27, "episode_return_max": 873.2933333333327, "episode_return_min": 868.6944444444446, "episode_return_mean": 870.6468333333337, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 377850, "num_agent_steps_trained": 377700, "num_env_steps_sampled": 377850, "num_env_steps_trained": 377700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.6524703452612, "num_env_steps_trained_throughput_per_sec": 295.42365299501176, "timesteps_total": 377850, "num_env_steps_sampled_lifetime": 377850, "num_agent_steps_sampled_lifetime": 377850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 377850, "timers": {"training_iteration_time_ms": 10229.796, "restore_workers_time_ms": 0.014, "training_step_time_ms": 544.193, "sample_time_ms": 527.651, "synch_weights_time_ms": 15.086}, "counters": {"num_env_steps_sampled": 377850, "num_env_steps_trained": 377700, "num_agent_steps_sampled": 377850, "num_agent_steps_trained": 377700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2519, "num_samples_added_to_queue": 377700}, "done": false, "training_iteration": 128, "trial_id": "38f59_00000", "date": "2024-10-10_22-33-29", "timestamp": 1728596009, "time_this_iter_s": 10.164700031280518, "time_total_s": 1312.5511848926544, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cc610>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1312.5511848926544, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 11.007142857142856, "ram_util_percent": 73.02857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1645.588623046875, "policy_loss": -251.7969512939453, "entropy": 4.686679840087891, "entropy_coeff": 0.01, "var_gnorm": 17.840152740478516, "vf_loss": 191144.578125, "vf_explained_var": 0.6543080806732178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1268.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 380700, "num_env_steps_trained": 380400, "num_agent_steps_sampled": 380700, "num_agent_steps_trained": 380400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2538, "num_samples_added_to_queue": 380700, "learner_queue": {"size_count": 1268, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.578, "learner_load_time_ms": 0.283, "learner_load_wait_time_ms": 1027.756, "learner_dequeue_time_ms": 8737.794}}, "env_runners": {"episode_reward_max": 872.2500000000003, "episode_reward_min": 868.5066666666671, "episode_reward_mean": 870.3915222222225, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.5066666666671}, "policy_reward_max": {"default_policy": 872.2500000000003}, "policy_reward_mean": {"default_policy": 870.3915222222225}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0034000000000000002, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.58959666666665, "mean_accuracy_min": 40.51099999999999, "mean_accuracy_max": 40.681999999999995, "num_model_switches_mean": 0.31859999999999994, "num_model_switches_min": 0.14, "num_model_switches_max": 0.47, "num_slav_mean": 0.0006513333333333335, "num_slav_min": 0.0002, "num_slav_max": 0.0010666666666666667, "mean_cluster_cpu_util_mean": 0.505897563315867, "mean_cluster_cpu_util_min": 0.5036200588343445, "mean_cluster_cpu_util_max": 0.5088578667953668, "mean_cluster_mem_util_mean": 0.3282258333333333, "mean_cluster_mem_util_min": 0.32782331223628686, "mean_cluster_mem_util_max": 0.32887078059071734, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.058959666666667, "reward_accuracy_mean_min": 4.0511, "reward_accuracy_mean_max": 4.068200000000001, "reward_sla_mean_mean": -0.02171111111111111, "reward_sla_mean_min": -0.035555555555555556, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.8959666666667, "reward_accuracy_sum_min": 405.11, "reward_accuracy_sum_max": 406.82000000000005, "reward_sla_sum_mean": -2.171111111111111, "reward_sla_sum_min": -3.555555555555556, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3353.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999, 870.2511111111113, 869.9977777777782, 870.2511111111113, 871.4566666666669, 871.1077777777779, 869.6800000000002, 870.0300000000008, 869.6488888888894, 869.1400000000003, 870.187777777778, 870.1555555555557, 870.6011111111117, 869.488888888889, 869.0444444444444, 870.4100000000005, 870.6633333333335, 868.9811111111112, 869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337, 869.014444444445, 870.187777777778, 869.8700000000002, 870.9177777777782, 870.662222222222, 869.4577777777781, 871.487777777778, 871.3922222222224, 870.9488888888891, 871.0133333333338, 868.9188888888891, 870.5055555555559, 871.5522222222223, 870.5055555555558, 871.3288888888887, 871.9633333333335, 871.361111111111, 870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003, 871.3933333333337, 871.4877777777781, 870.6000000000004, 871.0755555555558, 869.9033333333339, 870.6955555555559, 870.2511111111113, 869.6811111111115, 869.966666666667, 868.5066666666671, 870.155555555556, 870.598888888889, 870.917777777778, 870.2500000000003, 871.7744444444448, 870.6955555555559, 869.2677777777781, 870.7277777777781, 870.9811111111113, 870.0300000000007, 871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.2500000000003, 869.6155555555559, 871.2033333333334, 870.408888888889, 871.0444444444449, 870.3766666666667, 871.2655555555558, 870.2177777777775, 870.3755555555556, 870.5677777777777, 869.2366666666671, 869.4255555555554, 869.8699999999999, 870.2511111111113, 869.9977777777782, 870.2511111111113, 871.4566666666669, 871.1077777777779, 869.6800000000002, 870.0300000000008, 869.6488888888894, 869.1400000000003, 870.187777777778, 870.1555555555557, 870.6011111111117, 869.488888888889, 869.0444444444444, 870.4100000000005, 870.6633333333335, 868.9811111111112, 869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337, 869.014444444445, 870.187777777778, 869.8700000000002, 870.9177777777782, 870.662222222222, 869.4577777777781, 871.487777777778, 871.3922222222224, 870.9488888888891, 871.0133333333338, 868.9188888888891, 870.5055555555559, 871.5522222222223, 870.5055555555558, 871.3288888888887, 871.9633333333335, 871.361111111111, 870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003, 871.3933333333337, 871.4877777777781, 870.6000000000004, 871.0755555555558, 869.9033333333339, 870.6955555555559, 870.2511111111113, 869.6811111111115, 869.966666666667, 868.5066666666671, 870.155555555556, 870.598888888889, 870.917777777778, 870.2500000000003, 871.7744444444448, 870.6955555555559, 869.2677777777781, 870.7277777777781, 870.9811111111113, 870.0300000000007, 871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1996901261084928, "mean_inference_ms": 1.8168555346773865, "mean_action_processing_ms": 0.07482294247724647, "mean_env_wait_ms": 1.223025890488878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038199424743652344, "StateBufferConnector_ms": 0.0027930736541748047, "ViewRequirementAgentConnector_ms": 0.06447792053222656}, "num_episodes": 30, "episode_return_max": 872.2500000000003, "episode_return_min": 868.5066666666671, "episode_return_mean": 870.3915222222225, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380700, "num_agent_steps_trained": 380400, "num_env_steps_sampled": 380700, "num_env_steps_trained": 380400, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 280.0121920356174, "num_env_steps_trained_throughput_per_sec": 265.2747082442691, "timesteps_total": 380700, "num_env_steps_sampled_lifetime": 380700, "num_agent_steps_sampled_lifetime": 380700, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 380700, "timers": {"training_iteration_time_ms": 10212.824, "restore_workers_time_ms": 0.014, "training_step_time_ms": 531.038, "sample_time_ms": 515.765, "synch_weights_time_ms": 13.93}, "counters": {"num_env_steps_sampled": 380700, "num_env_steps_trained": 380400, "num_agent_steps_sampled": 380700, "num_agent_steps_trained": 380400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2538, "num_samples_added_to_queue": 380700}, "done": false, "training_iteration": 129, "trial_id": "38f59_00000", "date": "2024-10-10_22-33-39", "timestamp": 1728596019, "time_this_iter_s": 10.188149690628052, "time_total_s": 1322.7393345832825, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cfd30>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1322.7393345832825, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 11.453333333333331, "ram_util_percent": 71.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2864.252197265625, "policy_loss": 996.0586547851562, "entropy": 4.786584377288818, "entropy_coeff": 0.01, "var_gnorm": 17.831581115722656, "vf_loss": 188255.34375, "vf_explained_var": 0.6428526043891907}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1278.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 383700, "num_env_steps_trained": 383400, "num_agent_steps_sampled": 383700, "num_agent_steps_trained": 383400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2558, "num_samples_added_to_queue": 383700, "learner_queue": {"size_count": 1278, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.804, "learner_load_time_ms": 0.264, "learner_load_wait_time_ms": 990.344, "learner_dequeue_time_ms": 8739.727}}, "env_runners": {"episode_reward_max": 872.2500000000003, "episode_reward_min": 868.284444444445, "episode_reward_mean": 870.3670333333336, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.284444444445}, "policy_reward_max": {"default_policy": 872.2500000000003}, "policy_reward_mean": {"default_policy": 870.3670333333336}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0036000000000000008, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.57870333333332, "mean_accuracy_min": 40.50466666666666, "mean_accuracy_max": 40.67566666666666, "num_model_switches_mean": 0.29719999999999996, "num_model_switches_min": 0.1, "num_model_switches_max": 0.47, "num_slav_mean": 0.000626, "num_slav_min": 0.0002, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.505707783944659, "mean_cluster_cpu_util_min": 0.503572658117301, "mean_cluster_cpu_util_max": 0.5088578667953668, "mean_cluster_mem_util_mean": 0.32818068037974674, "mean_cluster_mem_util_min": 0.3277863924050633, "mean_cluster_mem_util_max": 0.32887078059071734, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.057870333333334, "reward_accuracy_mean_min": 4.050466666666668, "reward_accuracy_mean_max": 4.067566666666667, "reward_sla_mean_mean": -0.020866666666666665, "reward_sla_mean_min": -0.03777777777777778, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.78703333333345, "reward_accuracy_sum_min": 405.04666666666674, "reward_accuracy_sum_max": 406.7566666666667, "reward_sla_sum_mean": -2.086666666666667, "reward_sla_sum_min": -3.7777777777777777, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2159.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337, 869.014444444445, 870.187777777778, 869.8700000000002, 870.9177777777782, 870.662222222222, 869.4577777777781, 871.487777777778, 871.3922222222224, 870.9488888888891, 871.0133333333338, 868.9188888888891, 870.5055555555559, 871.5522222222223, 870.5055555555558, 871.3288888888887, 871.9633333333335, 871.361111111111, 870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003, 871.3933333333337, 871.4877777777781, 870.6000000000004, 871.0755555555558, 869.9033333333339, 870.6955555555559, 870.2511111111113, 869.6811111111115, 869.966666666667, 868.5066666666671, 870.155555555556, 870.598888888889, 870.917777777778, 870.2500000000003, 871.7744444444448, 870.6955555555559, 869.2677777777781, 870.7277777777781, 870.9811111111113, 870.0300000000007, 871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116, 870.1244444444449, 868.4744444444449, 871.2677777777782, 869.2044444444448, 870.1566666666671, 870.8233333333337, 870.0933333333336, 870.2200000000004, 871.234444444445, 869.7111111111112, 868.284444444445, 870.1577777777782, 869.8400000000006, 869.9033333333338, 868.6011111111113, 869.997777777778, 871.0755555555555, 870.3777777777782, 870.4411111111114, 870.3777777777782, 869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.6155555555557, 870.6011111111114, 871.487777777778, 870.1566666666671, 869.7766666666672, 869.584444444445, 869.9344444444447, 870.5677777777776, 871.9966666666668, 870.2188888888887, 869.996666666667, 870.9811111111115, 870.4733333333337, 869.014444444445, 870.187777777778, 869.8700000000002, 870.9177777777782, 870.662222222222, 869.4577777777781, 871.487777777778, 871.3922222222224, 870.9488888888891, 871.0133333333338, 868.9188888888891, 870.5055555555559, 871.5522222222223, 870.5055555555558, 871.3288888888887, 871.9633333333335, 871.361111111111, 870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003, 871.3933333333337, 871.4877777777781, 870.6000000000004, 871.0755555555558, 869.9033333333339, 870.6955555555559, 870.2511111111113, 869.6811111111115, 869.966666666667, 868.5066666666671, 870.155555555556, 870.598888888889, 870.917777777778, 870.2500000000003, 871.7744444444448, 870.6955555555559, 869.2677777777781, 870.7277777777781, 870.9811111111113, 870.0300000000007, 871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116, 870.1244444444449, 868.4744444444449, 871.2677777777782, 869.2044444444448, 870.1566666666671, 870.8233333333337, 870.0933333333336, 870.2200000000004, 871.234444444445, 869.7111111111112, 868.284444444445, 870.1577777777782, 869.8400000000006, 869.9033333333338, 868.6011111111113, 869.997777777778, 871.0755555555555, 870.3777777777782, 870.4411111111114, 870.3777777777782, 869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.199655952757237, "mean_inference_ms": 1.8170650385665061, "mean_action_processing_ms": 0.07482377610211036, "mean_env_wait_ms": 1.2230445743460883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00384521484375, "StateBufferConnector_ms": 0.0027959346771240234, "ViewRequirementAgentConnector_ms": 0.06471896171569824}, "num_episodes": 30, "episode_return_max": 872.2500000000003, "episode_return_min": 868.284444444445, "episode_return_mean": 870.3670333333336, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 383700, "num_agent_steps_trained": 383400, "num_env_steps_sampled": 383700, "num_env_steps_trained": 383400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.21906632199125, "num_env_steps_trained_throughput_per_sec": 286.21906632199125, "timesteps_total": 383700, "num_env_steps_sampled_lifetime": 383700, "num_agent_steps_sampled_lifetime": 383700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 383700, "timers": {"training_iteration_time_ms": 10218.583, "restore_workers_time_ms": 0.014, "training_step_time_ms": 526.682, "sample_time_ms": 512.022, "synch_weights_time_ms": 13.344}, "counters": {"num_env_steps_sampled": 383700, "num_env_steps_trained": 383400, "num_agent_steps_sampled": 383700, "num_agent_steps_trained": 383400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2558, "num_samples_added_to_queue": 383700}, "done": false, "training_iteration": 130, "trial_id": "38f59_00000", "date": "2024-10-10_22-33-50", "timestamp": 1728596030, "time_this_iter_s": 10.49144196510315, "time_total_s": 1333.2307765483856, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc6500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1333.2307765483856, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 10.286666666666665, "ram_util_percent": 71.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2281.950927734375, "policy_loss": 311.4342041015625, "entropy": 4.9337687492370605, "entropy_coeff": 0.01, "var_gnorm": 17.84740447998047, "vf_loss": 198531.8125, "vf_explained_var": 0.6355900764465332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1288.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 386700, "num_env_steps_trained": 386400, "num_agent_steps_sampled": 386700, "num_agent_steps_trained": 386400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2578, "num_samples_added_to_queue": 386700, "learner_queue": {"size_count": 1288, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.601, "learner_load_time_ms": 0.282, "learner_load_wait_time_ms": 976.634, "learner_dequeue_time_ms": 8727.127}}, "env_runners": {"episode_reward_max": 872.7233333333331, "episode_reward_min": 868.284444444445, "episode_reward_mean": 870.5577666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.284444444445}, "policy_reward_max": {"default_policy": 872.7233333333331}, "policy_reward_mean": {"default_policy": 870.5577666666669}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0018, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.606443333333324, "mean_accuracy_min": 40.50466666666666, "mean_accuracy_max": 40.751666666666665, "num_model_switches_mean": 0.3362, "num_model_switches_min": 0.1, "num_model_switches_max": 0.57, "num_slav_mean": 0.0006519999999999999, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.506073479614819, "mean_cluster_cpu_util_min": 0.503572658117301, "mean_cluster_cpu_util_max": 0.5088578667953668, "mean_cluster_mem_util_mean": 0.3282873470464135, "mean_cluster_mem_util_min": 0.3277863924050633, "mean_cluster_mem_util_max": 0.32887078059071734, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.060644333333334, "reward_accuracy_mean_min": 4.050466666666668, "reward_accuracy_mean_max": 4.075166666666667, "reward_sla_mean_mean": -0.021733333333333334, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.06443333333345, "reward_accuracy_sum_min": 405.04666666666674, "reward_accuracy_sum_max": 407.5166666666667, "reward_sla_sum_mean": -2.173333333333334, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2459.0, "global_timestep_min": 300, "global_timestep_max": 4100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003, 871.3933333333337, 871.4877777777781, 870.6000000000004, 871.0755555555558, 869.9033333333339, 870.6955555555559, 870.2511111111113, 869.6811111111115, 869.966666666667, 868.5066666666671, 870.155555555556, 870.598888888889, 870.917777777778, 870.2500000000003, 871.7744444444448, 870.6955555555559, 869.2677777777781, 870.7277777777781, 870.9811111111113, 870.0300000000007, 871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116, 870.1244444444449, 868.4744444444449, 871.2677777777782, 869.2044444444448, 870.1566666666671, 870.8233333333337, 870.0933333333336, 870.2200000000004, 871.234444444445, 869.7111111111112, 868.284444444445, 870.1577777777782, 869.8400000000006, 869.9033333333338, 868.6011111111113, 869.997777777778, 871.0755555555555, 870.3777777777782, 870.4411111111114, 870.3777777777782, 869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334, 870.6944444444445, 870.9155555555557, 870.4400000000004, 871.3277777777777, 871.1366666666667, 872.0577777777778, 871.0744444444443, 872.7233333333331, 870.5977777777777, 871.518888888889, 870.8533333333335, 871.3922222222222, 871.0422222222218, 870.8199999999999, 871.2322222222222, 871.0744444444442, 872.184444444444, 871.0722222222222, 869.8366666666665, 871.3911111111107, 870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.2822222222222, 870.4100000000004, 870.0922222222227, 870.7266666666666, 869.5833333333337, 869.6155555555559, 870.3122222222221, 870.2177777777775, 871.7100000000002, 872.2500000000003, 871.3933333333337, 871.4877777777781, 870.6000000000004, 871.0755555555558, 869.9033333333339, 870.6955555555559, 870.2511111111113, 869.6811111111115, 869.966666666667, 868.5066666666671, 870.155555555556, 870.598888888889, 870.917777777778, 870.2500000000003, 871.7744444444448, 870.6955555555559, 869.2677777777781, 870.7277777777781, 870.9811111111113, 870.0300000000007, 871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116, 870.1244444444449, 868.4744444444449, 871.2677777777782, 869.2044444444448, 870.1566666666671, 870.8233333333337, 870.0933333333336, 870.2200000000004, 871.234444444445, 869.7111111111112, 868.284444444445, 870.1577777777782, 869.8400000000006, 869.9033333333338, 868.6011111111113, 869.997777777778, 871.0755555555555, 870.3777777777782, 870.4411111111114, 870.3777777777782, 869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334, 870.6944444444445, 870.9155555555557, 870.4400000000004, 871.3277777777777, 871.1366666666667, 872.0577777777778, 871.0744444444443, 872.7233333333331, 870.5977777777777, 871.518888888889, 870.8533333333335, 871.3922222222222, 871.0422222222218, 870.8199999999999, 871.2322222222222, 871.0744444444442, 872.184444444444, 871.0722222222222, 869.8366666666665, 871.3911111111107, 870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19965619466141166, "mean_inference_ms": 1.8187292437375497, "mean_action_processing_ms": 0.07483318838897897, "mean_env_wait_ms": 1.223349046247582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038199424743652344, "StateBufferConnector_ms": 0.0027735233306884766, "ViewRequirementAgentConnector_ms": 0.0641939640045166}, "num_episodes": 30, "episode_return_max": 872.7233333333331, "episode_return_min": 868.284444444445, "episode_return_mean": 870.5577666666669, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 386700, "num_agent_steps_trained": 386400, "num_env_steps_sampled": 386700, "num_env_steps_trained": 386400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.02750140518253, "num_env_steps_trained_throughput_per_sec": 288.02750140518253, "timesteps_total": 386700, "num_env_steps_sampled_lifetime": 386700, "num_agent_steps_sampled_lifetime": 386700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 386700, "timers": {"training_iteration_time_ms": 10257.248, "restore_workers_time_ms": 0.013, "training_step_time_ms": 517.361, "sample_time_ms": 501.784, "synch_weights_time_ms": 14.271}, "counters": {"num_env_steps_sampled": 386700, "num_env_steps_trained": 386400, "num_agent_steps_sampled": 386700, "num_agent_steps_trained": 386400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2578, "num_samples_added_to_queue": 386700}, "done": false, "training_iteration": 131, "trial_id": "38f59_00000", "date": "2024-10-10_22-34-00", "timestamp": 1728596040, "time_this_iter_s": 10.425522327423096, "time_total_s": 1343.6562988758087, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1b010>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1343.6562988758087, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 10.433333333333334, "ram_util_percent": 72.04666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1368.869384765625, "policy_loss": -519.0120239257812, "entropy": 4.748781204223633, "entropy_coeff": 0.01, "var_gnorm": 17.8731746673584, "vf_loss": 190212.78125, "vf_explained_var": 0.6422383189201355}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1298.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 389700, "num_env_steps_trained": 389400, "num_agent_steps_sampled": 389700, "num_agent_steps_trained": 389400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2598, "num_samples_added_to_queue": 389700, "learner_queue": {"size_count": 1298, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.405, "learner_load_time_ms": 0.281, "learner_load_wait_time_ms": 977.047, "learner_dequeue_time_ms": 8756.15}}, "env_runners": {"episode_reward_max": 872.8188888888886, "episode_reward_min": 868.284444444445, "episode_reward_mean": 870.6094444444446, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 868.284444444445}, "policy_reward_max": {"default_policy": 872.8188888888886}, "policy_reward_mean": {"default_policy": 870.6094444444446}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0022, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.60916666666666, "mean_accuracy_min": 40.50466666666665, "mean_accuracy_max": 40.751666666666665, "num_model_switches_mean": 0.343, "num_model_switches_min": 0.1, "num_model_switches_max": 0.57, "num_slav_mean": 0.0006446666666666665, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5061575128700128, "mean_cluster_cpu_util_min": 0.5034990462401177, "mean_cluster_cpu_util_max": 0.5092022545504689, "mean_cluster_mem_util_mean": 0.328301861814346, "mean_cluster_mem_util_min": 0.32767194092827007, "mean_cluster_mem_util_max": 0.3289778481012658, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.060916666666667, "reward_accuracy_mean_min": 4.050466666666668, "reward_accuracy_mean_max": 4.075166666666667, "reward_sla_mean_mean": -0.02148888888888888, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 406.0916666666668, "reward_accuracy_sum_min": 405.04666666666674, "reward_accuracy_sum_max": 407.5166666666667, "reward_sla_sum_mean": -2.148888888888889, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3450.0, "global_timestep_min": 1200, "global_timestep_max": 5100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116, 870.1244444444449, 868.4744444444449, 871.2677777777782, 869.2044444444448, 870.1566666666671, 870.8233333333337, 870.0933333333336, 870.2200000000004, 871.234444444445, 869.7111111111112, 868.284444444445, 870.1577777777782, 869.8400000000006, 869.9033333333338, 868.6011111111113, 869.997777777778, 871.0755555555555, 870.3777777777782, 870.4411111111114, 870.3777777777782, 869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334, 870.6944444444445, 870.9155555555557, 870.4400000000004, 871.3277777777777, 871.1366666666667, 872.0577777777778, 871.0744444444443, 872.7233333333331, 870.5977777777777, 871.518888888889, 870.8533333333335, 871.3922222222222, 871.0422222222218, 870.8199999999999, 871.2322222222222, 871.0744444444442, 872.184444444444, 871.0722222222222, 869.8366666666665, 871.3911111111107, 870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997, 870.5344444444444, 871.0422222222224, 871.0122222222225, 869.7433333333337, 870.2188888888894, 870.4733333333334, 871.4888888888892, 870.0611111111112, 870.6000000000001, 869.7133333333338, 872.8188888888886, 871.3611111111111, 869.3611111111109, 870.0922222222225, 871.3300000000004, 871.488888888889, 871.1722222222228, 870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [871.265555555556, 870.8222222222225, 870.1555555555557, 869.6155555555557, 869.1411111111117, 870.3144444444448, 870.2833333333339, 870.7277777777783, 870.0933333333337, 871.1411111111116, 870.1244444444449, 868.4744444444449, 871.2677777777782, 869.2044444444448, 870.1566666666671, 870.8233333333337, 870.0933333333336, 870.2200000000004, 871.234444444445, 869.7111111111112, 868.284444444445, 870.1577777777782, 869.8400000000006, 869.9033333333338, 868.6011111111113, 869.997777777778, 871.0755555555555, 870.3777777777782, 870.4411111111114, 870.3777777777782, 869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334, 870.6944444444445, 870.9155555555557, 870.4400000000004, 871.3277777777777, 871.1366666666667, 872.0577777777778, 871.0744444444443, 872.7233333333331, 870.5977777777777, 871.518888888889, 870.8533333333335, 871.3922222222222, 871.0422222222218, 870.8199999999999, 871.2322222222222, 871.0744444444442, 872.184444444444, 871.0722222222222, 869.8366666666665, 871.3911111111107, 870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997, 870.5344444444444, 871.0422222222224, 871.0122222222225, 869.7433333333337, 870.2188888888894, 870.4733333333334, 871.4888888888892, 870.0611111111112, 870.6000000000001, 869.7133333333338, 872.8188888888886, 871.3611111111111, 869.3611111111109, 870.0922222222225, 871.3300000000004, 871.488888888889, 871.1722222222228, 870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19960117723831403, "mean_inference_ms": 1.8187904768870593, "mean_action_processing_ms": 0.07482088108643659, "mean_env_wait_ms": 1.2232438994942905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037817955017089844, "StateBufferConnector_ms": 0.0027446746826171875, "ViewRequirementAgentConnector_ms": 0.06363058090209961}, "num_episodes": 30, "episode_return_max": 872.8188888888886, "episode_return_min": 868.284444444445, "episode_return_mean": 870.6094444444446, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 389700, "num_agent_steps_trained": 389400, "num_env_steps_sampled": 389700, "num_env_steps_trained": 389400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.42039596411246, "num_env_steps_trained_throughput_per_sec": 288.42039596411246, "timesteps_total": 389700, "num_env_steps_sampled_lifetime": 389700, "num_agent_steps_sampled_lifetime": 389700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 389700, "timers": {"training_iteration_time_ms": 10294.409, "restore_workers_time_ms": 0.014, "training_step_time_ms": 529.149, "sample_time_ms": 513.499, "synch_weights_time_ms": 14.13}, "counters": {"num_env_steps_sampled": 389700, "num_env_steps_trained": 389400, "num_agent_steps_sampled": 389700, "num_agent_steps_trained": 389400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2598, "num_samples_added_to_queue": 389700}, "done": false, "training_iteration": 132, "trial_id": "38f59_00000", "date": "2024-10-10_22-34-11", "timestamp": 1728596051, "time_this_iter_s": 10.411487579345703, "time_total_s": 1354.0677864551544, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1b7f0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1354.0677864551544, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 10.68, "ram_util_percent": 70.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1161.65283203125, "policy_loss": -825.51025390625, "entropy": 4.745509624481201, "entropy_coeff": 0.01, "var_gnorm": 17.897018432617188, "vf_loss": 200139.96875, "vf_explained_var": 0.6351944208145142}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1308.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 392700, "num_env_steps_trained": 392400, "num_agent_steps_sampled": 392700, "num_agent_steps_trained": 392400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2618, "num_samples_added_to_queue": 392700, "learner_queue": {"size_count": 1308, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.266, "learner_load_time_ms": 0.246, "learner_load_wait_time_ms": 983.329, "learner_dequeue_time_ms": 8756.755}}, "env_runners": {"episode_reward_max": 872.8188888888886, "episode_reward_min": 867.6822222222224, "episode_reward_mean": 870.352788888889, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.6822222222224}, "policy_reward_max": {"default_policy": 872.8188888888886}, "policy_reward_mean": {"default_policy": 870.352788888889}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0024000000000000002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.58972333333333, "mean_accuracy_min": 40.45399999999999, "mean_accuracy_max": 40.751666666666665, "num_model_switches_mean": 0.31520000000000004, "num_model_switches_min": 0.1, "num_model_switches_max": 0.57, "num_slav_mean": 0.0006633333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5058604008089723, "mean_cluster_cpu_util_min": 0.5025402762456335, "mean_cluster_cpu_util_max": 0.5092022545504689, "mean_cluster_mem_util_mean": 0.3282320833333333, "mean_cluster_mem_util_min": 0.327623417721519, "mean_cluster_mem_util_max": 0.3289778481012658, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.058972333333333, "reward_accuracy_mean_min": 4.045400000000001, "reward_accuracy_mean_max": 4.075166666666667, "reward_sla_mean_mean": -0.02211111111111111, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.89723333333336, "reward_accuracy_sum_min": 404.5400000000001, "reward_accuracy_sum_max": 407.5166666666667, "reward_sla_sum_mean": -2.2111111111111112, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4450.0, "global_timestep_min": 2200, "global_timestep_max": 6100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334, 870.6944444444445, 870.9155555555557, 870.4400000000004, 871.3277777777777, 871.1366666666667, 872.0577777777778, 871.0744444444443, 872.7233333333331, 870.5977777777777, 871.518888888889, 870.8533333333335, 871.3922222222222, 871.0422222222218, 870.8199999999999, 871.2322222222222, 871.0744444444442, 872.184444444444, 871.0722222222222, 869.8366666666665, 871.3911111111107, 870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997, 870.5344444444444, 871.0422222222224, 871.0122222222225, 869.7433333333337, 870.2188888888894, 870.4733333333334, 871.4888888888892, 870.0611111111112, 870.6000000000001, 869.7133333333338, 872.8188888888886, 871.3611111111111, 869.3611111111109, 870.0922222222225, 871.3300000000004, 871.488888888889, 871.1722222222228, 870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778, 870.3477777777783, 868.4422222222224, 867.9033333333335, 869.1733333333339, 870.1266666666673, 869.998888888889, 869.2055555555559, 868.6666666666671, 868.7622222222226, 867.7777777777784, 869.1733333333339, 869.4900000000004, 870.4744444444449, 868.3488888888893, 869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.1733333333336, 870.7922222222226, 870.1888888888894, 868.3155555555555, 870.2833333333336, 869.0455555555558, 871.1722222222224, 870.6633333333332, 871.33, 871.173333333334, 870.6944444444445, 870.9155555555557, 870.4400000000004, 871.3277777777777, 871.1366666666667, 872.0577777777778, 871.0744444444443, 872.7233333333331, 870.5977777777777, 871.518888888889, 870.8533333333335, 871.3922222222222, 871.0422222222218, 870.8199999999999, 871.2322222222222, 871.0744444444442, 872.184444444444, 871.0722222222222, 869.8366666666665, 871.3911111111107, 870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997, 870.5344444444444, 871.0422222222224, 871.0122222222225, 869.7433333333337, 870.2188888888894, 870.4733333333334, 871.4888888888892, 870.0611111111112, 870.6000000000001, 869.7133333333338, 872.8188888888886, 871.3611111111111, 869.3611111111109, 870.0922222222225, 871.3300000000004, 871.488888888889, 871.1722222222228, 870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778, 870.3477777777783, 868.4422222222224, 867.9033333333335, 869.1733333333339, 870.1266666666673, 869.998888888889, 869.2055555555559, 868.6666666666671, 868.7622222222226, 867.7777777777784, 869.1733333333339, 869.4900000000004, 870.4744444444449, 868.3488888888893, 869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19955071243881575, "mean_inference_ms": 1.818929703450686, "mean_action_processing_ms": 0.0748064521170449, "mean_env_wait_ms": 1.223178278964251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004212617874145508, "StateBufferConnector_ms": 0.002735137939453125, "ViewRequirementAgentConnector_ms": 0.06353974342346191}, "num_episodes": 30, "episode_return_max": 872.8188888888886, "episode_return_min": 867.6822222222224, "episode_return_mean": 870.352788888889, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392700, "num_agent_steps_trained": 392400, "num_env_steps_sampled": 392700, "num_env_steps_trained": 392400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 287.77852567123387, "num_env_steps_trained_throughput_per_sec": 287.77852567123387, "timesteps_total": 392700, "num_env_steps_sampled_lifetime": 392700, "num_agent_steps_sampled_lifetime": 392700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 392700, "timers": {"training_iteration_time_ms": 10306.091, "restore_workers_time_ms": 0.012, "training_step_time_ms": 517.173, "sample_time_ms": 502.071, "synch_weights_time_ms": 13.809}, "counters": {"num_env_steps_sampled": 392700, "num_env_steps_trained": 392400, "num_agent_steps_sampled": 392700, "num_agent_steps_trained": 392400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2618, "num_samples_added_to_queue": 392700}, "done": false, "training_iteration": 133, "trial_id": "38f59_00000", "date": "2024-10-10_22-34-21", "timestamp": 1728596061, "time_this_iter_s": 10.434497594833374, "time_total_s": 1364.5022840499878, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cc100>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1364.5022840499878, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 10.526666666666667, "ram_util_percent": 70.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1153.69384765625, "policy_loss": -861.4474487304688, "entropy": 4.630006790161133, "entropy_coeff": 0.01, "var_gnorm": 17.902368545532227, "vf_loss": 202903.125, "vf_explained_var": 0.633463978767395}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1318.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 395700, "num_env_steps_trained": 395400, "num_agent_steps_sampled": 395700, "num_agent_steps_trained": 395400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2638, "num_samples_added_to_queue": 395700, "learner_queue": {"size_count": 1318, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.186, "learner_load_time_ms": 0.242, "learner_load_wait_time_ms": 987.411, "learner_dequeue_time_ms": 8611.715}}, "env_runners": {"episode_reward_max": 872.8188888888886, "episode_reward_min": 867.3966666666669, "episode_reward_mean": 869.8498222222225, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.3966666666669}, "policy_reward_max": {"default_policy": 872.8188888888886}, "policy_reward_mean": {"default_policy": 869.8498222222225}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0052, "num_moves_min": 0.0, "num_moves_max": 0.06, "mean_accuracy_mean": 40.543426666666655, "mean_accuracy_min": 40.44766666666666, "mean_accuracy_max": 40.751666666666665, "num_model_switches_mean": 0.24600000000000005, "num_model_switches_min": 0.05, "num_model_switches_max": 0.57, "num_slav_mean": 0.0006753333333333334, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5051306495909175, "mean_cluster_cpu_util_min": 0.5025391156462584, "mean_cluster_cpu_util_max": 0.5092022545504689, "mean_cluster_mem_util_mean": 0.3280371308016878, "mean_cluster_mem_util_min": 0.3275996835443038, "mean_cluster_mem_util_max": 0.3289778481012658, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.054342666666667, "reward_accuracy_mean_min": 4.044766666666668, "reward_accuracy_mean_max": 4.075166666666667, "reward_sla_mean_mean": -0.022511111111111117, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.011111111111111112, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.43426666666676, "reward_accuracy_sum_min": 404.47666666666674, "reward_accuracy_sum_max": 407.5166666666667, "reward_sla_sum_mean": -2.2511111111111113, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -1.1111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5450.0, "global_timestep_min": 3200, "global_timestep_max": 7100}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997, 870.5344444444444, 871.0422222222224, 871.0122222222225, 869.7433333333337, 870.2188888888894, 870.4733333333334, 871.4888888888892, 870.0611111111112, 870.6000000000001, 869.7133333333338, 872.8188888888886, 871.3611111111111, 869.3611111111109, 870.0922222222225, 871.3300000000004, 871.488888888889, 871.1722222222228, 870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778, 870.3477777777783, 868.4422222222224, 867.9033333333335, 869.1733333333339, 870.1266666666673, 869.998888888889, 869.2055555555559, 868.6666666666671, 868.7622222222226, 867.7777777777784, 869.1733333333339, 869.4900000000004, 870.4744444444449, 868.3488888888893, 869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669, 869.5555555555559, 869.1111111111118, 868.6022222222227, 869.1100000000004, 870.0000000000007, 868.4444444444449, 869.9044444444451, 868.0322222222226, 868.6033333333337, 868.1900000000005, 869.8088888888893, 870.2533333333339, 870.3800000000006, 869.6822222222228, 869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.2822222222225, 870.9800000000002, 872.4388888888889, 872.2477777777779, 871.581111111111, 871.6777777777777, 869.5811111111111, 871.5177777777776, 871.0099999999999, 870.8499999999997, 870.5344444444444, 871.0422222222224, 871.0122222222225, 869.7433333333337, 870.2188888888894, 870.4733333333334, 871.4888888888892, 870.0611111111112, 870.6000000000001, 869.7133333333338, 872.8188888888886, 871.3611111111111, 869.3611111111109, 870.0922222222225, 871.3300000000004, 871.488888888889, 871.1722222222228, 870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778, 870.3477777777783, 868.4422222222224, 867.9033333333335, 869.1733333333339, 870.1266666666673, 869.998888888889, 869.2055555555559, 868.6666666666671, 868.7622222222226, 867.7777777777784, 869.1733333333339, 869.4900000000004, 870.4744444444449, 868.3488888888893, 869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669, 869.5555555555559, 869.1111111111118, 868.6022222222227, 869.1100000000004, 870.0000000000007, 868.4444444444449, 869.9044444444451, 868.0322222222226, 868.6033333333337, 868.1900000000005, 869.8088888888893, 870.2533333333339, 870.3800000000006, 869.6822222222228, 869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19950392796978755, "mean_inference_ms": 1.8189960430199161, "mean_action_processing_ms": 0.07479210270679765, "mean_env_wait_ms": 1.2231052551222426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004238128662109375, "StateBufferConnector_ms": 0.002730131149291992, "ViewRequirementAgentConnector_ms": 0.06339764595031738}, "num_episodes": 30, "episode_return_max": 872.8188888888886, "episode_return_min": 867.3966666666669, "episode_return_mean": 869.8498222222225, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 395700, "num_agent_steps_trained": 395400, "num_env_steps_sampled": 395700, "num_env_steps_trained": 395400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.1888050909574, "num_env_steps_trained_throughput_per_sec": 288.1888050909574, "timesteps_total": 395700, "num_env_steps_sampled_lifetime": 395700, "num_agent_steps_sampled_lifetime": 395700, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 395700, "timers": {"training_iteration_time_ms": 10338.453, "restore_workers_time_ms": 0.012, "training_step_time_ms": 526.415, "sample_time_ms": 511.021, "synch_weights_time_ms": 13.956}, "counters": {"num_env_steps_sampled": 395700, "num_env_steps_trained": 395400, "num_agent_steps_sampled": 395700, "num_agent_steps_trained": 395400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2638, "num_samples_added_to_queue": 395700}, "done": false, "training_iteration": 134, "trial_id": "38f59_00000", "date": "2024-10-10_22-34-32", "timestamp": 1728596072, "time_this_iter_s": 10.42302417755127, "time_total_s": 1374.925308227539, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18be0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1374.925308227539, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 10.573333333333332, "ram_util_percent": 70.84666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2427.3076171875, "policy_loss": 368.4927978515625, "entropy": 4.608061790466309, "entropy_coeff": 0.01, "var_gnorm": 17.89975929260254, "vf_loss": 207263.890625, "vf_explained_var": 0.6295785903930664}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1327.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 398400, "num_env_steps_trained": 398100, "num_agent_steps_sampled": 398400, "num_agent_steps_trained": 398100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2656, "num_samples_added_to_queue": 398400, "learner_queue": {"size_count": 1327, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.948, "learner_load_time_ms": 0.254, "learner_load_wait_time_ms": 1065.115, "learner_dequeue_time_ms": 8445.41}}, "env_runners": {"episode_reward_max": 871.5822222222224, "episode_reward_min": 867.3966666666669, "episode_reward_mean": 869.4776333333338, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.3966666666669}, "policy_reward_max": {"default_policy": 871.5822222222224}, "policy_reward_mean": {"default_policy": 869.4776333333338}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.008199999999999999, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.510429999999985, "mean_accuracy_min": 40.44766666666666, "mean_accuracy_max": 40.66933333333333, "num_model_switches_mean": 0.18409999999999996, "num_model_switches_min": 0.05, "num_model_switches_max": 0.44, "num_slav_mean": 0.000688, "num_slav_min": 0.0003333333333333333, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5046055048032727, "mean_cluster_cpu_util_min": 0.5025391156462584, "mean_cluster_cpu_util_max": 0.5082513329656186, "mean_cluster_mem_util_mean": 0.32788940928270044, "mean_cluster_mem_util_min": 0.3275933544303797, "mean_cluster_mem_util_max": 0.3287552742616034, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.051043, "reward_accuracy_mean_min": 4.044766666666668, "reward_accuracy_mean_max": 4.066933333333334, "reward_sla_mean_mean": -0.022933333333333333, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.011111111111111112, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.1043000000001, "reward_accuracy_sum_min": 404.47666666666674, "reward_accuracy_sum_max": 406.6933333333334, "reward_sla_sum_mean": -2.293333333333334, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -1.1111111111111112, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5889.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778, 870.3477777777783, 868.4422222222224, 867.9033333333335, 869.1733333333339, 870.1266666666673, 869.998888888889, 869.2055555555559, 868.6666666666671, 868.7622222222226, 867.7777777777784, 869.1733333333339, 869.4900000000004, 870.4744444444449, 868.3488888888893, 869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669, 869.5555555555559, 869.1111111111118, 868.6022222222227, 869.1100000000004, 870.0000000000007, 868.4444444444449, 869.9044444444451, 868.0322222222226, 868.6033333333337, 868.1900000000005, 869.8088888888893, 870.2533333333339, 870.3800000000006, 869.6822222222228, 869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451, 869.9044444444451, 867.8722222222225, 869.2688888888894, 870.3155555555561, 869.7133333333339, 869.2044444444447, 869.5855555555559, 869.7444444444452, 870.3477777777784, 869.935555555556, 869.1100000000004, 869.8400000000004, 868.4433333333335, 869.6177777777782, 869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.0288888888891, 870.7911111111117, 870.8533333333335, 871.4555555555556, 870.9800000000002, 871.5822222222224, 871.3300000000002, 870.1244444444449, 870.8544444444447, 868.8544444444445, 870.1555555555558, 869.9977777777784, 869.807777777778, 870.3477777777783, 868.4422222222224, 867.9033333333335, 869.1733333333339, 870.1266666666673, 869.998888888889, 869.2055555555559, 868.6666666666671, 868.7622222222226, 867.7777777777784, 869.1733333333339, 869.4900000000004, 870.4744444444449, 868.3488888888893, 869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669, 869.5555555555559, 869.1111111111118, 868.6022222222227, 869.1100000000004, 870.0000000000007, 868.4444444444449, 869.9044444444451, 868.0322222222226, 868.6033333333337, 868.1900000000005, 869.8088888888893, 870.2533333333339, 870.3800000000006, 869.6822222222228, 869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451, 869.9044444444451, 867.8722222222225, 869.2688888888894, 870.3155555555561, 869.7133333333339, 869.2044444444447, 869.5855555555559, 869.7444444444452, 870.3477777777784, 869.935555555556, 869.1100000000004, 869.8400000000004, 868.4433333333335, 869.6177777777782, 869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19945412849306152, "mean_inference_ms": 1.8180572288695334, "mean_action_processing_ms": 0.0747742680930864, "mean_env_wait_ms": 1.2229976710420107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004304647445678711, "StateBufferConnector_ms": 0.002774477005004883, "ViewRequirementAgentConnector_ms": 0.06489443778991699}, "num_episodes": 27, "episode_return_max": 871.5822222222224, "episode_return_min": 867.3966666666669, "episode_return_mean": 869.4776333333338, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 398400, "num_agent_steps_trained": 398100, "num_env_steps_sampled": 398400, "num_env_steps_trained": 398100, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.95980516247147, "num_env_steps_trained_throughput_per_sec": 263.95980516247147, "timesteps_total": 398400, "num_env_steps_sampled_lifetime": 398400, "num_agent_steps_sampled_lifetime": 398400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 398400, "timers": {"training_iteration_time_ms": 10328.086, "restore_workers_time_ms": 0.013, "training_step_time_ms": 542.217, "sample_time_ms": 526.294, "synch_weights_time_ms": 14.59}, "counters": {"num_env_steps_sampled": 398400, "num_env_steps_trained": 398100, "num_agent_steps_sampled": 398400, "num_agent_steps_trained": 398100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2656, "num_samples_added_to_queue": 398400}, "done": false, "training_iteration": 135, "trial_id": "38f59_00000", "date": "2024-10-10_22-34-42", "timestamp": 1728596082, "time_this_iter_s": 10.24620771408081, "time_total_s": 1385.1715159416199, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc19330>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1385.1715159416199, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 14.578571428571431, "ram_util_percent": 72.42142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2090.30615234375, "policy_loss": -179.63352966308594, "entropy": 4.6989898681640625, "entropy_coeff": 0.01, "var_gnorm": 17.8702392578125, "vf_loss": 228403.65625, "vf_explained_var": 0.5969892740249634}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1337.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 401250, "num_env_steps_trained": 401100, "num_agent_steps_sampled": 401250, "num_agent_steps_trained": 401100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2675, "num_samples_added_to_queue": 401100, "learner_queue": {"size_count": 1337, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 58.155, "learner_load_time_ms": 0.214, "learner_load_wait_time_ms": 1019.46, "learner_dequeue_time_ms": 8533.24}}, "env_runners": {"episode_reward_max": 871.2044444444447, "episode_reward_min": 867.3966666666669, "episode_reward_mean": 869.4459888888894, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.3966666666669}, "policy_reward_max": {"default_policy": 871.2044444444447}, "policy_reward_mean": {"default_policy": 869.4459888888894}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0078000000000000005, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.50637666666666, "mean_accuracy_min": 40.44766666666666, "mean_accuracy_max": 40.56799999999999, "num_model_switches_mean": 0.1705, "num_model_switches_min": 0.05, "num_model_switches_max": 0.3, "num_slav_mean": 0.0006853333333333333, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012, "mean_cluster_cpu_util_mean": 0.5044717815774958, "mean_cluster_cpu_util_min": 0.5025391156462584, "mean_cluster_cpu_util_max": 0.5063818142121712, "mean_cluster_mem_util_mean": 0.32786401371308016, "mean_cluster_mem_util_min": 0.3275933544303797, "mean_cluster_mem_util_max": 0.3282209915611814, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.050637666666667, "reward_accuracy_mean_min": 4.044766666666668, "reward_accuracy_mean_max": 4.056800000000001, "reward_sla_mean_mean": -0.02284444444444445, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.06376666666677, "reward_accuracy_sum_min": 404.47666666666674, "reward_accuracy_sum_max": 405.68000000000006, "reward_sla_sum_mean": -2.2844444444444445, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4684.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669, 869.5555555555559, 869.1111111111118, 868.6022222222227, 869.1100000000004, 870.0000000000007, 868.4444444444449, 869.9044444444451, 868.0322222222226, 868.6033333333337, 868.1900000000005, 869.8088888888893, 870.2533333333339, 870.3800000000006, 869.6822222222228, 869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451, 869.9044444444451, 867.8722222222225, 869.2688888888894, 870.3155555555561, 869.7133333333339, 869.2044444444447, 869.5855555555559, 869.7444444444452, 870.3477777777784, 869.935555555556, 869.1100000000004, 869.8400000000004, 868.4433333333335, 869.6177777777782, 869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115, 869.3000000000006, 869.9355555555559, 869.6500000000005, 868.8555555555558, 869.5222222222225, 869.8388888888891, 869.5855555555561, 869.838888888889, 870.6011111111117, 869.8088888888894, 869.2688888888895, 868.5066666666671, 869.9344444444447, 868.0622222222223, 868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.2688888888895, 867.6822222222224, 868.2211111111114, 869.7455555555562, 869.2700000000002, 869.0788888888891, 870.5377777777783, 870.5700000000007, 870.0622222222228, 870.3166666666674, 869.4600000000006, 870.506666666667, 867.7777777777782, 869.396666666667, 868.8888888888894, 869.5866666666669, 869.5555555555559, 869.1111111111118, 868.6022222222227, 869.1100000000004, 870.0000000000007, 868.4444444444449, 869.9044444444451, 868.0322222222226, 868.6033333333337, 868.1900000000005, 869.8088888888893, 870.2533333333339, 870.3800000000006, 869.6822222222228, 869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451, 869.9044444444451, 867.8722222222225, 869.2688888888894, 870.3155555555561, 869.7133333333339, 869.2044444444447, 869.5855555555559, 869.7444444444452, 870.3477777777784, 869.935555555556, 869.1100000000004, 869.8400000000004, 868.4433333333335, 869.6177777777782, 869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115, 869.3000000000006, 869.9355555555559, 869.6500000000005, 868.8555555555558, 869.5222222222225, 869.8388888888891, 869.5855555555561, 869.838888888889, 870.6011111111117, 869.8088888888894, 869.2688888888895, 868.5066666666671, 869.9344444444447, 868.0622222222223, 868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19941748926470534, "mean_inference_ms": 1.8172746348036393, "mean_action_processing_ms": 0.07476164278202282, "mean_env_wait_ms": 1.2229798711268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004163265228271484, "StateBufferConnector_ms": 0.002785921096801758, "ViewRequirementAgentConnector_ms": 0.06553959846496582}, "num_episodes": 27, "episode_return_max": 871.2044444444447, "episode_return_min": 867.3966666666669, "episode_return_mean": 869.4459888888894, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 401250, "num_agent_steps_trained": 401100, "num_env_steps_sampled": 401250, "num_env_steps_trained": 401100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 280.0965027930296, "num_env_steps_trained_throughput_per_sec": 294.8384239926627, "timesteps_total": 401250, "num_env_steps_sampled_lifetime": 401250, "num_agent_steps_sampled_lifetime": 401250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 401250, "timers": {"training_iteration_time_ms": 10302.886, "restore_workers_time_ms": 0.014, "training_step_time_ms": 533.836, "sample_time_ms": 518.927, "synch_weights_time_ms": 13.594}, "counters": {"num_env_steps_sampled": 401250, "num_env_steps_trained": 401100, "num_agent_steps_sampled": 401250, "num_agent_steps_trained": 401100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2675, "num_samples_added_to_queue": 401100}, "done": false, "training_iteration": 136, "trial_id": "38f59_00000", "date": "2024-10-10_22-34-52", "timestamp": 1728596092, "time_this_iter_s": 10.192592859268188, "time_total_s": 1395.364108800888, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2c580>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1395.364108800888, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 10.840000000000002, "ram_util_percent": 72.44000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2450.117431640625, "policy_loss": 497.50341796875, "entropy": 4.559206485748291, "entropy_coeff": 0.01, "var_gnorm": 17.84093475341797, "vf_loss": 196629.171875, "vf_explained_var": 0.6403964161872864}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1347.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 404250, "num_env_steps_trained": 404100, "num_agent_steps_sampled": 404250, "num_agent_steps_trained": 404100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2695, "num_samples_added_to_queue": 404100, "learner_queue": {"size_count": 1347, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 52.693, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 989.209, "learner_dequeue_time_ms": 8500.717}}, "env_runners": {"episode_reward_max": 871.2044444444447, "episode_reward_min": 867.3966666666669, "episode_reward_mean": 869.5139888888891, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.3966666666669}, "policy_reward_max": {"default_policy": 871.2044444444447}, "policy_reward_mean": {"default_policy": 869.5139888888891}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0058000000000000005, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.51651, "mean_accuracy_min": 40.45399999999999, "mean_accuracy_max": 40.57433333333333, "num_model_switches_mean": 0.17310000000000003, "num_model_switches_min": 0.06, "num_model_switches_max": 0.34, "num_slav_mean": 0.0006953333333333332, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.504664570003677, "mean_cluster_cpu_util_min": 0.5025391156462584, "mean_cluster_cpu_util_max": 0.5063818142121712, "mean_cluster_mem_util_mean": 0.3279189240506329, "mean_cluster_mem_util_min": 0.3275933544303797, "mean_cluster_mem_util_max": 0.3282209915611814, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0516510000000014, "reward_accuracy_mean_min": 4.045400000000001, "reward_accuracy_mean_max": 4.057433333333334, "reward_sla_mean_mean": -0.023177777777777776, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.1651, "reward_accuracy_sum_min": 404.5400000000001, "reward_accuracy_sum_max": 405.7433333333334, "reward_sla_sum_mean": -2.3177777777777777, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3344.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451, 869.9044444444451, 867.8722222222225, 869.2688888888894, 870.3155555555561, 869.7133333333339, 869.2044444444447, 869.5855555555559, 869.7444444444452, 870.3477777777784, 869.935555555556, 869.1100000000004, 869.8400000000004, 868.4433333333335, 869.6177777777782, 869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115, 869.3000000000006, 869.9355555555559, 869.6500000000005, 868.8555555555558, 869.5222222222225, 869.8388888888891, 869.5855555555561, 869.838888888889, 870.6011111111117, 869.8088888888894, 869.2688888888895, 868.5066666666671, 869.9344444444447, 868.0622222222223, 868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779, 870.5688888888891, 870.6322222222224, 870.6011111111115, 869.4900000000004, 869.7444444444449, 870.4433333333341, 869.5866666666672, 868.8244444444447, 870.157777777778, 869.3644444444448, 869.9022222222223, 870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.5233333333339, 870.5700000000005, 869.1100000000005, 869.9366666666672, 867.8088888888891, 868.887777777778, 869.206666666667, 869.2377777777782, 869.1744444444452, 868.4444444444449, 869.745555555556, 867.3966666666669, 869.6500000000002, 868.3811111111114, 868.5711111111118, 869.9044444444451, 869.9044444444451, 867.8722222222225, 869.2688888888894, 870.3155555555561, 869.7133333333339, 869.2044444444447, 869.5855555555559, 869.7444444444452, 870.3477777777784, 869.935555555556, 869.1100000000004, 869.8400000000004, 868.4433333333335, 869.6177777777782, 869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115, 869.3000000000006, 869.9355555555559, 869.6500000000005, 868.8555555555558, 869.5222222222225, 869.8388888888891, 869.5855555555561, 869.838888888889, 870.6011111111117, 869.8088888888894, 869.2688888888895, 868.5066666666671, 869.9344444444447, 868.0622222222223, 868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779, 870.5688888888891, 870.6322222222224, 870.6011111111115, 869.4900000000004, 869.7444444444449, 870.4433333333341, 869.5866666666672, 868.8244444444447, 870.157777777778, 869.3644444444448, 869.9022222222223, 870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19941370130262448, "mean_inference_ms": 1.8177796267464148, "mean_action_processing_ms": 0.07476751055534836, "mean_env_wait_ms": 1.2232180024539814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003873586654663086, "StateBufferConnector_ms": 0.002788543701171875, "ViewRequirementAgentConnector_ms": 0.06564617156982422}, "num_episodes": 30, "episode_return_max": 871.2044444444447, "episode_return_min": 867.3966666666669, "episode_return_mean": 869.5139888888891, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404250, "num_agent_steps_trained": 404100, "num_env_steps_sampled": 404250, "num_env_steps_trained": 404100, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.61971809663794, "num_env_steps_trained_throughput_per_sec": 288.61971809663794, "timesteps_total": 404250, "num_env_steps_sampled_lifetime": 404250, "num_agent_steps_sampled_lifetime": 404250, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 404250, "timers": {"training_iteration_time_ms": 10326.448, "restore_workers_time_ms": 0.011, "training_step_time_ms": 509.902, "sample_time_ms": 494.825, "synch_weights_time_ms": 13.722}, "counters": {"num_env_steps_sampled": 404250, "num_env_steps_trained": 404100, "num_agent_steps_sampled": 404250, "num_agent_steps_trained": 404100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2695, "num_samples_added_to_queue": 404100}, "done": false, "training_iteration": 137, "trial_id": "38f59_00000", "date": "2024-10-10_22-35-03", "timestamp": 1728596103, "time_this_iter_s": 10.412346363067627, "time_total_s": 1405.7764551639557, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2c130>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1405.7764551639557, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 10.446666666666665, "ram_util_percent": 72.22666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2111.70751953125, "policy_loss": 185.31228637695312, "entropy": 4.588109493255615, "entropy_coeff": 0.01, "var_gnorm": 17.847803115844727, "vf_loss": 194015.96875, "vf_explained_var": 0.6388646364212036}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1356.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 407100, "num_env_steps_trained": 406800, "num_agent_steps_sampled": 407100, "num_agent_steps_trained": 406800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2714, "num_samples_added_to_queue": 407100, "learner_queue": {"size_count": 1356, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 44.884, "learner_load_time_ms": 0.236, "learner_load_wait_time_ms": 1041.604, "learner_dequeue_time_ms": 8497.779}}, "env_runners": {"episode_reward_max": 871.2044444444447, "episode_reward_min": 867.4277777777783, "episode_reward_mean": 869.604166666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.4277777777783}, "policy_reward_max": {"default_policy": 871.2044444444447}, "policy_reward_mean": {"default_policy": 869.604166666667}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.004, "num_moves_min": 0.0, "num_moves_max": 0.1, "mean_accuracy_mean": 40.51574999999999, "mean_accuracy_min": 40.466666666666654, "mean_accuracy_max": 40.57433333333333, "num_model_switches_mean": 0.1534, "num_model_switches_min": 0.0, "num_model_switches_max": 0.34, "num_slav_mean": 0.000666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5045342256159219, "mean_cluster_cpu_util_min": 0.5025368404118404, "mean_cluster_cpu_util_max": 0.506300916988417, "mean_cluster_mem_util_mean": 0.3279081645569619, "mean_cluster_mem_util_min": 0.3275933544303797, "mean_cluster_mem_util_max": 0.3282209915611814, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.051574999999999, "reward_accuracy_mean_min": 4.046666666666667, "reward_accuracy_mean_max": 4.057433333333334, "reward_sla_mean_mean": -0.0222, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.1575, "reward_accuracy_sum_min": 404.6666666666667, "reward_accuracy_sum_max": 405.7433333333334, "reward_sla_sum_mean": -2.22, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2165.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115, 869.3000000000006, 869.9355555555559, 869.6500000000005, 868.8555555555558, 869.5222222222225, 869.8388888888891, 869.5855555555561, 869.838888888889, 870.6011111111117, 869.8088888888894, 869.2688888888895, 868.5066666666671, 869.9344444444447, 868.0622222222223, 868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779, 870.5688888888891, 870.6322222222224, 870.6011111111115, 869.4900000000004, 869.7444444444449, 870.4433333333341, 869.5866666666672, 868.8244444444447, 870.157777777778, 869.3644444444448, 869.9022222222223, 870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557, 869.935555555556, 869.5233333333339, 870.3800000000007, 869.5555555555562, 870.5077777777785, 868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.2688888888895, 869.2677777777783, 869.5544444444447, 870.5066666666671, 870.665555555556, 869.4911111111114, 869.7766666666671, 869.7133333333337, 869.586666666667, 869.3322222222225, 869.0144444444446, 869.077777777778, 869.3011111111115, 869.3000000000006, 869.9355555555559, 869.6500000000005, 868.8555555555558, 869.5222222222225, 869.8388888888891, 869.5855555555561, 869.838888888889, 870.6011111111117, 869.8088888888894, 869.2688888888895, 868.5066666666671, 869.9344444444447, 868.0622222222223, 868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779, 870.5688888888891, 870.6322222222224, 870.6011111111115, 869.4900000000004, 869.7444444444449, 870.4433333333341, 869.5866666666672, 868.8244444444447, 870.157777777778, 869.3644444444448, 869.9022222222223, 870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557, 869.935555555556, 869.5233333333339, 870.3800000000007, 869.5555555555562, 870.5077777777785, 868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19945755398284273, "mean_inference_ms": 1.819745552836281, "mean_action_processing_ms": 0.0747921341945389, "mean_env_wait_ms": 1.223765925032895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003865957260131836, "StateBufferConnector_ms": 0.0028023719787597656, "ViewRequirementAgentConnector_ms": 0.06582975387573242}, "num_episodes": 30, "episode_return_max": 871.2044444444447, "episode_return_min": 867.4277777777783, "episode_return_mean": 869.604166666667, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 407100, "num_agent_steps_trained": 406800, "num_env_steps_sampled": 407100, "num_env_steps_trained": 406800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 276.6985948765224, "num_env_steps_trained_throughput_per_sec": 262.1355109356528, "timesteps_total": 407100, "num_env_steps_sampled_lifetime": 407100, "num_agent_steps_sampled_lifetime": 407100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 407100, "timers": {"training_iteration_time_ms": 10340.959, "restore_workers_time_ms": 0.013, "training_step_time_ms": 547.711, "sample_time_ms": 531.663, "synch_weights_time_ms": 14.623}, "counters": {"num_env_steps_sampled": 407100, "num_env_steps_trained": 406800, "num_agent_steps_sampled": 407100, "num_agent_steps_trained": 406800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2714, "num_samples_added_to_queue": 407100}, "done": false, "training_iteration": 138, "trial_id": "38f59_00000", "date": "2024-10-10_22-35-13", "timestamp": 1728596113, "time_this_iter_s": 10.310977935791016, "time_total_s": 1416.0874330997467, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb4880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1416.0874330997467, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 10.664285714285715, "ram_util_percent": 71.72142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2212.353271484375, "policy_loss": 185.77734375, "entropy": 4.498281478881836, "entropy_coeff": 0.01, "var_gnorm": 17.900646209716797, "vf_loss": 204007.078125, "vf_explained_var": 0.6330353021621704}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1366.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 409950, "num_env_steps_trained": 409800, "num_agent_steps_sampled": 409950, "num_agent_steps_trained": 409800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2733, "num_samples_added_to_queue": 409800, "learner_queue": {"size_count": 1366, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.273, "learner_load_time_ms": 0.263, "learner_load_wait_time_ms": 1023.456, "learner_dequeue_time_ms": 8544.037}}, "env_runners": {"episode_reward_max": 871.2044444444447, "episode_reward_min": 867.4277777777783, "episode_reward_mean": 869.5712777777783, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.4277777777783}, "policy_reward_max": {"default_policy": 871.2044444444447}, "policy_reward_mean": {"default_policy": 869.5712777777783}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.002, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.510683333333326, "mean_accuracy_min": 40.466666666666654, "mean_accuracy_max": 40.57433333333333, "num_model_switches_mean": 0.13560000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.34, "num_slav_mean": 0.0006606666666666667, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5045309762824048, "mean_cluster_cpu_util_min": 0.5025368404118404, "mean_cluster_cpu_util_max": 0.5063442958264388, "mean_cluster_mem_util_mean": 0.32789811708860755, "mean_cluster_mem_util_min": 0.3275617088607594, "mean_cluster_mem_util_max": 0.3282209915611814, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.051068333333332, "reward_accuracy_mean_min": 4.046666666666667, "reward_accuracy_mean_max": 4.057433333333334, "reward_sla_mean_mean": -0.022022222222222224, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 405.1068333333333, "reward_accuracy_sum_min": 404.6666666666667, "reward_accuracy_sum_max": 405.7433333333334, "reward_sla_sum_mean": -2.2022222222222223, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2363.0, "global_timestep_min": 300, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779, 870.5688888888891, 870.6322222222224, 870.6011111111115, 869.4900000000004, 869.7444444444449, 870.4433333333341, 869.5866666666672, 868.8244444444447, 870.157777777778, 869.3644444444448, 869.9022222222223, 870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557, 869.935555555556, 869.5233333333339, 870.3800000000007, 869.5555555555562, 870.5077777777785, 868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.7600000000004, 870.0300000000002, 870.5377777777782, 871.2044444444447, 869.1733333333335, 869.8400000000005, 868.1255555555559, 869.9666666666673, 869.5855555555557, 869.5533333333339, 871.0133333333335, 870.5055555555558, 870.5377777777779, 870.5688888888891, 870.6322222222224, 870.6011111111115, 869.4900000000004, 869.7444444444449, 870.4433333333341, 869.5866666666672, 868.8244444444447, 870.157777777778, 869.3644444444448, 869.9022222222223, 870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557, 869.935555555556, 869.5233333333339, 870.3800000000007, 869.5555555555562, 870.5077777777785, 868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19946734535420332, "mean_inference_ms": 1.8200758809610986, "mean_action_processing_ms": 0.07479795601757112, "mean_env_wait_ms": 1.2239722621349205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039103031158447266, "StateBufferConnector_ms": 0.0028340816497802734, "ViewRequirementAgentConnector_ms": 0.06626367568969727}, "num_episodes": 27, "episode_return_max": 871.2044444444447, "episode_return_min": 867.4277777777783, "episode_return_mean": 869.5712777777783, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 409950, "num_agent_steps_trained": 409800, "num_env_steps_sampled": 409950, "num_env_steps_trained": 409800, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 277.0302123874137, "num_env_steps_trained_throughput_per_sec": 291.6107498814881, "timesteps_total": 409950, "num_env_steps_sampled_lifetime": 409950, "num_agent_steps_sampled_lifetime": 409950, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 409950, "timers": {"training_iteration_time_ms": 10351.916, "restore_workers_time_ms": 0.011, "training_step_time_ms": 538.626, "sample_time_ms": 524.145, "synch_weights_time_ms": 13.064}, "counters": {"num_env_steps_sampled": 409950, "num_env_steps_trained": 409800, "num_agent_steps_sampled": 409950, "num_agent_steps_trained": 409800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2733, "num_samples_added_to_queue": 409800}, "done": false, "training_iteration": 139, "trial_id": "38f59_00000", "date": "2024-10-10_22-35-23", "timestamp": 1728596123, "time_this_iter_s": 10.297919511795044, "time_total_s": 1426.3853526115417, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc19ae0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1426.3853526115417, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 10.446666666666665, "ram_util_percent": 71.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2332.811279296875, "policy_loss": 326.1552429199219, "entropy": 4.576221942901611, "entropy_coeff": 0.01, "var_gnorm": 17.91258430480957, "vf_loss": 202038.484375, "vf_explained_var": 0.6342909336090088}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1373.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 412200, "num_env_steps_trained": 411900, "num_agent_steps_sampled": 412200, "num_agent_steps_trained": 411900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2748, "num_samples_added_to_queue": 412200, "learner_queue": {"size_count": 1373, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 75.947, "learner_load_time_ms": 0.237, "learner_load_wait_time_ms": 1224.657, "learner_dequeue_time_ms": 8710.742}}, "env_runners": {"episode_reward_max": 870.8244444444452, "episode_reward_min": 867.4277777777783, "episode_reward_mean": 869.4326000000007, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.4277777777783}, "policy_reward_max": {"default_policy": 870.8244444444452}, "policy_reward_mean": {"default_policy": 869.4326000000007}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0030000000000000005, "num_moves_min": 0.0, "num_moves_max": 0.02, "mean_accuracy_mean": 40.495926666666655, "mean_accuracy_min": 40.441333333333326, "mean_accuracy_max": 40.55533333333332, "num_model_switches_mean": 0.10560000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.32, "num_slav_mean": 0.000658, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012666666666666666, "mean_cluster_cpu_util_mean": 0.5042712889547711, "mean_cluster_cpu_util_min": 0.5023459505423792, "mean_cluster_cpu_util_max": 0.5063442958264388, "mean_cluster_mem_util_mean": 0.32782891350210974, "mean_cluster_mem_util_min": 0.3274166666666666, "mean_cluster_mem_util_max": 0.3281239451476794, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.049592666666666, "reward_accuracy_mean_min": 4.044133333333334, "reward_accuracy_mean_max": 4.055533333333334, "reward_sla_mean_mean": -0.02193333333333333, "reward_sla_mean_min": -0.042222222222222223, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.9592666666667, "reward_accuracy_sum_min": 404.41333333333336, "reward_accuracy_sum_max": 405.5533333333334, "reward_sla_sum_mean": -2.193333333333334, "reward_sla_sum_min": -4.222222222222222, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3153.0, "global_timestep_min": 1200, "global_timestep_max": 4800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557, 869.935555555556, 869.5233333333339, 870.3800000000007, 869.5555555555562, 870.5077777777785, 868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.696666666667, 869.5855555555556, 868.7922222222226, 869.7755555555559, 868.1900000000004, 869.6500000000005, 867.4277777777783, 870.5700000000005, 868.9833333333338, 870.1888888888894, 870.125555555556, 870.1888888888893, 868.6333333333337, 869.9988888888894, 867.8088888888893, 868.157777777778, 870.0622222222225, 870.0311111111116, 868.6655555555557, 869.935555555556, 869.5233333333339, 870.3800000000007, 869.5555555555562, 870.5077777777785, 868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19948407053530026, "mean_inference_ms": 1.8183866256612102, "mean_action_processing_ms": 0.07479658263349305, "mean_env_wait_ms": 1.2240361110954567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004235267639160156, "StateBufferConnector_ms": 0.0030107498168945312, "ViewRequirementAgentConnector_ms": 0.07075691223144531}, "num_episodes": 24, "episode_return_max": 870.8244444444452, "episode_return_min": 867.4277777777783, "episode_return_mean": 869.4326000000007, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412200, "num_agent_steps_trained": 411900, "num_env_steps_sampled": 412200, "num_env_steps_trained": 411900, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 219.6839499339867, "num_env_steps_trained_throughput_per_sec": 205.03835327172092, "timesteps_total": 412200, "num_env_steps_sampled_lifetime": 412200, "num_agent_steps_sampled_lifetime": 412200, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 412200, "timers": {"training_iteration_time_ms": 10327.966, "restore_workers_time_ms": 0.013, "training_step_time_ms": 622.284, "sample_time_ms": 606.537, "synch_weights_time_ms": 14.197}, "counters": {"num_env_steps_sampled": 412200, "num_env_steps_trained": 411900, "num_agent_steps_sampled": 412200, "num_agent_steps_trained": 411900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2748, "num_samples_added_to_queue": 412200}, "done": false, "training_iteration": 140, "trial_id": "38f59_00000", "date": "2024-10-10_22-35-34", "timestamp": 1728596134, "time_this_iter_s": 10.252017498016357, "time_total_s": 1436.637370109558, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cda80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1436.637370109558, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 19.513333333333335, "ram_util_percent": 74.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2010.0980224609375, "policy_loss": 22.742958068847656, "entropy": 4.705312728881836, "entropy_coeff": 0.01, "var_gnorm": 17.91120719909668, "vf_loss": 200147.09375, "vf_explained_var": 0.6356925964355469}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1382.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 414750, "num_env_steps_trained": 414600, "num_agent_steps_sampled": 414750, "num_agent_steps_trained": 414600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2765, "num_samples_added_to_queue": 414600, "learner_queue": {"size_count": 1382, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 72.169, "learner_load_time_ms": 0.237, "learner_load_wait_time_ms": 1170.811, "learner_dequeue_time_ms": 8873.779}}, "env_runners": {"episode_reward_max": 870.8244444444452, "episode_reward_min": 867.3344444444447, "episode_reward_mean": 869.225766666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.3344444444447}, "policy_reward_max": {"default_policy": 870.8244444444452}, "policy_reward_mean": {"default_policy": 869.225766666667}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0072, "num_moves_min": 0.0, "num_moves_max": 0.06, "mean_accuracy_mean": 40.47724333333332, "mean_accuracy_min": 40.39699999999999, "mean_accuracy_max": 40.548999999999985, "num_model_switches_mean": 0.11720000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.26, "num_slav_mean": 0.000664, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5039930206609672, "mean_cluster_cpu_util_min": 0.5018121093031808, "mean_cluster_cpu_util_max": 0.5063442958264388, "mean_cluster_mem_util_mean": 0.32775029008438816, "mean_cluster_mem_util_min": 0.3273639240506329, "mean_cluster_mem_util_max": 0.3281239451476794, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.047724333333333, "reward_accuracy_mean_min": 4.0397, "reward_accuracy_mean_max": 4.054900000000001, "reward_sla_mean_mean": -0.022133333333333338, "reward_sla_mean_min": -0.03777777777777778, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.77243333333337, "reward_accuracy_sum_min": 403.97, "reward_accuracy_sum_max": 405.49000000000007, "reward_sla_sum_mean": -2.213333333333334, "reward_sla_sum_min": -3.777777777777778, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3975.0, "global_timestep_min": 2200, "global_timestep_max": 5600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783, 868.6033333333338, 867.3977777777781, 869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.4433333333338, 868.5077777777783, 870.0622222222227, 869.554444444445, 868.8877777777781, 869.6500000000005, 869.0155555555559, 869.3644444444453, 870.0311111111116, 869.3333333333339, 868.9833333333337, 869.3322222222226, 869.9666666666672, 870.4122222222229, 870.4111111111115, 870.1577777777783, 868.6977777777779, 868.8566666666671, 869.5866666666673, 869.9355555555561, 869.7133333333338, 870.3166666666672, 869.1744444444449, 869.0788888888894, 870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783, 868.6033333333338, 867.3977777777781, 869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1997536939560499, "mean_inference_ms": 1.8245537560327956, "mean_action_processing_ms": 0.07490636180810346, "mean_env_wait_ms": 1.2260092837355723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00454258918762207, "StateBufferConnector_ms": 0.0031633377075195312, "ViewRequirementAgentConnector_ms": 0.07504582405090332}, "num_episodes": 24, "episode_return_max": 870.8244444444452, "episode_return_min": 867.3344444444447, "episode_return_mean": 869.225766666667, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414750, "num_agent_steps_trained": 414600, "num_env_steps_sampled": 414750, "num_env_steps_trained": 414600, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 241.41579706480778, "num_env_steps_trained_throughput_per_sec": 255.6167263039141, "timesteps_total": 414750, "num_env_steps_sampled_lifetime": 414750, "num_agent_steps_sampled_lifetime": 414750, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 414750, "timers": {"training_iteration_time_ms": 10342.668, "restore_workers_time_ms": 0.014, "training_step_time_ms": 626.261, "sample_time_ms": 609.745, "synch_weights_time_ms": 15.045}, "counters": {"num_env_steps_sampled": 414750, "num_env_steps_trained": 414600, "num_agent_steps_sampled": 414750, "num_agent_steps_trained": 414600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2765, "num_samples_added_to_queue": 414600}, "done": false, "training_iteration": 141, "trial_id": "38f59_00000", "date": "2024-10-10_22-35-44", "timestamp": 1728596144, "time_this_iter_s": 10.577843427658081, "time_total_s": 1447.2152135372162, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2c8b0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1447.2152135372162, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 15.166666666666666, "ram_util_percent": 74.00666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1076.4688720703125, "policy_loss": -668.029541015625, "entropy": 4.966549873352051, "entropy_coeff": 0.01, "var_gnorm": 17.903724670410156, "vf_loss": 175939.8125, "vf_explained_var": 0.6526315212249756}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1389.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 417000, "num_env_steps_trained": 416700, "num_agent_steps_sampled": 417000, "num_agent_steps_trained": 416700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2780, "num_samples_added_to_queue": 417000, "learner_queue": {"size_count": 1389, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.757, "learner_load_time_ms": 0.31, "learner_load_wait_time_ms": 1248.89, "learner_dequeue_time_ms": 9050.017}}, "env_runners": {"episode_reward_max": 870.8244444444452, "episode_reward_min": 866.9244444444444, "episode_reward_mean": 868.978466666667, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.9244444444444}, "policy_reward_max": {"default_policy": 870.8244444444452}, "policy_reward_mean": {"default_policy": 868.978466666667}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.017400000000000002, "num_moves_min": 0.0, "num_moves_max": 0.14, "mean_accuracy_mean": 40.45184666666666, "mean_accuracy_min": 40.28933333333332, "mean_accuracy_max": 40.548999999999985, "num_model_switches_mean": 0.15039999999999998, "num_model_switches_min": 0.02, "num_model_switches_max": 0.41, "num_slav_mean": 0.0006619999999999999, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0011333333333333334, "mean_cluster_cpu_util_mean": 0.5036609102086781, "mean_cluster_cpu_util_min": 0.49975473432616285, "mean_cluster_cpu_util_max": 0.5063442958264388, "mean_cluster_mem_util_mean": 0.32764749472573845, "mean_cluster_mem_util_min": 0.3268291139240506, "mean_cluster_mem_util_max": 0.3281239451476794, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0451846666666675, "reward_accuracy_mean_min": 4.028933333333333, "reward_accuracy_mean_max": 4.054900000000001, "reward_sla_mean_mean": -0.022066666666666665, "reward_sla_mean_min": -0.03777777777777778, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.51846666666665, "reward_accuracy_sum_min": 402.8933333333333, "reward_accuracy_sum_max": 405.49000000000007, "reward_sla_sum_mean": -2.206666666666667, "reward_sla_sum_min": -3.777777777777778, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4783.0, "global_timestep_min": 3100, "global_timestep_max": 6400}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783, 868.6033333333338, 867.3977777777781, 869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781, 868.1911111111115, 869.2388888888894, 869.5255555555559, 868.5722222222226, 867.937777777778, 868.8911111111114, 868.8277777777782, 866.9244444444444, 868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.0944444444451, 868.0622222222228, 869.4911111111115, 870.125555555556, 869.0466666666671, 870.8233333333338, 868.8555555555558, 870.824444444445, 868.6977777777782, 868.3488888888894, 869.4588888888894, 869.7444444444448, 869.7766666666672, 869.3011111111116, 870.6022222222226, 868.5077777777783, 869.2055555555557, 869.5866666666672, 869.0788888888895, 868.697777777778, 868.7288888888893, 869.4600000000005, 869.4911111111116, 869.6822222222229, 868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783, 868.6033333333338, 867.3977777777781, 869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781, 868.1911111111115, 869.2388888888894, 869.5255555555559, 868.5722222222226, 867.937777777778, 868.8911111111114, 868.8277777777782, 866.9244444444444, 868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2000991691590579, "mean_inference_ms": 1.8311969351227737, "mean_action_processing_ms": 0.07503964972646972, "mean_env_wait_ms": 1.2282883699020453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004891395568847656, "StateBufferConnector_ms": 0.0033347606658935547, "ViewRequirementAgentConnector_ms": 0.07972836494445801}, "num_episodes": 24, "episode_return_max": 870.8244444444452, "episode_return_min": 866.9244444444444, "episode_return_mean": 868.978466666667, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 417000, "num_agent_steps_trained": 416700, "num_env_steps_sampled": 417000, "num_env_steps_trained": 416700, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 221.19480744004477, "num_env_steps_trained_throughput_per_sec": 206.44848694404178, "timesteps_total": 417000, "num_env_steps_sampled_lifetime": 417000, "num_agent_steps_sampled_lifetime": 417000, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 417000, "timers": {"training_iteration_time_ms": 10319.723, "restore_workers_time_ms": 0.014, "training_step_time_ms": 687.233, "sample_time_ms": 669.475, "synch_weights_time_ms": 16.02}, "counters": {"num_env_steps_sampled": 417000, "num_env_steps_trained": 416700, "num_agent_steps_sampled": 417000, "num_agent_steps_trained": 416700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2780, "num_samples_added_to_queue": 417000}, "done": false, "training_iteration": 142, "trial_id": "38f59_00000", "date": "2024-10-10_22-35-55", "timestamp": 1728596155, "time_this_iter_s": 10.197329044342041, "time_total_s": 1457.4125425815582, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe201b2740>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1457.4125425815582, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 19.313333333333333, "ram_util_percent": 71.44666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 864.0880126953125, "policy_loss": -853.3604125976562, "entropy": 5.057392120361328, "entropy_coeff": 0.01, "var_gnorm": 17.879566192626953, "vf_loss": 173262.0625, "vf_explained_var": 0.6516139507293701}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1398.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 419550, "num_env_steps_trained": 419400, "num_agent_steps_sampled": 419550, "num_agent_steps_trained": 419400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2797, "num_samples_added_to_queue": 419400, "learner_queue": {"size_count": 1398, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 76.405, "learner_load_time_ms": 0.321, "learner_load_wait_time_ms": 1140.652, "learner_dequeue_time_ms": 9295.467}}, "env_runners": {"episode_reward_max": 870.8244444444452, "episode_reward_min": 862.6788888888881, "episode_reward_mean": 867.9223666666669, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.6788888888881}, "policy_reward_max": {"default_policy": 870.8244444444452}, "policy_reward_mean": {"default_policy": 867.9223666666669}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.06169999999999999, "num_moves_min": 0.0, "num_moves_max": 0.37, "mean_accuracy_mean": 40.34690333333332, "mean_accuracy_min": 39.947333333333326, "mean_accuracy_max": 40.50466666666666, "num_model_switches_mean": 0.22480000000000003, "num_model_switches_min": 0.02, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006546666666666666, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0011333333333333332, "mean_cluster_cpu_util_mean": 0.5018299547251334, "mean_cluster_cpu_util_min": 0.49398168321382596, "mean_cluster_cpu_util_max": 0.506141742507814, "mean_cluster_mem_util_mean": 0.3271780748945148, "mean_cluster_mem_util_min": 0.325168776371308, "mean_cluster_mem_util_max": 0.327918776371308, "reward_consolidation_mean_mean": 4.666355555555555, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.034690333333334, "reward_accuracy_mean_min": 3.9947333333333335, "reward_accuracy_mean_max": 4.050466666666668, "reward_sla_mean_mean": -0.02182222222222223, "reward_sla_mean_min": -0.03777777777777778, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.63555555555547, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.46903333333336, "reward_accuracy_sum_min": 399.47333333333336, "reward_accuracy_sum_max": 405.04666666666674, "reward_sla_sum_mean": -2.1822222222222223, "reward_sla_sum_min": -3.777777777777778, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5578.0, "global_timestep_min": 3700, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783, 868.6033333333338, 867.3977777777781, 869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781, 868.1911111111115, 869.2388888888894, 869.5255555555559, 868.5722222222226, 867.937777777778, 868.8911111111114, 868.8277777777782, 866.9244444444444, 868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338, 866.5133333333331, 867.181111111111, 865.1533333333327, 863.1544444444436, 863.6955555555545, 865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.7611111111115, 869.5866666666672, 869.7455555555563, 870.2855555555564, 869.3011111111118, 869.2377777777783, 869.6188888888894, 869.0466666666671, 869.3333333333337, 869.5244444444452, 869.2377777777782, 869.4288888888896, 868.3488888888893, 868.5711111111117, 870.1266666666671, 869.6822222222228, 869.6822222222228, 870.8244444444452, 868.9844444444449, 868.3177777777781, 869.1422222222228, 870.1900000000007, 869.5233333333341, 869.555555555556, 869.7455555555562, 868.8577777777781, 868.9522222222226, 869.0477777777783, 868.6033333333338, 867.3977777777781, 869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781, 868.1911111111115, 869.2388888888894, 869.5255555555559, 868.5722222222226, 867.937777777778, 868.8911111111114, 868.8277777777782, 866.9244444444444, 868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338, 866.5133333333331, 867.181111111111, 865.1533333333327, 863.1544444444436, 863.6955555555545, 865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2002775659516284, "mean_inference_ms": 1.8320101205269, "mean_action_processing_ms": 0.07511229704591188, "mean_env_wait_ms": 1.229293489032892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050411224365234375, "StateBufferConnector_ms": 0.0034084320068359375, "ViewRequirementAgentConnector_ms": 0.08196663856506348}, "num_episodes": 24, "episode_return_max": 870.8244444444452, "episode_return_min": 862.6788888888881, "episode_return_mean": 867.9223666666669, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 419550, "num_agent_steps_trained": 419400, "num_env_steps_sampled": 419550, "num_env_steps_trained": 419400, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 254.1202889035174, "num_env_steps_trained_throughput_per_sec": 269.06854119195964, "timesteps_total": 419550, "num_env_steps_sampled_lifetime": 419550, "num_agent_steps_sampled_lifetime": 419550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 419550, "timers": {"training_iteration_time_ms": 10280.717, "restore_workers_time_ms": 0.013, "training_step_time_ms": 571.122, "sample_time_ms": 553.54, "synch_weights_time_ms": 16.178}, "counters": {"num_env_steps_sampled": 419550, "num_env_steps_trained": 419400, "num_agent_steps_sampled": 419550, "num_agent_steps_trained": 419400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2797, "num_samples_added_to_queue": 419400}, "done": false, "training_iteration": 143, "trial_id": "38f59_00000", "date": "2024-10-10_22-36-05", "timestamp": 1728596165, "time_this_iter_s": 10.046833276748657, "time_total_s": 1467.4593758583069, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde4940>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1467.4593758583069, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 13.728571428571428, "ram_util_percent": 70.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2378.026123046875, "policy_loss": 542.6823120117188, "entropy": 4.886026382446289, "entropy_coeff": 0.01, "var_gnorm": 17.856842041015625, "vf_loss": 185000.1875, "vf_explained_var": 0.6436282992362976}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1408.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 422550, "num_env_steps_trained": 422400, "num_agent_steps_sampled": 422550, "num_agent_steps_trained": 422400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2817, "num_samples_added_to_queue": 422400, "learner_queue": {"size_count": 1408, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.942, "learner_load_time_ms": 0.312, "learner_load_wait_time_ms": 994.095, "learner_dequeue_time_ms": 9354.763}}, "env_runners": {"episode_reward_max": 869.9688888888892, "episode_reward_min": 862.6788888888881, "episode_reward_mean": 867.2140222222224, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.6788888888881}, "policy_reward_max": {"default_policy": 869.9688888888892}, "policy_reward_mean": {"default_policy": 867.2140222222224}, "custom_metrics": {"num_consolidated_mean": 2.9996000000000005, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.17239999999999994, "num_moves_min": 0.0, "num_moves_max": 0.64, "mean_accuracy_mean": 40.287179999999985, "mean_accuracy_min": 39.947333333333326, "mean_accuracy_max": 40.47933333333332, "num_model_switches_mean": 0.3086, "num_model_switches_min": 0.02, "num_model_switches_max": 0.6, "num_slav_mean": 0.0006786666666666666, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5007893915758871, "mean_cluster_cpu_util_min": 0.49398168321382596, "mean_cluster_cpu_util_max": 0.5053524200220629, "mean_cluster_mem_util_mean": 0.3269100870253165, "mean_cluster_mem_util_min": 0.325168776371308, "mean_cluster_mem_util_max": 0.3278222573839662, "reward_consolidation_mean_mean": 4.666044444444443, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0287180000000005, "reward_accuracy_mean_min": 3.9947333333333335, "reward_accuracy_mean_max": 4.047933333333334, "reward_sla_mean_mean": -0.022622222222222224, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.60444444444437, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 402.87180000000006, "reward_accuracy_sum_min": 399.47333333333336, "reward_accuracy_sum_max": 404.7933333333334, "reward_sla_sum_mean": -2.2622222222222224, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5646.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781, 868.1911111111115, 869.2388888888894, 869.5255555555559, 868.5722222222226, 867.937777777778, 868.8911111111114, 868.8277777777782, 866.9244444444444, 868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338, 866.5133333333331, 867.181111111111, 865.1533333333327, 863.1544444444436, 863.6955555555545, 865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993, 864.2966666666659, 865.8811111111111, 867.847777777778, 867.0522222222224, 867.1466666666668, 867.1455555555558, 869.4300000000004, 868.6366666666671, 866.7633333333337, 867.018888888889, 865.4077777777771, 865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.904444444445, 868.0644444444447, 867.3344444444447, 868.3188888888894, 869.3033333333337, 868.3188888888893, 867.6511111111113, 869.4922222222225, 869.7144444444447, 869.9688888888892, 868.763333333334, 868.3500000000004, 868.3822222222226, 868.1277777777781, 869.1744444444449, 869.1122222222227, 868.7944444444449, 867.6522222222226, 868.4766666666673, 868.9222222222227, 868.445555555556, 868.4777777777781, 868.1911111111115, 869.2388888888894, 869.5255555555559, 868.5722222222226, 867.937777777778, 868.8911111111114, 868.8277777777782, 866.9244444444444, 868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338, 866.5133333333331, 867.181111111111, 865.1533333333327, 863.1544444444436, 863.6955555555545, 865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993, 864.2966666666659, 865.8811111111111, 867.847777777778, 867.0522222222224, 867.1466666666668, 867.1455555555558, 869.4300000000004, 868.6366666666671, 866.7633333333337, 867.018888888889, 865.4077777777771, 865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20050356673210648, "mean_inference_ms": 1.8343946752622151, "mean_action_processing_ms": 0.07519084026705843, "mean_env_wait_ms": 1.2306882268196708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051348209381103516, "StateBufferConnector_ms": 0.003237485885620117, "ViewRequirementAgentConnector_ms": 0.07741737365722656}, "num_episodes": 30, "episode_return_max": 869.9688888888892, "episode_return_min": 862.6788888888881, "episode_return_mean": 867.2140222222224, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 422550, "num_agent_steps_trained": 422400, "num_env_steps_sampled": 422550, "num_env_steps_trained": 422400, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 286.571732710947, "num_env_steps_trained_throughput_per_sec": 286.571732710947, "timesteps_total": 422550, "num_env_steps_sampled_lifetime": 422550, "num_agent_steps_sampled_lifetime": 422550, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 422550, "timers": {"training_iteration_time_ms": 10286.591, "restore_workers_time_ms": 0.013, "training_step_time_ms": 521.343, "sample_time_ms": 505.375, "synch_weights_time_ms": 14.6}, "counters": {"num_env_steps_sampled": 422550, "num_env_steps_trained": 422400, "num_agent_steps_sampled": 422550, "num_agent_steps_trained": 422400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2817, "num_samples_added_to_queue": 422400}, "done": false, "training_iteration": 144, "trial_id": "38f59_00000", "date": "2024-10-10_22-36-15", "timestamp": 1728596175, "time_this_iter_s": 10.486194133758545, "time_total_s": 1477.9455699920654, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1ac80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1477.9455699920654, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 10.56, "ram_util_percent": 69.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2550.216064453125, "policy_loss": 628.6974487304688, "entropy": 4.983489513397217, "entropy_coeff": 0.01, "var_gnorm": 17.843303680419922, "vf_loss": 193646.90625, "vf_explained_var": 0.6463689804077148}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1417.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 425400, "num_env_steps_trained": 425100, "num_agent_steps_sampled": 425400, "num_agent_steps_trained": 425100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2836, "num_samples_added_to_queue": 425400, "learner_queue": {"size_count": 1417, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 57.723, "learner_load_time_ms": 0.285, "learner_load_wait_time_ms": 1026.66, "learner_dequeue_time_ms": 9259.719}}, "env_runners": {"episode_reward_max": 869.4300000000004, "episode_reward_min": 862.6788888888881, "episode_reward_mean": 866.3793444444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.6788888888881}, "policy_reward_max": {"default_policy": 869.4300000000004}, "policy_reward_mean": {"default_policy": 866.3793444444443}, "custom_metrics": {"num_consolidated_mean": 2.9996000000000005, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2962, "num_moves_min": 0.0, "num_moves_max": 0.64, "mean_accuracy_mean": 40.20148999999999, "mean_accuracy_min": 39.947333333333326, "mean_accuracy_max": 40.453999999999986, "num_model_switches_mean": 0.3856, "num_model_switches_min": 0.1, "num_model_switches_max": 0.6, "num_slav_mean": 0.0006720000000000001, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.4992346531129344, "mean_cluster_cpu_util_min": 0.49398168321382596, "mean_cluster_cpu_util_max": 0.5045520890788748, "mean_cluster_mem_util_mean": 0.32653215981012657, "mean_cluster_mem_util_min": 0.325168776371308, "mean_cluster_mem_util_max": 0.3276682489451477, "reward_consolidation_mean_mean": 4.666044444444443, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.020149, "reward_accuracy_mean_min": 3.9947333333333335, "reward_accuracy_mean_max": 4.045400000000001, "reward_sla_mean_mean": -0.022400000000000003, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.60444444444437, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 402.01490000000007, "reward_accuracy_sum_min": 399.47333333333336, "reward_accuracy_sum_max": 404.5400000000001, "reward_sla_sum_mean": -2.24, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4286.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338, 866.5133333333331, 867.181111111111, 865.1533333333327, 863.1544444444436, 863.6955555555545, 865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993, 864.2966666666659, 865.8811111111111, 867.847777777778, 867.0522222222224, 867.1466666666668, 867.1455555555558, 869.4300000000004, 868.6366666666671, 866.7633333333337, 867.018888888889, 865.4077777777771, 865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224, 867.7166666666669, 867.3699999999995, 866.7366666666666, 865.2466666666661, 865.8499999999995, 865.6911111111106, 864.2333333333329, 864.5822222222215, 864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.9855555555562, 869.1122222222228, 869.1122222222226, 868.4144444444448, 869.2077777777785, 868.5733333333337, 867.8755555555558, 867.5599999999998, 867.6200000000002, 869.4288888888894, 868.0333333333336, 868.8588888888895, 867.7800000000002, 868.2244444444449, 867.6544444444445, 868.1933333333338, 866.5133333333331, 867.181111111111, 865.1533333333327, 863.1544444444436, 863.6955555555545, 865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993, 864.2966666666659, 865.8811111111111, 867.847777777778, 867.0522222222224, 867.1466666666668, 867.1455555555558, 869.4300000000004, 868.6366666666671, 866.7633333333337, 867.018888888889, 865.4077777777771, 865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224, 867.7166666666669, 867.3699999999995, 866.7366666666666, 865.2466666666661, 865.8499999999995, 865.6911111111106, 864.2333333333329, 864.5822222222215, 864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20044797689228747, "mean_inference_ms": 1.8296114781663733, "mean_action_processing_ms": 0.07516228309738428, "mean_env_wait_ms": 1.230102348648647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004862546920776367, "StateBufferConnector_ms": 0.003082752227783203, "ViewRequirementAgentConnector_ms": 0.07260489463806152}, "num_episodes": 30, "episode_return_max": 869.4300000000004, "episode_return_min": 862.6788888888881, "episode_return_mean": 866.3793444444443, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 425400, "num_agent_steps_trained": 425100, "num_env_steps_sampled": 425400, "num_env_steps_trained": 425100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 278.7086579130138, "num_env_steps_trained_throughput_per_sec": 264.0397811807499, "timesteps_total": 425400, "num_env_steps_sampled_lifetime": 425400, "num_agent_steps_sampled_lifetime": 425400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 425400, "timers": {"training_iteration_time_ms": 10286.281, "restore_workers_time_ms": 0.013, "training_step_time_ms": 536.483, "sample_time_ms": 520.72, "synch_weights_time_ms": 14.306}, "counters": {"num_env_steps_sampled": 425400, "num_env_steps_trained": 425100, "num_agent_steps_sampled": 425400, "num_agent_steps_trained": 425100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2836, "num_samples_added_to_queue": 425400}, "done": false, "training_iteration": 145, "trial_id": "38f59_00000", "date": "2024-10-10_22-36-25", "timestamp": 1728596185, "time_this_iter_s": 10.236047267913818, "time_total_s": 1488.1816172599792, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1b880>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1488.1816172599792, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 11.06, "ram_util_percent": 68.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1658.0606689453125, "policy_loss": 13.159416198730469, "entropy": 4.776846408843994, "entropy_coeff": 0.01, "var_gnorm": 17.832107543945312, "vf_loss": 165923.1875, "vf_explained_var": 0.6587281823158264}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1425.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 427650, "num_env_steps_trained": 427500, "num_agent_steps_sampled": 427650, "num_agent_steps_trained": 427500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2851, "num_samples_added_to_queue": 427500, "learner_queue": {"size_count": 1425, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.479, "learner_load_time_ms": 0.28, "learner_load_wait_time_ms": 1220.524, "learner_dequeue_time_ms": 9486.977}}, "env_runners": {"episode_reward_max": 869.4300000000004, "episode_reward_min": 862.6788888888881, "episode_reward_mean": 866.2435555555553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.6788888888881}, "policy_reward_max": {"default_policy": 869.4300000000004}, "policy_reward_mean": {"default_policy": 866.2435555555553}, "custom_metrics": {"num_consolidated_mean": 2.9997000000000003, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.36950000000000005, "num_moves_min": 0.04, "num_moves_max": 0.64, "mean_accuracy_mean": 40.185466666666656, "mean_accuracy_min": 39.959999999999994, "mean_accuracy_max": 40.41599999999999, "num_model_switches_mean": 0.4128, "num_model_switches_min": 0.14, "num_model_switches_max": 0.6, "num_slav_mean": 0.0006693333333333334, "num_slav_min": 0.00013333333333333334, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.4990157415483085, "mean_cluster_cpu_util_min": 0.4943382170435742, "mean_cluster_cpu_util_max": 0.5037826921309064, "mean_cluster_mem_util_mean": 0.32646942246835436, "mean_cluster_mem_util_min": 0.3252473628691983, "mean_cluster_mem_util_max": 0.32756487341772156, "reward_consolidation_mean_mean": 4.666199999999999, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0185466666666665, "reward_accuracy_mean_min": 3.9959999999999996, "reward_accuracy_mean_max": 4.0416, "reward_sla_mean_mean": -0.02231111111111111, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.0044444444444444444, "reward_consolidation_sum_mean": 466.61999999999995, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 401.85466666666673, "reward_accuracy_sum_min": 399.59999999999997, "reward_accuracy_sum_max": 404.16, "reward_sla_sum_mean": -2.2311111111111113, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.4444444444444445, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3361.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993, 864.2966666666659, 865.8811111111111, 867.847777777778, 867.0522222222224, 867.1466666666668, 867.1455555555558, 869.4300000000004, 868.6366666666671, 866.7633333333337, 867.018888888889, 865.4077777777771, 865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224, 867.7166666666669, 867.3699999999995, 866.7366666666666, 865.2466666666661, 865.8499999999995, 865.6911111111106, 864.2333333333329, 864.5822222222215, 864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327, 865.5655555555549, 865.3733333333332, 866.07, 868.0677777777778, 867.3055555555558, 868.4155555555557, 868.6044444444448, 864.3277777777771, 865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [865.2188888888879, 863.567777777777, 863.0588888888882, 865.5611111111104, 866.4199999999995, 867.6588888888883, 864.5499999999992, 864.7744444444432, 862.6788888888881, 864.7111111111102, 864.709999999999, 866.4188888888885, 866.673333333333, 864.6433333333326, 865.6933333333328, 863.8533333333324, 865.0266666666657, 864.8055555555544, 864.3599999999993, 864.2966666666659, 865.8811111111111, 867.847777777778, 867.0522222222224, 867.1466666666668, 867.1455555555558, 869.4300000000004, 868.6366666666671, 866.7633333333337, 867.018888888889, 865.4077777777771, 865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224, 867.7166666666669, 867.3699999999995, 866.7366666666666, 865.2466666666661, 865.8499999999995, 865.6911111111106, 864.2333333333329, 864.5822222222215, 864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327, 865.5655555555549, 865.3733333333332, 866.07, 868.0677777777778, 867.3055555555558, 868.4155555555557, 868.6044444444448, 864.3277777777771, 865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20060973072035426, "mean_inference_ms": 1.833507954582008, "mean_action_processing_ms": 0.07523051193379762, "mean_env_wait_ms": 1.2313239355909058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004900455474853516, "StateBufferConnector_ms": 0.0030841827392578125, "ViewRequirementAgentConnector_ms": 0.0726463794708252}, "num_episodes": 21, "episode_return_max": 869.4300000000004, "episode_return_min": 862.6788888888881, "episode_return_mean": 866.2435555555553, "episodes_this_iter": 21}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 427650, "num_agent_steps_trained": 427500, "num_env_steps_sampled": 427650, "num_env_steps_trained": 427500, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 223.506695549317, "num_env_steps_trained_throughput_per_sec": 238.40714191927145, "timesteps_total": 427650, "num_env_steps_sampled_lifetime": 427650, "num_agent_steps_sampled_lifetime": 427650, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 427650, "timers": {"training_iteration_time_ms": 10275.456, "restore_workers_time_ms": 0.014, "training_step_time_ms": 671.086, "sample_time_ms": 654.769, "synch_weights_time_ms": 14.853}, "counters": {"num_env_steps_sampled": 427650, "num_env_steps_trained": 427500, "num_agent_steps_sampled": 427650, "num_agent_steps_trained": 427500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2851, "num_samples_added_to_queue": 427500}, "done": false, "training_iteration": 146, "trial_id": "38f59_00000", "date": "2024-10-10_22-36-36", "timestamp": 1728596196, "time_this_iter_s": 10.078007459640503, "time_total_s": 1498.2596247196198, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1bf40>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1498.2596247196198, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 19.521428571428572, "ram_util_percent": 69.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2170.906494140625, "policy_loss": 147.9723358154297, "entropy": 4.501137733459473, "entropy_coeff": 0.01, "var_gnorm": 17.835582733154297, "vf_loss": 203643.75, "vf_explained_var": 0.6321072578430176}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1434.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 430500, "num_env_steps_trained": 430200, "num_agent_steps_sampled": 430500, "num_agent_steps_trained": 430200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2870, "num_samples_added_to_queue": 430500, "learner_queue": {"size_count": 1434, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 61.559, "learner_load_time_ms": 0.308, "learner_load_wait_time_ms": 1045.355, "learner_dequeue_time_ms": 9537.484}}, "env_runners": {"episode_reward_max": 870.4444444444453, "episode_reward_min": 863.342222222222, "episode_reward_mean": 867.2111444444442, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 863.342222222222}, "policy_reward_max": {"default_policy": 870.4444444444453}, "policy_reward_mean": {"default_policy": 867.2111444444442}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.33080000000000004, "num_moves_min": 0.0, "num_moves_max": 0.64, "mean_accuracy_mean": 40.27533666666666, "mean_accuracy_min": 40.01066666666666, "mean_accuracy_max": 40.466666666666654, "num_model_switches_mean": 0.3289000000000001, "num_model_switches_min": 0.0, "num_model_switches_max": 0.6, "num_slav_mean": 0.000658, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5006131336757677, "mean_cluster_cpu_util_min": 0.4953461229086229, "mean_cluster_cpu_util_max": 0.505156186799044, "mean_cluster_mem_util_mean": 0.32688037974683537, "mean_cluster_mem_util_min": 0.32559968354430374, "mean_cluster_mem_util_max": 0.3278185654008439, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.027533666666667, "reward_accuracy_mean_min": 4.0010666666666665, "reward_accuracy_mean_max": 4.046666666666667, "reward_sla_mean_mean": -0.021933333333333332, "reward_sla_mean_min": -0.04000000000000001, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 402.7533666666667, "reward_accuracy_sum_min": 400.1066666666667, "reward_accuracy_sum_max": 404.6666666666667, "reward_sla_sum_mean": -2.193333333333334, "reward_sla_sum_min": -4.000000000000001, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2311.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224, 867.7166666666669, 867.3699999999995, 866.7366666666666, 865.2466666666661, 865.8499999999995, 865.6911111111106, 864.2333333333329, 864.5822222222215, 864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327, 865.5655555555549, 865.3733333333332, 866.07, 868.0677777777778, 867.3055555555558, 868.4155555555557, 868.6044444444448, 864.3277777777771, 865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668, 867.6522222222223, 869.9377777777783, 868.0966666666671, 868.8900000000002, 869.5566666666671, 868.7622222222228, 869.2700000000004, 868.6033333333339, 869.7777777777783, 868.9844444444448, 867.0822222222224, 869.2711111111116, 868.1600000000002, 868.7311111111115, 868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [865.5011111111107, 866.1022222222219, 865.9744444444444, 868.0988888888891, 867.4633333333338, 867.5577777777784, 868.0344444444447, 868.0344444444447, 867.1455555555558, 865.0899999999995, 864.7077777777778, 863.342222222222, 866.9255555555558, 867.7177777777781, 867.6544444444447, 868.5422222222223, 867.715555555556, 868.3200000000002, 867.2722222222224, 867.7166666666669, 867.3699999999995, 866.7366666666666, 865.2466666666661, 865.8499999999995, 865.6911111111106, 864.2333333333329, 864.5822222222215, 864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327, 865.5655555555549, 865.3733333333332, 866.07, 868.0677777777778, 867.3055555555558, 868.4155555555557, 868.6044444444448, 864.3277777777771, 865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668, 867.6522222222223, 869.9377777777783, 868.0966666666671, 868.8900000000002, 869.5566666666671, 868.7622222222228, 869.2700000000004, 868.6033333333339, 869.7777777777783, 868.9844444444448, 867.0822222222224, 869.2711111111116, 868.1600000000002, 868.7311111111115, 868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20056982982315316, "mean_inference_ms": 1.8300962206674962, "mean_action_processing_ms": 0.07521803211536669, "mean_env_wait_ms": 1.2310118550263973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00469660758972168, "StateBufferConnector_ms": 0.003054380416870117, "ViewRequirementAgentConnector_ms": 0.07132458686828613}, "num_episodes": 30, "episode_return_max": 870.4444444444453, "episode_return_min": 863.342222222222, "episode_return_mean": 867.2111444444442, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 430500, "num_agent_steps_trained": 430200, "num_env_steps_sampled": 430500, "num_env_steps_trained": 430200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 271.9464159086985, "num_env_steps_trained_throughput_per_sec": 257.63344665034595, "timesteps_total": 430500, "num_env_steps_sampled_lifetime": 430500, "num_agent_steps_sampled_lifetime": 430500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 430500, "timers": {"training_iteration_time_ms": 10284.026, "restore_workers_time_ms": 0.013, "training_step_time_ms": 536.684, "sample_time_ms": 520.829, "synch_weights_time_ms": 14.471}, "counters": {"num_env_steps_sampled": 430500, "num_env_steps_trained": 430200, "num_agent_steps_sampled": 430500, "num_agent_steps_trained": 430200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2870, "num_samples_added_to_queue": 430500}, "done": false, "training_iteration": 147, "trial_id": "38f59_00000", "date": "2024-10-10_22-36-46", "timestamp": 1728596206, "time_this_iter_s": 10.493379831314087, "time_total_s": 1508.7530045509338, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe201b3700>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1508.7530045509338, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 11.300000000000002, "ram_util_percent": 70.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 3178.13037109375, "policy_loss": 1168.389892578125, "entropy": 4.459364414215088, "entropy_coeff": 0.01, "var_gnorm": 17.891138076782227, "vf_loss": 202311.875, "vf_explained_var": 0.6333146095275879}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1444.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 433350, "num_env_steps_trained": 433200, "num_agent_steps_sampled": 433350, "num_agent_steps_trained": 433200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2889, "num_samples_added_to_queue": 433200, "learner_queue": {"size_count": 1444, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 59.855, "learner_load_time_ms": 0.293, "learner_load_wait_time_ms": 1005.768, "learner_dequeue_time_ms": 9504.285}}, "env_runners": {"episode_reward_max": 870.603333333334, "episode_reward_min": 864.2333333333326, "episode_reward_mean": 867.8420444444446, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 864.2333333333326}, "policy_reward_max": {"default_policy": 870.603333333334}, "policy_reward_mean": {"default_policy": 867.8420444444446}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.23400000000000007, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 40.33442666666666, "mean_accuracy_min": 40.01066666666666, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.2268, "num_model_switches_min": 0.0, "num_model_switches_max": 0.6, "num_slav_mean": 0.0006506666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5016401050284979, "mean_cluster_cpu_util_min": 0.4955128010663725, "mean_cluster_cpu_util_max": 0.5053097076668506, "mean_cluster_mem_util_mean": 0.32713841772151897, "mean_cluster_mem_util_min": 0.32559968354430374, "mean_cluster_mem_util_max": 0.3278808016877637, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.033442666666667, "reward_accuracy_mean_min": 4.0010666666666665, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.02168888888888889, "reward_sla_mean_min": -0.04000000000000001, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.34426666666667, "reward_accuracy_sum_min": 400.1066666666667, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.168888888888889, "reward_sla_sum_min": -4.000000000000001, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2362.0, "global_timestep_min": 500, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327, 865.5655555555549, 865.3733333333332, 866.07, 868.0677777777778, 867.3055555555558, 868.4155555555557, 868.6044444444448, 864.3277777777771, 865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668, 867.6522222222223, 869.9377777777783, 868.0966666666671, 868.8900000000002, 869.5566666666671, 868.7622222222228, 869.2700000000004, 868.6033333333339, 869.7777777777783, 868.9844444444448, 867.0822222222224, 869.2711111111116, 868.1600000000002, 868.7311111111115, 868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673, 868.7300000000006, 869.0477777777786, 868.1588888888894, 868.6033333333335, 869.3966666666671, 868.5400000000003, 868.6666666666672, 868.6666666666672, 869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [864.2333333333326, 864.2644444444437, 868.6066666666669, 866.3233333333327, 865.9122222222218, 865.7855555555551, 866.135555555555, 865.1211111111104, 864.9311111111105, 865.1855555555545, 864.5511111111102, 864.994444444444, 867.8766666666667, 867.8144444444443, 866.8633333333329, 865.6266666666663, 865.6599999999993, 865.9144444444436, 866.611111111111, 865.1522222222216, 865.9777777777773, 864.4233333333327, 865.5655555555549, 865.3733333333332, 866.07, 868.0677777777778, 867.3055555555558, 868.4155555555557, 868.6044444444448, 864.3277777777771, 865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668, 867.6522222222223, 869.9377777777783, 868.0966666666671, 868.8900000000002, 869.5566666666671, 868.7622222222228, 869.2700000000004, 868.6033333333339, 869.7777777777783, 868.9844444444448, 867.0822222222224, 869.2711111111116, 868.1600000000002, 868.7311111111115, 868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673, 868.7300000000006, 869.0477777777786, 868.1588888888894, 868.6033333333335, 869.3966666666671, 868.5400000000003, 868.6666666666672, 868.6666666666672, 869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20069091686529483, "mean_inference_ms": 1.8327153862266328, "mean_action_processing_ms": 0.0752703574823965, "mean_env_wait_ms": 1.231995850892054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004285335540771484, "StateBufferConnector_ms": 0.0030145645141601562, "ViewRequirementAgentConnector_ms": 0.07001972198486328}, "num_episodes": 27, "episode_return_max": 870.603333333334, "episode_return_min": 864.2333333333326, "episode_return_mean": 867.8420444444446, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 433350, "num_agent_steps_trained": 433200, "num_env_steps_sampled": 433350, "num_env_steps_trained": 433200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.50352889814536, "num_env_steps_trained_throughput_per_sec": 298.4247672612056, "timesteps_total": 433350, "num_env_steps_sampled_lifetime": 433350, "num_agent_steps_sampled_lifetime": 433350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 433350, "timers": {"training_iteration_time_ms": 10259.303, "restore_workers_time_ms": 0.013, "training_step_time_ms": 535.981, "sample_time_ms": 519.82, "synch_weights_time_ms": 14.686}, "counters": {"num_env_steps_sampled": 433350, "num_env_steps_trained": 433200, "num_agent_steps_sampled": 433350, "num_agent_steps_trained": 433200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2889, "num_samples_added_to_queue": 433200}, "done": false, "training_iteration": 148, "trial_id": "38f59_00000", "date": "2024-10-10_22-36-56", "timestamp": 1728596216, "time_this_iter_s": 10.06824278831482, "time_total_s": 1518.8212473392487, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe201b2530>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1518.8212473392487, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 10.35, "ram_util_percent": 69.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1274.9921875, "policy_loss": -795.1849365234375, "entropy": 4.635457515716553, "entropy_coeff": 0.01, "var_gnorm": 17.92404556274414, "vf_loss": 208408.359375, "vf_explained_var": 0.6295087337493896}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1453.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 436200, "num_env_steps_trained": 435900, "num_agent_steps_sampled": 436200, "num_agent_steps_trained": 435900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2908, "num_samples_added_to_queue": 436200, "learner_queue": {"size_count": 1453, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 62.18, "learner_load_time_ms": 0.314, "learner_load_wait_time_ms": 1031.943, "learner_dequeue_time_ms": 9362.092}}, "env_runners": {"episode_reward_max": 870.603333333334, "episode_reward_min": 865.2488888888882, "episode_reward_mean": 868.7565444444449, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.2488888888882}, "policy_reward_max": {"default_policy": 870.603333333334}, "policy_reward_mean": {"default_policy": 868.7565444444449}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.13360000000000002, "num_moves_min": 0.0, "num_moves_max": 0.52, "mean_accuracy_mean": 40.42720999999999, "mean_accuracy_min": 40.03599999999999, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.0974, "num_model_switches_min": 0.0, "num_model_switches_max": 0.54, "num_slav_mean": 0.0006546666666666667, "num_slav_min": 0.0002, "num_slav_max": 0.0015999999999999999, "mean_cluster_cpu_util_mean": 0.5032334743289208, "mean_cluster_cpu_util_min": 0.4971908324140466, "mean_cluster_cpu_util_max": 0.5053097076668506, "mean_cluster_mem_util_mean": 0.3275463185654008, "mean_cluster_mem_util_min": 0.32594409282700426, "mean_cluster_mem_util_max": 0.3278808016877637, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.042721000000001, "reward_accuracy_mean_min": 4.0036000000000005, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.021822222222222222, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.2720999999999, "reward_accuracy_sum_min": 400.36, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.1822222222222223, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3369.0, "global_timestep_min": 1500, "global_timestep_max": 5000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668, 867.6522222222223, 869.9377777777783, 868.0966666666671, 868.8900000000002, 869.5566666666671, 868.7622222222228, 869.2700000000004, 868.6033333333339, 869.7777777777783, 868.9844444444448, 867.0822222222224, 869.2711111111116, 868.1600000000002, 868.7311111111115, 868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673, 868.7300000000006, 869.0477777777786, 868.1588888888894, 868.6033333333335, 869.3966666666671, 868.5400000000003, 868.6666666666672, 868.6666666666672, 869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556, 869.1111111111117, 869.3333333333339, 869.2700000000006, 868.8255555555561, 868.8255555555561, 869.5555555555561, 868.4444444444448, 869.555555555556, 870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [865.8499999999993, 867.56, 866.8944444444445, 868.1944444444446, 868.5422222222228, 868.0022222222225, 865.2488888888882, 865.3088888888885, 866.2288888888886, 867.5933333333335, 867.6244444444444, 868.6388888888891, 867.3366666666668, 867.6522222222223, 869.9377777777783, 868.0966666666671, 868.8900000000002, 869.5566666666671, 868.7622222222228, 869.2700000000004, 868.6033333333339, 869.7777777777783, 868.9844444444448, 867.0822222222224, 869.2711111111116, 868.1600000000002, 868.7311111111115, 868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673, 868.7300000000006, 869.0477777777786, 868.1588888888894, 868.6033333333335, 869.3966666666671, 868.5400000000003, 868.6666666666672, 868.6666666666672, 869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556, 869.1111111111117, 869.3333333333339, 869.2700000000006, 868.8255555555561, 868.8255555555561, 869.5555555555561, 868.4444444444448, 869.555555555556, 870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20078973436824155, "mean_inference_ms": 1.8352107809154956, "mean_action_processing_ms": 0.075318252797899, "mean_env_wait_ms": 1.2328882737400175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041599273681640625, "StateBufferConnector_ms": 0.0029561519622802734, "ViewRequirementAgentConnector_ms": 0.06888675689697266}, "num_episodes": 30, "episode_return_max": 870.603333333334, "episode_return_min": 865.2488888888882, "episode_return_mean": 868.7565444444449, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436200, "num_agent_steps_trained": 435900, "num_env_steps_sampled": 436200, "num_env_steps_trained": 435900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 274.68033835837673, "num_env_steps_trained_throughput_per_sec": 260.223478444778, "timesteps_total": 436200, "num_env_steps_sampled_lifetime": 436200, "num_agent_steps_sampled_lifetime": 436200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 436200, "timers": {"training_iteration_time_ms": 10268.103, "restore_workers_time_ms": 0.014, "training_step_time_ms": 553.608, "sample_time_ms": 538.433, "synch_weights_time_ms": 13.785}, "counters": {"num_env_steps_sampled": 436200, "num_env_steps_trained": 435900, "num_agent_steps_sampled": 436200, "num_agent_steps_trained": 435900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2908, "num_samples_added_to_queue": 436200}, "done": false, "training_iteration": 149, "trial_id": "38f59_00000", "date": "2024-10-10_22-37-07", "timestamp": 1728596227, "time_this_iter_s": 10.386142253875732, "time_total_s": 1529.2073895931244, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc6c50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1529.2073895931244, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 11.033333333333333, "ram_util_percent": 68.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1782.0888671875, "policy_loss": -300.5639953613281, "entropy": 4.501153469085693, "entropy_coeff": 0.01, "var_gnorm": 17.931629180908203, "vf_loss": 209615.640625, "vf_explained_var": 0.6293619871139526}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1463.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 439050, "num_env_steps_trained": 438900, "num_agent_steps_sampled": 439050, "num_agent_steps_trained": 438900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2927, "num_samples_added_to_queue": 438900, "learner_queue": {"size_count": 1463, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.372, "learner_load_time_ms": 0.313, "learner_load_wait_time_ms": 1038.967, "learner_dequeue_time_ms": 9233.974}}, "env_runners": {"episode_reward_max": 870.603333333334, "episode_reward_min": 866.0633333333334, "episode_reward_mean": 869.0338111111117, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.0633333333334}, "policy_reward_max": {"default_policy": 870.603333333334}, "policy_reward_mean": {"default_policy": 869.0338111111117}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.0886, "num_moves_min": 0.0, "num_moves_max": 0.26, "mean_accuracy_mean": 40.46026999999999, "mean_accuracy_min": 40.377999999999986, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.027600000000000003, "num_model_switches_min": 0.0, "num_model_switches_max": 0.22, "num_slav_mean": 0.0006706666666666666, "num_slav_min": 0.0002, "num_slav_max": 0.0015999999999999999, "mean_cluster_cpu_util_mean": 0.5037118454679169, "mean_cluster_cpu_util_min": 0.5011465572715573, "mean_cluster_cpu_util_max": 0.5053097076668506, "mean_cluster_mem_util_mean": 0.3276792194092827, "mean_cluster_mem_util_min": 0.32740822784810125, "mean_cluster_mem_util_max": 0.3278808016877637, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0460270000000005, "reward_accuracy_mean_min": 4.0378, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.022355555555555556, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.60269999999997, "reward_accuracy_sum_min": 403.78, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.2355555555555555, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4258.0, "global_timestep_min": 2200, "global_timestep_max": 5900}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673, 868.7300000000006, 869.0477777777786, 868.1588888888894, 868.6033333333335, 869.3966666666671, 868.5400000000003, 868.6666666666672, 868.6666666666672, 869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556, 869.1111111111117, 869.3333333333339, 869.2700000000006, 868.8255555555561, 868.8255555555561, 869.5555555555561, 868.4444444444448, 869.555555555556, 870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231, 868.7622222222228, 868.2222222222229, 869.5555555555562, 868.1588888888894, 869.1744444444452, 869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.254444444445, 868.7622222222228, 869.2066666666674, 870.4444444444453, 867.206666666667, 870.2222222222229, 867.5577777777779, 868.1922222222227, 869.0488888888893, 869.0800000000005, 869.6833333333341, 868.6988888888893, 869.8100000000006, 869.6833333333338, 869.9366666666673, 869.2066666666673, 868.7300000000006, 869.0477777777786, 868.1588888888894, 868.6033333333335, 869.3966666666671, 868.5400000000003, 868.6666666666672, 868.6666666666672, 869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556, 869.1111111111117, 869.3333333333339, 869.2700000000006, 868.8255555555561, 868.8255555555561, 869.5555555555561, 868.4444444444448, 869.555555555556, 870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231, 868.7622222222228, 868.2222222222229, 869.5555555555562, 868.1588888888894, 869.1744444444452, 869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20073621216733567, "mean_inference_ms": 1.8340401853632624, "mean_action_processing_ms": 0.075308574427892, "mean_env_wait_ms": 1.2327198679082103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003946542739868164, "StateBufferConnector_ms": 0.0028638839721679688, "ViewRequirementAgentConnector_ms": 0.06647539138793945}, "num_episodes": 27, "episode_return_max": 870.603333333334, "episode_return_min": 866.0633333333334, "episode_return_mean": 869.0338111111117, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 439050, "num_agent_steps_trained": 438900, "num_env_steps_sampled": 439050, "num_env_steps_trained": 438900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 270.25185188534533, "num_env_steps_trained_throughput_per_sec": 284.4756335635214, "timesteps_total": 439050, "num_env_steps_sampled_lifetime": 439050, "num_agent_steps_sampled_lifetime": 439050, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 439050, "timers": {"training_iteration_time_ms": 10298.476, "restore_workers_time_ms": 0.014, "training_step_time_ms": 570.657, "sample_time_ms": 554.394, "synch_weights_time_ms": 14.864}, "counters": {"num_env_steps_sampled": 439050, "num_env_steps_trained": 438900, "num_agent_steps_sampled": 439050, "num_agent_steps_trained": 438900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2927, "num_samples_added_to_queue": 438900}, "done": false, "training_iteration": 150, "trial_id": "38f59_00000", "date": "2024-10-10_22-37-17", "timestamp": 1728596237, "time_this_iter_s": 10.55854606628418, "time_total_s": 1539.7659356594086, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6590>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1539.7659356594086, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 10.473333333333331, "ram_util_percent": 67.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2241.99560546875, "policy_loss": 212.770751953125, "entropy": 4.499102592468262, "entropy_coeff": 0.01, "var_gnorm": 17.92360496520996, "vf_loss": 204272.234375, "vf_explained_var": 0.6326168775558472}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1470.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 441300, "num_env_steps_trained": 441000, "num_agent_steps_sampled": 441300, "num_agent_steps_trained": 441000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2942, "num_samples_added_to_queue": 441300, "learner_queue": {"size_count": 1470, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 69.324, "learner_load_time_ms": 0.242, "learner_load_wait_time_ms": 1271.875, "learner_dequeue_time_ms": 9271.218}}, "env_runners": {"episode_reward_max": 870.603333333334, "episode_reward_min": 866.0633333333334, "episode_reward_mean": 869.0657777777784, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.0633333333334}, "policy_reward_max": {"default_policy": 870.603333333334}, "policy_reward_mean": {"default_policy": 869.0657777777784}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.08120000000000001, "num_moves_min": 0.0, "num_moves_max": 0.23, "mean_accuracy_mean": 40.46413333333332, "mean_accuracy_min": 40.441333333333326, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.0128, "num_model_switches_min": 0.0, "num_model_switches_max": 0.08, "num_slav_mean": 0.0006726666666666668, "num_slav_min": 0.0002, "num_slav_max": 0.0015999999999999999, "mean_cluster_cpu_util_mean": 0.5037759493932709, "mean_cluster_cpu_util_min": 0.5011465572715573, "mean_cluster_cpu_util_max": 0.505303766776981, "mean_cluster_mem_util_mean": 0.3277004852320674, "mean_cluster_mem_util_min": 0.32740822784810125, "mean_cluster_mem_util_max": 0.3278823839662448, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0464133333333345, "reward_accuracy_mean_min": 4.044133333333334, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.02242222222222223, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.6413333333333, "reward_accuracy_sum_min": 404.41333333333336, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.2422222222222223, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5062.0, "global_timestep_min": 3200, "global_timestep_max": 6700}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556, 869.1111111111117, 869.3333333333339, 869.2700000000006, 868.8255555555561, 868.8255555555561, 869.5555555555561, 868.4444444444448, 869.555555555556, 870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231, 868.7622222222228, 868.2222222222229, 869.5555555555562, 868.1588888888894, 869.1744444444452, 869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117, 869.1111111111119, 868.6666666666675, 869.555555555556, 870.1588888888895, 869.3333333333338, 869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.6188888888895, 868.0000000000007, 867.9366666666671, 868.0000000000006, 868.7622222222227, 867.936666666667, 869.7777777777783, 869.8733333333339, 868.6666666666672, 869.5555555555561, 870.0955555555562, 868.6033333333338, 869.333333333334, 869.7777777777786, 868.8888888888894, 868.6666666666673, 870.603333333334, 868.9844444444451, 868.825555555556, 869.1111111111117, 869.3333333333339, 869.2700000000006, 868.8255555555561, 868.8255555555561, 869.5555555555561, 868.4444444444448, 869.555555555556, 870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231, 868.7622222222228, 868.2222222222229, 869.5555555555562, 868.1588888888894, 869.1744444444452, 869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117, 869.1111111111119, 868.6666666666675, 869.555555555556, 870.1588888888895, 869.3333333333338, 869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20081584633257665, "mean_inference_ms": 1.8353890431369064, "mean_action_processing_ms": 0.07533724329090198, "mean_env_wait_ms": 1.2334445161484402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004286289215087891, "StateBufferConnector_ms": 0.0030486583709716797, "ViewRequirementAgentConnector_ms": 0.0717475414276123}, "num_episodes": 24, "episode_return_max": 870.603333333334, "episode_return_min": 866.0633333333334, "episode_return_mean": 869.0657777777784, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 441300, "num_agent_steps_trained": 441000, "num_env_steps_sampled": 441300, "num_env_steps_trained": 441000, "num_env_steps_sampled_this_iter": 2250, "num_env_steps_trained_this_iter": 2100, "num_env_steps_sampled_throughput_per_sec": 218.86330178805537, "num_env_steps_trained_throughput_per_sec": 204.272415002185, "timesteps_total": 441300, "num_env_steps_sampled_lifetime": 441300, "num_agent_steps_sampled_lifetime": 441300, "num_steps_trained_this_iter": 2100, "agent_timesteps_total": 441300, "timers": {"training_iteration_time_ms": 10270.247, "restore_workers_time_ms": 0.015, "training_step_time_ms": 607.745, "sample_time_ms": 591.662, "synch_weights_time_ms": 14.624}, "counters": {"num_env_steps_sampled": 441300, "num_env_steps_trained": 441000, "num_agent_steps_sampled": 441300, "num_agent_steps_trained": 441000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2942, "num_samples_added_to_queue": 441300}, "done": false, "training_iteration": 151, "trial_id": "38f59_00000", "date": "2024-10-10_22-37-28", "timestamp": 1728596248, "time_this_iter_s": 10.291385889053345, "time_total_s": 1550.057321548462, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18b50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1550.057321548462, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 23.62, "ram_util_percent": 71.00666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1785.923828125, "policy_loss": -202.19068908691406, "entropy": 4.597466468811035, "entropy_coeff": 0.01, "var_gnorm": 17.90999412536621, "vf_loss": 200190.6875, "vf_explained_var": 0.6350713968276978}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1479.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 443700, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 443700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2960, "num_samples_added_to_queue": 444000, "learner_queue": {"size_count": 1479, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.006, "learner_load_time_ms": 0.238, "learner_load_wait_time_ms": 1077.601, "learner_dequeue_time_ms": 9155.369}}, "env_runners": {"episode_reward_max": 870.3811111111119, "episode_reward_min": 866.0633333333334, "episode_reward_mean": 869.0788111111117, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 866.0633333333334}, "policy_reward_max": {"default_policy": 870.3811111111119}, "policy_reward_mean": {"default_policy": 869.0788111111117}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.10049999999999999, "num_moves_min": 0.0, "num_moves_max": 0.23, "mean_accuracy_mean": 40.46343666666665, "mean_accuracy_min": 40.441333333333326, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.014199999999999999, "num_model_switches_min": 0.0, "num_model_switches_max": 0.08, "num_slav_mean": 0.0006666666666666666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0015999999999999999, "mean_cluster_cpu_util_mean": 0.5037236332505975, "mean_cluster_cpu_util_min": 0.5015256710792425, "mean_cluster_cpu_util_max": 0.5054652739474168, "mean_cluster_mem_util_mean": 0.32768900316455685, "mean_cluster_mem_util_min": 0.3274361814345991, "mean_cluster_mem_util_max": 0.3278823839662448, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.046343666666667, "reward_accuracy_mean_min": 4.044133333333334, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.02222222222222222, "reward_sla_mean_min": -0.05333333333333334, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.6343666666666, "reward_accuracy_sum_min": 404.41333333333336, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.2222222222222223, "reward_sla_sum_min": -5.333333333333334, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5962.0, "global_timestep_min": 4100, "global_timestep_max": 7600}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231, 868.7622222222228, 868.2222222222229, 869.5555555555562, 868.1588888888894, 869.1744444444452, 869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117, 869.1111111111119, 868.6666666666675, 869.555555555556, 870.1588888888895, 869.3333333333338, 869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007, 868.2222222222227, 869.7777777777784, 869.6511111111116, 869.0477777777784, 867.6511111111116, 869.1744444444449, 869.6511111111117, 869.4922222222231, 870.2222222222229, 869.1111111111117, 869.7777777777785, 868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [870.0000000000005, 867.7777777777783, 869.3966666666673, 869.7777777777785, 868.5400000000003, 869.5555555555562, 869.9366666666673, 869.1111111111115, 869.5555555555561, 868.8577777777784, 868.6033333333338, 869.3333333333339, 866.0633333333334, 868.8255555555563, 869.333333333334, 869.1111111111115, 868.8888888888895, 870.3811111111117, 869.3966666666674, 868.8888888888895, 868.6666666666673, 870.2222222222231, 868.7622222222228, 868.2222222222229, 869.5555555555562, 868.1588888888894, 869.1744444444452, 869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117, 869.1111111111119, 868.6666666666675, 869.555555555556, 870.1588888888895, 869.3333333333338, 869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007, 868.2222222222227, 869.7777777777784, 869.6511111111116, 869.0477777777784, 867.6511111111116, 869.1744444444449, 869.6511111111117, 869.4922222222231, 870.2222222222229, 869.1111111111117, 869.7777777777785, 868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2009179592959468, "mean_inference_ms": 1.8367352043557843, "mean_action_processing_ms": 0.07537927302803976, "mean_env_wait_ms": 1.2342423227210886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004432201385498047, "StateBufferConnector_ms": 0.0030939579010009766, "ViewRequirementAgentConnector_ms": 0.07326960563659668}, "num_episodes": 27, "episode_return_max": 870.3811111111119, "episode_return_min": 866.0633333333334, "episode_return_mean": 869.0788111111117, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 443700, "num_env_steps_sampled": 444000, "num_env_steps_trained": 443700, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 266.021847267762, "num_env_steps_trained_throughput_per_sec": 266.021847267762, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 444000, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 10267.998, "restore_workers_time_ms": 0.015, "training_step_time_ms": 552.399, "sample_time_ms": 534.941, "synch_weights_time_ms": 15.732}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 443700, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 443700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2960, "num_samples_added_to_queue": 444000}, "done": false, "training_iteration": 152, "trial_id": "38f59_00000", "date": "2024-10-10_22-37-38", "timestamp": 1728596258, "time_this_iter_s": 10.159120321273804, "time_total_s": 1560.2164418697357, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb76d0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1560.2164418697357, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 12.673333333333334, "ram_util_percent": 71.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2349.372802734375, "policy_loss": 347.87677001953125, "entropy": 4.48372745513916, "entropy_coeff": 0.01, "var_gnorm": 17.887842178344727, "vf_loss": 201494.71875, "vf_explained_var": 0.6428248882293701}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1489.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 446850, "num_env_steps_trained": 446700, "num_agent_steps_sampled": 446850, "num_agent_steps_trained": 446700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2979, "num_samples_added_to_queue": 446700, "learner_queue": {"size_count": 1489, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 65.108, "learner_load_time_ms": 0.251, "learner_load_wait_time_ms": 995.411, "learner_dequeue_time_ms": 9158.585}}, "env_runners": {"episode_reward_max": 870.3811111111119, "episode_reward_min": 867.1433333333337, "episode_reward_mean": 869.0728222222227, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 867.1433333333337}, "policy_reward_max": {"default_policy": 870.3811111111119}, "policy_reward_mean": {"default_policy": 869.0728222222227}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.08760000000000001, "num_moves_min": 0.0, "num_moves_max": 0.22, "mean_accuracy_mean": 40.46172666666666, "mean_accuracy_min": 40.42233333333332, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.020200000000000006, "num_model_switches_min": 0.0, "num_model_switches_max": 0.16, "num_slav_mean": 0.0006633333333333333, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012, "mean_cluster_cpu_util_mean": 0.5037208462033462, "mean_cluster_cpu_util_min": 0.5010049526567384, "mean_cluster_cpu_util_max": 0.5054652739474168, "mean_cluster_mem_util_mean": 0.3276754483122362, "mean_cluster_mem_util_min": 0.327415611814346, "mean_cluster_mem_util_max": 0.3278823839662448, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.046172666666667, "reward_accuracy_mean_min": 4.042233333333334, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.022111111111111113, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.61726666666675, "reward_accuracy_sum_min": 404.22333333333336, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.2111111111111112, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5237.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117, 869.1111111111119, 868.6666666666675, 869.555555555556, 870.1588888888895, 869.3333333333338, 869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007, 868.2222222222227, 869.7777777777784, 869.6511111111116, 869.0477777777784, 867.6511111111116, 869.1744444444449, 869.6511111111117, 869.4922222222231, 870.2222222222229, 869.1111111111117, 869.7777777777785, 868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894, 869.365555555556, 868.8255555555561, 870.0000000000008, 868.7622222222225, 869.7777777777784, 869.2700000000007, 867.936666666667, 868.8888888888896, 869.8733333333339, 868.3811111111116, 867.1433333333337, 869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.3333333333337, 868.6666666666672, 869.3333333333339, 869.333333333334, 869.1111111111118, 868.3177777777784, 870.0633333333343, 869.714444444445, 868.8888888888896, 869.1111111111117, 867.5877777777781, 868.0000000000005, 869.0477777777784, 870.2222222222229, 867.9366666666673, 868.6666666666671, 868.2222222222227, 868.8255555555561, 870.3811111111119, 869.5555555555561, 870.2222222222229, 869.1111111111117, 869.1111111111119, 868.6666666666675, 869.555555555556, 870.1588888888895, 869.3333333333338, 869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007, 868.2222222222227, 869.7777777777784, 869.6511111111116, 869.0477777777784, 867.6511111111116, 869.1744444444449, 869.6511111111117, 869.4922222222231, 870.2222222222229, 869.1111111111117, 869.7777777777785, 868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894, 869.365555555556, 868.8255555555561, 870.0000000000008, 868.7622222222225, 869.7777777777784, 869.2700000000007, 867.936666666667, 868.8888888888896, 869.8733333333339, 868.3811111111116, 867.1433333333337, 869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20110187248880176, "mean_inference_ms": 1.8409747721744247, "mean_action_processing_ms": 0.07545381050018093, "mean_env_wait_ms": 1.235644216815362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004492044448852539, "StateBufferConnector_ms": 0.0031251907348632812, "ViewRequirementAgentConnector_ms": 0.07387018203735352}, "num_episodes": 27, "episode_return_max": 870.3811111111119, "episode_return_min": 867.1433333333337, "episode_return_mean": 869.0728222222227, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 446850, "num_agent_steps_trained": 446700, "num_env_steps_sampled": 446850, "num_env_steps_trained": 446700, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 283.7944347046969, "num_env_steps_trained_throughput_per_sec": 298.73098389968095, "timesteps_total": 446850, "num_env_steps_sampled_lifetime": 446850, "num_agent_steps_sampled_lifetime": 446850, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 446850, "timers": {"training_iteration_time_ms": 10268.784, "restore_workers_time_ms": 0.013, "training_step_time_ms": 530.35, "sample_time_ms": 514.845, "synch_weights_time_ms": 14.146}, "counters": {"num_env_steps_sampled": 446850, "num_env_steps_trained": 446700, "num_agent_steps_sampled": 446850, "num_agent_steps_trained": 446700, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2979, "num_samples_added_to_queue": 446700}, "done": false, "training_iteration": 153, "trial_id": "38f59_00000", "date": "2024-10-10_22-37-48", "timestamp": 1728596268, "time_this_iter_s": 10.053564071655273, "time_total_s": 1570.270005941391, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc19750>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1570.270005941391, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 10.742857142857144, "ram_util_percent": 71.46428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1814.4697265625, "policy_loss": -21.645645141601562, "entropy": 4.857640266418457, "entropy_coeff": 0.01, "var_gnorm": 17.845550537109375, "vf_loss": 185068.828125, "vf_explained_var": 0.6322533488273621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1498.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 449550, "num_env_steps_trained": 449400, "num_agent_steps_sampled": 449550, "num_agent_steps_trained": 449400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2997, "num_samples_added_to_queue": 449400, "learner_queue": {"size_count": 1498, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.527, "learner_load_time_ms": 0.262, "learner_load_wait_time_ms": 1105.201, "learner_dequeue_time_ms": 9198.425}}, "env_runners": {"episode_reward_max": 870.2222222222229, "episode_reward_min": 865.8755555555556, "episode_reward_mean": 868.9046444444451, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.8755555555556}, "policy_reward_max": {"default_policy": 870.2222222222229}, "policy_reward_mean": {"default_policy": 868.9046444444451}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.11100000000000002, "num_moves_min": 0.0, "num_moves_max": 0.34, "mean_accuracy_mean": 40.44601999999999, "mean_accuracy_min": 40.32099999999999, "mean_accuracy_max": 40.47299999999999, "num_model_switches_mean": 0.0638, "num_model_switches_min": 0.0, "num_model_switches_max": 0.34, "num_slav_mean": 0.0006666666666666666, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0013333333333333333, "mean_cluster_cpu_util_mean": 0.5034843152463688, "mean_cluster_cpu_util_min": 0.5003104430961574, "mean_cluster_cpu_util_max": 0.5054652739474168, "mean_cluster_mem_util_mean": 0.3276189715189874, "mean_cluster_mem_util_min": 0.32709810126582267, "mean_cluster_mem_util_max": 0.3278823839662448, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.044602, "reward_accuracy_mean_min": 4.0321, "reward_accuracy_mean_max": 4.0473, "reward_sla_mean_mean": -0.022222222222222223, "reward_sla_mean_min": -0.04444444444444445, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 404.46020000000004, "reward_accuracy_sum_min": 403.21, "reward_accuracy_sum_max": 404.73, "reward_sla_sum_mean": -2.2222222222222223, "reward_sla_sum_min": -4.4444444444444455, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4031.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007, 868.2222222222227, 869.7777777777784, 869.6511111111116, 869.0477777777784, 867.6511111111116, 869.1744444444449, 869.6511111111117, 869.4922222222231, 870.2222222222229, 869.1111111111117, 869.7777777777785, 868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894, 869.365555555556, 868.8255555555561, 870.0000000000008, 868.7622222222225, 869.7777777777784, 869.2700000000007, 867.936666666667, 868.8888888888896, 869.8733333333339, 868.3811111111116, 867.1433333333337, 869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118, 869.3655555555562, 869.2700000000006, 869.1122222222226, 868.9222222222224, 869.1755555555561, 868.2244444444448, 867.7166666666668, 867.24, 866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.5555555555562, 867.7777777777783, 868.8888888888897, 868.3811111111117, 867.7777777777783, 869.4922222222228, 868.6033333333338, 868.8888888888894, 868.8255555555561, 868.6666666666674, 869.6188888888894, 869.3333333333339, 870.2222222222227, 868.444444444445, 869.492222222223, 868.6033333333338, 869.3333333333339, 870.0000000000008, 869.2700000000007, 868.2222222222227, 869.7777777777784, 869.6511111111116, 869.0477777777784, 867.6511111111116, 869.1744444444449, 869.6511111111117, 869.4922222222231, 870.2222222222229, 869.1111111111117, 869.7777777777785, 868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894, 869.365555555556, 868.8255555555561, 870.0000000000008, 868.7622222222225, 869.7777777777784, 869.2700000000007, 867.936666666667, 868.8888888888896, 869.8733333333339, 868.3811111111116, 867.1433333333337, 869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118, 869.3655555555562, 869.2700000000006, 869.1122222222226, 868.9222222222224, 869.1755555555561, 868.2244444444448, 867.7166666666668, 867.24, 866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20121350527719073, "mean_inference_ms": 1.8421576274188651, "mean_action_processing_ms": 0.07549446512294404, "mean_env_wait_ms": 1.236374689253424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00445556640625, "StateBufferConnector_ms": 0.00308990478515625, "ViewRequirementAgentConnector_ms": 0.07349395751953125}, "num_episodes": 27, "episode_return_max": 870.2222222222229, "episode_return_min": 865.8755555555556, "episode_return_mean": 868.9046444444451, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 449550, "num_agent_steps_trained": 449400, "num_env_steps_sampled": 449550, "num_env_steps_trained": 449400, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 257.9270127521563, "num_env_steps_trained_throughput_per_sec": 257.9270127521563, "timesteps_total": 449550, "num_env_steps_sampled_lifetime": 449550, "num_agent_steps_sampled_lifetime": 449550, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 449550, "timers": {"training_iteration_time_ms": 10268.733, "restore_workers_time_ms": 0.013, "training_step_time_ms": 615.112, "sample_time_ms": 599.078, "synch_weights_time_ms": 14.615}, "counters": {"num_env_steps_sampled": 449550, "num_env_steps_trained": 449400, "num_agent_steps_sampled": 449550, "num_agent_steps_trained": 449400, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 2997, "num_samples_added_to_queue": 449400}, "done": false, "training_iteration": 154, "trial_id": "38f59_00000", "date": "2024-10-10_22-37-58", "timestamp": 1728596278, "time_this_iter_s": 10.478060007095337, "time_total_s": 1580.7480659484863, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb54e0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1580.7480659484863, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 14.26, "ram_util_percent": 70.92666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2593.78173828125, "policy_loss": 794.7618408203125, "entropy": 4.8291096687316895, "entropy_coeff": 0.01, "var_gnorm": 17.823156356811523, "vf_loss": 181350.71875, "vf_explained_var": 0.6452969908714294}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1507.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 452400, "num_env_steps_trained": 452100, "num_agent_steps_sampled": 452400, "num_agent_steps_trained": 452100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3016, "num_samples_added_to_queue": 452400, "learner_queue": {"size_count": 1507, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.019, "learner_load_time_ms": 0.239, "learner_load_wait_time_ms": 1006.36, "learner_dequeue_time_ms": 9032.954}}, "env_runners": {"episode_reward_max": 870.0011111111115, "episode_reward_min": 865.2433333333336, "episode_reward_mean": 868.3247000000005, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.2433333333336}, "policy_reward_max": {"default_policy": 870.0011111111115}, "policy_reward_mean": {"default_policy": 868.3247000000005}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2083, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 40.39313666666666, "mean_accuracy_min": 40.219666666666654, "mean_accuracy_max": 40.466666666666654, "num_model_switches_mean": 0.18239999999999998, "num_model_switches_min": 0.0, "num_model_switches_max": 0.58, "num_slav_mean": 0.000682, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0013333333333333333, "mean_cluster_cpu_util_mean": 0.5025527368312189, "mean_cluster_cpu_util_min": 0.49792192958264386, "mean_cluster_cpu_util_max": 0.5051401912116197, "mean_cluster_mem_util_mean": 0.3273890875527426, "mean_cluster_mem_util_min": 0.3264910337552742, "mean_cluster_mem_util_max": 0.3278454641350211, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.039313666666667, "reward_accuracy_mean_min": 4.021966666666667, "reward_accuracy_mean_max": 4.046666666666667, "reward_sla_mean_mean": -0.02273333333333333, "reward_sla_mean_min": -0.04444444444444445, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.9313666666668, "reward_accuracy_sum_min": 402.19666666666666, "reward_accuracy_sum_max": 404.6666666666667, "reward_sla_sum_mean": -2.273333333333334, "reward_sla_sum_min": -4.4444444444444455, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2677.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894, 869.365555555556, 868.8255555555561, 870.0000000000008, 868.7622222222225, 869.7777777777784, 869.2700000000007, 867.936666666667, 868.8888888888896, 869.8733333333339, 868.3811111111116, 867.1433333333337, 869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118, 869.3655555555562, 869.2700000000006, 869.1122222222226, 868.9222222222224, 869.1755555555561, 868.2244444444448, 867.7166666666668, 867.24, 866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111, 868.3211111111116, 867.5288888888889, 868.1955555555555, 865.6566666666665, 867.5922222222221, 866.6411111111111, 867.9400000000002, 867.6866666666668, 866.0988888888891, 866.7333333333337, 867.146666666667, 868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.0000000000005, 868.9211111111116, 869.2700000000007, 869.9366666666674, 869.4288888888896, 869.492222222223, 869.2700000000006, 869.4922222222227, 868.444444444445, 868.1588888888894, 869.2700000000004, 869.0477777777784, 868.6988888888894, 868.5400000000005, 869.4922222222227, 868.8888888888894, 869.365555555556, 868.8255555555561, 870.0000000000008, 868.7622222222225, 869.7777777777784, 869.2700000000007, 867.936666666667, 868.8888888888896, 869.8733333333339, 868.3811111111116, 867.1433333333337, 869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118, 869.3655555555562, 869.2700000000006, 869.1122222222226, 868.9222222222224, 869.1755555555561, 868.2244444444448, 867.7166666666668, 867.24, 866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111, 868.3211111111116, 867.5288888888889, 868.1955555555555, 865.6566666666665, 867.5922222222221, 866.6411111111111, 867.9400000000002, 867.6866666666668, 866.0988888888891, 866.7333333333337, 867.146666666667, 868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20116842370196203, "mean_inference_ms": 1.839553967439195, "mean_action_processing_ms": 0.07547639236793037, "mean_env_wait_ms": 1.2359926171693618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004500627517700195, "StateBufferConnector_ms": 0.0029082298278808594, "ViewRequirementAgentConnector_ms": 0.06866979598999023}, "num_episodes": 30, "episode_return_max": 870.0011111111115, "episode_return_min": 865.2433333333336, "episode_return_mean": 868.3247000000005, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452400, "num_agent_steps_trained": 452100, "num_env_steps_sampled": 452400, "num_env_steps_trained": 452100, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 281.7383193332688, "num_env_steps_trained_throughput_per_sec": 266.909986736781, "timesteps_total": 452400, "num_env_steps_sampled_lifetime": 452400, "num_agent_steps_sampled_lifetime": 452400, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 452400, "timers": {"training_iteration_time_ms": 10257.737, "restore_workers_time_ms": 0.014, "training_step_time_ms": 534.226, "sample_time_ms": 518.186, "synch_weights_time_ms": 14.67}, "counters": {"num_env_steps_sampled": 452400, "num_env_steps_trained": 452100, "num_agent_steps_sampled": 452400, "num_agent_steps_trained": 452100, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3016, "num_samples_added_to_queue": 452400}, "done": false, "training_iteration": 155, "trial_id": "38f59_00000", "date": "2024-10-10_22-38-09", "timestamp": 1728596289, "time_this_iter_s": 10.1261465549469, "time_total_s": 1590.8742125034332, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc1a5c0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1590.8742125034332, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 11.326666666666666, "ram_util_percent": 71.18666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2112.6005859375, "policy_loss": 177.83700561523438, "entropy": 4.615853309631348, "entropy_coeff": 0.01, "var_gnorm": 17.82840347290039, "vf_loss": 194861.125, "vf_explained_var": 0.6373000144958496}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1516.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 455100, "num_env_steps_trained": 454800, "num_agent_steps_sampled": 455100, "num_agent_steps_trained": 454800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3034, "num_samples_added_to_queue": 455100, "learner_queue": {"size_count": 1516, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 68.093, "learner_load_time_ms": 0.212, "learner_load_wait_time_ms": 1074.876, "learner_dequeue_time_ms": 9032.428}}, "env_runners": {"episode_reward_max": 870.3177777777782, "episode_reward_min": 865.2433333333336, "episode_reward_mean": 868.2288111111114, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.2433333333336}, "policy_reward_max": {"default_policy": 870.3177777777782}, "policy_reward_mean": {"default_policy": 868.2288111111114}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.22340000000000007, "num_moves_min": 0.0, "num_moves_max": 0.6, "mean_accuracy_mean": 40.38110333333333, "mean_accuracy_min": 40.219666666666654, "mean_accuracy_max": 40.466666666666654, "num_model_switches_mean": 0.21780000000000005, "num_model_switches_min": 0.0, "num_model_switches_max": 0.58, "num_slav_mean": 0.0006746666666666667, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0013333333333333333, "mean_cluster_cpu_util_mean": 0.5023959260663724, "mean_cluster_cpu_util_min": 0.49792192958264386, "mean_cluster_cpu_util_max": 0.5051401912116197, "mean_cluster_mem_util_mean": 0.3273500896624472, "mean_cluster_mem_util_min": 0.3264910337552742, "mean_cluster_mem_util_max": 0.3278454641350211, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.038110333333334, "reward_accuracy_mean_min": 4.021966666666667, "reward_accuracy_mean_max": 4.046666666666667, "reward_sla_mean_mean": -0.02248888888888889, "reward_sla_mean_min": -0.04444444444444445, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.8110333333334, "reward_accuracy_sum_min": 402.19666666666666, "reward_accuracy_sum_max": 404.6666666666667, "reward_sla_sum_mean": -2.2488888888888887, "reward_sla_sum_min": -4.4444444444444455, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2017.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118, 869.3655555555562, 869.2700000000006, 869.1122222222226, 868.9222222222224, 869.1755555555561, 868.2244444444448, 867.7166666666668, 867.24, 866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111, 868.3211111111116, 867.5288888888889, 868.1955555555555, 865.6566666666665, 867.5922222222221, 866.6411111111111, 867.9400000000002, 867.6866666666668, 866.0988888888891, 866.7333333333337, 867.146666666667, 868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445, 868.2877777777779, 868.3511111111115, 869.6200000000007, 868.4777777777783, 868.7633333333338, 868.9533333333336, 868.667777777778, 868.9222222222223, 868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.2700000000007, 869.7144444444451, 869.3333333333339, 869.555555555556, 867.6511111111117, 869.2066666666674, 868.1588888888892, 869.5555555555563, 869.8100000000007, 869.5555555555562, 869.3333333333338, 868.6666666666671, 868.9211111111116, 869.0477777777784, 869.4922222222228, 868.0011111111118, 869.3655555555562, 869.2700000000006, 869.1122222222226, 868.9222222222224, 869.1755555555561, 868.2244444444448, 867.7166666666668, 867.24, 866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111, 868.3211111111116, 867.5288888888889, 868.1955555555555, 865.6566666666665, 867.5922222222221, 866.6411111111111, 867.9400000000002, 867.6866666666668, 866.0988888888891, 866.7333333333337, 867.146666666667, 868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445, 868.2877777777779, 868.3511111111115, 869.6200000000007, 868.4777777777783, 868.7633333333338, 868.9533333333336, 868.667777777778, 868.9222222222223, 868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20122802708888435, "mean_inference_ms": 1.8401679973566294, "mean_action_processing_ms": 0.07549688393311758, "mean_env_wait_ms": 1.2363572768995972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004706621170043945, "StateBufferConnector_ms": 0.0029485225677490234, "ViewRequirementAgentConnector_ms": 0.06970477104187012}, "num_episodes": 27, "episode_return_max": 870.3177777777782, "episode_return_min": 865.2433333333336, "episode_return_mean": 868.2288111111114, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 455100, "num_agent_steps_trained": 454800, "num_env_steps_sampled": 455100, "num_env_steps_trained": 454800, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 263.4913741203718, "num_env_steps_trained_throughput_per_sec": 263.4913741203718, "timesteps_total": 455100, "num_env_steps_sampled_lifetime": 455100, "num_agent_steps_sampled_lifetime": 455100, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 455100, "timers": {"training_iteration_time_ms": 10275.757, "restore_workers_time_ms": 0.014, "training_step_time_ms": 559.411, "sample_time_ms": 543.647, "synch_weights_time_ms": 14.4}, "counters": {"num_env_steps_sampled": 455100, "num_env_steps_trained": 454800, "num_agent_steps_sampled": 455100, "num_agent_steps_trained": 454800, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3034, "num_samples_added_to_queue": 455100}, "done": false, "training_iteration": 156, "trial_id": "38f59_00000", "date": "2024-10-10_22-38-19", "timestamp": 1728596299, "time_this_iter_s": 10.260493516921997, "time_total_s": 1601.1347060203552, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc19bd0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1601.1347060203552, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 12.085714285714287, "ram_util_percent": 71.37857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1110.99853515625, "policy_loss": -431.575439453125, "entropy": 4.960026264190674, "entropy_coeff": 0.01, "var_gnorm": 17.8554744720459, "vf_loss": 155745.40625, "vf_explained_var": 0.6623579263687134}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1525.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 457650, "num_env_steps_trained": 457500, "num_agent_steps_sampled": 457650, "num_agent_steps_trained": 457500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3051, "num_samples_added_to_queue": 457500, "learner_queue": {"size_count": 1525, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.945, "learner_load_time_ms": 0.201, "learner_load_wait_time_ms": 1116.244, "learner_dequeue_time_ms": 9157.336}}, "env_runners": {"episode_reward_max": 870.3177777777782, "episode_reward_min": 865.1799999999998, "episode_reward_mean": 867.9946111111111, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.1799999999998}, "policy_reward_max": {"default_policy": 870.3177777777782}, "policy_reward_mean": {"default_policy": 867.9946111111111}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2645, "num_moves_min": 0.04, "num_moves_max": 0.6, "mean_accuracy_mean": 40.36184999999999, "mean_accuracy_min": 40.219666666666654, "mean_accuracy_max": 40.453999999999986, "num_model_switches_mean": 0.26410000000000006, "num_model_switches_min": 0.04, "num_model_switches_max": 0.58, "num_slav_mean": 0.0006825000000000001, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0013333333333333333, "mean_cluster_cpu_util_mean": 0.5020146373126955, "mean_cluster_cpu_util_min": 0.49792192958264386, "mean_cluster_cpu_util_max": 0.5048609004412575, "mean_cluster_mem_util_mean": 0.3272588699894514, "mean_cluster_mem_util_min": 0.32637486814345995, "mean_cluster_mem_util_max": 0.32776687763713086, "reward_consolidation_mean_mean": 4.6665111111111095, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.036185, "reward_accuracy_mean_min": 4.021966666666667, "reward_accuracy_mean_max": 4.0454, "reward_sla_mean_mean": -0.02275, "reward_sla_mean_min": -0.04444444444444445, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.61850000000004, "reward_accuracy_sum_min": 402.19666666666666, "reward_accuracy_sum_max": 404.54, "reward_sla_sum_mean": -2.275, "reward_sla_sum_min": -4.4444444444444455, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2662.0, "global_timestep_min": 800, "global_timestep_max": 4300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111, 868.3211111111116, 867.5288888888889, 868.1955555555555, 865.6566666666665, 867.5922222222221, 866.6411111111111, 867.9400000000002, 867.6866666666668, 866.0988888888891, 866.7333333333337, 867.146666666667, 868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445, 868.2877777777779, 868.3511111111115, 869.6200000000007, 868.4777777777783, 868.7633333333338, 868.9533333333336, 868.667777777778, 868.9222222222223, 868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226, 868.3822222222226, 868.9222222222224, 868.1288888888888, 867.8433333333336, 867.6222222222223, 867.7500000000001, 866.5755555555555, 867.6244444444443, 867.8977777777781, 869.6522222222227, 868.7000000000004, 868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [866.9877777777782, 868.5400000000009, 870.0011111111115, 869.0166666666672, 868.5411111111116, 869.7155555555561, 868.7644444444447, 867.4311111111112, 865.8755555555556, 867.9399999999999, 868.984444444445, 868.6355555555559, 868.6355555555559, 869.0800000000005, 868.0011111111115, 869.1122222222227, 867.9377777777781, 869.4622222222227, 867.9711111111111, 868.3211111111116, 867.5288888888889, 868.1955555555555, 865.6566666666665, 867.5922222222221, 866.6411111111111, 867.9400000000002, 867.6866666666668, 866.0988888888891, 866.7333333333337, 867.146666666667, 868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445, 868.2877777777779, 868.3511111111115, 869.6200000000007, 868.4777777777783, 868.7633333333338, 868.9533333333336, 868.667777777778, 868.9222222222223, 868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226, 868.3822222222226, 868.9222222222224, 868.1288888888888, 867.8433333333336, 867.6222222222223, 867.7500000000001, 866.5755555555555, 867.6244444444443, 867.8977777777781, 869.6522222222227, 868.7000000000004, 868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20131283996220503, "mean_inference_ms": 1.8410367844207574, "mean_action_processing_ms": 0.07552318596707605, "mean_env_wait_ms": 1.2368520116562438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004827022552490234, "StateBufferConnector_ms": 0.0029931068420410156, "ViewRequirementAgentConnector_ms": 0.07124876976013184}, "num_episodes": 24, "episode_return_max": 870.3177777777782, "episode_return_min": 865.1799999999998, "episode_return_mean": 867.9946111111111, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 457650, "num_agent_steps_trained": 457500, "num_env_steps_sampled": 457650, "num_env_steps_trained": 457500, "num_env_steps_sampled_this_iter": 2550, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 253.4107332293262, "num_env_steps_trained_throughput_per_sec": 268.31724694869837, "timesteps_total": 457650, "num_env_steps_sampled_lifetime": 457650, "num_agent_steps_sampled_lifetime": 457650, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 457650, "timers": {"training_iteration_time_ms": 10234.028, "restore_workers_time_ms": 0.014, "training_step_time_ms": 547.682, "sample_time_ms": 532.101, "synch_weights_time_ms": 14.198}, "counters": {"num_env_steps_sampled": 457650, "num_env_steps_trained": 457500, "num_agent_steps_sampled": 457650, "num_agent_steps_trained": 457500, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3051, "num_samples_added_to_queue": 457500}, "done": false, "training_iteration": 157, "trial_id": "38f59_00000", "date": "2024-10-10_22-38-29", "timestamp": 1728596309, "time_this_iter_s": 10.074231147766113, "time_total_s": 1611.2089371681213, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fde4160>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1611.2089371681213, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 14.073333333333334, "ram_util_percent": 71.46000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2595.424072265625, "policy_loss": 614.2566528320312, "entropy": 4.8974223136901855, "entropy_coeff": 0.01, "var_gnorm": 17.863414764404297, "vf_loss": 199585.984375, "vf_explained_var": 0.6333876848220825}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1534.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 460500, "num_env_steps_trained": 460200, "num_agent_steps_sampled": 460500, "num_agent_steps_trained": 460200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3070, "num_samples_added_to_queue": 460500, "learner_queue": {"size_count": 1534, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 49.085, "learner_load_time_ms": 0.199, "learner_load_wait_time_ms": 1050.863, "learner_dequeue_time_ms": 9157.107}}, "env_runners": {"episode_reward_max": 870.3177777777782, "episode_reward_min": 863.2177777777767, "episode_reward_mean": 867.0316444444443, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 863.2177777777767}, "policy_reward_max": {"default_policy": 870.3177777777782}, "policy_reward_mean": {"default_policy": 867.0316444444443}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.31, "num_moves_min": 0.04, "num_moves_max": 0.53, "mean_accuracy_mean": 40.264886666666655, "mean_accuracy_min": 39.97266666666666, "mean_accuracy_max": 40.453999999999986, "num_model_switches_mean": 0.31339999999999996, "num_model_switches_min": 0.04, "num_model_switches_max": 0.57, "num_slav_mean": 0.0006804999999999999, "num_slav_min": 0.0002666666666666667, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.5004578936557731, "mean_cluster_cpu_util_min": 0.494953093399522, "mean_cluster_cpu_util_max": 0.504252861279647, "mean_cluster_mem_util_mean": 0.3268376991033755, "mean_cluster_mem_util_min": 0.32550316455696204, "mean_cluster_mem_util_max": 0.32769620253164566, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.026488666666666, "reward_accuracy_mean_min": 3.997266666666667, "reward_accuracy_mean_max": 4.0454, "reward_sla_mean_mean": -0.022683333333333337, "reward_sla_mean_min": -0.04000000000000001, "reward_sla_mean_max": -0.008888888888888889, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 402.64886666666666, "reward_accuracy_sum_min": 399.7266666666667, "reward_accuracy_sum_max": 404.54, "reward_sla_sum_mean": -2.2683333333333335, "reward_sla_sum_min": -4.000000000000001, "reward_sla_sum_max": -0.888888888888889, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3653.0, "global_timestep_min": 1700, "global_timestep_max": 5300}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445, 868.2877777777779, 868.3511111111115, 869.6200000000007, 868.4777777777783, 868.7633333333338, 868.9533333333336, 868.667777777778, 868.9222222222223, 868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226, 868.3822222222226, 868.9222222222224, 868.1288888888888, 867.8433333333336, 867.6222222222223, 867.7500000000001, 866.5755555555555, 867.6244444444443, 867.8977777777781, 869.6522222222227, 868.7000000000004, 868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998, 866.9599999999995, 865.6599999999994, 865.7233333333329, 863.2177777777767, 865.6611111111106, 865.1222222222214, 864.4877777777768, 863.8533333333321, 863.408888888888, 863.7888888888883, 866.1033333333328, 865.977777777777, 865.6611111111101, 865.0588888888881, 865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.0355555555557, 867.1477777777778, 866.0688888888889, 868.4800000000005, 866.8622222222223, 866.2266666666665, 865.5288888888888, 868.4477777777778, 867.8444444444447, 865.2433333333336, 867.1477777777778, 867.9733333333332, 866.7033333333335, 866.8933333333332, 867.4644444444446, 866.9266666666666, 867.2744444444444, 867.3055555555554, 867.8444444444445, 868.2877777777779, 868.3511111111115, 869.6200000000007, 868.4777777777783, 868.7633333333338, 868.9533333333336, 868.667777777778, 868.9222222222223, 868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226, 868.3822222222226, 868.9222222222224, 868.1288888888888, 867.8433333333336, 867.6222222222223, 867.7500000000001, 866.5755555555555, 867.6244444444443, 867.8977777777781, 869.6522222222227, 868.7000000000004, 868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998, 866.9599999999995, 865.6599999999994, 865.7233333333329, 863.2177777777767, 865.6611111111106, 865.1222222222214, 864.4877777777768, 863.8533333333321, 863.408888888888, 863.7888888888883, 866.1033333333328, 865.977777777777, 865.6611111111101, 865.0588888888881, 865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2013496652496962, "mean_inference_ms": 1.8402771260070665, "mean_action_processing_ms": 0.07553695561154447, "mean_env_wait_ms": 1.236961211456101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004692792892456055, "StateBufferConnector_ms": 0.0029904842376708984, "ViewRequirementAgentConnector_ms": 0.07100796699523926}, "num_episodes": 30, "episode_return_max": 870.3177777777782, "episode_return_min": 863.2177777777767, "episode_return_mean": 867.0316444444443, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460500, "num_agent_steps_trained": 460200, "num_env_steps_sampled": 460500, "num_env_steps_trained": 460200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 273.7028620092752, "num_env_steps_trained_throughput_per_sec": 259.2974482193133, "timesteps_total": 460500, "num_env_steps_sampled_lifetime": 460500, "num_agent_steps_sampled_lifetime": 460500, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 460500, "timers": {"training_iteration_time_ms": 10270.025, "restore_workers_time_ms": 0.015, "training_step_time_ms": 571.277, "sample_time_ms": 554.436, "synch_weights_time_ms": 15.296}, "counters": {"num_env_steps_sampled": 460500, "num_env_steps_trained": 460200, "num_agent_steps_sampled": 460500, "num_agent_steps_trained": 460200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3070, "num_samples_added_to_queue": 460500}, "done": false, "training_iteration": 158, "trial_id": "38f59_00000", "date": "2024-10-10_22-38-39", "timestamp": 1728596319, "time_this_iter_s": 10.425239562988281, "time_total_s": 1621.6341767311096, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6440>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1621.6341767311096, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 12.293333333333335, "ram_util_percent": 70.57333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2432.973388671875, "policy_loss": 470.3906555175781, "entropy": 4.817722797393799, "entropy_coeff": 0.01, "var_gnorm": 17.886585235595703, "vf_loss": 197703.59375, "vf_explained_var": 0.6346871852874756}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1544.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 463350, "num_env_steps_trained": 463200, "num_agent_steps_sampled": 463350, "num_agent_steps_trained": 463200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3089, "num_samples_added_to_queue": 463200, "learner_queue": {"size_count": 1544, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 60.706, "learner_load_time_ms": 0.174, "learner_load_wait_time_ms": 1052.829, "learner_dequeue_time_ms": 9185.2}}, "env_runners": {"episode_reward_max": 870.3177777777782, "episode_reward_min": 862.7099999999994, "episode_reward_mean": 866.146022222222, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.7099999999994}, "policy_reward_max": {"default_policy": 870.3177777777782}, "policy_reward_mean": {"default_policy": 866.146022222222}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.3114, "num_moves_min": 0.04, "num_moves_max": 0.53, "mean_accuracy_mean": 40.172546666666655, "mean_accuracy_min": 39.92833333333332, "mean_accuracy_max": 40.453999999999986, "num_model_switches_mean": 0.31770000000000004, "num_model_switches_min": 0.04, "num_model_switches_max": 0.56, "num_slav_mean": 0.0006644999999999999, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.49898901343307595, "mean_cluster_cpu_util_min": 0.4939729471180363, "mean_cluster_cpu_util_max": 0.5040728304835447, "mean_cluster_mem_util_mean": 0.32643084915611814, "mean_cluster_mem_util_min": 0.32496848628691977, "mean_cluster_mem_util_max": 0.32769620253164566, "reward_consolidation_mean_mean": 4.666355555555555, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.017254666666667, "reward_accuracy_mean_min": 3.992833333333333, "reward_accuracy_mean_max": 4.0454, "reward_sla_mean_mean": -0.02215, "reward_sla_mean_min": -0.04000000000000001, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.63555555555547, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 401.7254666666667, "reward_accuracy_sum_min": 399.2833333333333, "reward_accuracy_sum_max": 404.54, "reward_sla_sum_mean": -2.2150000000000003, "reward_sla_sum_min": -4.000000000000001, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4562.0, "global_timestep_min": 2700, "global_timestep_max": 6200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226, 868.3822222222226, 868.9222222222224, 868.1288888888888, 867.8433333333336, 867.6222222222223, 867.7500000000001, 866.5755555555555, 867.6244444444443, 867.8977777777781, 869.6522222222227, 868.7000000000004, 868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998, 866.9599999999995, 865.6599999999994, 865.7233333333329, 863.2177777777767, 865.6611111111106, 865.1222222222214, 864.4877777777768, 863.8533333333321, 863.408888888888, 863.7888888888883, 866.1033333333328, 865.977777777777, 865.6611111111101, 865.0588888888881, 865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777, 862.7099999999994, 864.836666666666, 865.6299999999991, 864.2033333333325, 863.7266666666659, 864.7111111111101, 863.5688888888877, 864.2977777777769, 864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.065555555556, 868.1611111111115, 868.5411111111115, 867.9377777777781, 869.7788888888895, 868.4455555555561, 868.7311111111115, 868.3188888888892, 868.0966666666669, 868.3177777777782, 868.3822222222226, 867.5577777777783, 868.6044444444449, 868.6677777777782, 870.3177777777782, 868.0644444444448, 869.1122222222226, 869.2711111111115, 868.5722222222226, 868.3822222222226, 868.9222222222224, 868.1288888888888, 867.8433333333336, 867.6222222222223, 867.7500000000001, 866.5755555555555, 867.6244444444443, 867.8977777777781, 869.6522222222227, 868.7000000000004, 868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998, 866.9599999999995, 865.6599999999994, 865.7233333333329, 863.2177777777767, 865.6611111111106, 865.1222222222214, 864.4877777777768, 863.8533333333321, 863.408888888888, 863.7888888888883, 866.1033333333328, 865.977777777777, 865.6611111111101, 865.0588888888881, 865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777, 862.7099999999994, 864.836666666666, 865.6299999999991, 864.2033333333325, 863.7266666666659, 864.7111111111101, 863.5688888888877, 864.2977777777769, 864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20148513894729292, "mean_inference_ms": 1.842742881257464, "mean_action_processing_ms": 0.07558591313816077, "mean_env_wait_ms": 1.2377935793129722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004453420639038086, "StateBufferConnector_ms": 0.0029914379119873047, "ViewRequirementAgentConnector_ms": 0.07133269309997559}, "num_episodes": 27, "episode_return_max": 870.3177777777782, "episode_return_min": 862.7099999999994, "episode_return_mean": 866.146022222222, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 463350, "num_agent_steps_trained": 463200, "num_env_steps_sampled": 463350, "num_env_steps_trained": 463200, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 269.65303273327856, "num_env_steps_trained_throughput_per_sec": 283.84529761397744, "timesteps_total": 463350, "num_env_steps_sampled_lifetime": 463350, "num_agent_steps_sampled_lifetime": 463350, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 463350, "timers": {"training_iteration_time_ms": 10289.369, "restore_workers_time_ms": 0.013, "training_step_time_ms": 537.253, "sample_time_ms": 521.754, "synch_weights_time_ms": 14.155}, "counters": {"num_env_steps_sampled": 463350, "num_env_steps_trained": 463200, "num_agent_steps_sampled": 463350, "num_agent_steps_trained": 463200, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3089, "num_samples_added_to_queue": 463200}, "done": false, "training_iteration": 159, "trial_id": "38f59_00000", "date": "2024-10-10_22-38-50", "timestamp": 1728596330, "time_this_iter_s": 10.580503225326538, "time_total_s": 1632.2146799564362, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fdc7d90>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1632.2146799564362, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 11.440000000000001, "ram_util_percent": 70.77333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2020.408935546875, "policy_loss": 158.44320678710938, "entropy": 4.806917190551758, "entropy_coeff": 0.01, "var_gnorm": 17.897769927978516, "vf_loss": 187638.65625, "vf_explained_var": 0.6416137218475342}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1553.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 466200, "num_env_steps_trained": 465900, "num_agent_steps_sampled": 466200, "num_agent_steps_trained": 465900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3108, "num_samples_added_to_queue": 466200, "learner_queue": {"size_count": 1553, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 63.864, "learner_load_time_ms": 0.202, "learner_load_wait_time_ms": 1031.605, "learner_dequeue_time_ms": 8934.439}}, "env_runners": {"episode_reward_max": 869.5566666666671, "episode_reward_min": 862.2355555555547, "episode_reward_mean": 864.8313222222215, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.2355555555547}, "policy_reward_max": {"default_policy": 869.5566666666671}, "policy_reward_mean": {"default_policy": 864.8313222222215}, "custom_metrics": {"num_consolidated_mean": 2.9998, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.34590000000000004, "num_moves_min": 0.14, "num_moves_max": 0.53, "mean_accuracy_mean": 40.04024333333332, "mean_accuracy_min": 39.91566666666666, "mean_accuracy_max": 40.42233333333333, "num_model_switches_mean": 0.35479999999999995, "num_model_switches_min": 0.14, "num_model_switches_max": 0.56, "num_slav_mean": 0.0006619999999999999, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.49666046257354296, "mean_cluster_cpu_util_min": 0.49300633158668883, "mean_cluster_cpu_util_max": 0.5039026360544218, "mean_cluster_mem_util_mean": 0.3258408438818565, "mean_cluster_mem_util_min": 0.32496848628691977, "mean_cluster_mem_util_max": 0.32769620253164566, "reward_consolidation_mean_mean": 4.666355555555555, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.004024333333333, "reward_accuracy_mean_min": 3.991566666666667, "reward_accuracy_mean_max": 4.042233333333334, "reward_sla_mean_mean": -0.022066666666666665, "reward_sla_mean_min": -0.04000000000000001, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.63555555555547, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 400.4024333333333, "reward_accuracy_sum_min": 399.1566666666667, "reward_accuracy_sum_max": 404.22333333333336, "reward_sla_sum_mean": -2.206666666666667, "reward_sla_sum_min": -4.000000000000001, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5567.0, "global_timestep_min": 3600, "global_timestep_max": 7200}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998, 866.9599999999995, 865.6599999999994, 865.7233333333329, 863.2177777777767, 865.6611111111106, 865.1222222222214, 864.4877777777768, 863.8533333333321, 863.408888888888, 863.7888888888883, 866.1033333333328, 865.977777777777, 865.6611111111101, 865.0588888888881, 865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777, 862.7099999999994, 864.836666666666, 865.6299999999991, 864.2033333333325, 863.7266666666659, 864.7111111111101, 863.5688888888877, 864.2977777777769, 864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768, 863.1877777777769, 862.6466666666656, 864.3622222222211, 864.0444444444435, 865.2822222222213, 862.9655555555544, 864.139999999999, 864.0122222222212, 864.9333333333324, 863.9499999999991, 864.7744444444436, 865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [868.8900000000006, 868.858888888889, 868.446666666667, 868.1633333333334, 867.718888888889, 869.5566666666671, 867.6522222222226, 868.1922222222227, 866.3200000000003, 868.0655555555561, 867.6533333333336, 867.0833333333331, 865.1799999999998, 866.9599999999995, 865.6599999999994, 865.7233333333329, 863.2177777777767, 865.6611111111106, 865.1222222222214, 864.4877777777768, 863.8533333333321, 863.408888888888, 863.7888888888883, 866.1033333333328, 865.977777777777, 865.6611111111101, 865.0588888888881, 865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777, 862.7099999999994, 864.836666666666, 865.6299999999991, 864.2033333333325, 863.7266666666659, 864.7111111111101, 863.5688888888877, 864.2977777777769, 864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768, 863.1877777777769, 862.6466666666656, 864.3622222222211, 864.0444444444435, 865.2822222222213, 862.9655555555544, 864.139999999999, 864.0122222222212, 864.9333333333324, 863.9499999999991, 864.7744444444436, 865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2015810041121524, "mean_inference_ms": 1.8448119090364736, "mean_action_processing_ms": 0.07562771496435178, "mean_env_wait_ms": 1.238384369445602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004210948944091797, "StateBufferConnector_ms": 0.0028841495513916016, "ViewRequirementAgentConnector_ms": 0.06848263740539551}, "num_episodes": 30, "episode_return_max": 869.5566666666671, "episode_return_min": 862.2355555555547, "episode_return_mean": 864.8313222222215, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 466200, "num_agent_steps_trained": 465900, "num_env_steps_sampled": 466200, "num_env_steps_trained": 465900, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 275.98903216531016, "num_env_steps_trained_throughput_per_sec": 261.46329363029383, "timesteps_total": 466200, "num_env_steps_sampled_lifetime": 466200, "num_agent_steps_sampled_lifetime": 466200, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 466200, "timers": {"training_iteration_time_ms": 10267.447, "restore_workers_time_ms": 0.013, "training_step_time_ms": 541.668, "sample_time_ms": 526.563, "synch_weights_time_ms": 13.75}, "counters": {"num_env_steps_sampled": 466200, "num_env_steps_trained": 465900, "num_agent_steps_sampled": 466200, "num_agent_steps_trained": 465900, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3108, "num_samples_added_to_queue": 466200}, "done": false, "training_iteration": 160, "trial_id": "38f59_00000", "date": "2024-10-10_22-39-00", "timestamp": 1728596340, "time_this_iter_s": 10.339078664779663, "time_total_s": 1642.5537586212158, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1ffb6500>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1642.5537586212158, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 11.486666666666668, "ram_util_percent": 70.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1478.48974609375, "policy_loss": -582.1116333007812, "entropy": 4.869225978851318, "entropy_coeff": 0.01, "var_gnorm": 17.893630981445312, "vf_loss": 207520.90625, "vf_explained_var": 0.6174527406692505}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1562.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 468900, "num_env_steps_trained": 468600, "num_agent_steps_sampled": 468900, "num_agent_steps_trained": 468600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3126, "num_samples_added_to_queue": 468900, "learner_queue": {"size_count": 1562, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 71.464, "learner_load_time_ms": 0.209, "learner_load_wait_time_ms": 1087.339, "learner_dequeue_time_ms": 8947.546}}, "env_runners": {"episode_reward_max": 869.2411111111113, "episode_reward_min": 862.2355555555547, "episode_reward_mean": 864.8171999999994, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.2355555555547}, "policy_reward_max": {"default_policy": 869.2411111111113}, "policy_reward_mean": {"default_policy": 864.8171999999994}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.37359999999999993, "num_moves_min": 0.24, "num_moves_max": 0.62, "mean_accuracy_mean": 40.03371999999999, "mean_accuracy_min": 39.91566666666666, "mean_accuracy_max": 40.34633333333332, "num_model_switches_mean": 0.38250000000000006, "num_model_switches_min": 0.24, "num_model_switches_max": 0.62, "num_slav_mean": 0.0006513333333333333, "num_slav_min": 0.0002, "num_slav_max": 0.0012000000000000001, "mean_cluster_cpu_util_mean": 0.4966239421021787, "mean_cluster_cpu_util_min": 0.49300633158668883, "mean_cluster_cpu_util_max": 0.5037103097995955, "mean_cluster_mem_util_mean": 0.3258265677742616, "mean_cluster_mem_util_min": 0.32496848628691977, "mean_cluster_mem_util_max": 0.3273934599156118, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.003372000000001, "reward_accuracy_mean_min": 3.991566666666667, "reward_accuracy_mean_max": 4.034633333333334, "reward_sla_mean_mean": -0.02171111111111111, "reward_sla_mean_min": -0.04, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 400.33719999999994, "reward_accuracy_sum_min": 399.1566666666667, "reward_accuracy_sum_max": 403.46333333333337, "reward_sla_sum_mean": -2.171111111111111, "reward_sla_sum_min": -4.0, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 5756.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777, 862.7099999999994, 864.836666666666, 865.6299999999991, 864.2033333333325, 863.7266666666659, 864.7111111111101, 863.5688888888877, 864.2977777777769, 864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768, 863.1877777777769, 862.6466666666656, 864.3622222222211, 864.0444444444435, 865.2822222222213, 862.9655555555544, 864.139999999999, 864.0122222222212, 864.9333333333324, 863.9499999999991, 864.7744444444436, 865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325, 864.4877777777771, 864.3288888888883, 865.2477777777775, 866.0088888888884, 866.8333333333329, 865.1822222222218, 867.5911111111112, 867.0200000000003, 869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [865.3444444444436, 863.8533333333324, 864.7733333333324, 863.8533333333323, 863.5044444444436, 863.7888888888886, 866.4844444444439, 866.1033333333328, 865.3122222222214, 864.4555555555548, 863.82111111111, 864.7422222222214, 863.8211111111102, 864.4877777777766, 864.1699999999993, 864.677777777777, 862.7099999999994, 864.836666666666, 865.6299999999991, 864.2033333333325, 863.7266666666659, 864.7111111111101, 863.5688888888877, 864.2977777777769, 864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768, 863.1877777777769, 862.6466666666656, 864.3622222222211, 864.0444444444435, 865.2822222222213, 862.9655555555544, 864.139999999999, 864.0122222222212, 864.9333333333324, 863.9499999999991, 864.7744444444436, 865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325, 864.4877777777771, 864.3288888888883, 865.2477777777775, 866.0088888888884, 866.8333333333329, 865.1822222222218, 867.5911111111112, 867.0200000000003, 869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2015875736164414, "mean_inference_ms": 1.8440364149182715, "mean_action_processing_ms": 0.07562994357861656, "mean_env_wait_ms": 1.2383211398456617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004239797592163086, "StateBufferConnector_ms": 0.0028846263885498047, "ViewRequirementAgentConnector_ms": 0.06872773170471191}, "num_episodes": 27, "episode_return_max": 869.2411111111113, "episode_return_min": 862.2355555555547, "episode_return_mean": 864.8171999999994, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468900, "num_agent_steps_trained": 468600, "num_env_steps_sampled": 468900, "num_env_steps_trained": 468600, "num_env_steps_sampled_this_iter": 2700, "num_env_steps_trained_this_iter": 2700, "num_env_steps_sampled_throughput_per_sec": 259.8713707231571, "num_env_steps_trained_throughput_per_sec": 259.8713707231571, "timesteps_total": 468900, "num_env_steps_sampled_lifetime": 468900, "num_agent_steps_sampled_lifetime": 468900, "num_steps_trained_this_iter": 2700, "agent_timesteps_total": 468900, "timers": {"training_iteration_time_ms": 10278.383, "restore_workers_time_ms": 0.013, "training_step_time_ms": 590.305, "sample_time_ms": 574.927, "synch_weights_time_ms": 13.896}, "counters": {"num_env_steps_sampled": 468900, "num_env_steps_trained": 468600, "num_agent_steps_sampled": 468900, "num_agent_steps_trained": 468600, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3126, "num_samples_added_to_queue": 468900}, "done": false, "training_iteration": 161, "trial_id": "38f59_00000", "date": "2024-10-10_22-39-11", "timestamp": 1728596351, "time_this_iter_s": 10.403076171875, "time_total_s": 1652.9568347930908, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc18ee0>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1652.9568347930908, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 11.700000000000001, "ram_util_percent": 71.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2121.55029296875, "policy_loss": 222.35385131835938, "entropy": 4.554809093475342, "entropy_coeff": 0.01, "var_gnorm": 17.875688552856445, "vf_loss": 191286.09375, "vf_explained_var": 0.6504725217819214}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1570.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 471300, "num_env_steps_trained": 471000, "num_agent_steps_sampled": 471300, "num_agent_steps_trained": 471000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3142, "num_samples_added_to_queue": 471300, "learner_queue": {"size_count": 1570, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 78.692, "learner_load_time_ms": 0.236, "learner_load_wait_time_ms": 1235.118, "learner_dequeue_time_ms": 9162.048}}, "env_runners": {"episode_reward_max": 869.9055555555562, "episode_reward_min": 862.2355555555547, "episode_reward_mean": 865.6862999999996, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.2355555555547}, "policy_reward_max": {"default_policy": 869.9055555555562}, "policy_reward_mean": {"default_policy": 865.6862999999996}, "custom_metrics": {"num_consolidated_mean": 2.9999000000000002, "num_consolidated_min": 2.99, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.32750000000000007, "num_moves_min": 0.04, "num_moves_max": 0.62, "mean_accuracy_mean": 40.126629999999984, "mean_accuracy_min": 39.91566666666666, "mean_accuracy_max": 40.453999999999986, "num_model_switches_mean": 0.3368, "num_model_switches_min": 0.04, "num_model_switches_max": 0.62, "num_slav_mean": 0.0006693333333333334, "num_slav_min": 0.0002, "num_slav_max": 0.0014666666666666665, "mean_cluster_cpu_util_mean": 0.49811877686040623, "mean_cluster_cpu_util_min": 0.49300633158668883, "mean_cluster_cpu_util_max": 0.5043319084390513, "mean_cluster_mem_util_mean": 0.3262229707278481, "mean_cluster_mem_util_min": 0.32496848628691977, "mean_cluster_mem_util_max": 0.32771202531645566, "reward_consolidation_mean_mean": 4.66651111111111, "reward_consolidation_mean_min": 4.65111111111111, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.012663, "reward_accuracy_mean_min": 3.991566666666667, "reward_accuracy_mean_max": 4.0454, "reward_sla_mean_mean": -0.02231111111111111, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.65111111111105, "reward_consolidation_sum_min": 465.111111111111, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 401.26630000000006, "reward_accuracy_sum_min": 399.1566666666667, "reward_accuracy_sum_max": 404.54, "reward_sla_sum_mean": -2.2311111111111113, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 4688.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768, 863.1877777777769, 862.6466666666656, 864.3622222222211, 864.0444444444435, 865.2822222222213, 862.9655555555544, 864.139999999999, 864.0122222222212, 864.9333333333324, 863.9499999999991, 864.7744444444436, 865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325, 864.4877777777771, 864.3288888888883, 865.2477777777775, 866.0088888888884, 866.8333333333329, 865.1822222222218, 867.5911111111112, 867.0200000000003, 869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445, 867.3688888888888, 868.0977777777784, 867.3988888888892, 868.3188888888894, 866.7955555555559, 867.7788888888894, 869.0800000000006, 869.873333333334, 867.9400000000002, 866.0022222222224, 868.3822222222226, 867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [864.7422222222211, 865.789999999999, 863.9799999999989, 864.296666666666, 864.8055555555545, 864.1066666666661, 863.757777777777, 864.298888888888, 864.8066666666657, 863.5366666666658, 865.0899999999995, 864.6455555555549, 864.3299999999992, 864.3299999999991, 863.8222222222213, 864.1711111111103, 864.329999999999, 863.7277777777767, 864.6477777777768, 863.1877777777769, 862.6466666666656, 864.3622222222211, 864.0444444444435, 865.2822222222213, 862.9655555555544, 864.139999999999, 864.0122222222212, 864.9333333333324, 863.9499999999991, 864.7744444444436, 865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325, 864.4877777777771, 864.3288888888883, 865.2477777777775, 866.0088888888884, 866.8333333333329, 865.1822222222218, 867.5911111111112, 867.0200000000003, 869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445, 867.3688888888888, 868.0977777777784, 867.3988888888892, 868.3188888888894, 866.7955555555559, 867.7788888888894, 869.0800000000006, 869.873333333334, 867.9400000000002, 866.0022222222224, 868.3822222222226, 867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20170853395956367, "mean_inference_ms": 1.8453788332615948, "mean_action_processing_ms": 0.07566371796564388, "mean_env_wait_ms": 1.2389738438439861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043909549713134766, "StateBufferConnector_ms": 0.0029549598693847656, "ViewRequirementAgentConnector_ms": 0.07071733474731445}, "num_episodes": 24, "episode_return_max": 869.9055555555562, "episode_return_min": 862.2355555555547, "episode_return_mean": 865.6862999999996, "episodes_this_iter": 24}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 471300, "num_agent_steps_trained": 471000, "num_env_steps_sampled": 471300, "num_env_steps_trained": 471000, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 228.78849616558853, "num_env_steps_trained_throughput_per_sec": 228.78849616558853, "timesteps_total": 471300, "num_env_steps_sampled_lifetime": 471300, "num_agent_steps_sampled_lifetime": 471300, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 471300, "timers": {"training_iteration_time_ms": 10312.433, "restore_workers_time_ms": 0.014, "training_step_time_ms": 674.225, "sample_time_ms": 656.696, "synch_weights_time_ms": 15.989}, "counters": {"num_env_steps_sampled": 471300, "num_env_steps_trained": 471000, "num_agent_steps_sampled": 471300, "num_agent_steps_trained": 471000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3142, "num_samples_added_to_queue": 471300}, "done": false, "training_iteration": 162, "trial_id": "38f59_00000", "date": "2024-10-10_22-39-21", "timestamp": 1728596361, "time_this_iter_s": 10.504633903503418, "time_total_s": 1663.4614686965942, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cfe80>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1663.4614686965942, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 18.260000000000005, "ram_util_percent": 73.34666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 1174.120849609375, "policy_loss": -638.3475341796875, "entropy": 4.735098838806152, "entropy_coeff": 0.01, "var_gnorm": 17.855440139770508, "vf_loss": 182667.375, "vf_explained_var": 0.6582084894180298}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1580.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 474300, "num_env_steps_trained": 474000, "num_agent_steps_sampled": 474300, "num_agent_steps_trained": 474000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3162, "num_samples_added_to_queue": 474300, "learner_queue": {"size_count": 1580, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 67.023, "learner_load_time_ms": 0.256, "learner_load_wait_time_ms": 979.554, "learner_dequeue_time_ms": 9135.623}}, "env_runners": {"episode_reward_max": 870.0955555555563, "episode_reward_min": 862.2355555555547, "episode_reward_mean": 866.9553, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 862.2355555555547}, "policy_reward_max": {"default_policy": 870.0955555555563}, "policy_reward_mean": {"default_policy": 866.9553}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2690000000000001, "num_moves_min": 0.04, "num_moves_max": 0.62, "mean_accuracy_mean": 40.261529999999986, "mean_accuracy_min": 39.91566666666666, "mean_accuracy_max": 40.466666666666654, "num_model_switches_mean": 0.27520000000000006, "num_model_switches_min": 0.04, "num_model_switches_max": 0.62, "num_slav_mean": 0.0006979999999999998, "num_slav_min": 0.0002, "num_slav_max": 0.0014666666666666665, "mean_cluster_cpu_util_mean": 0.500339069567016, "mean_cluster_cpu_util_min": 0.49300633158668883, "mean_cluster_cpu_util_max": 0.5051948428019856, "mean_cluster_mem_util_mean": 0.3268058122362869, "mean_cluster_mem_util_min": 0.32523892405063287, "mean_cluster_mem_util_max": 0.3277842827004219, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.026153000000001, "reward_accuracy_mean_min": 3.991566666666667, "reward_accuracy_mean_max": 4.046666666666667, "reward_sla_mean_mean": -0.02326666666666666, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 402.6153, "reward_accuracy_sum_min": 399.1566666666667, "reward_accuracy_sum_max": 404.6666666666667, "reward_sla_sum_mean": -2.326666666666667, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 3339.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325, 864.4877777777771, 864.3288888888883, 865.2477777777775, 866.0088888888884, 866.8333333333329, 865.1822222222218, 867.5911111111112, 867.0200000000003, 869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445, 867.3688888888888, 868.0977777777784, 867.3988888888892, 868.3188888888894, 866.7955555555559, 867.7788888888894, 869.0800000000006, 869.873333333334, 867.9400000000002, 866.0022222222224, 868.3822222222226, 867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226, 870.0955555555563, 869.0800000000007, 868.0955555555558, 869.5877777777785, 869.5244444444451, 868.0333333333338, 867.5566666666673, 867.9066666666669, 867.8755555555556, 868.5411111111115, 869.7777777777782, 867.5877777777783, 869.1433333333341, 869.302222222223, 868.5088888888893, 867.9700000000004, 868.2555555555558, 867.747777777778, 867.5577777777781, 868.8266666666673, 869.3655555555562, 868.2544444444447, 868.4766666666671, 868.6988888888895, 867.8100000000005, 869.3344444444448, 868.2555555555558, 868.1611111111116, 867.3033333333335, 867.7800000000002], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [865.6311111111103, 863.3788888888878, 863.25111111111, 864.2977777777767, 864.0766666666657, 862.2355555555547, 864.4888888888879, 863.2833333333325, 862.7744444444435, 863.0611111111101, 864.9644444444435, 865.3466666666657, 865.1866666666658, 864.6155555555547, 863.0922222222212, 864.2666666666659, 863.6322222222211, 864.107777777777, 864.5833333333325, 864.4877777777771, 864.3288888888883, 865.2477777777775, 866.0088888888884, 866.8333333333329, 865.1822222222218, 867.5911111111112, 867.0200000000003, 869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445, 867.3688888888888, 868.0977777777784, 867.3988888888892, 868.3188888888894, 866.7955555555559, 867.7788888888894, 869.0800000000006, 869.873333333334, 867.9400000000002, 866.0022222222224, 868.3822222222226, 867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226, 870.0955555555563, 869.0800000000007, 868.0955555555558, 869.5877777777785, 869.5244444444451, 868.0333333333338, 867.5566666666673, 867.9066666666669, 867.8755555555556, 868.5411111111115, 869.7777777777782, 867.5877777777783, 869.1433333333341, 869.302222222223, 868.5088888888893, 867.9700000000004, 868.2555555555558, 867.747777777778, 867.5577777777781, 868.8266666666673, 869.3655555555562, 868.2544444444447, 868.4766666666671, 868.6988888888895, 867.8100000000005, 869.3344444444448, 868.2555555555558, 868.1611111111116, 867.3033333333335, 867.7800000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20175273897772236, "mean_inference_ms": 1.8448660782114734, "mean_action_processing_ms": 0.07567914336615006, "mean_env_wait_ms": 1.2391515726483433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043087005615234375, "StateBufferConnector_ms": 0.0029273033142089844, "ViewRequirementAgentConnector_ms": 0.06969738006591797}, "num_episodes": 30, "episode_return_max": 870.0955555555563, "episode_return_min": 862.2355555555547, "episode_return_mean": 866.9553, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 474300, "num_agent_steps_trained": 474000, "num_env_steps_sampled": 474300, "num_env_steps_trained": 474000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 288.1356747251334, "num_env_steps_trained_throughput_per_sec": 288.1356747251334, "timesteps_total": 474300, "num_env_steps_sampled_lifetime": 474300, "num_agent_steps_sampled_lifetime": 474300, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 474300, "timers": {"training_iteration_time_ms": 10349.361, "restore_workers_time_ms": 0.013, "training_step_time_ms": 525.29, "sample_time_ms": 510.3, "synch_weights_time_ms": 13.671}, "counters": {"num_env_steps_sampled": 474300, "num_env_steps_trained": 474000, "num_agent_steps_sampled": 474300, "num_agent_steps_trained": 474000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3162, "num_samples_added_to_queue": 474300}, "done": false, "training_iteration": 163, "trial_id": "38f59_00000", "date": "2024-10-10_22-39-32", "timestamp": 1728596372, "time_this_iter_s": 10.421703100204468, "time_total_s": 1673.8831717967987, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cf310>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1673.8831717967987, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 10.513333333333334, "ram_util_percent": 74.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2010.7637939453125, "policy_loss": 188.39111328125, "entropy": 4.874496936798096, "entropy_coeff": 0.01, "var_gnorm": 17.852209091186523, "vf_loss": 183699.625, "vf_explained_var": 0.6438584327697754}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1590.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 477150, "num_env_steps_trained": 477000, "num_agent_steps_sampled": 477150, "num_agent_steps_trained": 477000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3181, "num_samples_added_to_queue": 477000, "learner_queue": {"size_count": 1590, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 54.639, "learner_load_time_ms": 0.269, "learner_load_wait_time_ms": 1024.542, "learner_dequeue_time_ms": 9095.183}}, "env_runners": {"episode_reward_max": 870.0955555555563, "episode_reward_min": 863.1533333333326, "episode_reward_mean": 867.9427333333338, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 863.1533333333326}, "policy_reward_max": {"default_policy": 870.0955555555563}, "policy_reward_mean": {"default_policy": 867.9427333333338}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.2513, "num_moves_min": 0.04, "num_moves_max": 0.55, "mean_accuracy_mean": 40.357606666666655, "mean_accuracy_min": 39.99799999999999, "mean_accuracy_max": 40.466666666666654, "num_model_switches_mean": 0.2534, "num_model_switches_min": 0.04, "num_model_switches_max": 0.59, "num_slav_mean": 0.0006900000000000002, "num_slav_min": 0.0002, "num_slav_max": 0.0014666666666666665, "mean_cluster_cpu_util_mean": 0.5020470266822945, "mean_cluster_cpu_util_min": 0.49500894006251145, "mean_cluster_cpu_util_max": 0.5051948428019856, "mean_cluster_mem_util_mean": 0.32723806434599156, "mean_cluster_mem_util_min": 0.32542774261603374, "mean_cluster_mem_util_max": 0.3277842827004219, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.0357606666666666, "reward_accuracy_mean_min": 3.9997999999999996, "reward_accuracy_mean_max": 4.046666666666667, "reward_sla_mean_mean": -0.023000000000000003, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.5760666666668, "reward_accuracy_sum_min": 399.97999999999996, "reward_accuracy_sum_max": 404.6666666666667, "reward_sla_sum_mean": -2.3000000000000003, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2298.0, "global_timestep_min": 100, "global_timestep_max": 7800}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445, 867.3688888888888, 868.0977777777784, 867.3988888888892, 868.3188888888894, 866.7955555555559, 867.7788888888894, 869.0800000000006, 869.873333333334, 867.9400000000002, 866.0022222222224, 868.3822222222226, 867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226, 870.0955555555563, 869.0800000000007, 868.0955555555558, 869.5877777777785, 869.5244444444451, 868.0333333333338, 867.5566666666673, 867.9066666666669, 867.8755555555556, 868.5411111111115, 869.7777777777782, 867.5877777777783, 869.1433333333341, 869.302222222223, 868.5088888888893, 867.9700000000004, 868.2555555555558, 867.747777777778, 867.5577777777781, 868.8266666666673, 869.3655555555562, 868.2544444444447, 868.4766666666671, 868.6988888888895, 867.8100000000005, 869.3344444444448, 868.2555555555558, 868.1611111111116, 867.3033333333335, 867.7800000000002, 867.8122222222224, 867.4944444444445, 868.923333333334, 867.7811111111114, 867.7800000000003, 869.1766666666672, 867.9077777777779, 867.7811111111114, 866.5744444444446, 869.3988888888894, 868.8277777777781, 869.7800000000004, 868.4466666666672, 868.8911111111117, 867.8122222222221, 868.6366666666669, 867.9077777777779, 867.6866666666667, 866.3200000000002, 868.8911111111115, 867.017777777778, 867.4944444444449, 869.3355555555559, 868.5733333333338, 868.1288888888892, 868.3200000000003, 869.0177777777782], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [869.2411111111113, 864.646666666666, 863.1533333333326, 865.5633333333328, 866.7055555555552, 866.4511111111107, 866.9900000000001, 868.2911111111113, 866.1944444444446, 868.2255555555557, 863.5033333333326, 865.5666666666662, 866.1677777777774, 865.8499999999997, 865.6899999999996, 866.3555555555555, 868.3211111111116, 868.7022222222224, 868.7344444444445, 867.3688888888888, 868.0977777777784, 867.3988888888892, 868.3188888888894, 866.7955555555559, 867.7788888888894, 869.0800000000006, 869.873333333334, 867.9400000000002, 866.0022222222224, 868.3822222222226, 867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226, 870.0955555555563, 869.0800000000007, 868.0955555555558, 869.5877777777785, 869.5244444444451, 868.0333333333338, 867.5566666666673, 867.9066666666669, 867.8755555555556, 868.5411111111115, 869.7777777777782, 867.5877777777783, 869.1433333333341, 869.302222222223, 868.5088888888893, 867.9700000000004, 868.2555555555558, 867.747777777778, 867.5577777777781, 868.8266666666673, 869.3655555555562, 868.2544444444447, 868.4766666666671, 868.6988888888895, 867.8100000000005, 869.3344444444448, 868.2555555555558, 868.1611111111116, 867.3033333333335, 867.7800000000002, 867.8122222222224, 867.4944444444445, 868.923333333334, 867.7811111111114, 867.7800000000003, 869.1766666666672, 867.9077777777779, 867.7811111111114, 866.5744444444446, 869.3988888888894, 868.8277777777781, 869.7800000000004, 868.4466666666672, 868.8911111111117, 867.8122222222221, 868.6366666666669, 867.9077777777779, 867.6866666666667, 866.3200000000002, 868.8911111111115, 867.017777777778, 867.4944444444449, 869.3355555555559, 868.5733333333338, 868.1288888888892, 868.3200000000003, 869.0177777777782]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2018663683185594, "mean_inference_ms": 1.8474425252608093, "mean_action_processing_ms": 0.0757216222705701, "mean_env_wait_ms": 1.2399696341272612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004159450531005859, "StateBufferConnector_ms": 0.0028879642486572266, "ViewRequirementAgentConnector_ms": 0.06831789016723633}, "num_episodes": 27, "episode_return_max": 870.0955555555563, "episode_return_min": 863.1533333333326, "episode_return_mean": 867.9427333333338, "episodes_this_iter": 27}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 477150, "num_agent_steps_trained": 477000, "num_env_steps_sampled": 477150, "num_env_steps_trained": 477000, "num_env_steps_sampled_this_iter": 2850, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 277.9812049499853, "num_env_steps_trained_throughput_per_sec": 292.61179468419505, "timesteps_total": 477150, "num_env_steps_sampled_lifetime": 477150, "num_agent_steps_sampled_lifetime": 477150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 477150, "timers": {"training_iteration_time_ms": 10327.802, "restore_workers_time_ms": 0.013, "training_step_time_ms": 533.228, "sample_time_ms": 518.963, "synch_weights_time_ms": 12.927}, "counters": {"num_env_steps_sampled": 477150, "num_env_steps_trained": 477000, "num_agent_steps_sampled": 477150, "num_agent_steps_trained": 477000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3181, "num_samples_added_to_queue": 477000}, "done": false, "training_iteration": 164, "trial_id": "38f59_00000", "date": "2024-10-10_22-39-42", "timestamp": 1728596382, "time_this_iter_s": 10.268239736557007, "time_total_s": 1684.1514115333557, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1d2cee00>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1684.1514115333557, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 10.426666666666668, "ram_util_percent": 73.62666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.0, "cur_lr": 0.0001, "total_loss": 2146.21142578125, "policy_loss": 356.42877197265625, "entropy": 4.997164249420166, "entropy_coeff": 0.01, "var_gnorm": 17.864761352539062, "vf_loss": 180477.40625, "vf_explained_var": 0.6453661322593689}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 256.0, "num_grad_updates_lifetime": 1600.0, "diff_num_grad_updates_vs_sampler_policy": 0.5}}, "num_env_steps_sampled": 480150, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480150, "num_agent_steps_trained": 480000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3201, "num_samples_added_to_queue": 480000, "learner_queue": {"size_count": 1600, "size_mean": 0.0, "size_std": 0.0, "size_quantiles": [0.0, 0.0, 0.0, 0.0, 0.0]}, "timing_breakdown": {"learner_grad_time_ms": 55.034, "learner_load_time_ms": 0.3, "learner_load_wait_time_ms": 994.019, "learner_dequeue_time_ms": 9047.473}}, "env_runners": {"episode_reward_max": 870.0955555555563, "episode_reward_min": 865.431111111111, "episode_reward_mean": 867.8742111111112, "episode_len_mean": 100.0, "episode_media": {}, "episodes_timesteps_total": 10000, "policy_reward_min": {"default_policy": 865.431111111111}, "policy_reward_max": {"default_policy": 870.0955555555563}, "policy_reward_mean": {"default_policy": 867.8742111111112}, "custom_metrics": {"num_consolidated_mean": 3.0, "num_consolidated_min": 3.0, "num_consolidated_max": 3.0, "num_overloaded_mean": 0.0, "num_overloaded_min": 0.0, "num_overloaded_max": 0.0, "num_moves_mean": 0.27020000000000005, "num_moves_min": 0.04, "num_moves_max": 0.55, "mean_accuracy_mean": 40.355643333333326, "mean_accuracy_min": 40.11199999999999, "mean_accuracy_max": 40.466666666666654, "num_model_switches_mean": 0.2720000000000001, "num_model_switches_min": 0.04, "num_model_switches_max": 0.56, "num_slav_mean": 0.0007046666666666665, "num_slav_min": 0.0002, "num_slav_max": 0.0014666666666666665, "mean_cluster_cpu_util_mean": 0.5019278650717044, "mean_cluster_cpu_util_min": 0.495659898418827, "mean_cluster_cpu_util_max": 0.5051948428019856, "mean_cluster_mem_util_mean": 0.32722256856540083, "mean_cluster_mem_util_min": 0.3259941983122363, "mean_cluster_mem_util_max": 0.3277842827004219, "reward_consolidation_mean_mean": 4.666666666666666, "reward_consolidation_mean_min": 4.666666666666666, "reward_consolidation_mean_max": 4.666666666666666, "reward_illegal_mean_mean": 0.0, "reward_illegal_mean_min": 0.0, "reward_illegal_mean_max": 0.0, "reward_accuracy_mean_mean": 4.035564333333333, "reward_accuracy_mean_min": 4.0112, "reward_accuracy_mean_max": 4.046666666666667, "reward_sla_mean_mean": -0.023488888888888892, "reward_sla_mean_min": -0.04888888888888889, "reward_sla_mean_max": -0.006666666666666667, "reward_consolidation_sum_mean": 466.6666666666666, "reward_consolidation_sum_min": 466.6666666666666, "reward_consolidation_sum_max": 466.6666666666666, "reward_illegal_sum_mean": 0.0, "reward_illegal_sum_min": 0, "reward_illegal_sum_max": 0, "reward_accuracy_sum_mean": 403.5564333333334, "reward_accuracy_sum_min": 401.12, "reward_accuracy_sum_max": 404.6666666666667, "reward_sla_sum_mean": -2.348888888888889, "reward_sla_sum_min": -4.888888888888889, "reward_sla_sum_max": -0.6666666666666667, "timestep_mean": 100.0, "timestep_min": 100, "timestep_max": 100, "global_timestep_mean": 2367.0, "global_timestep_min": 400, "global_timestep_max": 4000}, "hist_stats": {"timestep": [], "global_timestep": [], "num_consolidated": [], "num_overloaded": [], "num_moves": [], "mean_accuracy": [], "num_slav": [], "num_model_switches": [], "rewards": [], "mean_cluster_cpu_util": [], "mean_cluster_mem_util": [], "episode_reward": [867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226, 870.0955555555563, 869.0800000000007, 868.0955555555558, 869.5877777777785, 869.5244444444451, 868.0333333333338, 867.5566666666673, 867.9066666666669, 867.8755555555556, 868.5411111111115, 869.7777777777782, 867.5877777777783, 869.1433333333341, 869.302222222223, 868.5088888888893, 867.9700000000004, 868.2555555555558, 867.747777777778, 867.5577777777781, 868.8266666666673, 869.3655555555562, 868.2544444444447, 868.4766666666671, 868.6988888888895, 867.8100000000005, 869.3344444444448, 868.2555555555558, 868.1611111111116, 867.3033333333335, 867.7800000000002, 867.8122222222224, 867.4944444444445, 868.923333333334, 867.7811111111114, 867.7800000000003, 869.1766666666672, 867.9077777777779, 867.7811111111114, 866.5744444444446, 869.3988888888894, 868.8277777777781, 869.7800000000004, 868.4466666666672, 868.8911111111117, 867.8122222222221, 868.6366666666669, 867.9077777777779, 867.6866666666667, 866.3200000000002, 868.8911111111115, 867.017777777778, 867.4944444444449, 869.3355555555559, 868.5733333333338, 868.1288888888892, 868.3200000000003, 869.0177777777782, 866.9566666666668, 867.6855555555559, 867.3377777777778, 866.3544444444443, 867.9411111111112, 867.1166666666666, 865.7522222222221, 865.8788888888885, 865.8811111111104, 865.8499999999996, 869.1455555555557, 867.3677777777779, 867.7166666666669, 867.5911111111112, 867.3055555555554, 866.8622222222219, 867.2111111111112, 865.6255555555554, 866.7055555555552, 865.913333333333, 866.8922222222225, 866.9244444444448, 867.6544444444446, 867.3055555555557, 865.8144444444447, 866.0377777777771, 867.2755555555555, 866.0688888888888, 866.3566666666662, 866.0088888888885], "episode_lengths": [100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100, 100], "policy_default_policy_reward": [867.9388888888893, 868.1922222222225, 867.9055555555559, 869.9055555555562, 869.1433333333338, 868.0355555555559, 865.431111111111, 866.9555555555559, 869.2711111111116, 869.0811111111116, 867.6200000000002, 868.6988888888894, 868.5722222222226, 870.0955555555563, 869.0800000000007, 868.0955555555558, 869.5877777777785, 869.5244444444451, 868.0333333333338, 867.5566666666673, 867.9066666666669, 867.8755555555556, 868.5411111111115, 869.7777777777782, 867.5877777777783, 869.1433333333341, 869.302222222223, 868.5088888888893, 867.9700000000004, 868.2555555555558, 867.747777777778, 867.5577777777781, 868.8266666666673, 869.3655555555562, 868.2544444444447, 868.4766666666671, 868.6988888888895, 867.8100000000005, 869.3344444444448, 868.2555555555558, 868.1611111111116, 867.3033333333335, 867.7800000000002, 867.8122222222224, 867.4944444444445, 868.923333333334, 867.7811111111114, 867.7800000000003, 869.1766666666672, 867.9077777777779, 867.7811111111114, 866.5744444444446, 869.3988888888894, 868.8277777777781, 869.7800000000004, 868.4466666666672, 868.8911111111117, 867.8122222222221, 868.6366666666669, 867.9077777777779, 867.6866666666667, 866.3200000000002, 868.8911111111115, 867.017777777778, 867.4944444444449, 869.3355555555559, 868.5733333333338, 868.1288888888892, 868.3200000000003, 869.0177777777782, 866.9566666666668, 867.6855555555559, 867.3377777777778, 866.3544444444443, 867.9411111111112, 867.1166666666666, 865.7522222222221, 865.8788888888885, 865.8811111111104, 865.8499999999996, 869.1455555555557, 867.3677777777779, 867.7166666666669, 867.5911111111112, 867.3055555555554, 866.8622222222219, 867.2111111111112, 865.6255555555554, 866.7055555555552, 865.913333333333, 866.8922222222225, 866.9244444444448, 867.6544444444446, 867.3055555555557, 865.8144444444447, 866.0377777777771, 867.2755555555555, 866.0688888888888, 866.3566666666662, 866.0088888888885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20189274629637932, "mean_inference_ms": 1.849312333983749, "mean_action_processing_ms": 0.07574537243855425, "mean_env_wait_ms": 1.240408113585475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003994941711425781, "StateBufferConnector_ms": 0.002810955047607422, "ViewRequirementAgentConnector_ms": 0.06632232666015625}, "num_episodes": 30, "episode_return_max": 870.0955555555563, "episode_return_min": 865.431111111111, "episode_return_mean": 867.8742111111112, "episodes_this_iter": 30}, "num_healthy_workers": 3, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480150, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480150, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 3000, "num_env_steps_trained_this_iter": 3000, "num_env_steps_sampled_throughput_per_sec": 287.147146335755, "num_env_steps_trained_throughput_per_sec": 287.147146335755, "timesteps_total": 480150, "num_env_steps_sampled_lifetime": 480150, "num_agent_steps_sampled_lifetime": 480150, "num_steps_trained_this_iter": 3000, "agent_timesteps_total": 480150, "timers": {"training_iteration_time_ms": 10360.986, "restore_workers_time_ms": 0.013, "training_step_time_ms": 531.981, "sample_time_ms": 516.69, "synch_weights_time_ms": 13.941}, "counters": {"num_env_steps_sampled": 480150, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480150, "num_agent_steps_trained": 480000, "num_training_step_calls_since_last_synch_worker_weights": 0, "num_weight_broadcasts": 3201, "num_samples_added_to_queue": 480000}, "done": false, "training_iteration": 165, "trial_id": "38f59_00000", "date": "2024-10-10_22-39-53", "timestamp": 1728596393, "time_this_iter_s": 10.457456111907959, "time_total_s": 1694.6088676452637, "pid": 296821, "hostname": "support", "node_ip": "10.60.83.132", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'scheduler.oskube.envs.simulation.sim_edge_env.SimEdgeEnv'>", "env_config": {"obs_elements": ["cpu_predictions", "hosts_resources_alloc", "hosts_resources_req", "hosts_resources_usage", "containers_request", "containers_usage", "containers_accuracy", "containers_hosts", "sla_violations"], "penalty_illegal": -10, "penalty_sla": -5, "penalty_consolidation": 7, "penalty_accuracy": 10, "episode_length": 100, "accuracy_lower": 0, "accuracy_upper": 100, "consolidation_lower": 0, "consolidation_upper": 0.75, "sla_lower": 0, "sla_upper": 0.15, "no_action_on_overloaded": false, "overload_threshold": 0.8, "seed": 1, "prediction_length": 6, "datacenter": "<datacenter.Datacenter.DatacenterGeneration object at 0x7cfe1fc2ce50>", "datasets": {"bitbrains_path": "/home/babarali/OSKube/datasets/bitbrains/rnd", "yolo_path": "/home/babarali/OSKube/datasets/yolo"}, "scheduler_path": "/home/babarali/OSKube/scheduler"}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": 50, "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.0001, "grad_clip": 40.0, "grad_clip_by": "global_norm", "train_batch_size": 256, "train_batch_size_per_learner": 256, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "ReLU", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": "true", "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x7cfe19551c60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 203, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": true, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": true, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "buffer_size": 2048, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "vtrace": true, "vtrace_clip_rho_threshold": 2, "vtrace_clip_pg_rho_threshold": 2, "num_multi_gpu_tower_stacks": 1, "minibatch_buffer_size": 1, "num_sgd_iter": 1, "replay_proportion": 0.25, "replay_buffer_num_slots": 300, "learner_queue_size": 3, "learner_queue_timeout": 300, "max_requests_in_flight_per_aggregator_worker": 2, "timeout_s_sampler_manager": 0.0, "timeout_s_aggregator_manager": 0.0, "broadcast_interval": 1, "num_aggregation_workers": 0, "num_gpu_loader_threads": 8, "opt_type": "adam", "lr_schedule": null, "decay": 0.99, "momentum": 0.0, "epsilon": 0.1, "vf_loss_coeff": 0.01, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "_separate_vf_optimizer": false, "_lr_vf": 0.0005, "_minibatch_size": "auto", "__stdout_file__": null, "__stderr_file__": null, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'utils.callbacks.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1694.6088676452637, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 10.6, "ram_util_percent": 72.6}}
